/* @preserve 
 * @name: BUI v1.6.3  
 * @detail: BUI 是一个免费的UI交互框架, 用于快速定制开发WebApp,微信,混合移动应用(Bingotouch,Link,Dcloud,Apicloud,Appcan等).
 * @site: http://www.easybui.com/ 
 * Copyright © 2017-2020 BUI. All Rights Reserved. 
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e;window.libs=window.Zepto||window.jQuery||{},window.bui={},window.router={},(e=window.bui).debug=!0,e.hasRouter=!1,e.nativeRouter=!1,e.isWebapp,e.currentPlatform="",e.log=!0,e.trace=!1,e.native={},e.config={},e.config.namespace="bui",e.config.classNamePrefix=e.config.namespace+"-",e.config.version="1.6.3",e.config.versionCode=20201102,e.version=e.config.version,e.versionCode=e.config.versionCode,e.config.viewport={zoom:!0,create:!0},e.config.init={auto:!0},e.config.ready={},e.config.ajax={},e.config.get={},e.config.put={},e.config.delete={},e.config.post={},e.config.back={},e.config.load={},e.config.getPageParams={},e.config.refresh={},e.config.run={},e.config.checkVersion={},e.config.component={auto:!0},e.config.dialog={},e.config.confirm={},e.config.alert={},e.config.hint={},e.config.prompt={},e.config.loading={},e.config.mask={},e.config.list={},e.config.listview={},e.config.scroll={},e.config.pullrefresh={},e.config.select={},e.config.sidebar={},e.config.slide={},e.config.actionsheet={},e.config.dropdown={},e.config.accordion={},e.config.stepbar={},e.config.rating={},e.config.number={},e.config.file={},e.config.fileselect={},e.config.upload={},e.config.download={},e.config.swipe={},e.config.router={},e.config.loader={},e.config.loader.define={},e.config.loader.load={},e.config.loader.component={},e.config.store={},e.config.floor={},function(e,t){e.prefix=function(t){return e.config.classNamePrefix+t},e.showLog=function(t,n){n=n||"";var i="";"object"==typeof t&&"message"in t&&"name"in t?i=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(i=t),e.log&&console.error(n+" "+i),e.trace&&console.trace&&console.trace(),e.trigger("catcherror",t,n)},e.guid=function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(e=void 0===e?"bui":e||"")+t().substr(e.length)+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e.swipeDirection=function(e,t,n,i){var r=t-e,a=i-n,o=Math.abs(r),l=Math.abs(a);return!(o<9&&l<9)&&(o/l>3?r>0?"swiperight":"swipeleft":a>0?"swipedown":"swipeup")},e.obj=function(n,i){var r=null;i=i||null;var a=e.hasRouter&&router.currentPage()||"html",o=t(a=i||a),l="string"==typeof n;if("object"==typeof n)return r=t(n);if(l&&/^(\d)/.test(n))return r=o.find("[id='"+n+"']");if(l&&/^[a-zA-z]/.test(n)){var c=/^(html|head|body|header|main|footer|ul|li|section|dt|dd|div|span|img|article|i|strong|input|textarea|select|h1|h2|h3|h4|h5|h6|p|view|component|components|iframe)$/gi.test(n)||/^\[.+\]$/.test(n)||n.indexOf("[")>-1?n:"#"+n;return r=o.find(c)}return/^#\d/.test(n)?r=o.find("[id='"+n.substr(1)+"']"):/^\.\d/.test(n)?r=o.find("[class='"+n.substr(1)+"']"):n&&(r=o.find(n)),r},e.$=e.obj,e.objId=function(t){return e.obj(t,"html")},e.selector=function(e){return void 0===e?this:t(e,this)},e.widget=function(e){return e&&e in this?this[e]:this},e.option=function(n,i){if("object"!==e.typeof(n)&&void 0===i)return"string"==typeof n?this.config[n]:this.config;if("id"==n)return e.showLog("不允许修改控件的ID参数"),this;if(n&&"object"===e.typeof(n)){var r=t.extend(this.config,n);return this.init(r)}if(this.config.hasOwnProperty(n)){var a={};a[n]=i;r=t.extend(this.config,a);return this.init(r)}return this}}(window.bui||{},window.libs),function(e,t){e.emitter=function(){function t(){this.handle=Object.create(null)}return t.prototype.on=function(t,n,i){return"function"==typeof n?(i=n,n=this):(i=i,n=n||this),n.handle=n.handle||{},e.unit.stringToArray(t).forEach((function(e,t){void 0===n.handle[e]&&(n.handle[e]=[]),n.handle[e].push(i)})),n},t.prototype.off=function(t,n,i){"function"==typeof n?(i=n,n=this):"function"==typeof i?(i=i,n=n||this):n=this;var r=e.typeof(t);if(void 0===t)n.handle=Object.create(null);else if("string"===r&&"function"==typeof i){var a=n.handle[t]||[];e.array.remove(a,i)}else if("string"===r||"array"===r){"object"!=typeof n.handle&&(n.handle={}),e.unit.stringToArray(t).forEach((function(e,t){n.handle[e]=[]}))}return n},t.prototype.one=function(e,t){var n=this;return this.on(e,(function i(){t&&t.apply(n,arguments),n.off(e,i)})),this},t.prototype.wait=function(t,n){var i=this,r=e.unit.stringToArray(t),a=[],o=!0;return r.forEach((function(t,l){i.on(t,(function(t){a[l]=t,a.length===r.length&&o&&(r.forEach((function(t,n){a[n]=e.history.getLast().component[t]||{}})),n&&n.apply(i,a),o=!1)}))})),this},t.prototype.waited=function(t,n){var i=this,r=e.unit.stringToArray(t),a=[],o=!0;return r.forEach((function(t,l){i.on(t,(function(t){a[l]=t.exports||t,a.length===r.length&&o&&(r.forEach((function(t,n){var i=e.history.getLast().component[t];a[n]=i?i.exports:{}})),n&&n.apply(i,a),o=!1)}))})),this},t.prototype.trigger=function(e){try{if(this.handle[arguments[0]]instanceof Array){var t=this.handle[arguments[0]],n=[].slice.apply(arguments);n.shift();for(var i=0,r=t.length;i<r;i++)t[i]&&t[i].apply(this.self||this,n)}}catch(e){}return this},t.prototype.notify=function(){try{for(var e in this.handle)if(this.handle[e]instanceof Array)for(var t=this.handle[e],n=0,i=t.length;n<i;n++)t[n]&&t[n].apply(this.self||this)}catch(e){}return this},function(e){return new t}}();var n=e.emitter();e.on=n.on,e.off=n.off,e.trigger=n.trigger,e.one=n.one}(window.bui||{}),function(e,t){e.store=function(n){var i={el:null,scope:"",data:null,extends:null,mixins:[],beforeMounts:[],beforeCompiles:[],compileds:[],beforeUpdates:[],mounteds:[],updateds:[],beforeDestroys:[],destroyeds:[],computed:null,methods:null,watch:null,templates:null,beforeMount:null,mounted:null,beforeCompile:null,compiled:null,beforeUpdate:null,updated:null,beforeDestroy:null,destroyed:null,isPublic:!1,modelEvent:"input",scopeSplit:".",delayInput:200,needStatic:!1,needView:!0,needComponent:!1,needCompile:!0,needNative:!1,deep:!0,log:!1,autoinit:!0},r=null;function a(n){var r=null,a=n&&n.extends?[n.extends]:[];e.array.merge(i.mixins,a,n.mixins||[],[n]);var o=t.extend(!0,{},i,e.config.store);return function e(n){var a=0;for(a=0;a<n.length;a++){var l=n[a];l.beforeMount&&i.beforeMounts.push(l.beforeMount),l.beforeCompile&&i.beforeCompiles.push(l.beforeCompile),l.beforeUpdate&&i.beforeUpdates.push(l.beforeUpdate),l.updated&&i.updateds.push(l.updated),l.compiled&&i.compileds.push(l.compiled),l.mounted&&i.mounteds.push(l.mounted),l.beforeDestroy&&i.beforeDestroys.push(l.beforeDestroy),l.destroyed&&i.destroyeds.push(l.destroyed),r=t.extend(!0,o,l),l.mixins&&l.mixins.length&&a<n.length-1&&e(l.mixins)}}(i.mixins),r=t.extend(!0,i,r)}var o,l="function"==typeof(r=a(n)).data?r.data.call(V):r.data,c=r.scope||e.guid(),s=r.computed,u=r.scopeSplit,d=r.methods,f=r.templates,p=r.watch||i.watch,h=(r.delayInput,r.isPublic),g=r.modelEvent,m=r.needStatic,v="",y=!1,b=!0,w={},x={},k={},O=!1,L={},I=e.emitter(),j={target:null};r.el?r.el=r.el:r.el=h?"body":".bui-page",o=r.el,v=0==o.indexOf(".")||0==o.indexOf("#")?o.substr(1):o;var P=null,T=null,S=null,E=null,N=[],$=!0,C=l,R=void 0===r.log?i.log:r.log,A=/b-text|b-html|b-value|b-show|b-hide|b-checked|b-src|b-href|b-bind|b-style|b-class|b-model|b-id|b-data|b-title|b-visible/gim,F={"b-text":function(t){var n="b-text",i=ee.call(this,t,n),r=G.call(this,n),a="",o=e.typeof(t.value),l=i.attr(n),c=oe.call(this,n),s=(c[0].keyname,c[0].param);switch(o){case"array":a=te(t,l);break;case"function":a=t.value.apply(V,s);break;default:a=t.value}a=r?!a:a,i.text(a),N=[]},"b-html":function(t){var n="b-html",i=ee.call(this,t,n),r=G.call(this,n),a="",o=e.typeof(t.value),l=i.attr(n),c=oe.call(this,n),s=(c[0].keyname,c[0].param);switch(o){case"array":a=te(t,l);break;case"function":a=t.value.apply(V,s);break;default:a=t.value}a=r?!a:a,i.html(a),N=[]},"b-value":function(e){var t=ee.call(this,e,"b-value");h?t.each((function(t,n){ne.call(this,e)})):ne.call(t[0],e);N=[]},"b-show":function(e){var t=ee.call(this,e,"b-show");void 0!==e.value&&1==Boolean(e.value)?this.removeAttribute("style"):void 0!==e.value&&0==Boolean(e.value)&&t.css("display","none");N=[]},"b-visible":function(e){var t=ee.call(this,e,"b-visible");void 0!==e.value&&1==Boolean(e.value)?this.removeAttribute("style"):void 0!==e.value&&0==Boolean(e.value)&&t.css("visibility","hidden");N=[]},"b-hide":function(e){var n="!"+c+u+e.keyname,i=h?t(`[b-show="${n}"]`):P(this);void 0!==e.value&&1==Boolean(e.value)?i.css("display","none"):void 0!==e.value&&0==Boolean(e.value)&&i.removeAttr("style")},"b-checked":function(e){this.checked=!!e.value,N=[]},"b-bind":function(e){var t=ee.call(this,e,"b-bind"),n=this,i=e.keyname,r=e.value;if("object"==typeof r)for(let a in r)he(i+"."+a,(function(t){re(ee.call(n,e,"b-bind"),a,t.value)})),re(t,a,r[a]);else{var a="string"==typeof i&&i.split("."),o=a[a.length-1];re(t,o,r)}},"b-src":function(e){ee.call(this,e,"b-src").attr("src",e.value),N=[]},"b-title":function(e){ee.call(this,e,"b-title").attr("title",e.value),N=[]},"b-data":function(e){ee.call(this,e,"b-data").attr("data",e.value),N=[]},"b-id":function(e){ee.call(this,e,"b-id").attr("id",e.value),N=[]},"b-href":function(e){ee.call(this,e,"b-href").attr("href",e.value),N=[]},"b-class":function(n){var i=ee.call(this,n,"b-class"),r=this;this.classList;if("object"==typeof n.value)if("array"===e.typeof(n.value)){n.value.length||i.attr("class",""),n.value.forEach((function(e,t){!i.hasClass(e)&&i.addClass(e)}));var a=n.keyname.indeOf(".$index");a>-1?he(n.keyname.substr(0,a)+"."+t(i).index(),(function(e){var t=ee.call(r,n,"b-class");ae(t,e.value[t.index()],e.value)})):he(n.keyname,(function(e){var t=ee.call(r,n,"b-class");ae(t,e.value[t.index()],e.value)}))}else for(let e in n.value){let t=n.value[e],a=n.preValue&&n.preValue[e]||"";he(n.keyname+"."+e,(function(t){ae(ee.call(r,n,"b-class"),e,t.value)})),ae(i,e,t,a)}else if("function"==typeof n.value){var o=oe.call(this,"b-class"),l=o[0].keyname,c=o[0].param,s=n.value.apply(V,c);ae(i,l,s,n.preValue)}else{var u="string"==typeof n.keyname&&n.keyname.split("."),d=u[u.length-1];ae(i,d,n.value,n.preValue)}N=[]},"b-model":function(e){var t=ee.call(this,e,"b-model");h?t.each((function(t,n){ie.call(this,e)})):ie.call(t[0],e)},"b-style":function(e){var t=ee.call(this,e,"b-style"),n=this;if("object"==typeof e.value)for(let i in e.value)he(e.keyname+"."+i,(function(t){ee.call(n,e,"b-style").css(i,t.value)})),t.css(e.value);else t.css(e.keyname,e.value);N=[]}},D={"b-text":[],"b-html":[],"b-value":[],"b-show":[],"b-hide":[],"b-checked":[],"b-bind":[],"b-src":[],"b-title":[],"b-data":[],"b-id":[],"b-href":[],"b-class":[],"b-model":[],"b-style":[]},U={},V=(t.extend(!0,{},l,d,p,s,f),{$methods:d,$refs:L,mixin:a,$options:r,$templates:f,config:r,watch:B,nextTick:function(t){return he("nexttick",(function(n){try{t&&t.call(V,n)}catch(n){e.showLog(n)}})),this},oneTick:function(t,n){var i="nexttick-"+t;if(k.hasOwnProperty(i))return this;return k[i]=n,he("nexttick",(function(n){if(n.keyname===t)try{x[t].pop(),0==x[t].length&&k[i]&&k[i].call(V,n)}catch(n){e.showLog(n)}})),this},get:function(t){if(void 0===t)return C=C;if("string"==typeof t){var n=e.unit.getKeyValue(t,C);return N=[],n}return C},set:de,delete:fe,del:fe,observer:ce,compile:z,$mount:z,compileHtml:_,clearKey:function(){return N=[],y=!1,b=!0,O=!1,this},destroy:function(){return N=[],r.beforeDestroys.forEach((function(e,t){e.call(V)})),y=!1,b=!0,O=!1,ge(),r.beforeMounts=[],r.beforeCompiles=[],r.compileds=[],r.mounteds=[],r.beforeUpdates=[],r.updateds=[],r.destroyeds.forEach((function(e,t){e.call(V)})),this},init:M,connect:function(t,n,i){if("object"!=typeof t||!t.hasOwnProperty("$refs"))return V;var r=this;if("string"==typeof n){ue(t,n);var a=e.unit.getKeyValue(n,r.$data);"object"===e.typeof(a)?c(n,a,i||n):l(i||n,a,n)}else{var o=Object.keys(C);let n=0;for(;n<o.length;n++){let i=o[n];if(e.array.compare(se,i,"field"))break;ue(t,i);if(t.$data.hasOwnProperty(i)){t.$data[i];let n=r.$data[i];"object"===e.typeof(n)?c(i,n):l(i,n)}}}function l(n,i,r){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i);let a=B(r||n,(function(i){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i)})),o=e.array.index(se,n,"field");(o<0||se[o]&&t.$options.el!==se[o].el)&&se.push({field:r||n,el:t.$options.el,disconnect:a})}function c(n,a,o){let l=Object.keys(a);for(let a=0;a<l.length;a++){let o=l[a],s=n+"."+o,u=void 0===i,d=u||""==i?o:i+"."+o,f=(ue(t,s),e.unit.getKeyValue(s,r.$data));u?t.set(s,f):t.set(d,f);let p=B(s,(function(e){void 0!==i?t.set(d,e):t.set(s,e)}));var c=e.array.index(se,s,"field");(c<0||se[c]&&t.$options.el!==se[c].el)&&se.push({field:s,el:t.$options.el,disconnect:p})}t.trigger.call(t,o||n,{action:"set",target:null,value:C[n],preValue:null,action:"set",keyname:n,origin:C})}return V},disconnect:function(t){if("string"==typeof t){var n=e.array.get(se,t,"field");n&&n.disconnect()}else se.forEach((function(e,t){e.disconnect()}));return V},on:he,off:ge,one:function(e,t){if(k.hasOwnProperty(e))return this;return he(e,t),k[e]=t,this},trigger:me,emitter:I});try{r.autoinit&&M()}catch(t){e.showLog(t)}function M(){var n=(P=e.hasRouter?router.$:t)(r.el);T="object"==typeof r.el?t(r.el):n.length?n:t(r.el),S=T&&T.parent(),E=T&&T.children(),V.$el=T,V.$parent=S,V.$children=E,V.$data=l;for(let e in d)d[e]=d[e].bind(V);return V.$methods=d,d&&function(){try{Object.keys(d).forEach((t=>{l.hasOwnProperty(t)?e.showLog("不能跟data的键值相同:"+t):Object.defineProperty(V,t,{get:function(){return d[t].bind(this)},set:function(){}})}))}catch(t){e.showLog(t)}}(),f&&function(){try{Object.keys(f).forEach((t=>{l.hasOwnProperty(t)?e.showLog("不能跟data的键值相同:"+t):Object.defineProperty(V,t,{get:function(){return f[t].bind(this)},set:function(){}})}))}catch(t){e.showLog(t)}}(),me.call(V,"beforemount"),r.beforeMounts.forEach((function(e,t){e.call(V)})),ce(l),function(){for(let e in l)Object.defineProperty(V,e,{configurable:!0,get(){R&&console.log("1. module getting "+e,N),!y&&b?(y=!0,b=!1,N=[]):(y=!1,b=!1);let t=l[e];return Array.isArray(t)&&j.target&&(w[e]=[],w[e].push(j.target)),t},set(t){R&&console.log("2. module setting "+e,N),N=[],l[e]=t,C[e]=t}})}(),p&&function(t){try{H(t)}catch(t){e.showLog(t)}}(p),s&&function(){try{Object.keys(s).forEach((t=>{if(l.hasOwnProperty(t))e.showLog("不能跟data的键值相同:"+t);else{var n=s[t];Object.defineProperty(V,t,{get:function(){var e,i="function"==typeof n?n.bind(this):n.get.bind(this);return j.target&&(w[t]=[],w[t].push(j.target)),j.target=function(){var e=i();w[t]&&w[t].forEach((e=>e())),me(t,{target:null,value:e,action:"set",keyname:t,param:[],origin:C}),j.target=null,N=[]},e=i(),j.target=null,N=[],e},set:n&&"object"===e.typeof(n)&&n.set||function(){}})}}))}catch(t){e.showLog(t)}}(),h?r.needCompile&&router&&router.on("complete",(function(e){r.needCompile&&z(),$&&r.mounteds.forEach((function(t,n){t.call(V,e)})),C=t.extend(!0,{},l),y=!1,b=!0,me.call(V,"mounted",e),$=!1,N=[]})):($||ge(),m&&function(){let e=T.html();e=_(e),T.html(e)}(),r.needView?function(e){loader.views({id:e.id,loaded:function(e){z(e.el)},compiled:e.compiled})}({id:T,compiled:function(){r.needCompile&&z(),r.mounteds.forEach((function(e,t){e.call(V)}))}}):(r.needCompile&&z(),r.mounteds.forEach((function(e,t){e.call(V)}))),C=t.extend(!0,{},l),y=!1,b=!0,N=[],me.call(V,"mounted"),$=!1),this}function H(t,n,i){t=t||p;try{let r=Object.keys(t),a=[];r.forEach((function(r,o){let c=i||("object"==typeof t[r]?t[r].handler:t[r]);a.push(r),n&&a.unshift(n);let s=a.join("."),u=t[r];if("object"===e.typeof(u)){let n=u.deep?Object.keys(l[r]):Object.keys(t[r]),i=e.unit.getKeyValue(r,l);n.forEach((function(t,n){let r=s+"."+t,o=i[t];"object"===e.typeof(o)&&H(o,r,c),B(r,c),a=[]})),u.immediate&&u.handler&&u.handler.call(V,l[r],C[r])}B(s,c),a=[]}))}catch(t){e.showLog(t)}}function B(t,n){var i=function(t){try{var i=[t.value,t.preValue||"",t];if("init"!==t.action){var r=n;switch(e.typeof(r)){case"function":r.apply(V,i);break;case"array":r.forEach((function(e,t){e.apply(V,i)}));break;case"string":new Function(r+`(${t.value},${t.preValue||""})`)();break;default:r.apply(V,i)}}}catch(t){e.showLog(t)}};return he(t,i),ge.bind(this,t,i)}function z(n){try{var i=null,a=null;void 0===n?(i=T,a=r):"string"==typeof n?(i=P(n),a=r):n&&"object"==typeof n&&(i=P(n)||t(n),a=t.extend(!0,{},r,n));var o=!0;if(a.beforeCompiles.forEach((function(e,t){if(!1===(o=e.call(V,a)))return!1})),!1===o)return N=[],!1;if(function(t){var n=t.find(`[b-template*=${c}]`),i=[];if(x={},n.length)try{n.each((function(t,n){var r=P(this),a=oe.call(this,"b-template"),o=a[0].keyname,l=a[0].param,s=c+u;l[0]||console.error('b-template 没有找到数据源, 格式为: b-template="page.template(page.sources)"');var d="string"==typeof l[0]&&l[0].replace(new RegExp(s),"")||"",p=r.attr("b-command")||"html",g=r.attr("b-children")||r.children()[0]&&r.children()[0].tagName;W(d,V);h&&ge(d),x.hasOwnProperty(d)?x[d].push(d):x[d]=[d],he(d,(function(t){try{var n,i=t.param;switch(t.action){case"push":case"unshift":n=i;break;case"splice":n=i.slice(2)||"";break;default:n=t.value}if(f&&f.hasOwnProperty(o)){(l=l.map((function(e,t){return"string"==typeof e&&0==e.indexOf(c+u)&&t>0?W(e.replace(new RegExp(s),""),C):e})))[0]=n;var a=void 0!==n&&"undefined"!==n&&f[o]&&f[o].apply(V,l);void 0===a&&(a="",e.showLog(o+"模板方法需要返回内容，例如：return html;")),h&&(r=P(`[b-template*="${s+d}"]`));var m=t.preValue||[];0==m.length&&"html"==p&&r.empty();var v=g?r.children(g):r.children(),y=v,b=i&&i.length||0;switch($=!0,t.action){case"push":if(r.append(a),v=r.children(g),b&&b==v.length)J(v);else if(b>1)for(var w=y.length,x=w;x<v.length;x++)J(v.eq(w+x-1));else J(v.last());break;case"unshift":if(r.prepend(a),v=r.children(g),b&&b==v.length)J(v);else if(b>1)for(x=0;x<b;x++)J(v.eq(x));else J(v.first());break;case"pop":v.last().remove(),J((v=r.children(g)).last());break;case"shift":v.first().remove(),J((v=r.children(g)).first());break;case"length":break;case"splice":var k=parseInt(i[0]),O=parseInt(i[1]);O>=m.length&&(r.empty(),v=r.children(g));var L=v.length,I=L>0;if(0==O)if(I&&L-1>=k){v.eq(k).before(a),v=r.children(g);for(x=0;x<n.length;x++)J(v.eq(k+x))}else{r.append(a),v=r.children(g);for(x=0;x<n.length;x++)J(v.eq(L+x))}else if(O>0){if(void 0!==i[2])if(I&&L-1>=k){v.eq(k).before(a),v=r.children(g);for(x=0;x<n.length;x++)J(v.eq(k+x))}else{r.append(a),v=r.children(g);for(x=0;x<n.length;x++)J(v.eq(L+x))}let e=0;switch(p){case"append":e=v.length-t.preValue.length||0;break;case"prepend":case"html":default:e=0}for(x=0;x<O;x++)v.eq(k+n.length+x+e).remove();a&&!t.value.length&&r.html(a)}break;case"reverse":case"sort":r.html(a),J(r);break;default:r[p](a),J(r)}me.call(V,"nexttick",t)}else e.showLog(`找不到对应的模板,请检查下 scope:${c} 的templates是否存在${o}`,"bui.store")}catch(t){e.showLog(t)}})),e.array.compare(i,d)||i.push(d),N=[]})),K(i)}catch(t){e.showLog(t)}}(i),J(i),a.needComponent)return loader.components({id:i,compiled:function(){X(i),Z(i),Y(i),!0,q(),N=[],a.compileds.forEach((function(e,t){e.call(V,a)}))}}),this;X(i),Z(i),Y(i),!0,q(),N=[],a.compileds.forEach((function(e,t){e.call(V,a)}))}catch(t){e.showLog(t)}return this}function q(){return T.find("[ref]").each((function(){let t=this.getAttribute("ref"),n=L.hasOwnProperty(t),i=null;n&&"htmldivelement"===e.typeof(L[t])?(i=[L[t]],i.push(this),L[t]=i):n&&"array"===e.typeof(L[t])?L[t].push(this):L[t]=this})),this}function _(n){try{var i=this,r="string"==typeof n?n:"",a=new RegExp("{{[\\s]?"+c+u+"(.*?)}}","mg");return r=r.replace(a,(function(n,r){var a=r.split(c+u);""===t.trim(a[0])&&a.shift();var o=a.length>0&&e.unit.getKeyValue(a.join("."),C)||"";return"function"==typeof o?o.call(i):o}))}catch(t){e.showLog(t)}}function W(t,n){let i;if(U&&U.hasOwnProperty(t))i=U[t];else{if(i=e.unit.getKeyValue(t,n),void 0===i)return void(R&&console.warn(`请检查 ${t} 在bui.store scope:${c} 中有没有声明定义`));U[t]=i}return i}function J(t){try{var n=t,i=[],r=(n[0]&&n[0].outerHTML||n.html()||"").match(A)||[],a=e.array.uniq(r);a.length&&a.forEach((function(t,r){var a=n.find(`[${t}*=${c}]`);a.length<1&&(a=n.closest(`[${t}*=${c}]`)),a.length&&a.each((function(n,r){var a="",o=oe.call(this,""+t),l=o[0]&&o[0].keyname||"",c=l.indexOf(".length"),s=c>-1?l.substr(0,c):l,u=o[0]&&o[0].param;W(s,V);var d=oe.call(this,"b-linked");if(d.length&&d.forEach((function(t,n){he(t.keyname,(function(t){me(l,{target:null,value:e.unit.getKeyValue(l,V),action:"set",keyname:l,param:u,origin:C})}))})),"b-show"===t)switch(o[0]&&o[0].rule){case"!":a="b-hide";break;default:a="b-show"}else a=t;if(h){var f=e.array.compare(D[a],s);!f&&D[a].push(s),!f&&he(s,F[a].bind(this))}else!$&&0===n&&ge(s),he(s,F[a].bind(this));e.array.compare(i,s)||i.push(s),N=[],y=!1,b=!0}))})),K(i)}catch(t){e.showLog(t)}}function K(e){e.forEach((function(e,t){me(e,{target:null,action:"init",value:U[e],param:null,keyname:e,origin:C}),N=[]}))}function X(n){var i=n,a=`[type="text"][b-model*=${c}],\n                                [type="search"][b-model*=${c}],\n                                [type="password"][b-model*=${c}],\n                                [type="url"][b-model*=${c}],\n                                [type="number"][b-model*=${c}],\n                                [type="email"][b-model*=${c}],\n                                [type="range"][b-model*=${c}],\n                                [type="tel"][b-model*=${c}],\n                                textarea[b-model*=${c}]`;if("input"===r.modelEvent){var o=!1;i.off("input compositionstart compositionend",a).on(g,a,(function(e){o||l.call(e.target,e)})).on("compositionstart",a,(function(e){o=!0,e.stopPropagation()})).on("compositionend",a,(function(e){o=!1,l.call(e.target,e),e.stopPropagation()}))}else i.off(g,a).on(g,a,l);function l(t){var n=t.target.value,i=oe.call(this,"b-model"),r=i[0]&&i[0].keyname||"";if(""===r)return e.showLog("b-model的值不能为空"),!1;de(r,n),N=[],t.stopPropagation()}var s=`[type="checkbox"][b-model*=${c}],\n                                [type="radio"][b-model*=${c}]`;i.off("change",s).on("change",s,(function(t){try{var n,r=this,a=this.getAttribute("value")||this.checked,o=this.getAttribute("type"),l=oe.call(this,"b-model")[0].keyname,s=this.getAttribute("check-value"),u=this.getAttribute("uncheck-value"),d=this.getAttribute("check"),f=this.getAttribute("uncheck");(d||f||s||u)&&(a=this.checked?s||this.value||d:u||f||""),n=W(l,V);var p=/\{.+\}$/g.test(a)?null:i.find(`[type="checkbox"][b-model="${c+"."+l}"][value="${a}"],\n                [type="radio"][b-model="${c+"."+l}"][value="${a}"]`);switch(o){case"checkbox":this.checked&&(n&&"array"===e.typeof(n)?!e.array.compare(n,a)&&e.unit.getKeyValue(l,V).push(a):de(l,a),this.checked=!0),this.checked||(n&&"array"===e.typeof(n)?e.array.remove(e.unit.getKeyValue(l,V),a):de(l,a),this.checked=!1),p&&p.each((function(e,t){this.checked=r.checked}));break;case"radio":default:de(l,a)}N=[],t.stopPropagation()}catch(t){e.showLog(t)}}));var u=`select[b-model*=${c}]`;i.off("change",u).on("change",u,(function(n){try{var i=t(this).val(),r=(this.selectedIndex,this.multiple),a=oe.call(this,"b-model")[0].keyname,o=null;switch(o=W(a,V),r){case!0:"array"!==e.typeof(o)&&e.showLog(a+"的类型必须为数组"),i.splice(0,0,0,i.length+1),o.splice.apply(o,i);break;default:de(a,i)}N=[],n.stopPropagation()}catch(n){e.showLog(n)}}))}function Y(e){e.off("change",`[b-checked*=${c}]`).on("change",`[b-checked*=${c}]`,(function(e){var t=this.checked;de(oe.call(this,"b-checked")[0].keyname,t),N=[],e.stopPropagation()}))}function Z(e){var t=e;t.off("click.bui",`[b-click*=${c}]`).on("click.bui",`[b-click*=${c}]`,(function(e){var t=Q.call(this,e,"b-click");if(!1===t)return!1;void 0===t&&e.stopPropagation()})),t.off("touchstart",`[b-touchstart*=${c}]`).on("touchstart",`[b-touchstart*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-touchstart"))return!1})),t.off("touchmove",`[b-touchmove*=${c}]`).on("touchmove",`[b-touchmove*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-touchmove"))return!1})),t.off("touchend",`[b-touchend*=${c}]`).on("touchend",`[b-touchend*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-touchend"))return!1})),t.off("scroll",`[b-scroll*=${c}]`).on("scroll",`[b-scroll*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-scroll"))return!1})),t.off("focus",`[b-focus*=${c}]`).on("focus",`[b-focus*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-focus"))return!1})),t.off("change",`[b-change*=${c}]`).on("change",`[b-change*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-change"))return!1})),t.off("blur",`[b-blur*=${c}]`).on("blur",`[b-blur*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-blur"))return!1})),t.off("submit",`[b-submit*=${c}]`).on("submit",`[b-submit*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-submit"))return!1}))}function Q(t,n){var i=oe.call(this,n),r=i[0].keyname,a=i[0].param,o=null;a.push(t);try{var l="function"==typeof(o=W(r,V))&&o.apply(V,a);return N=[],me(r,{target:this,value:o,action:"set",keyname:r,param:a,origin:C}),l}catch(t){e.showLog(t)}}function G(e){return 0==this.getAttribute(e).indexOf("!")}function ee(e,n){var i=c+u+e.keyname;return h?t(`[${n}="${i}"]`):P(this)}function te(e,t){return t.indexOf(".length")>-1?e.value.length||0:e.value instanceof Array?e.value.join(","):e.value}function ne(t){var n=this.getAttribute("type"),i=this.value,r=this,a=this.getAttribute("b-value");switch(n){case"radio":i==t.value?this.checked=!0:this.checked=!1;break;case"checkbox":"array"===e.typeof(t.value)&&t.value.forEach((function(e,t){i==e&&(r.checked=!0)}));break;default:this.value=te(t,a)}}function ie(e){var n=this.getAttribute("type"),i=this.value,r=(e.param,this);if("SELECT"===this.nodeName&&this.multiple)e.value.length>1?e.value.forEach((function(e,n){"string"==typeof e?t(r).find(`option[value=${e}]`).attr("selected",!0):t(r).find(`option[value=${e.value}]`).attr("selected",!0)})):this.value=e.value[0];else{switch(n){case"radio":i==e.value?this.checked=!0:this.checked=!1;break;case"checkbox":if(i&&e.value instanceof Array)switch(e.action){case"push":case"unshift":e.param.filter((function(e,t){i!==e||(r.checked=!0)}));break;case"pop":case"shift":e.param.filter((function(e,t){i===e&&(r.checked=!1)}));break;case"splice":var a=e.param,o=parseInt(a[1]),l=a.slice(2);0==o?l.forEach((function(e,t){i===e&&(r.checked=!0)})):o>0&&(e.preValue.forEach((function(t,n){n<=e.param[1]&&(r.checked=!1)})),e.value.forEach((function(e,t){i===e&&(r.checked=!0)})));break;case"length":break;default:e.value.filter((function(e,t){i==e&&(r.checked=!0)}))}else e.value===i||1==e.value?this.checked=!0:this.checked=!1;break;default:if(event&&event.target&&"INPUT"===event.target.nodeName)break;this.value=e.value}N=[]}}function re(e,t,n){switch(t){case"disabled":n?e.attr(t,n):e.removeAttr(t);break;case"checked":e.prop(t,n);break;default:var i="object"==typeof n?JSON.stringify(n):n;e.attr(t,i)}N=[]}function ae(e,t,n,i){"boolean"==typeof n?(n&&e.addClass(t),!n&&e.removeClass(t)):"string"==typeof n?(h&&e.removeClass(n),i&&e.removeClass(i),n&&!e.hasClass(n)&&e.addClass(n),void 0!==i&&""===n&&e.removeClass(i)):(Boolean(n)&&e.addClass(t),!Boolean(n)&&e.removeClass(t))}function oe(t){var n=[],i=this,r=this.getAttribute(t)||"",a=r.indexOf("&")>-1?r.split("&"):r&&[r]||[];try{a.forEach((function(e,r){var a={},o=le.call(i,e,t);a.scope=c,a.rule=o.rule,a.keyname=o.name,a.param=o.param,a.eventType=o.eventType,a.eventProperty=o.eventProperty,n.push(a)}))}catch(t){e.showLog("参数处理出错")}return n}function le(n,i){try{var r=n?n.match(/([^\(|\)]+)/g):[],a="",o="",l=null,s=[],d=null,f=this,p="",h=t(f).attr("b-target"),g=h&&t(f).parents(h)[0]||f,m="",v="";if(p=(p=(l=r[0]&&r[0].indexOf(c+u)>-1?r[0].split(c+u):[c,r[0]])[0].split(c))[0]||p[1]||"",a=c,(o=l[1]||"").indexOf("$index")>-1){let e=t(g).index();o=o.replace("$index",e)}else if(o.indexOf("$id")>-1){let e=g.id;o=o.replace("$id",e)}else if(o.indexOf("$parentIndex")>-1){let e=t(g).parent().index();o=o.replace("$parentIndex",e)}if(void 0!==r[1]){let n=r[1]||"";try{var y=/\{.+\}$/g,b=/\[.+\]$/g;let r=/(\'(.*?)\'.*?)|(\"(.*?)\".*?)|(\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14})|(^((https|http|ftp|rtsp|mms)?:\/\/)[^\,]+)|([a-zA-Z0-9][-a-zA-Z0-9\._]{0,62})|(\{.+\})|(\[.+])|([$\w\.]+)|([\d\.]+)|([\u4e00-\u9fa5|\w|\d]+)/g;s=(n?n.match(r):[]).map((function(n,r){var a=n.replace(/^\"|^\'|\"$|\'$/g,""),o=t(g).attr("b-target"),l=o&&t(g).parents(o)[0]||g;switch(n){case"$this":a=l;break;case"$index":a=t(l).index();break;case"$parentIndex":a=t(l).parent().index();break;case"$parent":a=l.parentNode;break;case"$children":a=t(l).children();break;case"$id":a=l.id;break;case"$text":a=l.textContent;break;case"$value":a=l.value;break;case"$html":a=l.innerHTML}if("b-template"!==i){var s=c+u;e.unit.startWithStr(a,s)&&(a=e.unit.getKeyValue(a.split(s)[1],V))}return y.test(n)||b.test(n)?JSON.parse(n):a}))}catch(t){e.showLog(t,"getArguments"),s=[]}}void 0!==r[2]&&(m=(d=r[2].indexOf(".")>-1?r[2].split("."):[r[2]])[0],v=d[1]||"")}catch(t){e.showLog("参数格式错误:"+n)}return{scope:a,rule:p,name:o,param:s,eventType:m,eventProperty:v}}function ce(t,n){if(!t.hasOwnProperty("widget")||"function"!=typeof t.widget)return function(t,n){if(n&&"array"===e.typeof(n)){if(n.length>1){var i=n.pop();a(e.unit.getKeyValue(n.join("."),t),i)}else a(t,n[0]);return}function a(t,n){let i=t[n];if(i instanceof Array?function(t,n){var i=[],a=Array.prototype;let o=Object.create(a);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var s=a[t];Object.defineProperty(o,t,{enumerable:!0,configurable:!0,value:function(a){let o=[...arguments];me.call(V,"beforeupdate",{target:null,action:t,param:o,value:this,prevValue:[],keyname:n,origin:C}),i.push(n),l.hasOwnProperty(n)||i.unshift(N.join("."));var u=i.join("."),d=this.slice(0);let f=s.apply(this,o);switch(R&&console.log(`5. ${u} action ${t} `),t){case"pop":case"shift":o=[f]}e.unit.setKeyValue(u,this,C);var p=T.find(`[b-template*="${c}.${u}"]`);return me(u,{target:p,action:t,param:o,value:this,preValue:d,keyname:n,origin:C}),w[i[0]]&&"array"===e.typeof(w[i[0]])&&w[i[0]].forEach((e=>e())),i=[],N=[],y=!1,b=!0,me.call(V,"updated",{target:p,action:t,param:o,value:this,preValue:d,keyname:n,origin:C}),r.updateds.forEach((function(e,i){e.call(V,{target:p,action:t,param:o,value:this,preValue:d,keyname:n,origin:C})})),f}})})),o.$index=function(t,n){return e.array.index(this,t,n)},o.$include=function(t,n){return e.array.compare(this,t,n)},o.$empty=function(){return e.array.empty(this)},o.$replace=function(t){return e.array.replace(this,t)},o.$merge=function(){return e.array.merge(this,...arguments)},o.$get=function(t,n){return e.array.get(this,t,n)},o.$set=function(t,n,i){return e.array.set(this,t,n,i)},o.$delete=function(t,n){return e.array.delete(this,t,n)},o.$deleteIndex=function(t){return e.array.deleteIndex(this,t)},t.__proto__=o}(i,n):function(t,n){let i=t[n],a="function"==typeof i?i.call(V):i;var o=[];Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get(e){return R&&console.log(`3. data getting ${n}:`,a),I.target=this,(y||!y&&b)&&N.push(n),j.target&&o.push(j.target),a},set(t){if(t===a)return N=[],O=!1,y=!1,b=!0,!0;I.target===this&&(N=[]),I.target=this,(!b||!y&&b)&&N.push(n);var i=N.join(".");!O&&me.call(V,"beforeupdate",{action:"set",value:t,preValue:a,keyname:i,origin:C}),!O&&r.beforeUpdates.forEach((function(e,n){e.call(V,{action:"set",value:t,preValue:a,keyname:i,origin:C})})),R&&console.log("4. data setting "+i,t);var c=e.unit.getKeyValue(i,C);return a=t,o.forEach((e=>e())),!O&&me(i,{action:"set",value:a,preValue:c,keyname:i,origin:C}),e.unit.setKeyValue(i,a,C),a instanceof Array?ce(l,N):"object"===e.typeof(a)&&(r.deep&&ce(t),a&&Object.keys(a).forEach((function(e,t){var i=n+"."+e;N=[],me(i,{target:null,value:a[e],preValue:c&&c[e],action:"set",keyname:i,origin:C})}))),!O&&me.call(V,"updated",{action:"set",value:a,preValue:c,keyname:i,origin:C}),!O&&r.updateds.forEach((function(e,t){e.call(V,{action:"set",value:a,preValue:c,keyname:i,origin:C})})),N=[],O=!1,y=!1,b=!0,!0}})}(t,n),i&&"object"===e.typeof(i))return ce(i)}Object.keys(t).forEach((function(e){a(t,e)}))}(t,n)}var se=[];function ue(t,n){var i=e.array.index(se,n,"field");return!!(i>-1&&se[i]&&t.$options.el===se[i].el)&&(se[i].disconnect&&se[i].disconnect(),!0)}function de(n,i){var a=null;if(N=[],"string"==typeof n&&void 0!==i){R&&console.log(`set ${n} `),O=!0,me.call(V,"beforeupdate",{action:"set",target:null,value:a,preValue:o,action:"set",keyname:n,origin:C}),r.beforeUpdates.forEach((function(e,t){e.call(V,{action:"set",target:null,value:a,preValue:o,action:"set",keyname:n,origin:C})}));var o=e.unit.getKeyValue(n,C);i&&"object"===e.typeof(i)?(a=t.extend(!0,{},i),Object.keys(i).forEach((function(e,t){var r=n+"."+e;me.call(V,r,{target:null,value:i[e],preValue:o,action:"set",keyname:r,origin:C})}))):a=i,e.unit.setKeyValue(n,i,l),e.unit.setKeyValue(n,a,C),me.call(V,n,{target:null,value:a,preValue:o,action:"set",keyname:n,origin:C}),me.call(V,"updated",{action:"set",target:null,value:a,preValue:o,action:"set",keyname:n,origin:C}),r.updateds.forEach((function(e,t){e.call(V,{action:"set",target:null,value:a,preValue:o,action:"set",keyname:n,origin:C})})),"object"==typeof i&&(i instanceof Array?ce(l,n.split(u)):ce(i)),N=[]}else n&&"object"===e.typeof(n)&&(C=t.extend(!0,{},C,n),pe(n));return C}function fe(t,n){return function(t,n){"string"==typeof t&&(e.unit.delKey(t,C),n&&n.call(V,t))}(t,(function(e){me(t)})),C}function pe(t,n){for(var i in t){var r=void 0===n?i:n+i,a=t[i];me(r,{target:null,value:a,preValue:C[i]||"undefined",action:"set",param:null,keyname:r,origin:C}),a&&"object"===e.typeof(a)&&pe(a,i+".")}}function he(t,n){var i="";return i=t&&"array"===e.typeof(t)?t.map((function(e,t){return v+"_"+c+u+e})):v+"_"+c+u+t,I.on.call(V,i,n),this}function ge(e,t){if(e){var n=v+"_"+c+u+e;I.off.call(V,n,t)}else V.handle={};return this}function me(e){var t=v+"_"+c+u+e;return R&&console.warn(t,"trigger"),arguments[0]=t,I.trigger.apply(V,arguments),y=!1,b=!0,this}return V}}(window.bui||{},window.libs),function(e,t){e.viewport=function(n,i){e.trigger.call(e,"viewportbefore");var r,a=document.querySelector("meta[name=viewport]"),o="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no",l=window.devicePixelRatio,c=document.documentElement.clientWidth,s=document.documentElement.clientHeight,u=parseInt(c)*parseInt(l),d=parseInt(s)*parseInt(l);if(c=c>s?s+24:c,a)e.config.viewport.create&&(a.content=o);else{var f=document.createElement("meta");f.name="viewport",f.content=o;var p=document.head;e.config.viewport.create&&p.appendChild(f),f=null}var h=e.array.index([240,320,360,375,384,393,412,414,435,480,512,540,768,1024,1536,2048,2732,534,854,750],document.documentElement.clientWidth);function g(t){var n=i||750,a=document.head.parentNode,o=t||(c/n*100).toFixed(2);return r=o||48,e.config.viewport.zoom&&(a.style.fontSize=r+"px"),e.trigger.call(e,"viewportinit"),this}return h>-1&&void 0===n?r=[32,42.67,48,50,51.2,52.4,54.93,55.2,58,64,68.27,60,60,60,60,60,60,60,60,60][h]:g(n),{width:function(e){return c||t("body").width()||t("#bui-router").width()||t(".bui-page").width()},height:function(e){return s||t("body").height()||t("#bui-router").height()||t(".bui-page").height()},fontSize:r,screenWidth:function(e){return u},screenHeight:function(e){return d},ratio:function(e){return l},init:g}}}(window.bui||{},window.libs),function(e,t){e.loader=function(n){var i,r=t.extend({},{cache:!0,log:!1,baseUrl:"",relativePath:"pages",needNative:!1,deepView:!1,viewTag:"view",componentTag:"component",deepComponent:!0,scriptSuffix:".js"},e.config.loader,n),o=e.emitter(),l=[],c=[],s={},u={baseUrl:"",modules:{},globals:{}},d={},f={init:function(e){return e=e||{},r=t.extend({},r,e),f.config=r,this},config:r,define:function(n,i,a){var o={moduleName:"",template:"",script:"",path:"",props:null,isComponent:!1,params:null,data:null,depend:[],beforeCreate:null,created:null,beforeLoad:null,loaded:null,hide:null,exports:null,show:null,beforeDestroy:null,destroyed:null},l={},c="";try{var s=v().name?v():function(e){var t=window.location.pathname,n=t.indexOf(".html"),i="",r="";r=n>-1?(i=t.substr(1,n))+".js":(i=t.substr(1))+".js";return{name:i,src:r}}(),f=s.name}catch(e){}var h=[];if(void 0===n)return e.showLog("define第1个参数不能为空"),this;"function"==typeof n?(a=n,c=f,i=[]):"object"===e.typeof(n)?(c=f,i=n.depend||[],a=n.loaded,l=t.extend(!0,{},o,n)):"array"===e.typeof(n)?(a=i,i=n,c=f):"function"==typeof i?(c=n,a=i,i=[]):(c=n,i=i,a=a);var g=d.hasOwnProperty(c)&&d[c].script||s.src,b=window.location.href.substr(0,window.location.href.indexOf("#")).replace("index.html","");g=g.replace(b,""),r.log&&console.log("define "+c),i.length&&(h=m(i,g));if("string"==typeof c&&"function"==typeof a){(l=n&&"object"===e.typeof(n)?t.extend(!0,{},o,d[c],e.config.loader.define,n):t.extend(!0,{},o,d[c],e.config.loader.define)).moduleName=c,l.depend=h,l.style=[],l.script=g,l.path=g.substr(0,g.lastIndexOf("/")+1),l.loaded=function(){var e=[y,d[f]&&d[f].exports,d[f],u.globals],t=[];h.length&&h.forEach((function(e,n){d[e]&&t.push(d[e].exports)}));var n=t.concat(e);return a&&a.apply(this,n)},l.isDefined=!0,p(l)}else e.showLog("define "+c+"模块的参数格式不对");return l},global:function(e){if("object"==typeof e)p({globals:e});else{if("function"!=typeof e)return p().globals;p({globals:e.call(f,u.globals)})}return f},require:y,destroy:function(n){r.log&&console.log("destroy "+n);var i="string"==typeof n?d[n]:null;if(i){i.beforeDestroy&&i.beforeDestroy.call(i);var a=t('script[name="'+n+'"]').attr("src");l=e.array.remove(l,a),t('script[name="'+n+'"]').remove(),delete u.modules[n],d=u.modules,i.destroyed&&i.destroyed.call(i)}},map:p,import:T,importCss:function(t,n){return new Promise((function(i,a){if("string"==typeof t){var o=e.hasRouter?t:e.unit.relativePath(t,r.relativePath),l=document.createElement("link")||{};l.href=o+(r.cache?"":"?t="+(new Date).getTime()),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),n&&l.setAttribute("id",n),document.head&&document.head.appendChild(l),l=null,i(t,n)}else e.showLog(t+"的格式不正确")}))},importSync:S,importHtml:E,load:w,checkLoad:function(t){var n=!0,i=[];if(d=u.modules,"string"==typeof t){t.indexOf(",")>-1?i=t.split(","):i.push(t)}else t&&"array"===e.typeof(t)&&(i=t||[]);if(i.length)i.forEach((function(e,t){d.hasOwnProperty(e)||(n=!1),d[e]&&!1===d[e].isLoaded&&(n=!1)}));else for(var r in d)d[r]&&!1===d[r].isLoaded&&(n=!1);return n},components:O,component:k,delay:function(n){var i=t.extend(!0,{id:"",deepView:r.deepView,deepComponent:r.deepComponent,delay:!1,everytime:!1,param:null,beforeLoad:null,loaded:null,compiled:null},n),a=e.$(i.id);for(let e=0;e<a.length;e++){let n=a[e],o=n&&n.getAttribute("delay"),l=n&&n.tagName.toLowerCase();("true"===o||i.everytime)&&("true"===o&&l===r.componentTag||i.everytime?(i.isSelf=!0,i.id=n,i.everytime?n.removeAttribute("delay"):n.setAttribute("delay","false"),k(i)):"true"===o&&l===r.viewTag||i.everytime?(i.isSelf=!0,i.id=n,n.removeAttribute("delay"),P(i)):(i.isSelf=!1,l=t(n).find('[delay="true"]')[0]&&t(n).find('[delay="true"]')[0].tagName.toLowerCase(),t(n).find('[delay="true"]').removeAttr("delay"),l===r.componentTag&&k(i),l===r.viewTag&&P(i)))}return this},views:j,view:P,get:function(e){if("string"==typeof e)return u.modules[e]||null},set:h,one:function(e,t){return o.one.apply(f,arguments),this},wait:function(e,t){return o.wait.apply(f,arguments),this},waited:function(e,t){return o.waited.apply(f,arguments),this},on:function(t,n){var i=e.history.getLast("id"),r=arguments,a=e.unit.stringToArray(t);return a.forEach((function(e,t){r[0]=i+"-"+e,o.on.apply(f,r)})),this},off:function(t,n){var i=e.history.getLast("id"),r=arguments,a=e.unit.stringToArray(t);return a.forEach((function(e,t){r[0]=i+"-"+e,o.off.apply(f,r)})),this},trigger:R};function p(n){if(void 0===n)return u;if("object"==typeof n&&(n.hasOwnProperty("modules")||n.hasOwnProperty("baseUrl")||n.hasOwnProperty("globals")))u=t.extend(!0,{},u,n),d=u.modules;else if("object"==typeof n&&n.hasOwnProperty("moduleName")){var i=function(n){var i={id:"",moduleName:"",template:"",data:null,props:null,isComponent:!1,params:null,depend:[],script:"",style:[],isDefined:!1,isLoaded:!1,beforeCreate:null,created:null,beforeLoad:null,loaded:null,show:null,hide:null,beforeDestroy:null,destroyed:null,path:"",exports:{},dependExports:[]},r={};d.hasOwnProperty(n.moduleName)&&(r=t.extend(!0,{},d[n.moduleName]));var a=t.extend(!0,{},i,r,n);n.props&&(a.props=n.props);return a.params=e.history.getParams("url"),a}(n);d[n.moduleName]=i||{},u=t.extend(!0,u,{modules:d}),d=u.modules}return u}function h(t,n){if(n&&"object"===e.typeof(n)){if(n.moduleName=t,n.hasOwnProperty("loaded")&&"function"==typeof n.loaded){var i=n.loaded;n.loaded=function(){d=u.modules;var e=n.moduleName,t=d[e].depend,r=[y,d[e]&&d[e].exports,d[e],u.globals],a=[];t.length&&t.forEach((function(e,t){d[e]&&a.push(d[e].exports)}));var o=a.concat(r);return i&&i.apply(this,o)},n.script=n.moduleName+".js",n.path=n.script.substr(0,n.script.lastIndexOf("/")+1)}n.depend&&n.depend.length&&(n.depend=m(n.depend,n.script)),p(n)}return this}function g(e,t){var n=e,i=t.lastIndexOf("/"),r=t.substr(0,i);return e.indexOf("../")>-1?(e=e.replace(/\..\//g,(function(e){var t=r.lastIndexOf("/");return r=r.substr(0,t),""})),n=r?r+"/"+e:e):e.indexOf("./")>-1&&(n=r+"/"+e.replace(/\.\//g,"")),n}function m(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],a=r.indexOf("./")>-1?g(r,t):r;if(a.indexOf(".css")>-1)a.indexOf("css!")>-1?styles.push(a.substr(4)):styles.push(a);else{var o=a.indexOf(".js");o>-1&&(a=a.substr(0,o)),n.push(a),d.hasOwnProperty(a)||p({moduleName:a})}}return n}function v(){var e,n=window.location.href,o=[],l=document.currentScript;if(n.indexOf("#")>-1?o=n.split("#"):o.push(n),i=o[0].replace("/index.html","")+"/",l)return e=l.src.replace(i,""),{name:l.getAttribute("name")||e.substr("0",e.indexOf(r.scriptSuffix)),src:e};try{a()}catch(e){var c=(c=(e.stack||e.sourceURL||e.stacktrace||"").split(/[@ ]/g).pop().replace(/(:\d+)?:\d+$/i,"")).replace(new RegExp(i,"g"),"");return{name:(l=t('script[src="'+c+'"]')[0])?l.getAttribute("name"):c.replace(r.scriptSuffix,""),src:c}}}function y(t,n){if(r.log&&console.log("require "+t),t&&"string"==typeof t){if(t.indexOf(".css")>-1)return T(t,n);if(t.indexOf(".html")>-1)return T(t,n);t=[t]}if(n&&"function"!=typeof n)return e.showLog("require第2个参数格式为function","bui.loader.require"),this;try{(function(t,n){var i=[];function a(t,n){t=t||[],d=u.modules;var o=e.array.uniq(t);o.length>1&&o.forEach((function(e,t){var n=d[e];(n&&1==n.isLoaded||n.loaded)&&o.splice(t,1)})),o.forEach((function(t,l){var c=d[t];if(d[t]&&d[t].style&&d[t]&&d[t].style.length&&$(d[t].style),e.array.compare(i,t)||i.unshift(t),c&&c.isLoaded){if(!1===(c&&c.beforeLoad&&c.beforeLoad.call(c,c.depend)))return!1;l==o.length-1&&(n&&n.apply(c),i=[])}else if(c&&c.loaded){if(s(t,l),!1===(d[t].beforeCreate&&d[t].beforeCreate.call(d[t])))return!1;d[t].created&&d[t].created.call(d[t])}else N(t,(function(){var e=d[t];if(!1===(e&&e.beforeCreate&&e.beforeCreate.call(d[t])))return!1;e&&e.style&&e.style.length&&$(e.style),e&&e.created&&e.created.call(d[t]),s(t,l)}),(function(){l==o.length-1&&(n&&n.apply(null),i=[])}));function s(e,t){var i=d[e];return i&&(i.isDefined=!0),i.id=c?c.id:"",i.props=c?c.props:{},!1!==(i&&i.beforeLoad&&i.beforeLoad.call(i,i.depend))&&(i&&i.depend&&i.depend.length?(r.log&&console.warn(i.moduleName+" depend:"),r.log&&console.log(i.depend),void a(i.depend,n)):void(t==o.length-1&&n&&n.apply(i)))}}))}a(t,(function(){if(function(e){var t=!0,n=e||[];if(d=u.modules,n.length){let e=0;for(;e<n.length;e++){let a=n[e];var i=d[a];if(i&&!1===i.isDefined)return t=!1,r.log&&console.warn("check defined false:"+i.moduleName),r.log&&console.warn("wait modules:"),r.log&&console.warn(n),t}}else for(var a in d)if(d[a]&&!1===d[a].isDefined)return t=!1,r.log&&console.warn("check defined false:"+i.moduleName),t;return t}(i)){var a=[];t.forEach((function(i,r){h(i,{params:e.history.getParams("url")}),b(i),a.push(d[i]&&d[i].exports),r===t.length-1&&n&&n.apply(f,a||[])}))}}))})(t=t.map((function(t,n){return e.unit.resolvePath(t)})),n)}catch(t){e.showLog(t,"bui.loader.require")}return this}function b(t){d=u.modules;var n="string"==typeof t?d[t]||{}:t,i=n.depend||[],a=null,o=[];n.dependExports=[];try{if(i.length)for(var l=0;l<i.length;l++){var c=i[l],s=d[c];s.isLoaded?o[l]=s.exports:o[l]=b(s)||s.exports,s.exports=o[l],n.dependExports.push(o[l]),s.isLoaded=!0}a=n.isLoaded&&!n.isComponent?n.exports:n.loaded&&n.loaded.apply(n,o),n.exports=a||d[n.moduleName]&&d[n.moduleName].exports,n.isLoaded=!0,R(n.moduleName,n,n.exports),r.log&&console.log("execute "+n.moduleName)}catch(t){e.showLog(t,"bui.loader.execute")}return a}function w(n){var i=t.extend(!0,{id:"",cacheHtml:!1,cache:!1,url:"",script:"",param:null,template:null,beforeLoad:null,loaded:null},e.config.loader.load,n);if(i.id){if(i.url){if(!1===("function"==typeof i.beforeLoad?i.beforeLoad.call(f):i.beforeLoad))return this;var r=function(e){var t=d,n={},i=e&&e.indexOf(".html");i>-1?(n.url=e,n.module=e.substr(0,i)):(n.url=t[e]&&t[e].template||e+".html",n.module=e);return n}(i.url);if(i.script){var a=i.script.indexOf(".js");r.module=i.script.substr(0,a)}var o="string"==typeof i.id&&(i.id.indexOf("#")>-1||i.id.indexOf(".")>-1)?i.id.substr(1):i.id;i.id=o,i.name=r.module,i.url=r.url,p({id:o,moduleName:r.module,props:i.param}),e.history.getLast().currentComponent=o,e.history.setComponent({id:i.id,name:i.name,url:i.url,param:i.param||null});var l=p().modules[i.name];if(l&&"function"==typeof l.template){var c=l.template.call(l)||"";return!i.cacheHtml&&e.obj(i.id).html(c),x(i),this}if(i.cacheHtml)return x(i),this;if("function"==typeof r.url){var s=r.url(i)||"";return!i.cacheHtml&&e.obj(i.id).html(s),x(i),this}return T(r.url,(function(t){!i.cacheHtml&&e.obj(i.id).html(t),x(i)}),(function(e){i.onFail&&i.onFail.call(this,r)})),this}e.showLog("url不能为空")}else e.showLog("id不能为空")}function x(t){var n=p().modules[t.name];if(!1===(n.beforeLoad&&n.beforeLoad.call(n,n.depend)))return!1;if(h(t.name,{id:t.id,props:t.param||null,isComponent:!0}),n.isLoaded&&"function"==typeof n.loaded&&!t.cache){n.id=t.id,n.exports=n.loaded&&n.loaded.call(n,n.exports)||n.exports;var i={id:t.id,name:t.name,url:t.url,param:t.param||null,exports:n.exports||{}};return e.history.setComponent(i),window.store&&window.store.$mount&&window.store.$mount(t.id),t.loaded&&t.loaded.call(n,n.exports),R(t.id,i),f}e.checkLoad(t.name);y(t.name,(function(i){var r={id:t.id,name:t.name,url:t.url,param:t.param||null,exports:i||{}};e.history.setComponent(r),window.store&&window.store.$mount&&window.store.$mount(t.id),t.loaded&&t.loaded.call(n,i),R(t.id,r)}))}function k(n){var i=t.extend(!0,{id:"",isSelf:!0,deepComponent:r.deepComponent,cache:!1,cacheHtml:!1,delay:!0,param:null,beforeLoad:null,loaded:null,compiled:null},e.config.loader.component,n),a=null;a=""===i.id?e.$(r.componentTag):i.isSelf?e.$(i.id):e.$(i.id).find(r.componentTag);var o=[],l=[],c=[],s=[],u=p().modules;for(let n=0;n<a.length;n++){let r=a[n];var d=e.guid();!r.id&&r.setAttribute("id",d);var f=e.unit.getAttributes(r),h=f.parentId=i&&i.id||e.history.getLast().id||"bui-page",g=e.$(h).parents("component"),m=i.isSelf?g[0]&&g[0].id:i.id;"array"===e.typeof(h)?m=i.isSelf?g&&g[0].id:h[0].id:"object"==typeof f.parentId&&e.typeof(f.parentId).indexOf("element")>-1&&(m=i.isSelf?g[0]&&g[0].id:h.id);var v=m&&e.history.getComponent(m,"name");if(v)f.parentId=m,f.parentName=v;else{var y=e.history.getLast();f.parentId=y.id,f.parentName=y.name}var b=f.name||r.getAttribute("name"),x="true"===f.rendered||i.cacheHtml;if(b&&(!f.delay||!i.delay)){f=t.extend(!0,{},f,i.param);var k=u[b],O=r.innerHTML,I=k&&"string"==typeof k.template?k.template:b+".html",j=k&&k.script?k.script:b+".js";I=I||b+".html",k&&"function"==typeof k.template?o.push({id:r.id,el:r,name:b,cacheHtml:x,cache:i.cache,deepComponent:i.deepComponent,template:k.template||"",url:I,srcript:j,slot:O,param:f}):(c.push(I),s.push(j),l.push({id:r.id,el:r,name:b,cacheHtml:x,cache:i.cache,deepComponent:i.deepComponent,url:I,srcript:j,slot:O,param:f}))}}return o.length&&(o.forEach((function(e,t){w({id:e.id,url:e.url,param:e.param||null,template:e.template,cacheHtml:e.cacheHtml,cache:e.cache,beforeLoad:i.beforeLoad})})),i.data=o,L(i)),l.length?(S(e.array.merge(c,s),(function(e){!function t(n){var r=l[n];return n==l.length?(i.data=l,L(i),this):r?(r.template=e[n],void w({id:r.id,url:r.url,param:r.param||null,cacheHtml:r.cacheHtml,cache:r.cache,beforeLoad:i.beforeLoad,loaded:function(e){t(n+1)},onFail:function(){t(n+1)}})):this}(0)})),this):(i.compiled&&i.compiled(i.data),R("componentcompiled",i.data),!1)}function O(e){return k(t.extend(!0,{id:"",isSelf:!1,deepComponent:r.deepComponent,cache:!1,cacheHtml:!1,beforeLoad:null,loaded:null,compiled:null},e)),this}function L(t){for(let i=0;i<t.data.length;i++){let a=t.data[i];new RegExp(`<${r.viewTag}.+name=`,"gi").test(a.template)&&j({id:a.id});var n=new RegExp(`<${r.componentTag}.+name=`,"gi");new RegExp(`<${r.componentTag}.+name="${a.name}"`,"gi").test(a.template)?e.showLog(`请检查代码, <${r.componentTag} name="${a.name}"></${r.componentTag}>的模板里面存在循环嵌套`):(t.deepComponent&&n.test(a.template)&&O({id:a.id}),t.loaded&&t.loaded(a),R("componentloaded",a))}t.compiled&&t.compiled(t.data),R("componentcompiled",t.data)}function I(n){for(let l=0;l<n.data.length;l++){let c=n.data[l];if(!c.cacheHtml){c.el.innerHTML=c.template;var i=new RegExp(`<${r.componentTag}.+name`,"gi");new RegExp(`<${r.componentTag}.+name="${c.name}"`,"gi");i.test(c.template)&&O({id:c.id});var a=new RegExp(`<${r.viewTag}.+name="${c.name}"`,"gi"),o=new RegExp(`<${r.viewTag}.+name="${c.name}"`,"gi");if(o.test(c.template)){e.showLog(`请检查代码, <${r.viewTag} name="${c.name}"></${r.viewTag}>的模板里面存在循环嵌套`);continue}n.deepView&&a.test(c.template)&&!o.test(c.template)&&j({id:t(c.el)})}n.loaded&&n.loaded(c),R("viewloaded",c)}n.compiled&&n.compiled(n.data),R("viewcompiled",n.data)}function j(e){return P(t.extend(!0,{id:"",isSelf:!1,deepView:r.deepView,loaded:null,compiled:null},e)),this}function P(n){var i=t.extend(!0,{id:"",isSelf:!0,deepView:r.deepView,loaded:null,compiled:null},n),a=null;a=""===i.id?e.$(r.viewTag):i.isSelf?e.$(i.id):e.$(i.id).find(r.viewTag);var o=[],l=[],c=loader.map().modules;for(let t=0;t<a.length;t++){let n=a[t];var s=n.getAttribute("name"),u=n.getAttribute("delay"),d=c[s],f="true"===n.getAttribute("rendered"),p=e.guid();if(!n.id&&n.setAttribute("id",p),"true"!==u){var h=n.innerHTML,g=d&&d.template?d.template:s+".html";d&&"function"==typeof d.template?l.push({id:n.id,el:n,name:s,cacheHtml:f,template:d.template.call(d)||"",url:g,slot:h}):o.push({id:n.id,el:n,name:s,cacheHtml:f,url:g,slot:h})}}return l.length&&(l.forEach((function(e,t){e.el.innerHTML=e.template,window.store&&window.store.$mount&&window.store.$mount(i.id)})),i.data=l,I(i)),function e(t){if(t==o.length)return i.data=o,void I(i);o[t]&&E(o[t].url,(function(n){o[t].template=n,e(t+1)}),(function(n){o[t].template="",e(t+1)}))}(0),this}function T(n,i,r){return new Promise((function(a,o){if("string"==typeof n)(n=e.unit.resolvePath(n)).indexOf(".css")>-1?(i&&i(n),C(n).then((function(e){a(n)}))):n.indexOf(".html")>-1||n.indexOf(".htm")>-1?E(n).then((function(e){if("function"!=typeof i)return t(i).html(e),r&&r(e),void a(e);i&&i(e),a(e)}),(function(e){r&&r(e),o(e)})):N(n).then((function(e){i&&i(e),a(e)}),(function(e){r&&r(e),o(e)}));else if(n&&"array"===e.typeof(n)){var l=n.map((function(t,n){return(t=e.unit.resolvePath(t)).indexOf(".css")>-1?C(t):t.indexOf(".html")>-1||t.indexOf(".htm")>-1?E(t):N(t)}));Promise.all(l).then((function(e){i&&i(e),a(e)}),(function(e){r&&r(e),o(e)}))}}))}function S(t,n,i){return new Promise((function(r,a){if("string"==typeof t)T(t,n,i);else if(t&&"array"===e.typeof(t)){var o=[];!function i(a){if(a==t.length)return n&&n(o),void r(o);var l=e.unit.resolvePath(t[a]);return l.indexOf(".css")>-1?C(l,(function(e){o.push(e),i(a+1)})):l.indexOf(".html")>-1||l.indexOf(".htm")>-1?E(l,(function(e){o.push(e),i(a+1)}),(function(e){i(a+1)})):N(l,(function(e){o.push(e),i(a+1)}),(function(e){i(a+1)}))}(0)}}))}function E(t,n,i){return new Promise((function(a,o){var l="function"==typeof n;if(t=e.hasRouter?t:e.unit.relativePath(t,r.relativePath),s.hasOwnProperty(t))return l?n&&n.call(f,s[t],200):"string"==typeof n&&e.$(n).html(s[t]),a(s[t],200),this;"string"==typeof t&&bui.ajax({baseUrl:r.baseUrl,url:t,dataType:"html",contentType:"text/html;charset=UTF-8",mimeType:"html",processData:!1,needNative:r.needNative,cache:r.cache,data:null,success:function(r,o,c){s[t]=r,l?n&&n.call(f,r,o,c):"string"==typeof n&&(e.$(n).html(r),i&&i.call(f,r,o,c)),a(r,o)},error:function(e,t,n){l&&i&&i.call(f,e,t,n),o(e,t,n)}})}))}function N(n,i,a){return new Promise((function(o,c){var s;if(d=u.modules,void 0===n||""==n)return a&&a.call(this,n),c(n),this;if(n in d)s=n,n=d[n].script||s+r.scriptSuffix;else{var f=n.indexOf(r.scriptSuffix);f>-1?s=(n=n).substr(0,f):(s=n,n+=r.scriptSuffix)}n=e.hasRouter?n:e.unit.relativePath(n,r.relativePath);var p=document.createElement("script")||{},h=r.cache?"":"?t="+(new Date).getTime(),g=n.indexOf("http://")>-1||n.indexOf("https://")>-1;p.type="text/javascript",p.async=!1,p.src=g?n+h:u.baseUrl+n+h,p.setAttribute("name",s),p.onload=function(){r.log&&console.log("create "+n),i&&i(n),o(n)},p.onerror=function(e){r.log&&console.log("createError "+n),a&&a(n),c(n)};var m=e.array.index(l,n);return d[s]&&d[s].isDefined?(i&&i(n),o(n)):(m>-1&&d.hasOwnProperty(s)&&t('script[name="'+s+'"]').remove(),m>-1&&!d.hasOwnProperty(s)&&t('script[name="'+s+'"]').remove(),document.body&&document.body.appendChild(p),r.cache&&l.push(n)),p=null,this}))}function $(t){return new Promise((function(n,i){t.length;if("array"===e.typeof(t)){var r=t.map((function(e){return C(e)}));return Promise.all(r)}return C(t)}))}function C(t,n){return new Promise((function(i,a){if("string"==typeof t){if(e.array.index(c,t)<0){var o=e.hasRouter?t:e.unit.relativePath(t,r.relativePath),l=document.createElement("link")||{};l.href=o+(r.cache?"":"?t="+(new Date).getTime()),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),document.head&&document.head.appendChild(l),l=null,c.push(t)}i(t,n)}else e.showLog(t+"的格式不正确")}))}function R(t){f.self=this==window||this==f?null:this;var n=e.history.getLast("id");arguments[0]=n+"-"+t,o.trigger.apply(f,arguments)}return f},window.loader=e.loader(),e.define=loader.define,e.require=loader.require,e.map=loader.map,e.import=loader.import,e.checkLoad=loader.checkLoad,e.checkDefine=loader.checkDefine,e.checkImport=loader.checkImport}(window.bui||{},window.libs),function(e,t){e.toggle=function(n){if("string"==typeof n){var i=n||"";(n={}).id=i}var r,a,o={show:function(t,n){if(s)return;if(d=e.objId(l.id),!f&&!p)return!1;f=!1,"function"==typeof t?(t=t,n=n||a||""):(n=t||a||"",t=null);d[0]&&"none"==d[0].style.display&&d.css("display",c);d.addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n?(l.revert&&d.removeClass("animated "+n),t&&t.call(o,this),h=!0,f=!0):d.one("webkitAnimationEnd",(function(){try{!h&&d.css("display",c),l.revert&&d.removeClass("animated "+n),t&&t.call(o,this),h=!0,f=!0}catch(t){e.showLog(t,"toggle show method")}}));return this},hide:function(t,n){if(s)return;if(d=e.objId(l.id),!f&&!p)return;p=!1,"function"==typeof t?(t=t,n=n||r||""):(n=t||r||"",t=null);d.css("display",c).addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n?(d.css("display","none"),l.revert&&d.removeClass("animated "+n),t&&t.call(o,this),h=!1,p=!0):d.one("webkitAnimationEnd",(function(){try{d.css("display","none"),l.revert&&d.removeClass("animated "+n),t&&t.call(o,this),h=!1,p=!0}catch(t){e.showLog(t,"toggle hide method")}}));return this},remove:function(){return d.remove(),this},isShow:function(){return h},destroy:function(e){e=1==e;d&&(d.off(),e&&d.remove());s=!0},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(o,t,n)},config:l,init:g},l=o.config=t.extend(!0,{},{id:"",effect:"fadeIn",useBox:!1,revert:!0,inOrder:!1},n),c=l.useBox?"-webkit-box":"block",s=!1,u={show:["fadeIn","fadeInLeft","fadeInRight","fadeInDown","fadeInUp","fadeInLeftBig","fadeInRightBig","fadeInUpBig","fadeInDownBig","zoomIn","bounceIn","rotateIn","rollIn","flipInX","flipInY","lightSpeedIn","showIn","slideInRight","slideInLeft","coverInLeft","coverInRight","zoomSlideInLeft","zoomSlideInRight","pushInLeft","pushInRight"],hide:["fadeOut","fadeOutLeft","fadeOutRight","fadeOutUp","fadeOutDown","fadeOutLeftBig","fadeOutRightBig","fadeOutDownBig","fadeOutUpBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutRight","slideOutLeft","coverOutLeft","coverOutRight","zoomSlideOutLeft","zoomSlideOutRight","pushOutLeft","pushOutRight"],hideInOrder:["fadeOut","fadeOutRight","fadeOutLeft","fadeOutDown","fadeOutUp","fadeOutRightBig","fadeOutLeftBig","fadeOutUpBig","fadeOutDownBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutLeft","slideOutRight","coverOutRight","coverOutLeft","zoomSlideOutRight","zoomSlideOutLeft","pushOutRight","pushOutLeft"]},d=null,f=!0,p=!0,h=!1;function g(t){if(s=!1,(t=t||l).id){d=e.objId(t.id),l=o.config=t,d.attr("class")||"";var n=t.effect,i=t.inOrder?e.array.index(u.hideInOrder,n):e.array.index(u.hide,n),c=n&&(e.array.index(u.show,n)>-1?e.array.index(u.show,n):i);return h=!(d[0]&&"none"==d[0].style.display||"none"==d.css("display")),c<0?(a=u.show[0],r=t.inOrder?u.hideInOrder[0]:u.hide[0]):(a=u.show[c],r=t.inOrder?u.hideInOrder[c]:u.hide[c]),this}e.showLog("toggle id不能为空","bui.toggle")}return l.id&&g(l),o}}(window.bui||{},window.libs),function(e,t){e.unit={},e.unit.remToPx=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100;return e=(parseFloat(e)*t).toFixed(2)},e.unit.pxToRem=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100;return e=(parseFloat(e)/t).toFixed(2)},e.unit.pxToRemZoom=function(e){return e=(parseFloat(e)/100).toFixed(2)},e.unit.debounce=function(e,t,n){var i;return function(){var r=n||this,a=arguments,o=function(){i=null,e.apply(r,a)};clearTimeout(i),i=setTimeout(o,t)}},e.unit.throttle=function(e,t,n){var i,r;return t||(t=250),function(){var a=n||this,o=+new Date,l=arguments;i&&o<i+t?(clearTimeout(r),r=setTimeout((function(){i=o,e.apply(a,l)}),t)):(i=o,e.apply(a,l))}},e.unit.startWithCss=function(e){var t=new RegExp("^\\.|^#");return"string"==typeof e&&t.test(e)},e.unit.startWithStr=function(e,t){var n=new RegExp("^"+t);return"string"==typeof e&&n.test(e)},e.unit.startWithId=function(e){var t=new RegExp("^#");return"string"==typeof e&&t.test(e)},e.unit.startWithClass=function(e){var t=new RegExp("^\\.");return"string"==typeof e&&t.test(e)},e.unit.endWithImage=function(e){var t=new RegExp("(.png|.jpg|.gif)$");return"string"==typeof e&&t.test(e)},e.unit.tel=function(t){var n,i="tel:";return 0==(t=String(t)).indexOf("+")&&(i="wtai://wp/mc;"),n=t,window.location.href=i+n,e},e.unit.sms=function(t,n){var i=navigator.userAgent,r=/(iPhone|iPad|iOS)/i.test(i)?"&":"?";return window.location.href="sms:"+t+r+"body="+n,e},e.unit.mailto=function(t){return"string"==typeof(t="email"in t?t:{}).email&&t.email.indexOf("@")>0?window.location.href="mailto:"+t.email+"?subject="+(t.subject||"")+"&body="+(t.body||"")+"&cc="+(t.cc||""):e.showLog(email+"格式不正确"),e},e.unit.openExtral=function(t){var n=[],i="";if((t=String(t)).indexOf("mailto:")>=0)if((i=(n=t.split("mailto:"))[1]).indexOf("?")>-1){var r=i.split("?"),a=e.unit.keyStringToObject(r[1]);a.email=r[0],e.unit.mailto(a)}else e.unit.mailto({email:i});if(t.indexOf("tel:")>=0&&(n=t.split("tel:"),i=parseInt(n[1]),e.unit.tel(i)),t.indexOf("sms:")>=0)if(i=(n=t.split("sms:"))[1],t.indexOf("=")>=0){var o=t.split("=")[1];e.unit.sms(i,o)}else e.unit.sms(i);return e},e.unit.objectToKeyString=function(e,t){var n="";for(var i in e){n+="&"+i+"="+(t?encodeURIComponent(e[i]):e[i])}return n.substr(1)},e.unit.keyStringToObject=function(t,n){var i,r={},a=[];try{for(a=t.split("&"),i=0;i<a.length;i++){var o=n?decodeURIComponent(a[i].split("=")[1]):a[i].split("=")[1];r[a[i].split("=")[0]]=o}}catch(t){e.showLog(t)}return r},e.unit.checkTargetInclude=function(e,n){var i=n,r=[];if(i.indexOf(",")>-1){var a,o=(r=i.split(",")).length;for(a=0;a<o;a++){var l=r[a];l.indexOf(".")>-1&&(r[a]=l.substr(1))}}else i.indexOf(".")>-1?r[0]=i.substr(1):r[0]=i;var c,s=r.length;for(c=0;c<s;c++)if(t(e).hasClass(r[c])||t(e).closest("."+r[c]).length)return!0;return!1},e.unit.jsonToString=function(t){return"object"==typeof t?function(t){var n;if("object"===e.typeof(t)){for(var i in t)t[i]=r(t,i);n=JSON.stringify(t)}else"array"===e.typeof(t)?(t.forEach((function(e,n){t[n]=r(t,n)})),n=JSON.stringify(t)):n=t;function r(t,n){var i=t[n];return i&&"object"===e.typeof(i)?t[n]=function(t){if(t&&"object"===e.typeof(t)){for(var n in t){var i=t[n];"object"==typeof i&&(t[n]=JSON.stringify(i))}return t}}(i):i&&"array"===e.typeof(i)?t[n]=function(t){if(t&&"array"===e.typeof(t))return t.forEach((function(e,n){"object"==typeof e&&(t[n]=JSON.stringify(e))})),t}(i):t[n]=i,t[n]}return n}(t):t},e.unit.stringToJson=function(t){return t&&function t(n){var i,r;try{if(i="object"==typeof n?n:JSON.parse(n),"array"===e.typeof(i))i.forEach((function(e,n){i[n]=t(e)}));else if("object"===e.typeof(i))for(var a in i){var o=i[a];i[a]=t(o)}r=i}catch(e){r=n}return r}(t)},e.unit.stringToArray=function(t){var n=e.typeof(t);return"array"===n?t:"string"===n&&t.indexOf(",")>-1?t.split(","):[t]},e.unit.setKeyValue=function(e,t,n){var i=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(n,r){if(i.length)return e(i.shift(),r[n]||{});r[n]=t}(i.shift(),n)},e.unit.getKeyValue=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(t,i){var r=i[t];if(r&&"string"==typeof r&&r.indexOf("{")>-1&&r.indexOf("}")>-1)try{i[t]=JSON.parse(r)}catch(e){i[t]=r}return void 0!==r&&n.length?e(n.shift(),r):r}(n.shift(),t)},e.unit.getKeyObj=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(t,i){var r=i[t];return!r instanceof Array&&r instanceof Object?e(n.shift(),r):r}(n.shift(),t)},e.unit.getKeyName=function(e){var t=field&&field.indexOf(".")>-1?field.split("."):[field];return function e(n,i){var r=i[n];return!r instanceof Array&&r instanceof Object?e(t.shift(),r):r}(t.shift(),e)},e.unit.delKey=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(i,r){return n.length?e(n.shift(),r[i]):(delete r[i],t)}(n.shift(),t)},e.unit.calcHeight=function(e,n){var i=t(e);i[0]&&(i[0].style.height="calc(100% - "+n+")")},e.unit.resolvePath=function(t){if(!e.hasRouter)return t;var n=t=t||"",i=(router&&router.history&&router.history.getLast()||{url:n}).url||"";if("function"==typeof i)return n;var r=i.lastIndexOf("/"),a=i.substr(0,r);return t.indexOf("../")>-1?(t=t.replace(/\..\//g,(function(e){var t=a.lastIndexOf("/");return a=a.substr(0,t),""})),n=a?a+"/"+t:t):t.indexOf("./")>-1&&(n=a+"/"+t.replace(/\.\//g,"")),n},e.unit.filterField=function(t,n){var i={};if("object"==typeof n){var r="object"===e.typeof(t),a="object"===e.typeof(n),o="array"===e.typeof(t),l="array"===e.typeof(n);if(r){if(a)for(let e in n)i[e]=n[e]?t[n[e]]:t[e];else l&&n.forEach((function(e,n){i[e]=t[e]}));return i}return o?(i=[],l?t.forEach((function(e,t){let r={};n.forEach((function(t,n){r[t]=e[t]})),i.push(r)})):a&&t.forEach((function(e,t){let r={};for(let t in n)r[t]=n[t]?e[n[t]]:e[t];i.push(r)})),i):void 0}},e.unit.fixZero=function(e){return e<10?"0"+e:e},e.unit.getAttributes=function(t){if("object"!=typeof t)return null;var n={},i=/\{.+\}$/g,r=/\[.+\]$/g;return t.attributes&&Object.keys(t.attributes).forEach((function(a,o){var l=t.attributes[a],c=l.value;if(i.test(c)||r.test(c))try{c=JSON.parse(c)}catch(t){c=c,e.showLog(t)}n[l.name]=c})),n},e.unit.resolvePathname=function(e,t){t=t||0;var n=e.lastIndexOf("/"),i=e.substring(t,n);return i.indexOf("/")>-1?i.split("/"):[i]},e.unit.relativeUrl=function(e,t){var n=[];return t.length>=e.length?t.forEach((function(t,i){let r=e[i];r&&t===r||(r&&t!==r?(n.unshift(".."),n.push(t)):n.push(t))})):e.forEach((function(e,i){let r=t[i];r&&e===r||(r&&e!==r?(n.unshift(".."),n.push(r)):n.unshift(".."))})),n},e.unit.relativePath=function(t,n){n=n||"pages";var i=window.self.location.href;if(i.indexOf("source.html?url=")>-1&&i.indexOf("code=")>-1)return t;if(0===t.indexOf("http://")||0===t.indexOf("https://"))return t;var r=window.location.href,a=r.indexOf(n),o=t&&t.indexOf("/")>-1?t.split("/"):[t],l=[];if(a<0){var c=window.location.pathname.toLocaleLowerCase(),s=c.indexOf("www"),u=c.indexOf("src"),d=c.indexOf("dist");if(s>-1){let t=e.unit.resolvePathname(c,s+4);l=e.unit.relativeUrl(t,o)}else if(d>-1){let t=e.unit.resolvePathname(c,d+5);l=e.unit.relativeUrl(t,o)}else{if(!(u>-1))return 0==t.indexOf("/")?t.replace("/",""):t;{let t=e.unit.resolvePathname(c,u+4);l=e.unit.relativeUrl(t,o)}}}else{let t=e.unit.resolvePathname(r,a);l=e.unit.relativeUrl(t,o)}return l.join("/")},e.unit.between=function(t,n,i){var r=!0,a=new Date;if(n=n||0,i=i||e.date.convert(a.getFullYear+"/12/31").getTime(),"number"==typeof t)(t<n||t>i)&&(r=!1);else{n||e.showLog("bui.unit.between 第2个参数为最小日期");try{n=e.date.convert(n).getTime(),i=e.date.convert(i).getTime(),((t=e.date.convert(t).getTime())<n||t>i)&&(r=!1)}catch(t){e.showLog("bui.unit.between 用来检测数字或者日期,请检查参数格式是否正确")}}return r},e.unit.numberunit=function(e){var t=+e,n=t;return t>1e4&&(n=parseFloat(t/1e4).toFixed(1)+"万"),n}}(window.bui||{},window.libs),function(e,t){var n,i,r,a;e.history=(r=[],a={get:function(t,n){if(void 0===t)return r;{let i=n||"name";return e.array.get(r,t,i)}},getLast:function(e){var t=r.length-1,n=r[t]||{};return e?n[e]:n},getPrev:function(e){var t=r.length-2,n=r[t]||{};return e?n[e]:n},getParams:function(e){var t=this.getLast(),n={};switch(e){case"page":n=this.getPageParam()||n;break;case"part":case"component":n=this.getComponentParam()||n;break;case"url":n=t.param||bui.getUrlParams();break;default:n=this.getComponentParam(e)||this.getPageParam(e)||t.param||bui.getUrlParams()}return n},setComponent:function(e){return this.getLast().component[e.id]=e,e},getComponentParam:function(e){var t=this.getLast(),n=e||t.currentComponent;return n&&t.component[n]&&t.component[n].param||null},getComponent:function(t,n){if(void 0!==t){n=n||"exports";var i=this.getLast();return i.component[t]&&i.component[t][n]||null}e.showLog("必须传component id才能获取实例")},getParentComponent:function(){var e=this.getComponentParam();return e&&e.parentId&&this.getComponent(e.parentId)||this.getLast("exports")},getParentParams:function(){var e=this.getComponentParam();return this.getParams(e.parentId)||this.getLast("param")||null},getPage:function(t,n){if(void 0!==t){n=n||"exports";var i=this.getLast(),r=null,a=i.page;if(a.hasOwnProperty(t))r=a[t]&&a[t][n]||{};else if(t){var o=Object.keys(a);for(let e=0;e<o.length;e++){let i=a[o[e]]||{};if(i.name===t)return i[n]}}else{var l=i.currentPage;r=a[l]&&a[l][n]||{}}return r}e.showLog("必须传page id 或者 模块名才能获取实例")},getPageDialog:function(t){if(void 0!==t){var n=this.getLast();return n.page[t]&&n.page[t].dialog||null}e.showLog("必须传page id才能获取对话框信息")},setPage:function(e){var n=this.getLast();if("object"!=typeof e)return e;if(e&&e.hasOwnProperty("id")){var i=t.extend(!0,{},n.page[e.id],e);return n.page[e.id]=i,e}},getPageParam:function(e){var t=this.getLast(),n=e||t.currentPage;return n&&t.page[n]&&t.page[n].param||null},add:function(n){var i=t.extend(!0,{id:"",name:"",url:"",replace:!1,syncHistory:!0,component:{},param:{},part:{},page:{},toggle:null,effect:"push"},n),a=r;if(n.toggle){var o=t.extend(!0,{},i,n);i.toggle=null,a.push(o)}else a.push(i);var l=window.location.origin+window.location.pathname+"#"+i.name,c=e.setUrlParams(l,i.param);return i.syncHistory&&"pushState"in window.history&&window.history.pushState(i,null,c),a},replace:function(n){n=t.extend(!0,{id:"",name:"",url:"",replace:!1,syncHistory:!0,param:{},part:{},page:{},toggle:null,effect:"push"},opts);var i=r,a=i.length-1,o=window.location.origin+window.location.pathname+"#"+n.name,l=e.setUrlParams(o,n.param);if(a>-1){if(opts.toggle){var c=t.extend(!0,{},n,opts);n.toggle=null,i.splice(a,1,c)}else i.splice(a,1,n);n.syncHistory&&"replaceState"in window.history&&window.history.replaceState(n,null,l)}return i},refresh:function(){if(e.hasRouter){var n=a.getLast(),i=loader.get(n.name);loader.import(n.url,(function(r){t("#"+n.id).html(r),e.config.init.auto&&e.init(),router.config.needView&&loader.views(),i.loaded(),router.config.needComponent&&loader.components()}))}else window.location.reload(!0)},removeNext:function(t){var n=r,i=t.index;if(parseInt(i)<0)return e.showLog("index 必须大于或者等于0"),n;var a=n.length-i;n.splice(i,a);var o=this.getLast(),l=window.location.origin+window.location.pathname+"#"+o.name,c=e.setUrlParams(l,o.param);return t.syncHistory&&"replaceState"in window.history&&window.history.replaceState(o.param,null,c),n},removeLast:function(e){var t=r.length-1;return this.removeNext({index:t,syncHistory:!1!==e})},check:function(t){var n=r;return e.array.compare(n,t,"name")||e.array.compare(n,t,"url")||e.array.compare(n,t,"id")},checkComponent:function(t){var n=this.getLast(),i=Object.keys(n.component);return e.array.compare(i,t)},checkPage:function(e,t){var n=this.getLast(),i=Object.keys(n.page);for(let t=0;t<i.length;t++){let r=i[t],a=n.page[r];if(a.name===e||a.id===e)return!0}return!1},epmty:function(e){return r=[]}},n=function(t){var n=(t=t&&t.replace(window.location.origin,"")||window.location.pathname).indexOf(".html"),i=t.indexOf("?"),r="",a="",o="",l=null,c=loader.map().modules;if(i>-1){var s=t.substr(i+1);l=e.unit.keyStringToObject(s,!0)}return n>-1?(a=(r=0==t.indexOf("/")?t.substr(1,n-1):t.substr(0,n-1))+".html",o=r+".js"):(a=c[r=t]&&c[r].template||"",o=c[r]&&c[r].script||""),{pid:r,name:r,url:a,src:o,param:l}}(window.location.href),i=e.guid(),t(document).ready((function(){document.body.setAttribute("id",i)})),r.push({id:e.guid(),pid:n.pid,name:n.pid,url:n.url,src:n.src,param:n.param,page:{},component:{}}),a)}(window.bui||{},window.libs),function(e,t){e.router=function(n){var i,r,a,o=t.extend({},{id:"",progress:!1,syncHistory:!0,autoInit:!0,firstAnimate:!1,path:"",indexModule:{moduleName:"main",template:"pages/main/main.html",script:"pages/main/main.js"},repairPath:!0,errorPage:"",hash:!1,cache:!0,reloadCache:!1,reload:!1,swipe:!1,swipeBack:!1,distance:100,startDistance:5,swipeDistance:50,onSwipeRight:null,onSwipeLeft:null,onSwipeUp:null,onSwipeDown:null,onBeforeSwipeRight:null,onSwipeCancel:null,pageMove:!0,needNative:!1,needView:!1,needComponent:!0,useScroll:"main,.bui-tab-main>ul>li,.bui-dialog-main,.bui-scroll,.bui-scroll-x",beforeBack:null,beforeLoad:null,loaded:null,store:null,width:0,height:0,async:!0,effect:"push",hashPrefix:"#",scriptSuffix:".js",pageSuffix:".html"},e.config.router,n),l=null,c=this,s=null,u=null,d=null,f="",p="",h=!0,g=!0,m=!1,v=!1,y={none:{inRight:"showIn",inLeft:"showIn"},fadein:{inRight:"fadeIn",inLeft:"fadeIn"},fadeinslide:{inRight:"fadeInRight",inLeft:"fadeInLeft"},slide:{inRight:"slideInRight",inLeft:"slideInLeft"},push:{inRight:"pushInRight",inLeft:"pushInLeft"},zoom:{inRight:"zoomIn",inLeft:"zoomIn"},cover:{inRight:"coverInRight",inLeft:"coverInLeft"},zoomslide:{inRight:"zoomSlideInRight",inLeft:"zoomSlideInLeft"},fadeinslideback:{inRight:"fadeInLeft",inLeft:"fadeInRight"},slideback:{inRight:"slideInLeft",inLeft:"slideInRight"},pushback:{inRight:"pushInLeft",inLeft:"pushInRight"},coverback:{inRight:"coverInLeft",inLeft:"coverInRight"},zoomslideback:{inRight:"zoomSlideInLeft",inLeft:"zoomSlideInRight"}},b={},w={},x={},k={},O=!1,L={},I={},j=loader.map(o.indexModule),P=e.history.epmty(),T=j.modules,S=e.storage({local:!1});function E(e){var t=window.location.hash||window.location.search,n=window.location.search,i=n&&n.indexOf("?"),r=(e=0!=e,t&&t.indexOf("?")),a=r>-1?t&&t.substr(1,r-1):window.location.hash.substr(1),l=a&&a.indexOf(o.pageSuffix),c=l>-1?a.substr(0,l):a,s=l>-1?a:a+o.pageSuffix,u={};function d(t,n){for(var i=t&&t.substr(n+1),r=i&&i.split("&"),a=0;a<r.length;a++){var o=e?decodeURIComponent(r[a].split("=")[1]):r[a].split("=")[1];u[r[a].split("=")[0]]=o}}return r>-1&&(d(n,i),d(t,r)),{pid:c,url:s,param:u}}function N(n){var i={id:"",url:"",param:{},effect:"",command:"html",path:o.path,repairPath:o.repairPath,firstAnimate:o.firstAnimate,progress:o.progress,reload:o.reload,autoInit:o.autoInit,needView:o.needView,needComponent:o.needComponent,replace:!1,iframe:!1,decode:!1,part:!1,cache:o.cache,callback:null,beforeLoad:o.beforeLoad,loaded:o.loaded},c=t.extend(!0,{},i,n),f=t.Deferred(),g=w.getLast()||null;P[P.length-2];c.url.indexOf("./")>-1&&(c.url=function(e,t){var n=e,i=t.url.lastIndexOf("/"),r=t.url.substr(0,i);e.indexOf("../")>-1?(e=e.replace(/\..\//g,(function(e){var t=r.lastIndexOf("/");return r=r.substr(0,t),""})),n=r?r+"/"+e:e):e.indexOf("./")>-1&&(n=r+"/"+e.replace(/\.\//g,""));return n}(c.url,g)),c.repairPath&&0===c.url.indexOf("/")&&(c.url=c.url.substr(1)),c.path&&(c.path="/"==c.path[c.path.length-1]?c.path:c.path+"/"),c.url=c.url in T||c.iframe||c.url.indexOf("http:")>-1?c.url:c.path+c.url,document.activeElement.blur();var v,y={};c.id=(c.id&&c.id.indexOf("#")>-1?c.id.substr(1):c.id)||"";var k=c.replace||c.part?g.id:c.id||e.guid(),j=e.objId(k);if(!c.url)return e.showLog("url 不能为空","bui.router.load"),f.promise();if(c.url=c.decode?decodeURIComponent(c.url):c.url,c.url.indexOf("tel:")>=0||c.url.indexOf("mailto:")>=0||c.url.indexOf("sms:")>=0)return e.unit.openExtral(c.url),f.promise();if(c.url&&c.url.indexOf("?")>-1){var S=c.url.split("?");y=e.unit.keyStringToObject(S[1]),c.url=S[0]}v=t.extend(!0,{},y,c.param),"undefined"==c.url&&(c.url="main"),c.iframe=Boolean(c.iframe);var E=$(c.url),C=E.pid,R=c.iframe?c.url:E.url,M={id:k,pid:C,name:C,url:"function"==typeof R?c.url:R,replace:c.replace,param:v,component:{},page:{},toggle:null,exports:{},effect:n.effect||o.effect,syncHistory:o.syncHistory};c.part?g:M,a&&a.show(),c.progress&&r&&r.show(),loader.map({moduleName:C,id:k});loader.get(M.pid);if(P.length&&c.effect){var z=P.length-1;P[z].effect=c.effect}!m&&!c.part&&!c.replace&&w.add(M),c.replace&&w.replace(M);var q=M,_="function"==typeof c.beforeLoad?c.beforeLoad.call(B,{prevTarget:g,target:M}):c.beforeLoad;if(H.call(B,"loadbefore",{prevTarget:g,target:M}),H.call(B,"beforeload",{prevTarget:g,target:M}),!1===_)return h=!1,this;if(c.part&&(e.history.setComponent({id:k,pid:C,url:R,param:v}),q.currentComponent=k,P.splice(P.length-1,1,q)),c.part||M,x[C])!function(e){Y(L.get(e.pid,"template")),e.part||(K(),!m&&X((function(){e.progress&&r&&r.hide()}))),Z(e)}({pid:C,progress:c.progress,part:c.part}),H.call(B,"complete",{prevTarget:g,target:M}),c.loaded&&c.loaded({prevTarget:g,target:M}),c.callback&&c.callback({prevTarget:g,target:M}),o.needComponent&&loader.components();else{if(c.iframe)return function(t){var n=function(t){var n=t.param?e.setUrlParams(t.url,t.param):t.url,i="",r=e.platform.isIos()?'scrolling="no"':"";return i+='<div id="'+t.id+'" class="bui-router-item bui-router-fixiframe" data-page="'+t.pid+'">',i+='<iframe class="bui-router-iframe" src="'+n+'" '+r+"></iframe>",i+="</div>"}({id:t.id,pid:t.pid,url:t.url,param:t.param});s&&s.attr("data-main",t.id).append(n),X((function(){c.progress&&r&&r.hide()}))}({id:k,pid:C,url:c.url,param:v}),f.promise();if(c.part)return A(R,(function(t,n,i){e.objId(k)[c.command](t),J(Q),c.cache&&L.add(C,{id:k,pid:C,template:t}),a&&a.hide(),c.progress&&r&&r.hide()}),(function(e,t,n){W(R,e),H.call(B,"loadfail",e,t,n)})),f.promise();A(R,(function(e,t,n){if("object"==typeof e)return W(R,e),!1;Y(e),c.cache&&L.add(C,{id:k,pid:C,template:e}),K(),c.firstAnimate?X((function(){J(Q),c.progress&&r&&r.hide(),I.add(C,{id:k,pid:C,param:v})})):(X((function(){c.progress&&r&&r.hide()})),J(Q),I.add(C,{id:k,pid:C,param:v}))}),(function(e,t,n){W(R,e),H.call(B,"loadfail",e,t,n)}))}function W(t,n,i,l){if(a&&a.hide(),c.progress&&r&&r.hide(),w.removeLast(),f.reject(t),"object"==typeof n)return e.showLog("找不到页面"+t,"bui.router.load"),o.errorPage&&function(e){!function(e){var t,n=window.location.href,i=(t=(t=n.indexOf(o.hashPrefix))>-1?t:0)>-1?n.substr(0,t):n;N({url:o.errorPage||i,param:{error:e}}),H.call(B,"error",{target:e,status:404})}(e)}(t),!1}function J(t){m||b[C]?(q.exports=b[C],Z({pid:C}),O&&X(),t&&t(),o.needComponent&&loader.components()):(loader.checkLoad(C)?(Z({pid:C}),o.needComponent&&loader.components(),t&&t()):loader.require(C,(function(n){try{if(c.firstAnimate&&c.progress&&r&&r.hide(),b[C]=n||null,M.exports=n,f.resolve(n),h||c.firstAnimate||c.replace){var i=loader.get(C);i&&i.show&&i.show({type:"firstload",target:M})}t&&t(),c.loaded&&c.loaded({prevTarget:g,target:M}),c.callback&&c.callback({prevTarget:g,target:M}),o.needComponent&&loader.components()}catch(t){e.showLog(t,"bui.router.load"),f.reject()}})),H.call(B,"complete",{prevTarget:g,target:M}))}function K(){var t=(l=e.objId(q.id))&&l.find(".bui-page");t&&t.length&&c.autoInit&&e.init({id:t,height:p})}function X(t){l=e.objId(k),F(),D();try{if(h||m||c.replace||c.part){!c.firstAnimate&&c.progress&&r&&r.hide(),t&&t(),a&&a.hide(),l&&l.css("zIndex",5);var n="pageshow-"+w.getLast().pid;H.call(B,"pageshow",{type:"load",target:w.getLast()}),H.call(B,n,{type:"load",target:w.getLast()})}else u&&u.hide(),d&&d.show((function(){!c.firstAnimate&&c.progress&&r&&r.hide(),t&&t(),l&&l.css("zIndex",5),a&&a.hide();var e=P[P.length-2]||{},n=w.getLast(),i=loader.get(n.pid),o=e&&e.pid&&loader.get(e.pid)||null,s="pageshow-"+n.pid,u="pagehide-"+e.pid;H.call(B,u,{type:"load",target:P[P.length-2]}),H.call(B,s,{type:"load",target:w.getLast()}),H.call(B,"pagehide",{type:"load",target:P[P.length-2]}),H.call(B,"pageshow",{type:"load",target:w.getLast()}),o&&o.hide&&o.hide({type:"load",target:P[P.length-2]}),i&&i.show&&i.show({type:"load",target:w.getLast()})}))}catch(t){e.showLog(t,"bui.router.doAnimate")}}function Y(t){var n="";if(B.store&&(t=B.store.compileHtml(t)),c.part)n=V({content:t}),c.id?j.html(n):e.showLog("id 不能为空","router.loadPart");else if(c.replace){var i=w.getLast();j=P.length?e.objId(i.id):s,i.pid=C,i.url=R,i.param=v;e.array.index(P,C,"pid");n=C in x?L.get(C,"template"):V({content:t}),j.html(n).attr("data-page",C)}else m||(n=U({id:k,content:t,pid:C}),s&&s.attr("data-main",k).append(n));return o.needView&&loader.views({compiled:function(){B.store&&!B.store.config.isPublic&&B.store.config.needCompile&&B.store.compile("#"+k)}}),!B.store||o.needView||B.store.config.isPublic||B.store.config.needCompile&&B.store.compile("#"+k),n}function Z(e){var t=w.getLast(),n=T[e.pid]&&T[e.pid]||{},i=n.loaded,l=i&&i.apply(n,n.dependExports)||n.exports;b[e.pid]=l||null,n.exports=l,t.exports=l,m&&H.call(B,"refresh",{prevTarget:g,target:t}),a&&a.hide(),o.progress&&r&&r.hide(),f.resolve(l),m=!1,h=!1}function Q(){var e=P[P.length-2]||null,t=w.getLast();h&&!c.part&&(H.call(B,"firstload",{prevTarget:e,target:t}),h=!1),c.part?H.call(B,"loadpart",{prevTarget:e,target:t}):H.call(B,"load",{prevTarget:e,target:t})}return f.promise()}function $(e){var t="",n=e;j=loader.map(),T=j.modules;var i=n.indexOf(o.pageSuffix);return i>-1?(n=(t=n).substr(0,i),T.hasOwnProperty(n)&&(t=T[n]&&T[n].template||t||"")):t=T[n=n]&&T[n].template||n+o.pageSuffix||"",{pid:n,url:t}}function C(n){var i=this,r={};"function"==typeof n?r.callback=n:r=n||{};var a=t.extend(!0,{index:-1,name:"",beforeBack:o.beforeBack,callback:null,loaded:o.loaded},r),l=parseInt(a.index),c=P.length;if(j=loader.map(),T=j.modules,!(l>0)){var f=w.getLast(),p=c-1,h=f.toggle;if(h)return h.hide(),void F();var m="function"==typeof a.beforeBack?a.beforeBack.call(B,{prevTarget:null,target:f}):r.beforeBack;H.call(B,"beforeback",{prevTarget:null,target:f});var v=loader.get(f.pid);return v&&v.beforeDestroy&&v.beforeDestroy(),!1===m?this:(a.name&&(l=R(a.name)),Math.abs(l)>p&&(l=-p),c>1&&g&&(l<-1&&D(l),g=!1,r.effect&&(u.option({effect:r.effect}),d.option({effect:r.effect})),u&&u.show(),d&&d.hide((function(){var n=c+l;!function(e){s.children().each((function(n,i){n>=e&&t(i).remove()}))}(n),w.removeNext(n),D();var r=F(),o=r.pid;e.objId(r.id).css("zIndex",5),function(){var e;e=b[o]||{};var t=loader.get(r.pid);a.callback&&a.callback.call(i,e,r),a.backed&&a.backed.call(B,{prevTarget:f,target:r}),H.call(B,"back",{prevTarget:f,target:r}),r;var n="pageshow-"+r.pid,l="pagehide-"+f.pid;v&&v.hide&&v.hide({type:"back",target:f}),t&&t.show&&t.show({type:"back",target:r}),H.call(B,l,{type:"back",target:f}),H.call(B,n,{type:"back",target:r}),H.call(B,"pageshow",{type:"back",target:r}),H.call(B,"pagehide",{type:"back",target:f}),v&&v.destroyed&&v.destroyed(),g=!0}()}))),this)}e.showLog("index 参数只能是负数","bui.router.back")}function R(t){var n,i=e.array.indexs(P,t,"pid"),r=i.length;if(r){var a=-(P.length-i[r-1]-1);n=0==a?-1:a}else n=-1;return n}function A(t,n,i){if("string"==typeof t){loader.importHtml(t,(function(e,t,i){e=function(e){var t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,n=/<body[^>]*>([\s\S]*)<\/body>/.exec(e);if(n&&2===n.length)return n[1].replace(t,"");return e}(e),n&&n(e,t,i),H.call(B,"success",e,t,i)}),(function(e,t,n){i&&i(e,t,n),H.call(B,"fail",e,t,n)}))}else if("function"==typeof t){var r=t&&t();n&&n(r,200,{}),H.call(B,"success",r,200,{})}else e.showLog("url 不能为空","bui.router.requestUrl")}function F(){var t=w.getLast(),n=t.id||"",i=t.effect||o.effect;return n&&(H.call(B,"beforepageshow",{target:t}),d=null,d=e.toggle({id:document.getElementById(n),effect:y[i]&&y[i].inRight||""}),s&&s.attr("data-main",n)),t}function D(t){t=t||-1;var n=P.length+t-1,i=P[n],r=i&&i.id||"",a=i&&i.effect||o.effect;return r&&(H.call(B,"beforepagehide",{target:i}),u=null,u=e.toggle({id:document.getElementById(r),effect:y[a]&&y[a].inLeft||""})),i}function U(e){var t="";return t+='<div id="'+e.id+'" class="bui-router-item" data-page="'+e.pid+'">',t+=e.content||"",t+="</div>"}function V(e){var t="";return t+=e.content}function M(t,n){return e.on.apply(B,arguments),this}function H(t){B.self=this==window||this==B?null:this,e.trigger.apply(B,arguments)}e.hasRouter=!0,w.get=function(){return P},w.add=function(n){if((n=n||{}).toggle){var i=t.extend(!0,{},n);n.toggle=null,P.push(i)}else P.push(n);var r=window.location.origin+window.location.pathname+"#"+n.pid,a=e.setUrlParams(r,n.param);if(!h)return o.syncHistory&&"pushState"in window.history&&window.history.pushState(n,null,a),P;o.syncHistory&&"replaceState"in window.history&&window.history.replaceState(n,null,a)},w.prepend=function(t){t=t||{};var n=window.location.origin+window.location.pathname+"#"+t.pid;e.setUrlParams(n,t.param);return P.unshift(t),P},w.replace=function(t){t=t||{};var n=P.length-1,i=window.location.origin+window.location.pathname+"#"+t.pid,r=e.setUrlParams(i,t.param);return n>-1&&(P.splice(n,1,t),o.syncHistory&&"replaceState"in window.history&&window.history.replaceState(t,null,r)),P},w.getLast=function(e){var t=P.length-1,n=P[t]||{};return e?n[e]:n},w.removeNext=function(t){var n=P.length-t;P.splice(t,n);var i=w.getLast(),r=window.location.origin+window.location.pathname+"#"+i.pid,a=e.setUrlParams(r,i.param);o.syncHistory&&"replaceState"in window.history&&window.history.replaceState(i.param,null,a)},w.removeLast=function(){var e=P.length-1;w.removeNext(e)},w.checkLoad=function(t){return e.array.compare(P,t,"pid")||e.array.compare(P,t,"url")||e.array.compare(P,t,"id")},L.add=function(e,t){return x[e]=t||{},x[e]},L.del=function(e){delete x[e]},L.get=function(e,t){return t?(x[e]||{})[t]:x[e]},L.save=function(){if(P.length>1){var e=i.html();S.set("cacheHtml",e),S.set("cacheHistory",P),S.set("hasCache","true")}},L.load=function(){var t=S.get("cacheHtml",0),n=S.get("cacheHistory",0),r=[];if(n.length>1){i.html(t),s=i.children(".bui-router-main"),C({name:E().pid});try{n.forEach((function(e,t){var n="string"==typeof e?JSON.parse(e):e;r.push(n)}));var a=r[r.length-1];a,loader.require(a.pid,(function(e){b[a.pid]=e||null})),M("back",(function(e){loader.require(e.target.pid,(function(t){b[e.target.pid]=t||null}))}))}catch(t){e.showLog(t)}P=r,F(),D(),h=!1,O=!0,L.clear()}},L.clear=function(){S.remove("cacheHistory"),S.remove("cacheHtml"),S.remove("hasCache")},I.add=function(e,t){return k[e]=t||{},k[e]},I.get=function(e,t){return t?(k[e]||{})[t]:k[e]};var B={init:function(n){if(B.store=n.store||null,delete n.store,n=t.extend(!0,{},o,e.config.router,n),o=B.config=n,"pages/main/main.html"===n.indexModule.template&&"pages/main/main.js"===n.indexModule.script||(j=loader.map(n.indexModule)),v&&"effect"in n&&P.forEach((function(e,t){e.effect=n.effect})),!n.id)return e.showLog("id 不能为空","bui.router.init"),!1;if(i=e.objId(n.id),a=bui.mask({appendTo:i,opacity:0,autoClose:!1}),r=e.loading({display:"block",width:30,height:30,opacity:0}),s=i.children(".bui-router-main"),f=n.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",p=n.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",!s.length){var l=function(e){var t="";String(f).indexOf("%"),String(p).indexOf("%");return t+='<div class="bui-router-main">',t+="</div>"}();i.html(l),s=i.children(".bui-router-main")}return(n.width>0||String(n.width).indexOf("%")>-1)&&s.width(n.width),(n.height>0||String(n.height).indexOf("%")>-1)&&s.height(n.height),function(n){if(function(){var t=S.get("hasCache",0);Boolean(t)&&o.reloadCache?L.load():function(t){try{var n=E();if(n.pid){if(n.pid.indexOf("http://")>-1||n.pid.indexOf("https://")>-1)return void N({url:n.pid,param:n.param,iframe:!0});N({url:n.pid,param:n.param})}else N({url:o.indexModule.moduleName,param:n.param||{}})}catch(t){e.showLog(t,"bui.router.loadUrl")}}()}(),n.swipe&&function(n){var r=/hp-tablet/gi.test(navigator.appVersion),a="ontouchstart"in window&&!r,l=0,c=0,s=!1,u=null,d=null,f={x1:0,x2:0,y1:0,y2:0,direction:""};i.on("touchstart",(function(i){var r=i.originalEvent&&i.originalEvent.targetTouches||i.targetTouches,l=a?r[0]:i;f.x1=l.pageX,f.y1=l.pageY,s=t(i.target).closest(o.useScroll).length,P.length>1&&f.x1>0&&f.x1<n.distance&&(u=t("#"+w.getLast().id),d=e.history.getPrev().id?t("#"+e.history.getPrev().id):null)})),i.on("touchmove",(function(i){var r=i.originalEvent&&i.originalEvent.targetTouches||i.targetTouches,p=a?r[0]:i;f.x2=p.pageX,f.y2=p.pageY,r.length>1||i.scale&&1!==i.scale||(s=t(i.target).closest(o.useScroll).length,f.x2-f.x1>0&&!s&&i.preventDefault(),f.direction||(f.direction=e.swipeDirection(f.x1,f.x2,f.y1,f.y2)),"swipeleft"!==f.direction&&"swiperight"!==f.direction||(i.preventDefault(),i.stopPropagation()),l=Math.abs(f.x2-f.x1),c=Math.abs(f.y2-f.y1),"swiperight"===f.direction&&l>n.startDistance&&n.swipeBack&&(d&&d.css("display","block"),n.pageMove&&u&&u.css("transform",`translateX(${l}px)`),i.preventDefault()))})),i.on("touchend",(function(e){(s=t(e.target).closest(o.useScroll).length,"swiperight"===f.direction&&f.x1>n.distance&&n.swipeBack&&(l=0),"swiperight"===f.direction&&l>n.swipeDistance)&&(!1!==(n.onBeforeSwipeRight&&n.onBeforeSwipeRight())&&n.swipeBack&&bui.back(),n.onSwipeRight&&n.onSwipeRight(e),H.call(B,"swiperight"));"swipeleft"===f.direction&&l>n.swipeDistance&&(n.onSwipeLeft&&n.onSwipeLeft(e),H.call(B,"swipeleft")),"swipeup"===f.direction&&c>n.swipeDistance&&!s&&(n.onSwipeUp&&n.onSwipeUp(e),H.call(B,"swipeup")),"swipedown"===f.direction&&c>n.swipeDistance&&!s&&(n.onSwipeDown&&n.onSwipeDown(e),H.call(B,"swipedown")),l<n.swipeDistance&&(d&&d.css("display","none"),u&&u.css("transform","translateX(0)")),l=0,s=!1,f={x1:0,x2:0,y1:0,y2:0,direction:""},u=null,d=null,e.stopPropagation()}))}(n),window.addEventListener("beforeunload",(function(e){o.reloadCache&&L.save(),H.call(c,"beforeunload",{target:P[P.length-1]})})),n.hash)return window.addEventListener("hashchange",(function(t){var n=E(),i=""==n.pid||"undefined"==n.pid?"main":n.pid,r=e.array.indexs(P,i,"pid"),a=r[r.length-1];a>-1?(C({index:-(P.length-a-1||1)}),H.call(c,"popstate",{type:"back",prevTarget:P[a-1],target:P[a]})):(N({url:i,param:n.param,replace:!0}),H.call(c,"popstate",{type:"load",prevTarget:P[P.length-2],target:P[P.length-1]}))})),this;o.syncHistory&&"pushState"in window.history&&window.addEventListener("popstate",(function(t){var n=E(),i=""==n.pid?o.indexModule.moduleName:n.pid,r=R(i);e.array.index(P,i,"pid")>-1?(C({index:r,param:n.param}),H.call(c,"popstate",{type:"back",prevTarget:P[r-1],target:P[r]})):(N({url:i,param:n.param}),H.call(c,"popstate",{type:"load",prevTarget:P[P.length-2],target:P[P.length-1]}))}))}(n),H.call(this,"init",{target:i[0]}),B},option:function(t,n){return v=!0,e.option.call(B,t,n)},config:o,data:{},on:M,off:function(t,n){return e.off.apply(B,arguments),this},trigger:H,load:N,resize:function(e){return(e=e||{}).width=e.width||o.width,e.height=e.height||o.height,window.viewport=bui.viewport(),f=e.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",p=e.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",s.css({width:f,height:p}),H.call(this,"resize",{target:P[P.length-1]}),this},destroy:function(t){return"string"==typeof t&&"main"!==t?(loader.destroy(t),L.del(t),t in b&&delete b[t]):e.showLog("参数只能是字符串"),this},loadPart:function(e){var n=t.Deferred(),i=t.extend(!0,{},{id:"",url:"",param:{},loaded:null},e);return i.loaded=function(t){e.loaded&&e.loaded.call(B,t),n.resolve(t),H.call(B,"loadpart",t)},loader.load(i),n.promise()},replace:function(e){return N({url:(e=e||{}).url||"",param:e.param||{},replace:!0}),this},refresh:function(){var t=P.length-1,n=P[t],i=P.length>1?P[P.length-2]:null;return e.history.refresh(),H.call(B,"refresh",{prevTarget:i,target:n}),this},back:C,isLoad:function(e){var t;return e&&(t=e in b),t},$:function(t){var n=w.getLast(),i=document.getElementById(n.id)||document;return e.obj(t,i)},currentId:function(e){return w.getLast().id},currentPage:function(){var e=w.getLast();return document.getElementById(e.id)},currentModule:function(){return w.getLast()},getPageParams:function(){return w.getLast().param},getPartParams:function(t){return e.history.getComponentParam(t)},getHistory:w.get,preload:function(n){var i=t.Deferred(),r=function(t,r){return A(t.url,(function(i){var a=e.guid(),o=$(t.url).pid,l=(U({id:a,content:i,pid:o}),[]);L.add(o,{id:a,pid:o,template:i}),l.push(o),t.style&&"array"===e.typeof(t.style)?t.style.forEach((function(e,t){l.push(e)})):t.style&&"string"===e.typeof(t.style)&&l.push(t.style),t.script&&"array"===e.typeof(t.script)?t.script.forEach((function(e,t){l.push(e)})):t.script&&"string"===e.typeof(t.script)&&l.push(t.script),loader.import(l,(function(){H.call(B,"preloadafter",{prevTarget:null,target:null}),r&&r(n)}),(function(){H.call(B,"preloadafter",{prevTarget:null,target:null}),r&&r(n)}))}),(function(n){e.showLog(t.url+"请求失败"),i.reject(t.url)})),i.promise()};return n&&"object"===e.typeof(n)?"url"in n&&r(n,(function(){i.resolve(n)})):n&&"array"===e.typeof(n)&&n.forEach((function(e,t){t==n.length-1?"url"in e&&r(e,(function(){i.resolve(n)})):"url"in e&&r(e)})),i},initScroll:function(n){var i=w.getLast(),r=e.objId(i.id),a="object"==typeof n?t(n):r.find(".bui-page");return a.length&&e.init({id:a,height:p}),this},history:{get:w.get,check:w.checkLoad,getLast:w.getLast,add:w.add,removeLast:w.removeLast,replace:w.replace}};return B}}(window.bui||{},window.libs),function(e,t){class n{constructor(n){this._default={log:!1,hasLife:!0,onBeforeInit:null,onInited:null},this._plugin=n||{name:"",depend:null,config:null,param:null,callback:null};let i=e.config.hasOwnProperty(this._plugin.name)?e.config[this._plugin.name]:null;this.config=t.extend(!0,{},this._default,i,this._plugin.config,this._plugin.param),this.initStatus=!1,this.reinitStatus=!1,this.widgets=Object.create(null),this.init()}widget(e){return e&&e in this.widgets?this.widgets[e]:this.widgets}init(e){let n=this,i=e||null;n.config=t.extend(!0,this.config,i);let r=n.config,a=r.hasLife&&r.onBeforeInit&&r.onBeforeInit.call(n,r);return r.log&&console.log(n._plugin.name+" before init"),!1===a||(n._plugin.callback&&n._plugin.callback.call(n,r),r.log&&console.log(n._plugin.name+" init"),r.hasLife&&r.onInited&&r.onInited.call(n,r),r.log&&console.log(n._plugin.name+" after inited"),this.initStatus=!0),n}reinit(){return this.destroy(),this.init(),this.config.log&&console.log(this._plugin.name+" reinit"),this}destroy(e){return this.beforeDestroy&&this.beforeDestroy(),this.beforeDestroy=null,this.widgets={},this.off(),this.initStatus=!1,e&&e.call(this),this.config.log&&console.log(this._plugin.name+" destroyed"),this}prefix(t){return e.config.classNamePrefix+t}showLog(t,n){n=n||"";let i="";return"object"==typeof t&&"message"in t&&"name"in t?i=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(i=t),e.log&&console.error(n+" "+i),e.trace&&console.trace&&console.trace(),this}option(n,i){if("object"!==e.typeof(n)&&void 0===i)return"string"==typeof n?this.config[n]:this.config;{let r=this;if("id"==n)return e.showLog("不允许修改控件的ID参数"),this;if(n&&"object"===e.typeof(n)){let e=t.extend(this.config,n);return r&&r.init(e)}if(this.config.hasOwnProperty(n)){let e={};e[n]=i;let a=t.extend(this.config,e);return r&&r.init(a)}}return this}get emitter(){return e.emitter()}get on(){return this.emitter.on}get off(){return this.emitter.off}get trigger(){return this.emitter.trigger}}e.extend=function(t){new class{constructor(e){this.init(e)}init(i){let r=i.name;return this.checkName(r)?(e[r]=function(e){return t.param=e,new n(t)},this):this}checkName(t){return t?e.hasOwnProperty(t)?(console.warn(`已有相同名为${t}的插件或方法,请重新换个名称注册.`),!1):(this.name=t,!0):(console.warn("插件名字不能为空"),!1)}}(t)}}(window.bui||{},window.libs);var t,n;(function(e){!function(t,n){t.extend({name:"page",config:{dialogid:"",url:"",param:null,script:"",appendTo:"",className:"bui-dialog-page",effect:"",pageSuffix:".html",height:0,width:0,iframe:!1,openFirst:!0,closeFirst:!1,autoClose:!1,needRemove:!1,useBox:!0,syncHistory:!1,title:"",buttons:null,mask:!1,life:!0,scroll:!1,needView:!1,needComponent:!0,cache:!0,close:!1,autoload:!0,fullscreen:!0,effect:"fadeInRight",onError:null,beforeClose:null,closed:null,beforeOpen:null,opened:null,beforeLoad:null,loaded:null},callback:function(i){var r=this,a=r.config,o="body"==r.appendTo?n:t.obj,l="",c=!1,s=(loader.map().modules,r.widgets.dialog=t.dialog({autoinit:!1,needRemove:i.needRemove})),u=null,d=!1;function f(e,t){var n="";return n+=`<div class="bui-dialog-main">${e}</div>${t.close?'<div class="bui-dialog-close"><i class="icon-close"></i></div>':""}`}function p(e){var n=loader.map().modules[u.module]||{};if(n.hide&&a.life){var i=t.hasRouter?t.history.getLast():{};n.hide({type:"page",target:i})}"function"==typeof e&&e.call(r,n),a.closed&&a.closed.call(r,n)}function h(n,i){var o=t.history.getLast(),l=(loader.map().modules||{})[n];if(a.cache&&c&&!d)return!a.openFirst&&s.open(),"function"==typeof i&&i.call(r,l.exports),r;if(t.history.setPage({id:s.config.id,name:n,url:a.url,dialog:s,param:a.param}),d=!1,l&&"function"==typeof l.loaded){var u=l.loaded&&l.loaded.call(e,l.exports)||l.exports;t.history.setPage({id:s.config.id,name:n,url:a.url,dialog:s,exports:u,param:a.param});var f=loader.map().modules[n]||{};return f.show&&a.life&&f.show({type:"page",target:o}),"function"==typeof i&&i.call(r,u),r.compile({id:s.config.id}),a.opened&&a.opened.call(r,u),!a.openFirst&&s.open(),this}loader.require(n,(function(e){var l=loader.map().modules[n]||{};t.history.setPage({id:s.config.id,name:n,url:a.url,dialog:s,exports:e,param:a.param}),l.show&&a.life&&l.show({type:"page",target:o}),"function"==typeof i&&i.call(r,e),r.compile({id:s.config.id}),a.opened&&a.opened.call(r,e)})),c=!0}function g(e){var t=loader.map().modules,n={},i=e.indexOf(a.pageSuffix);return i>-1?(n.url=e,n.module=e.substr(0,i)):(n.url=t[e]&&t[e].template||e+a.pageSuffix,n.module=e),n}r.init=function(e){var i=n.extend(!0,{},r.config,e);if(i.onClose=function(){t.hasRouter&&i.syncHistory&&bui.back(),p()},u=g(i.url),i.iframe){var a=t.platform.isIos()?'scrolling="no"':"";return i.content=`<iframe class="bui-router-iframe" src="${i.url}" ${a} ></iframe>`,s.create(i),i.autoload&&s.open(),i.loaded&&i.loaded.call(r,u),r}if(i.script){var c=i.script.indexOf(".js");u.module=i.script.substr(0,c)}return!1===(i.beforeLoad&&i.beforeLoad.call(r,u))?this:(loader.import(u.url,(function(e){"object"!=typeof e?(l=f(e,i),i.id?(s.init(i),o(i.id).html(e)):(i.content=e,s=s.create(i)),i.autoload&&r.open(),i.loaded&&i.loaded.call(r,u)):i.onError&&i.onError.call(r,e)})),r)},r.compile=function(e){var t=n.extend(!0,{id:s.config.id,cacheHtml:!1,cache:!1,needComponent:a.needComponent,needView:a.needView},e);t.needView&&loader.views(t),t.needComponent&&loader.components(t)},r.reload=function(e){var t=a=n.extend(!0,r.config,a,e);if(d=!0,u=g(t.url),t.script){var i=t.script.indexOf(".js");u.module=t.script.substr(0,i)}if(!1===(t.beforeLoad&&t.beforeLoad.call(r,u)))return this;loader.import(u.url,(function(e){"object"!=typeof e?(l=f(e,t),o("#"+(s.config.id||t.dialogid)).html(l),h(u.module),t.loaded&&t.loaded.call(r,u)):t.onError&&t.onError.call(r,e)}))},r.toggle=function(e,t){return r.isOpen()?r.close(t):r.open(e),r},r.isOpen=s.isOpen,r.close=function(e){return!1===(i.beforeClose&&a.beforeClose.call(r))?this:(t.hasRouter&&a.syncHistory&&t.history.removeLast(a.syncHistory),a.closeFirst?(s.close((function(){r.trigger("close"),p(e)})),r):(p(e),s.close(),r.trigger("close"),r))},r.remove=function(e){return s.remove(e),r.trigger("remove"),r},r.open=function(e){if(!1===(a.beforeOpen&&a.beforeOpen.call(r)))return this;if(a.iframe)return s.open(e),r;var n={hide:r.close,show:r.open};return t.hasRouter&&a.syncHistory&&t.history.add({id:s.config.id,name:u.module,url:a.url,replace:!1,param:a.param||{},part:{},page:{},effect:"push",toggle:n,syncHistory:a.syncHistory}),loader.map({moduleName:u.module,id:s.config.id}),t.history.getLast().currentPage=s.config.id,a.openFirst?(s.open((function(){r.trigger("open"),h(u.module,e)})),r):(h(u.module,e),s.open(),r.trigger("open"),r)},r.setParam=function(e){var i=n.extend(!0,{},a.param,e);t.history.setPage({id:s.config.id,param:i})},r.init(a)}})}(window.bui||{},window.libs)})(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports;!function(e,t){e.setUrlParams=function(t,n,i){i=0!=i,n="object"==typeof n?n:{};var r=e.unit.objectToKeyString(n,i);return""==r?t:t+"?"+r},e.getUrlParams=function(t){t=0!=t;var n=window.location.href,i=n.indexOf("?"),r={};if(i>-1){var a=n.substr(i+1);r=e.unit.keyStringToObject(a,t)}return r},e.getUrlParam=function(e){var t=window.location.href,n=new RegExp("(^|&|.)"+e+"=([^&]*)(&|$)","i"),i=t.substr(1).match(n);return null!=i?decodeURIComponent(i[2]):null},e.typeof=function(e){var t=Object.prototype.toString.call(e).slice(8,-1);return t=t.toLowerCase()},e.setting=function(t,n){return"string"==typeof t&&"object"==typeof n?e.config[t]=n:"string"==typeof t&&void 0===n?e.config[t]:e.config}}(window.bui||{}),function(e,t){e.array={},e.array.index=e.inArray=function(e,t,n){var i,r;e instanceof Array?(i=e||[],r=t):(i=t||[],r=e);for(var a=0;a<i.length;a++){var o=i[a];if((o&&o[n]||o)===r)return parseInt(a)}return-1},e.array.compare=e.compareArray=function(e,t,n){var i,r;e instanceof Array?(i=e||[],r=t):(i=t||[],r=e);for(var a=0;a<i.length;a++){var o=i[a];if((o&&o[n]||o)===r)return!0}return!1},e.array.remove=e.removeArray=function(t,n,i){var r,a;return t instanceof Array?(r=t||[],a=n):(r=n||[],a=t||[]),e.array.delete(r,a,i),r},e.array.filter=e.filterArray=function(t,n,i){var r,a;t instanceof Array?(r=t||[],a=n):(r=n||[],a=t);var o=[];for(var l in r)try{var c=r[l]&&r[l][i]||r[l];new RegExp(a).test(c)&&o.push(r[l])}catch(t){e.showLog(t)}return o},e.array.indexs=e.indexArray=function(e,t,n){var i,r;e instanceof Array?(i=e||[],r=t):(i=t||[],r=e);var a=[];for(var o in i){(i[o]&&i[o][n]||i[o])===r&&a.push(+o)}return a},e.array.excess=e.excessArray=function(e,t,n){var i;i=e instanceof Array?e||[]:t||[];var r={},a=[];for(var o in i)try{var l=i[o]&&i[o][n]||i[o];r[l]!==l&&(r[l]=l,a.push(i[o]))}catch(e){}return a},e.array.uniq=function(t,n){var i=[];for(let r=0;r<t.length;r++){let a=void 0===n,o=t[r],l=a?o:o[n]||o;e.array.index(i,l,n)<0&&i.push(o)}return i},e.array.copy=e.copyArray=function(t,n,i){var r=[];if(n=n||0,i=i||t&&t.length,!t||"array"===e.typeof(t))return t.forEach((function(e,t){r.push(e)})),r.splice(n,i)||[]},e.array.empty=function(t){if(!t||"array"===e.typeof(t))return t.splice(0,t.length)},e.array.replace=function(t,n){if(!(t&&"array"!==e.typeof(t)||n&&"array"!==e.typeof(n))){var i=[0,t.length].concat(n);return t.splice.apply(t,i)}},e.array.merge=function(t){if(!t||"array"===e.typeof(t)){var n=arguments,i=n.length-1,r=n[i],a="string"==typeof r;if(a&&n.length>1){let a=i,o=[];for(let e=0;e<a;e++){let i=Array.prototype.slice.call(n[e],0);t.forEach((function(e,t){let n=e[r]||e;i instanceof Array&&i.forEach((function(t,a){let o=t[r]||t;if(n===o){for(let n in t)e[n]=t[n];i.splice(a,1)}}))})),o.push(i)}return e.array.merge(t,...o)}var o=[t.length,0].concat(...Array.prototype.slice.call(arguments,1));return t.splice.apply(t,o),t}},e.array.get=function(t,n,i){if(!t||"array"===e.typeof(t)){for(var r,a=null,o=0;o<t.length;o++){((a=t[o])&&a[i]||a)===n&&(r=a)}return r}},e.array.getAll=function(e,t,n){e=e||[];var i=[],r=null;for(var a in e)try{var o=(r=e[a])&&r[n]||r;t&&t instanceof Array?t.forEach((function(e,t){o===e&&i.push(r)})):o===t&&i.push(r)}catch(e){}return i},e.array.set=function(t,n,i,r){if(!t||"array"===e.typeof(t)){var a=/\d/.test(n)&&"number"==typeof n;if(a&&i)return t.splice(n,1,i),t;for(let o=0;o<t.length;o++){let l=t[o],c=void 0===r?l:l[r]||l;if(a?o===n:c===n){if(r){if(i&&"object"===e.typeof(i))for(let e in i)l[e]=i[e];else l[r]=i;t.splice(o,1,l)}else t.splice(o,1,i);return t}}return t}},e.array.setAll=function(t,n,i,r){if(!t||"array"===e.typeof(t))return t.filter((function(a,o){let l=void 0===r?a:a[r]||a;if(o==n||l===n)if(r){if(i&&"object"===e.typeof(i))for(let e in i)a[e]=i[e];else a[r]=i;t.splice(o,1,a)}else t.splice(o,1,i)})),t},e.array.delete=function(t,n,i){if(!t||"array"===e.typeof(t)){var r=[],a=e.array.copy(t);return n&&"array"===e.typeof(n)?n.forEach((function(e,t){o(void 0!==i&&e[i]||e)})):o(n),r}function o(e){var n=0;for(let o=0;o<a.length;o++){let l=o-n,c=t.length!==a.length,s=c?t[l]||{}:t[o]||{};if((void 0!==i?s[i]:s)===e)return c?t.splice(l,1):t.splice(o,1),r.push(o),void++n}}},e.array.deleteIndex=function(t,n){if(!t||"array"===e.typeof(t)){var i=[];return n&&"array"===e.typeof(n)?n.forEach((function(n,r){i.push(t[n]),e.array.remove(t,t[n])})):(i.push(t[n]),e.array.remove(t,t[n])),i}}}(window.bui||{}),function(e,t){e.storage=function(t){var n=1,i=!0,r="",a=!1,o=!0;"number"==typeof t||"string"==typeof t?n=0==parseInt(t)?0:parseInt(t)||1:"object"==typeof t&&(n=t&&0==t.size?0:t.size||1,o=!t||0!=t.local,i=!t||0!=t.reverse,a=!(!t||1!=t.deep),r=t.prefix||"");var l=i?"push":"unshift",c=o?localStorage:sessionStorage;function s(t,n,i){t=r+t;var o,l=c.getItem(t)||"";try{o=a?l&&e.unit.stringToJson(l):l&&JSON.parse(l)}catch(t){o=l,e.showLog(t.name+": "+t.message,"bui.storage.get")}if("number"==typeof n&&i)o=o&&o[n]&&o[n][i]||void 0;else if("string"==typeof n){var s=e.array.index(o,n,i);o=o&&o[s]}else o="number"==typeof n?o&&o[n]||void 0:o;return o}return{get:s,getAll:function(e){for(var t={},n=parseInt(e)||0,i=0;i<localStorage.length;i++){var a=localStorage.key(i);a.substr(r.length);if(r&&0===a.indexOf(r))try{var o=JSON.parse(c.getItem(a));t[a]=void 0!==e?o[n]:o}catch(e){t[a]=c.getItem(a)}if(""===r)try{t[a]=JSON.parse(c.getItem(a))}catch(e){t[a]=c.getItem(a)}}return t},set:function(t,i,a){t=r+t;var o=1==n?null:c.getItem(t),s=[],u="",d=a?i[a]:i;if(null===o){s.push(i),u=JSON.stringify(s);try{c.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{var f=JSON.parse(o);if(e.array.compare(f,d,a)){e.array.remove(f,d,a),f[l](i);try{u=JSON.stringify(f),c.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{f[l](i),f.length>n&&0!=n&&("unshift"==l?f.pop():f.shift());try{u=JSON.stringify(f),c.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}}return this},remove:function(t,n,i){if("string"==typeof(t=r+t)){var a=s(t)||[];if("number"==typeof n){var o="number"==typeof i?i:o;a.splice(n,o);try{var l=JSON.stringify(a)||"";c.setItem(t,l)}catch(t){e.showLog(t.name+": "+t.message,"bui.storage.remove")}}else if("string"==typeof n){var u=e.array.remove(a,n,i);try{l=JSON.stringify(u)||"";c.setItem(t,l)}catch(t){e.showLog(t.name+": "+t.message,"bui.storage.remove")}}else c.removeItem(t);return this}e.showLog("要删除的字段名只能是字符串","bui.storage.remove")},clear:function(){if(r)for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);0===t.indexOf(r)&&c.removeItem(t)}else c.clear();return this}}}}(window.bui||{}),function(e,t){var n;e.platform=(n=navigator.userAgent,{isAndroid:function(e){return/(Android|Linux)/i.test(n)},isIphone:function(e){return/(iPhone)/i.test(n)},isIpad:function(e){return/(iPad)/i.test(n)},isIos:function(e){return/(iPhone|iPad|iOS)/i.test(n)},isWeiXin:function(e){return/(micromessenger)/i.test(n)},isBingotouch:function(e){return/(crosswalk)/i.test(n)},isMac:function(){return/Macintosh/i.test(n)},isIphoneX:function(e){var t=!1,n=3==window.devicePixelRatio&&375==window.screen.width&&812==window.screen.height,i=2==window.devicePixelRatio&&414==window.screen.width&&896==window.screen.height,r=3==window.devicePixelRatio&&414==window.screen.width&&896==window.screen.height;return(n||i||r)&&(t=!0),t},isWindow:function(e){return/Windows NT/i.test(n)}})}(window.bui||{}),function(e,t){e.date={},e.date.format=function(e,t){if(null==e)return"";var n=this.convert(e);t=t||"yyyy-MM-dd";var i={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[r]:("00"+i[r]).substr((""+i[r]).length)));return t},e.date.convert=function(e,t){if(e&&e.constructor==Date)return e;if("number"==typeof e&&13===String(e).length)return new Date(e);e=String(e);var n=new Date,i=n.getFullYear(),r=n.getMonth()+1,a=n.getDate();if((e=e.replace(/[-|年|月]/gim,"/").replace(/[时|分|秒|小时|分钟]/gim,":").replace(/^(\d{4}\/\d+?)($|\s)/,(function(e,t){return t+"/1"})).replace(/[日|号]/gim,"").replace(/^(\d{1,2}\/\d{1,2}?)($|\s)/,(function(e,t){return n.getFullYear()+"/"+t}))).indexOf("T")>-1&&-1==e.indexOf("GMT")){var o=(e=e.replace("T"," ")).indexOf(".")>-1?e.split("."):[e];return new Date(o[0])}if(e.indexOf("GMT")>-1){var l=(o=e.split(" "))[3]+"/"+{Jan:"1",Feb:"2",Mar:"3",Apr:"4",May:"5",Jun:"6",Jul:"7",Aug:"8",Sep:"9",Oct:"10",Nov:"11",Dec:"12"}[o[1]]+"/"+o[2]+" "+o[4];return new Date(l)}return e.indexOf("/")<0&&e.indexOf(":")>-1&&(e=i+"/"+r+"/"+a+" "+e),4===e.length?e+="/1/1 00:00:00":"MM"===t||"M"===t?e=i+"/"+e+"/1 00:00:00":"dd"!==t&&"d"!==t||(e=i+"/"+r+"/"+e+" 00:00:00"),new Date(e)},e.date.after=function(e,t,n){t=0===t?0:t||1;var i=this.convert(e).getTime()+1e3*parseInt(t)*3600*24;return this.format(i,n||"yyyy-MM-dd")},e.date.afterTime=function(e,t,n){var i=0===t?0:t||30,r=this.format(new Date,"yyyy/MM/dd")+" "+e,a=new Date(r).getTime()+1e3*i*60;return this.format(a,n||"hh:mm")},e.date.count=function(t,n,i){var r,a;switch(i){case"number":r=t,a=n;break;case"hour":let e=this.format(new Date,"yyyy/MM/dd"),i=e+" "+t,o=this.convert(i),l=e+" "+n,c=this.convert(l);r=o.getTime(),a=c.getTime();break;case"date":default:r=this.convert(t).getTime(),a=this.convert(n).getTime()}var o=r-a;o=Math.abs(o);var l=parseInt(o/1e3/3600/24,10),c=parseInt(o/1e3/3600%24,10),s=parseInt(o/1e3/60%60,10),u=parseInt(o/1e3%60,10);return{value:o,day:l,hour:c,minute:s,second:u,tip:`${l}天 ${e.unit.fixZero(c)}:${e.unit.fixZero(s)}:${e.unit.fixZero(u)}`}},e.date.countMonth=function(e){var t=this.convert(e),n=t.getMonth()+1;return t.setMonth(n),t.setDate(0),t.getDate()},e.date.toWeek=function(e,t){var n=this.convert(e),i=null;switch(t){case 1:i=["周日","周一","周二","周三","周四","周五","周六"];break;default:i=t||["星期天","星期一","星期二","星期三","星期四","星期五","星期六"]}return i[n.getDay()]},e.date.today=function(e){return e=e||"M-d",this.format(new Date,e)},e.date.fromnow=function(e){var t=+new Date,n=this.convert(e).getTime(),i="",r=this.count(t,n,"date"),a=t>n?"前":"后";return r.day?i=r.day+"天"+a:r.hour?i=r.hour+"小时"+a:r.minute?i=r.minute+"分钟"+a:r.second&&(i=r.second+"秒"+a),i}}(window.bui||{}),function(e,t){e.ajax=function(n){var i=t.Deferred(),r=null,a=t.extend(!0,{},{baseUrl:"",data:{},method:"GET",dataType:"json",timeout:6e4,headers:{},processData:!0,mimeType:"none",cache:!0,async:!0,needJsonString:!1,contentType:null,localData:null,transformRequest:null,transformResponse:null,native:!0,needNative:!1},e.config.ajax,n),o=a.success,l=a.fail||a.error;null===a.contentType&&"get"==a.method.toLocaleLowerCase()?a.contentType="text/html;charset=UTF-8":null===a.contentType&&"post"==a.method.toLocaleLowerCase()?a.contentType="application/x-www-form-urlencoded":a.contentType=a.contentType;"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;if(a.needJsonString)try{a.data="object"==typeof a.data?JSON.stringify(a.data):a.data}catch(e){a.data=a.data}if(a.data=a.transformRequest&&a.transformRequest.call(i,a.data)||a.data,!a.url)return e.showLog("url不能为空","bui.ajax"),i;if(a.url.indexOf("://")>-1?a.url=a.url:a.url.indexOf("./")>-1||a.url.indexOf("../")>-1?a.url=bui.unit.resolvePath(a.url):a.url=a.baseUrl+a.url,a.proxy){var c=a.url.indexOf(a.proxy),s=c>-1?c+1:-1;a.url=a.url.substr(s)}if(i.abort=function(){r&&r.abort()},a.localData)return a.localData=a.transformResponse&&a.transformResponse.call(i,a.localData)||a.localData,o&&o(a.localData,200),i.resolve(a.localData,200),i;if(a.needNative){if(void 0===e.native.ajax)return u(a),i;try{i=e.native.ajax&&e.native.ajax(a)||i}catch(e){}}else u(a);function u(e){e.success=function(t,n,r){var a=null;if("string"==typeof t&&"json"==e.dataType)try{a=JSON.parse(t)}catch(e){a=t}else a=t||{};a=e.transformResponse&&e.transformResponse.call(i,a)||a,o&&o(a,n,r),i.resolve(a,n,r)},e.error=function(t,n,r){var a;if("string"==typeof t&&"json"==e.dataType)try{a=JSON.parse(t)}catch(e){a=t}else a=t||{};l&&l(a,n,r),i.reject(a,n,r)};var n=e.type&&e.type.toUpperCase();e.type=n||e.method.toUpperCase(),r=t.ajax(e)}return i},e.get=function(n,i,r){var a={method:"GET"};a.url=n,a.data=i||{};var o=null,l=r&&r[0];return o=r&&"array"===e.typeof(r)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.get,a,l):a,bui.ajax(o)},e.post=function(n,i,r){var a={method:"POST",contentType:"application/x-www-form-urlencoded"};a.url=n,a.data=i||{};var o=null,l=r&&r[0];return(o=r&&"array"===e.typeof(r)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.post,a,l):a).contentType.indexOf("application/json")>-1&&(o.data="object"==typeof o.data?JSON.stringify(o.data):o.data),bui.ajax(o)},e.put=function(n,i,r){var a={method:"PUT",contentType:"application/json"};a.url=n,a.data=i||{};var o=null,l=r&&r[0];return(o=r&&"array"===e.typeof(r)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.put,a,l):a).contentType.indexOf("application/json")>-1&&(o.data="object"==typeof o.data?JSON.stringify(o.data):o.data),bui.ajax(o)},e.delete=function(n,i,r){var a={method:"DELETE",contentType:"application/json"};a.url=n,a.data=i||{};var o=null,l=r&&r[0];return(o=r&&"array"===e.typeof(r)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.delete,a,l):a).contentType.indexOf("application/json")>-1&&(o.data="object"==typeof o.data?JSON.stringify(o.data):o.data),bui.ajax(o)},e.all=function(n){var i=null;return i=n&&"array"===e.typeof(n)?n:Array.prototype.slice.apply(arguments),t.when.apply(null,i)}}(window.bui||{},window.libs),function(e,t){e.load=function(n){var i,r={url:"",param:{},reload:!!e.hasRouter&&router.config.reload,replace:!1,native:!0,needNative:!1},a=t.extend(!0,{},r,e.config.load,n),o={},l=a.url;if(a.url)if(document.activeElement.blur(),l.indexOf("tel:")>=0||l.indexOf("mailto:")>=0||l.indexOf("sms:")>=0)e.unit.openExtral(l);else{if(l&&l.indexOf("?")>-1){var c=l.split("?");o=e.unit.keyStringToObject(c[1]),a.url=c[0]}try{var s="string"==typeof a.param&&JSON.parse(a.param)||a.param||{};a.param=t.extend(!0,{},o,s)}catch(t){return void e.showLog("param 参数值必须是一个{}对象","bui.load:web")}n&&n.needNative||e.nativeRouter?e.native.load&&e.native.load(a):(i=e.setUrlParams(a.url,a.param),a.reload?window.location.href=e.hasRouter?"index.html#"+i:i:!a.replace||e.hasRouter?e.hasRouter?window.router.load(a):window.location.href=i:window.location.replace(i))}else e.showLog("url 不能为空!","bui.load:web")}}(window.bui||{},window.libs),function(e,t){e.getPageParams=function(n){var i=t.Deferred(),r={callback:null,native:!0,needNative:!1};n=n||{};var a=t.extend(!0,{},r,e.config.getPageParams);"function"==typeof n?a.callback=n:n&&"object"===e.typeof(n)&&(a=t.extend(!0,{},r,e.config.getPageParams,n));"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;if(n&&n.needNative||e.nativeRouter)return i=e.native.getPageParams&&e.native.getPageParams(a)||i;if(e.hasRouter){var o=window.router.getPageParams&&window.router.getPageParams()||e.getUrlParams();a.callback&&a.callback(o),i.resolve(o)}else{var l=e.getUrlParams();a.callback&&a.callback(l),i.resolve(l)}return i}}(window.bui||{},window.libs),function(e,t){e.back=function(n){var i,r={index:-1,name:"",delay:!0,native:!0,beforeBack:!0,callback:null};"function"==typeof n?(r.callback=n,i=t.extend(!0,{},r,e.config.back)):i=n&&"object"===e.typeof(n)?t.extend(!0,{},r,e.config.back,n):t.extend(!0,{},r,e.config.back);"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;var a=e.hasRouter&&router.history&&router.history.getLast()||null;if(!1!==("function"==typeof i.beforeBack?i.beforeBack.call(this,{prevTarget:null,target:a}):i.beforeBack))if(n&&n.needNative||e.nativeRouter)e.native.back&&e.native.back(i);else{if(e.hasRouter)if(window.router.config.syncHistory){var o=e.history.get(),l=o.length-1;if(i.name){var c=e.array.indexs(o,i.name,"name"),s=c.length;i.index=s?-(o.length-c[s-1]-1):-1}if(Math.abs(i.index)>=o.length&&(i.index=-l),Math.abs(i.index)>=window.history.length&&window.router.config.hash&&(i.index=window.router.config.reloadCache?-l:-(window.history.length-1)),0==i.index&&(i.index=-1),window.router.config.hash&&!window.router.config.reloadCache)return void d();(o.length>1||window.history.length>1)&&d()}else window.router.back&&window.router.back(i);else d();var u=null}function d(){var t=(e.hasRouter&&e.history.getPrev()||{}).exports||{};window.history.go(i.index),u&&clearTimeout(u),i.delay&&i.callback?u=setTimeout((function(){e.hasRouter?i.callback.call(router,t):i.callback.call(e,{})}),500):i.callback&&i.callback()}}}(window.bui||{},window.libs),function(e,t){e.refresh=e.history.refresh}(window.bui||{}),function(e,t){e.run=function(n){var i={};"string"==typeof n?i.id=n:n&&"object"===e.typeof(n)&&(i=t.extend(!0,{},{id:"",name:"",data:null,onFail:null,native:!0,needNative:!0},e.config.run,n));var r=String(i.id);"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;if(n.needNative)e.native.run&&e.native.run(i);else if(r.indexOf("http://")>-1||r.indexOf("https://")>-1){var a=e.setUrlParams(i.id,i.data);if(e.platform.isIos())return void(window.location.href=a);(window.open("","_blank")||window.open("","_newtab")).location.href=a}}}(window.bui||{},window.libs),function(e,t){e.fileselect=function(n){var i,r,a,o=t.extend(!0,{},{native:!0,needNative:!1,needCompress:!1,appendTo:"",quality:.8,from:"camera",width:800,height:800,duration:10,onSuccess:null,onFail:null,mediaType:"picture"},e.config.fileselect,n),l=this,c={add:function(n){s=null;var i=t.extend(!0,{needChangeData:!0,needCompress:!1,name:"resize.jpg"},o,n);(u=i).mimeType=n.mimeType?n.mimeType:"",f?(n.from?"picture"===n.from||"photo"===n.from||"savephoto"===n.from?r.removeAttr("capture"):r.attr("capture",n.from):r.removeAttr("capture"),e.platform.isIos()&&"function"==typeof FastClick?r[0].dispatchEvent(new Event("click")):r.trigger("click")):a.add(i);return this},remove:function(t,n){n=n||"name";if(!f)return d=a.remove(t,n);if("string"==typeof t){d.length&&e.array.remove(d,t,n);var i=d.length?d[d.length-1].data:null;return s=i,r[0].value="",d}return this},clear:function(){d=[],s=null,f?r[0].value="":a.clear();return d},value:function(){s=f?s:a.value();return s},data:function(){d=f?d:a.data();return d},toFile:x,toBase64:function(n){var i=t.extend(!0,{needCompress:!1,destinationType:"data",mimeType:"",needChangeData:!1},n);if(i.data=i.data||s,i.mimeType=n.mimeType?n.mimeType:i.data&&i.data.type||"image/jpeg",f)try{w(i)}catch(t){e.showLog(t)}else a.toBase64(i);return this},resize:w,toBlob:k,currentIndex:function(){var e="";e=f?d.length-1:a.data().length-1;return e},currentName:function(){var e="";e=f?d[d.length-1].name:a.value().name;return e},init:b},s=null,u=null,d=[],f="object"==typeof n&&void 0!==n.needNative?!n.needNative:e.isWebapp,p="*",h=!1,g=null,m=null,v=null,y=null;function b(n){var b=t.extend(!0,o,n);switch(o.appendTo=b.appendTo||e.hasRouter&&router.currentPage()||"body",b.mediaType){case"allmedeia":p="*";break;case"picture":case"image":p="image/*";break;case"video":p="video/*";break;case"audio":p="audio/*";break;default:p=b.mediaType}return d=[],g=new Image,m=new FileReader,v=document.createElement("canvas"),y=v.getContext("2d"),f?(!function(){if(null==r){i=bui.guid();var e=o.from?'capture="'+o.from+'"':"",n='<input type="file" accept="'+p+'" name="uploadFiles" id="'+i+'" '+e+' style="display:none"/>';t(o.appendTo).append(n),r=t("#"+i)||t('input[name="uploadFiles"]')}}(),h||(r.on("change",(function(t){var n=this.files;if(!(n.length<1)){n.length>1&&e.showLog("一次只能选一张图片","bui.fileselect:web");var i=n[0];s=i;var r={name:i.name,data:i,type:i.type,size:i.size};d.push(r),u.needCompress?(u.data=i,u.mimeType=u.mimeType?u.mimeType:i.type,w(u)):u.onSuccess&&u.onSuccess.call(l,i,d),this.value=""}})),h=!0)):a=e.native.fileselect&&e.native.fileselect.call(this,n,{module:c})||{},this}function w(n){var i=t.extend(!0,{destinationType:"file",data:null,mimeType:"",quality:.8,width:800,height:800,needCompress:!0,needChangeData:!1,onSuccess:null,onFail:null},o,n);g.onload=function(){var t=this.width,n=this.height,r=null,a=i.width,o=i.height,c=t,u=n;i.needCompress&&(t>a||n>o)&&(t/n>a/o?(c=a,u=Math.round(a*(n/t))):(u=o,c=Math.round(o*(t/n)))),v.width=c,v.height=u,y.clearRect(0,0,c,u),y.drawImage(g,0,0,c,u);var f=v.toDataURL(i.mimeType||i.data&&i.data.type||"image/jpeg",i.quality),p=function(e){return e.indexOf(".png")>-1||e.indexOf(".jpg")>-1||e.indexOf(".gif")>-1||e.indexOf(".jpeg")>-1?e.substr(0,e.lastIndexOf(".")):e}(i.data.name)||"";switch(i.destinationType){case"file":r=x(f,p);break;case"blob":r=k(f);break;case"data":r=f}if(i.needChangeData){s=r;var h=e.array.index(d,i.data.name,"name");h>-1&&(d[h].data=r,r.size&&(d[h].size=r.size),r.type&&(d[h].type=r.type))}return i.onSuccess&&i.onSuccess.call(l,r,d),r},g.onerror=function(){i.onFail&&i.onFail.call(l,g.src)},m.onload=function(e){g.src=e.target.result};try{var r=i.data&&i.data.type||"";r="object"==typeof r?r.type||"":r||"",i.data&&0==r.indexOf("image")&&m.readAsDataURL(n.data)}catch(t){e.showLog(t)}}function x(t,n){try{n=n||"file";for(var i=t.split(","),r=(i[0].match(/:(.*?);/)||[])[1]||"image/jpeg",a=r.split("/")[1],o=atob(i[1]),l=o.length,c=new Uint8Array(l);l--;)c[l]=o.charCodeAt(l);return new File([c],n+"."+a,{type:r})}catch(t){e.showLog(t)}}function k(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),r=i.length,a=new Uint8Array(r);r--;)a[r]=i.charCodeAt(r);return new Blob([a],{type:n})}return b(o),c}}(bui||{},libs),function(e,t){e.file=function(n){var i,r,a,o,l,c={getFolder:d,removeFolder:function(e){var n=t.extend(!0,{},e);s.needNative?l.removeFolder(n):d({root:n.root,folderName:n.folderName,create:n.create,onSuccess:function(e,t){e.removeRecursively((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}});return this},getFile:h,getFileName:p,removeFile:function(e){var n=t.extend(!0,{},e);s.needNative?l.removeFile(n):h({root:n.root,create:n.create,folderName:n.folderName,fileName:n.fileName,onSuccess:function(e,t){e.remove((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}});return this},toBase64:function(e){return o.toBase64(e),this},open:function(t){var n=t||{};if(!n.url)return;s.needNative?l.open(n):e.showLog("web暂不支持open方法","bui.file.open:web");return this},init:u},s=c.config=t.extend(!0,{},{size:10,native:!0,needNative:!1},e.config.file,n);"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;function u(n){return o=e.fileselect(n),r=function(n){var r=t.Deferred();n.needNative?l=e.native.file&&e.native.file(n,{fileselect:o,module:c})||{}:(i="bui.app",a=1024*parseInt(s.size)*1024,window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,navigator.webkitPersistentStorage&&navigator.webkitPersistentStorage.requestQuota(a,(function(e){window.requestFileSystem(window.PERSISTENT,e,(function(e){r.resolve(e)}),u)})));function u(e){var t="";try{switch(e.code){case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}}catch(e){}var n={msg:t};r.reject(n)}return r}(n),!n.needNative&&d({root:!0,create:!0}),this}function d(e){var n={folderName:i,root:!1,create:!1,msg:"",param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},a=t.extend({},n,e),o="";if(a.create?(o="创建 ",a.param.create=!0):(o="获取 ",a.param.create=!1),s.needNative)l.getFolder(a);else{var u=f(a.folderName);u=a.root?u:i+"/"+u,r.done((function(e){e.root.getDirectory(u,a.param,(function(t){a.onSuccess&&a.onSuccess.call(c,t,e)}),(function(e){var t={msg:o+u+" 文件夹失败"};a.onFail&&a.onFail.call(c,t)}))})).fail((function(e){a.onFail&&a.onFail.call(c,{msg:"文件系统还没准备好."})}))}return this}function f(e){return"."==e[0]||"/"==e[0]||" "==e[0]?f(e.slice(1)):"."!=e[0]&&"/"!=e[0]&&" "!=e[0]?e:void 0}function p(e){return e&&e.indexOf("/")>-1?e.slice(e.lastIndexOf("/")+1,e.indexOf("?")>-1?e.indexOf("?"):void 0):e}function h(e){var n=t.extend({},{fileName:"",folderName:"",root:!1,create:!1,param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},e),r="";if(n.create?(r="创建 ",n.param.create=!0):(r="获取 ",n.param.create=!1),n.fileName&&!(n.fileName.indexOf(".")<0)){if(s.needNative)l.getFile(n);else{var a=p(n.fileName);d({root:n.root,folderName:n.folderName,create:!0,onSuccess:function(e,t){var o=e.name==i?e.name+"/"+a:i+"/"+e.name+"/"+a;t.root.getFile(o,n.param,(function(e){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(e){var t={msg:r+a+" 文件失败"};n.onFail&&n.onFail.call(c,t)}))},onFail:function(e){n.onFail&&n.onFail(e)}})}return this}n.onFail&&n.onFail()}return u(s),c}}(window.bui||{},window.libs),function(e,t){e.upload=function(n){var i,r,a,o,l,c,s,u={url:"",data:null,headers:{},showProgress:!0,timeout:6e4,contentType:!1,processData:!1,autoClose:!0,native:!0,needNative:!1,method:"POST",fileKey:"file",dataType:"json",mediaType:"picture",from:"picture",onProgress:null,onMask:function(){b()},onSuccess:null,onFail:null},d=t.extend(!0,{},u,e.config.upload,n),f=t.Deferred(),p={init:m,add:function(e){return e.onSuccess=e.onSuccess?e.onSuccess.bind(p):null,e.onFail=e.onFail?e.onFail.bind(p):null,r.add(e),this},remove:function(e,t){var n=v(),i=n.length;if(i<1)return this;/\d/.test(e)&&e.indexOf(".")<0?r.remove(n[e].name,t):"string"==typeof e?r.remove(e,t):r.remove(n[i-1].name,t);return this},resize:function(e){return r.resize(e),this},currentIndex:function(){return r.currentIndex()},currentName:function(){return r.currentName()},clear:function(){return r.clear(),this},data:v,start:y,startAll:function(e){var n=t.extend(!0,{needFileinfo:!1},d,e),i=n[n.fileKey]||r.data();n.data||(n.data={});let a=[];for(let e=0;e<i.length;e++){i[e];!function(e){if(!(e>i.length-1)){if(n.data[n.fileKey]=i[e]&&i[e].data,n.needFileinfo)for(var t in i[e])"data"!==t&&(n.data[t]=i[e]&&i[e][t]);var r=n.onSuccess,o=n.onFail;n.onSuccess=function(t){r&&r.call(p,t),a[e]=t,e==i.length-1&&n.onEnd&&n.onEnd.call(p,a)},n.onFail=function(t){o&&o.call(p,t),a[e]=t,e==i.length-1&&n.onEnd&&n.onEnd.call(p,a)},y(n)}}(e)}return f},stop:b,toBase64:function(e){return r.toBase64(e),this},widget:function(t){var n={loading:i,fileselect:r,ajax:a};return e.widget.call(n,t)}},h=d.showProgress,g=d.onProgress;"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;function m(t){return i=e.loading({display:"block",width:30,height:30,opacity:0,autoClose:t.autoClose,callback:t.onMask}),r=e.fileselect.call(p,{native:t.native,needNative:t.needNative,from:t.from,mediaType:t.mediaType}),t&&t.needNative&&(o=e.native.upload&&e.native.upload(t,{loading:i,fileselect:r,module:p})||{}),t.data?(y(t),this):this}function v(){return r.data()}function y(e){var n=t.extend(!0,{},d,e);if(c=n.url,l=r.value(),h=n.showProgress,l){if(h&&i.show(),n&&n.needNative)return o.start(n)||f;var s=n.data,u=Object.keys(s),g=new FormData,m=!1;return u.forEach((function(e,t){n.fileKey===e&&(m=!0),g.append(e,s[e])})),!m&&g.append(n.fileKey,l),n.data=g,function(e){var n=e.onSuccess,i=e.onFail;return a=t.ajax({url:c,type:e.method,data:e.data,cache:e.cache,headers:e.headers,dataType:e.dataType,contentType:e.contentType,processData:e.processData,timeout:e.timeout,xhr:function(){var e=t.ajaxSettings.xhr();if(w&&e.upload)return e.upload.addEventListener("progress",w,!1),e},success:function(e){x(),n&&n.call(p,e),f.resolve(e)},error:function(e,t,n){x(),i&&i.call(p,e,t),f.reject(e,t,n)}}),f}(n)}}function b(e){return d&&d.needNative?o.stop(e):(i&&i.stop(),a&&a.abort(),e&&e.call(p,i,a)),this}function w(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);s=t.toString()+"%",t<100?(n=s,h&&i&&i.show({text:n})):x(),g&&g.call(p,s)}var n}))}function x(){return i&&i.stop(),this}return m(d),p}}(window.bui||{},window.libs),function(e,t){e.download=function(n){var i,r,a,o,l,c,s={open:function(e){return r.open(e),this},getFile:function(e){var n=t.extend(!0,{autoDown:!0},u,e),i=e.fileName||r.getFileName(n.url);r.getFile({fileName:i,folderName:n.folderName,onSuccess:function(e,t){n.onSuccess&&n.onSuccess.call(s,e.fullPath||e,e,t)},onFail:function(e){n.autoDown=y(n)}})},removeFile:function(t){if(!t.fileName)return e.showLog("请告诉我们你要删除哪个文件, fileName "),this;return t.folderName=t.folderName||u.folderName,r.removeFile(t),this},removeFolder:function(e){return e.folderName=e.folderName||u.folderName,r.removeFolder(e),this},start:y,stop:b,toBase64:function(e){return r.toBase64(e),this},init:v,widget:function(t){var n={loading:g,file:r,ajax:i};return e.widget.call(n,t)}},u=s.config=t.extend(!0,{},{url:"",data:{},headers:{},method:"GET",showProgress:!0,timeout:6e4,fileName:"",folderName:"download",native:!0,needNative:!0,onProgress:null,onSuccess:null,onFail:null},e.config.download,n),d="object"==typeof n&&void 0!==n.needNative?!n.needNative:e.isWebapp,f=u.showProgress,p=u.onProgress,h=u.onFail,g=null,m=null;function v(t){return g=t.showProgress&&e.loading({display:"block",width:30,height:30,opacity:0,callback:function(){b()}}),r=e.file({native:t.native,needNative:t.needNative}),t.needNative?a=e.native.download&&e.native.download(t,{file:r,loading:g,module:s})||{}:function(e){if(r.getFolder({folderName:e.folderName,create:!1,onSuccess:function(e,t){l=e.fullPath},onFail:function(t){r.getFolder({folderName:e.folderName,create:!0,onSuccess:function(e,t){l=e.fullPath},onFail:function(e){h&&h.call(s,e)}})}}),!e.url)return;y(e)}(t),this}function y(e){var n=t.extend(!0,{},u,e);o=n.needEncode?encodeURI(n.url):n.url,p=n.onProgress,(f=n.showProgress)&&g&&g.show({text:"0%"}),l+"/"+(e.fileName||r.getFileName(n.url)),n.needNative?a.start(n):(n.cache=!1,n.contentType=!1,n.processData=!1,i=t.ajax({url:o,type:n.method,data:n.data,cache:n.cache,headers:n.headers,contentType:n.contentType,processData:n.processData,timeout:n.timeout,xhr:function(){var e=t.ajaxSettings.xhr();if(w&&e)return e.addEventListener("progress",w,!1),e},success:function(t){var i=e.fileName||r.getFileName(n.url);r.getFile({fileName:i,folderName:n.folderName,create:!0,onSuccess:function(e,t){n.onSuccess&&n.onSuccess.call(s,e.fullPath,t)}})},fail:function(e){x(),n.onFail&&n.onFail.call(s,e)}}))}function b(e){d?(x(),i&&i.abort(),m&&window.cancelAnimationFrame(m)):a.stop(),e&&e.call(s,g,i)}function w(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,m=window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);c=t.toString()+"%",t<100?(n=c,f&&g&&g.show({text:n})):x(),p&&p.call(s,c)}var n}))}function x(){f&&g&&g.stop()}return v(u),s}}(window.bui||{},window.libs),function(e,t){e.currentPlatform="webapp",e.on("pagereadybefore",(function(){e.platform.isWindow()||e.platform.isMac()?window.viewport=e.viewport(40):window.viewport=e.viewport(),e.config.init.auto&&e.init(),!e.hasRouter&&e.config.component.auto&&loader.components({id:"body"})})),e.webready=function(n){t(document).ready((function(){e.trigger.call(e,"pagereadybefore"),n&&n.call(e),e.trigger.call(e,"pageready")}))},e.ready=function(n){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp;var i=t.Deferred();if(e.isWebapp)t(document).ready((function(){e.trigger.call(e,"pagereadybefore"),n&&n.call(e),e.trigger.call(e,"pageready"),i.resolve()}));else{if(void 0===e.native.ready)return e.showLog("当前 bui.isWebapp = false; 但bui.js为webapp版本,不支持原生方法,请使用 buijs update -p xxx, 更换bui.js为对应xxx平台版本;"),e.webready(n),i;i=e.native.ready&&e.native.ready(n)||i}return i}}(window.bui||{},window.libs),function(e,t){e.mask=function(n){var i,r,a={id:"",appendTo:"",className:"",opacity:.3,background:"",zIndex:100,autoTrigger:!1,autoClose:!1,onBeforeInit:null,onInited:null,callback:null},o={name:"mask",handle:{},on:function(t,n){return e.on.apply(o,arguments),this},off:b,hide:y,show:function(t){if(h)return;(d=e.objId(s))&&d.length?(d.css("display","block"),!p&&u.css("position","relative"),r=!0):m(l);return w.call(o,"show"),this},isShow:function(){return r},remove:v,destroy:function(e){v(),u&&u.off("click.mask");b("show"),b("hide"),h=!0},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(o,t,n)},config:l,init:g},l=o.config=t.extend(!0,{},a,e.config.mask,n),c=e.guid(),s=l.id?l.id.indexOf("#")>-1?l.id.substring(1):l.id:c,u=(t("body"),e.objId(l.appendTo)),d=null,f=!1,p=!1,h=!1;function g(n){h=!1;var r=t.extend(!0,a,l,n);return r.onBeforeInit&&r.onBeforeInit.call(o,r),r.appendTo=r.appendTo||"body",u=e.objId(r.appendTo),p=u[0]&&"COMPONENT"===u[0].tagName,l=o.config=r,i=u.css("position"),r.autoTrigger&&m(r),d=e.objId(r.id),r.onInited&&r.onInited.call(o,r),this}function m(n){if(!h){var i=t.extend(!0,{},a,l,n),c=function(t){var n=t.background?t.background:"rgba(0,0,0,"+t.opacity+")",i="";return i+'<div id="'+s+'" class="'+e.prefix("mask")+" "+t.className+'" style="background:'+n+";z-index:"+t.zIndex+'"></div>'}(i);return(d=e.objId(s))&&d.length?d.css("display","block"):(u.append(c),!p&&u.css("position","relative"),d=e.objId(s)),r=!0,w.call(o,"show"),f||function(e){d.off("click.bui").on("click.bui",(function(t){e.callback&&e.callback.call(o,t),e.autoClose&&y(),t.stopPropagation()})),f=!0}(i),this}}function v(){if(!h)return d&&d.remove(),d=null,u.css("position",i||"static"),r=!1,f=!1,w.call(o,"hide"),this}function y(){if(!h)return d&&d.css("display","none"),!p&&u.css("position","relative"),r=!1,w.call(o,"hide"),this}function b(t,n){return e.off.apply(o,arguments),this}function w(t){o.self=this==window||this==o?null:this,e.trigger.apply(o,arguments)}return g(l),o}}(window.bui||{},window.libs),function(e,t){e.loading=function(n){var i,r={name:"loading",handle:{},on:function(t,n){return e.on.apply(r,arguments),this},off:k,start:y,stop:w,isLoading:function(){return f},pause:function(){if(d)return;return s&&s.addClass("bui-loading-pause"),O.call(this,"pause"),this},text:b,showRing:function(){if(d)return;return s=e.objId(l),s.children(".bui-loading-cell").css("display","inline-block"),s.removeClass("bui-loading-pause"),this},hideRing:function(){if(d)return;return s=e.objId(l),s.children(".bui-loading-cell").css("display","none"),s.addClass("bui-loading-pause"),this},show:function(n){var i=n||{};if(d)return;var r=t.extend(!0,a,i);(s=e.objId(r.id))&&s.length?(b(r.text),s[0].style.display="-webkit-box",m&&m.show(),O.call(this,"show")):y(r);a.timeout&&(p&&clearTimeout(p),p=setTimeout((function(e){x()}),a.timeout));return f=!0,this},hide:x,destroy:function(e){e=1==e;w(),o&&o.off("click.bui");k("show"),k("hide"),k("start"),k("stop"),k("pause"),k("remove"),m&&m.destroy(e),d=!0},widget:function(t){var n={mask:m||{}};return e.widget.call(n,t)},option:function(t,n){return e.option.call(r,t,n)},config:a,init:v},a=r.config=t.extend(!0,{},{appendTo:"",width:30,height:30,text:"",onlyText:!1,mask:!0,zIndex:"",autoTrigger:!1,autoClose:!0,timeout:0,opacity:0,display:"block",template:null,onBeforeInit:null,onInited:null,callback:null},e.config.loading,n),o=(t("body"),null),l=e.guid(),c=l+"-mask",s=e.objId(l),u=!1,d=!1,f=!1,p=null;a.id=l;var h=a.callback;a.callback=function(e){a.autoClose&&w(),h&&h.call(r,e)};var g=t.extend(!0,{},a,{id:c}),m=a.mask?e.mask(g):null;function v(i){d=!1;var c=t.extend(!0,{},a,i);return c.onBeforeInit&&c.onBeforeInit.call(r,n),c.appendTo=c.appendTo||"body",o=t(c.appendTo),a=r.config=c,c.autoTrigger&&s.length<1&&y(c),s=e.objId(l),c.onInited&&c.onInited.call(r,c),this}function y(n){if(!d){var i=t.extend(!0,{},a,n);if(s=e.objId(l),s.children(".bui-loading-cell"),s.hasClass("bui-loading-pause"))s.removeClass("bui-loading-pause"),O.call(this,"start");else{s.length&&s.remove();var c=function(t){var n=(t=t||{}).text,i=o.width()||document.documentElement.clientWidth,a=n&&"block"==t.display?parseInt(t.height)+30:parseInt(t.height),c=-i/2,s=-a/2,u="block"==t.display?e.prefix("loading-block"):e.prefix("loading-inline"),d="";return d+='<div id="'+l+'" class="'+e.prefix("loading")+" "+u+'" style="width:'+i+"px;height:"+a+"px;line-height:"+a+"px;margin-left:"+c+"px;margin-top:"+s+"px;"+(t.zIndex?"z-index:"+t.zIndex:"")+'" >',t.onlyText||(d+='<div class="'+e.prefix("loading-cell")+'" style="width:'+parseFloat(t.width)+"px;height:"+parseFloat(t.height)+'px;"></div>'),d+='<div class="'+e.prefix("loading-text")+'">'+t.text+"</div>",d+="</div>",t&&t.template?t.template.call(r,t):d}(i);o.append(c),m&&m.show(),O.call(this,"show")}return i.timeout&&(p&&clearTimeout(p),p=setTimeout((function(){w()}),i.timeout)),u||function(e){var t=e||a;o.off("click.bui","#"+l).on("click.bui","#"+l,(function(e){t.callback&&t.callback.call(r,e),e.stopPropagation()})),u=!0}(i),f=!0,this}}function b(t){if(!d)return s=e.objId(l),i=s.children(".bui-loading-text"),void 0===t?i&&i.text():(i&&i.html(t),this)}function w(){if(!d)return(s=e.objId(l))&&s.remove(),s=null,m&&m.remove(),u=!1,f=!1,O.call(this,"remove"),O.call(this,"hide"),this}function x(){if(!d)return s=e.objId(l),(a.appendTo||s&&s.length)&&(s.css("display","none"),m&&m.hide()),f=!1,O.call(this,"hide"),this}function k(t,n){return e.off.apply(r,arguments),this}function O(t){r.self=this==window||this==r?null:this,e.trigger.apply(r,arguments)}return v(a),r}}(window.bui||{},window.libs),function(e,t){e.init=function(n){var i,r={id:".bui-page",height:0,header:"header",main:"main",footer:"footer",reduceRem:0};if("object"==e.typeof(n))i=t.extend({},r,e.config.init,n);else{var a={};a.height=n,i=t.extend({},r,a)}var o=i.height||document.documentElement.clientHeight||t("body").height()||t("#bui-router").height()||t(".bui-page").height();if(!(e.obj(i.main).length<1)){try{var l=e.obj(i.id),c=i.header.indexOf("#")>-1?e.obj(i.header)[0]:l.children(i.header)[0],s=i.footer.indexOf("#")>-1?e.obj(i.footer)[0]:l.children(i.footer)[0],u=i.main.indexOf("#")>-1?e.obj(i.main):l.children(i.main),d=c?c.offsetHeight:0,f=s?s.offsetHeight:0,p=i.reduceRem>0?e.unit.remToPx(i.reduceRem):0,h=o-d-f-p;if(parseInt(h)>0)u.height(h);else{var g=d+f+p+"px";e.unit.calcHeight(u,g)}}catch(t){e.showLog(t,"bui.init")}return h}},window.addEventListener?window.addEventListener("load",(function(t){e.trigger.call(e,"onload")}),!1):window.attachEvent("onload",(function(t){e.trigger.call(e,"onload")})),t(document).ready((function(){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp,e.trigger.call(e,"pagebefore"),"function"==typeof FastClick&&FastClick.attach(document.body),e.trigger.call(e,"pageinit")}));try{var n="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"",i=n.replace(/hidden/i,"visibilitychange");document.addEventListener(i,(function(t){document[n]?e.trigger.call(e,"pagehide",t):e.trigger.call(e,"pageshow",t)}))}catch(e){}try{navigator.control.gesture(!1),navigator.control.longpressMenu(!1)}catch(e){}}(window.bui||{},window.libs)}));
