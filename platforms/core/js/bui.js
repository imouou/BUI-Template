/* @preserve 
 * @name: BUI v1.5.5  
 * @detail: BUI 是一个免费的UI交互框架, 用于快速定制开发WebApp,微信,混合移动应用(Bingotouch,Link,Dcloud,Apicloud,Appcan等).
 * @site: http://www.easybui.com/ 
 * Copyright © 2016-2019 BUI. All Rights Reserved. 
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";window.libs=window.Zepto||window.jQuery||{},window.bui={},window.router={},function(e){e.debug=!0,e.hasRouter=!1,e.isWebapp,e.currentPlatform="",e.log=!0,e.trace=!1,e.native={},e.config={},e.config.namespace="bui",e.config.classNamePrefix=e.config.namespace+"-",e.config.version="1.5.5",e.config.versionCode=20191130,e.version=e.config.version,e.versionCode=e.config.versionCode,e.config.viewport={zoom:!0,create:!0},e.config.init={auto:!0},e.config.ready={},e.config.ajax={},e.config.get={},e.config.put={},e.config.delete={},e.config.post={},e.config.back={},e.config.load={},e.config.getPageParams={},e.config.refresh={},e.config.run={},e.config.checkVersion={},e.config.dialog={},e.config.confirm={},e.config.alert={},e.config.hint={},e.config.prompt={},e.config.loading={},e.config.mask={},e.config.list={},e.config.listview={},e.config.scroll={},e.config.pullrefresh={},e.config.select={},e.config.sidebar={},e.config.slide={},e.config.actionsheet={},e.config.dropdown={},e.config.accordion={},e.config.stepbar={},e.config.rating={},e.config.number={},e.config.file={},e.config.fileselect={},e.config.upload={},e.config.download={},e.config.swipe={},e.config.router={},e.config.loader={},e.config.store={}}(window.bui);var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},r=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)};!function(t,n){t.prefix=function(e){return t.config.classNamePrefix+e},t.showLog=function(n,i){i=i||"";var r="";"object"==(void 0===n?"undefined":e(n))&&"message"in n&&"name"in n?r=n.message+":"+n.name+"&&stack:"+n.stack:"string"==typeof n&&(r=n),t.log&&console.error(i+" "+r),t.trace&&console.trace&&console.trace()},t.guid=function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(e=void 0===e?"bui":e||"")+t().substr(e.length)+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},t.swipeDirection=function(e,t,n,i){var r=t-e,a=i-n,o=Math.abs(r),l=Math.abs(a);return!(o<9&&l<9)&&(o/l>3?r>0?"swiperight":"swipeleft":a>0?"swipedown":"swipeup")},t.obj=function(i,r){var a=null;r=r||null;var o=t.hasRouter?router.currentPage()||"body":"body";o=r||o;var l=n(o),c=/^(\d)/,u=/^[a-zA-z]/,s=/^\[.+\]$/,d=/^#\d/,f=/^\.\d/,p="string"==typeof i,h=/^(html|head|body|header|main|footer|ul|li|section|dt|dd|div|span|img|article|i|strong|input|textarea|select|h1|h2|h3|h4|h5|h6|p)$/gi;if("object"===(void 0===i?"undefined":e(i)))return a=n(i);if(p&&c.test(i))return a=l.find("[id='"+i+"']");if(p&&u.test(i)){var g=h.test(i)||s.test(i)?i:"#"+i;return a=l.find(g)}return d.test(i)?a=l.find("[id='"+i.substr(1)+"']"):f.test(i)?a=l.find("[class='"+i.substr(1)+"']"):i&&(a=l.find(i)),a},t.$=t.obj,t.objId=function(e){return t.obj(e,"html")},t.selector=function(e){return void 0===e?this:n(e,this)},t.widget=function(e){return e&&e in this?this[e]:this},t.option=function(e,i){if("object"!==t.typeof(e)&&void 0===i)return"string"==typeof e?this.config[e]:this.config;if("id"==e)return t.showLog("不允许修改控件的ID参数"),this;if(e&&"object"===t.typeof(e)){var r=n.extend(this.config,e);return this.init(r)}if(this.config.hasOwnProperty(e)){var a={};a[e]=i;var r=n.extend(this.config,a);return this.init(r)}return this}}(window.bui||{},window.libs),function(t,n){t.emitter=function(){function n(){this.handle=Object.create(null)}return n.prototype.on=function(e,n,i){"function"==typeof n?(i=n,n=this):(i=i,n=n||this),n.handle=n.handle||{};var r=null;return r=e&&"array"===t.typeof(e)?e:e&&e.indexOf(",")>-1?e.split(","):[e],r.forEach(function(e,t){void 0===n.handle[e]&&(n.handle[e]=[]),n.handle[e].push(i)}),n},n.prototype.off=function(n,i,r){if("function"==typeof i?(r=i,i=this):"function"==typeof r?(r=r,i=i||this):i=this,void 0===n)i.handle=Object.create(null);else if("string"==typeof n&&"function"==typeof r){var a=i.handle[n]||[];t.array.remove(a,r)}else if("string"==typeof n){"object"!==e(i.handle)&&(i.handle={});var o=n.indexOf(",")>-1?n.split(","):[n];o.forEach(function(e,t){i.handle[e]=[]})}return i},n.prototype.one=function(e,t){function n(){t&&t.apply(i,arguments),i.off(e,n)}var i=this;return this.on(e,n),this},n.prototype.trigger=function(e){try{if(this.handle[arguments[0]]instanceof Array){var t=this.handle[arguments[0]],n=[].slice.apply(arguments);n.shift();for(var i=0,r=t.length;i<r;i++)t[i]&&t[i].apply(this.self||this,n)}}catch(e){}return this},n.prototype.notify=function(){try{for(var e in this.handle)if(this.handle[e]instanceof Array)for(var t=this.handle[e],n=0,i=t.length;n<i;n++)t[n]&&t[n].apply(this.self||this)}catch(e){}return this},function(e){return new n}}();var i=t.emitter();t.on=i.on,t.off=i.off,t.trigger=i.trigger,t.one=i.one}(window.bui||{},window.libs),function(t,n){t.store=function(r){function a(){Ne=t.hasRouter?router.$:n,Te="object"===e(ue.el)?n(ue.el):Ne(ue.el),Pe=Te&&Te.parent(),Re=Te&&Te.children(),qe.$el=Te,qe.$parent=Pe,qe.$children=Re,qe.$data=se;for(var i in he)he[i]=he[i].bind(qe);return qe.$methods=he,he&&p(),ge&&h(),ae.call(qe,"beforemount"),ue.beforeMounts.forEach(function(e,t){e.call(qe)}),J(se),l(),ve&&c(),fe&&f(),me?ue.needCompile&&router&&router.on("complete",function(e){ue.needCompile&&g(),Ce&&ue.mounteds.forEach(function(t,n){t.call(qe,e)}),De=n.extend(!0,{},se),we=!1,xe=!0,ae.call(qe,"mounted",e),Ce=!1,Fe=[]}):(Ce||re(),be&&o(),ue.needCompile&&g(),ue.mounteds.forEach(function(e,t){e.call(qe)}),De=n.extend(!0,{},se),we=!1,xe=!0,Fe=[],ae.call(qe,"mounted"),Ce=!1),this}function o(){var e=Te.html();return e=m(e),Te.html(e),this}function l(){for(var e in se)!function(e){Object.defineProperty(qe,e,{configurable:!0,get:function(){Ue&&console.log("1. module getting "+e,Fe),!we&&xe?(we=!0,xe=!1,Fe=[]):(we=!1,xe=!1);var t=se[e];return Array.isArray(t)&&Se.target&&(ke[e]=[],ke[e].push(Se.target)),t},set:function(t){Ue&&console.log("2. module setting "+e,Fe),Fe=[],se[e]=t,De[e]=t}})}(e)}function c(){try{Object.keys(ve).forEach(function(e,t){d(e,ve[e])})}catch(e){t.showLog(e)}}function u(e){return ne("nexttick",function(n){try{e&&e.call(qe,n)}catch(n){t.showLog(n)}}),this}function s(e,n){var i="nexttick-"+e;return Ie.hasOwnProperty(i)?this:(Ie[i]=n,ne("nexttick",function(n){if(n.keyname===e)try{Oe[e].pop(),0==Oe[e].length&&Ie[i]&&Ie[i].call(qe,n)}catch(n){t.showLog(n)}}),this)}function d(e,n){return ne(e,function(e){try{var i=[e.value,e.preValue||"",e];if("init"!==e.action){var r=n;switch(t.typeof(r)){case"function":r.apply(qe,i);break;case"array":r.forEach(function(e,t){e.apply(qe,i)});break;case"string":new Function(r+"("+e.value+","+(e.preValue||"")+")")();break;default:r.apply(qe,i)}}}catch(e){t.showLog(e)}}),this}function f(){try{Object.keys(fe).forEach(function(e){if(se.hasOwnProperty(e))return void t.showLog("不能跟data的键值相同:"+e);var n=fe[e];Object.defineProperty(qe,e,{get:function(){var t,i="function"==typeof n?n.bind(this):n.get.bind(this);return Se.target=function(){var t=i();ae(e,{target:null,value:t,action:"set",keyname:e,param:[],origin:De}),Se.target=null,Fe=[]},t=i(),Se.target=null,Fe=[],t},set:n&&"object"===t.typeof(n)?n.set||function(){}:function(){}})})}catch(e){t.showLog(e)}}function p(){try{Object.keys(he).forEach(function(e){if(se.hasOwnProperty(e))return void t.showLog("不能跟data的键值相同:"+e);Object.defineProperty(qe,e,{get:function(){return he[e].bind(this)},set:function(){}})})}catch(e){t.showLog(e)}}function h(){try{Object.keys(ge).forEach(function(e){if(se.hasOwnProperty(e))return void t.showLog("不能跟data的键值相同:"+e);Object.defineProperty(qe,e,{get:function(){return ge[e].bind(this)},set:function(){}})})}catch(e){t.showLog(e)}}function g(i){try{var r=null,a=null;void 0===i?(r=Te,a=ue):"string"==typeof i?(r=Ne(i),a=ue):i&&"object"===(void 0===i?"undefined":e(i))&&(r=Ne(i.el),a=n.extend(!0,{},ue,i));var o=!0;if(a.beforeCompiles.forEach(function(e,t){if(!1===(o=e.call(qe,a)))return!1}),!1===o)return Fe=[],!1;j(r),b(r),x(r),O(r),k(r),Ae=!0,v(),Fe=[],a.compileds.forEach(function(e,t){e.call(qe,a)})}catch(e){t.showLog(e)}return this}function v(){return Te.find("[ref]").each(function(){var e=this.getAttribute("ref"),n=Le.hasOwnProperty(e),i=null;n&&"htmldivelement"===t.typeof(Le[e])?(i=[Le[e]],i.push(this),Le[e]=i):n&&"array"===t.typeof(Le[e])?Le[e].push(this):Le[e]=this}),this}function m(e){try{var i=this,r=e||"",a=new RegExp("{{[\\s]?"+de+pe+"(.*?)}}","mg");return r=r.replace(a,function(e,r){var a=r.split(de+pe);""===n.trim(a[0])&&a.shift();var o=a.length>0&&t.unit.getKeyValue(a.join("."),De)||"";return"function"==typeof o?o.call(i):o})}catch(e){t.showLog(e)}}function y(e,n){var i=void 0;if(e in We)i=We[e];else{if(void 0===(i=t.unit.getKeyValue(e,n)))return void(Ue&&console.warn("请检查 "+e+" 在bui.store scope:"+de+" 中有没有声明定义"));We[e]=i}return i}function b(e){try{var n=e,i=[],r=n.html()||"",a=r.match(Be)||[],o=t.array.uniq(a);o.length&&o.forEach(function(e,r){var a=n.find("["+e+"*="+de+"]");a.length&&a.each(function(n,r){var a=this,o="",l=M.call(this,""+e),c=l[0]&&l[0].keyname||"",u=c.indexOf(".length"),s=u>-1?c.substr(0,u):c,d=l[0]&&l[0].param;y(s,qe);var f=M.call(this,"b-linked");if(f.length&&f.forEach(function(e,n){ne(e.keyname,function(e){ae(c,{target:null,value:t.unit.getKeyValue(c,qe),action:"set",keyname:c,param:d,origin:De})})}),"b-show"===e)switch(l[0]&&l[0].rule){case"!":o="b-hide";break;default:o="b-show"}else o=e;if(me){var p=t.array.compare(Ve[o],s);!p&&Ve[o].push(s),!p&&ne(s,$e[o].bind(a))}else!Ce&&re(s),ne(s,$e[o].bind(a));t.array.compare(i,s)||i.push(s),Fe=[],we=!1,xe=!0})}),w(i)}catch(e){t.showLog(e)}}function w(e){e.forEach(function(e,t){ae(e,{target:null,action:"init",value:We[e],param:null,keyname:e,origin:De}),Fe=[]})}function x(e){function i(e){var n=e.target.value,i=M.call(this,"b-model"),r=i[0]&&i[0].keyname||"";if(""===r)return t.showLog("b-model的值不能为空"),!1;Y(r,n),Fe=[],e.stopPropagation()}function r(e){try{var n=this,i=this.getAttribute("value")||this.checked,r=this.getAttribute("type"),a=M.call(this,"b-model"),l=a[0].keyname,c=null,u=this.getAttribute("check-value"),s=this.getAttribute("uncheck-value");(u||s)&&(i=this.checked?u:s),c=y(l,qe);var d=/\{.+\}$/g,f=d.test(i),p=f?null:o.find('[type="checkbox"][b-model="'+de+"."+l+'"][value="'+i+'"],\n                [type="radio"][b-model="'+de+"."+l+'"][value="'+i+'"]');switch(r){case"checkbox":this.checked&&(c&&"array"===t.typeof(c)?!t.array.compare(c,i)&&t.unit.getKeyValue(l,qe).push(i):Y(l,i),this.checked=!0),this.checked||(c&&"array"===t.typeof(c)?t.array.remove(t.unit.getKeyValue(l,qe),i):Y(l,i),this.checked=!1),p&&p.each(function(e,t){this.checked=n.checked});break;case"radio":default:Y(l,i)}Fe=[],e.stopPropagation()}catch(e){t.showLog(e)}}function a(e){try{var i=n(this).val(),r=(this.selectedIndex,this.multiple),a=M.call(this,"b-model"),o=a[0].keyname,l=null;switch(l=y(o,qe),r){case!0:"array"!==t.typeof(l)&&t.showLog(o+"的类型必须为数组"),i.splice(0,0,0,i.length+1),l.splice.apply(l,i);break;default:Y(o,i)}Fe=[],e.stopPropagation()}catch(e){t.showLog(e)}}var o=e,l='[type="text"][b-model*='+de+'],\n                                [type="search"][b-model*='+de+'],\n                                [type="password"][b-model*='+de+'],\n                                [type="url"][b-model*='+de+'],\n                                [type="number"][b-model*='+de+'],\n                                [type="email"][b-model*='+de+'],\n                                [type="range"][b-model*='+de+'],\n                                [type="tel"][b-model*='+de+"],\n                                textarea[b-model*="+de+"]";if("input"===ue.modelEvent){var c=!1;o.off("input compositionstart compositionend",l).on(ye,l,function(e){c||i.call(e.target,e)}).on("compositionstart",l,function(e){c=!0,e.stopPropagation()}).on("compositionend",l,function(e){c=!1,i.call(e.target,e),e.stopPropagation()})}else o.off(ye,l).on(ye,l,i);var u='[type="checkbox"][b-model*='+de+'],\n                                [type="radio"][b-model*='+de+"]";o.off("change",u).on("change",u,r);var s="select[b-model*="+de+"]";o.off("change",s).on("change",s,a)}function k(e){e.off("change","[b-checked*="+de+"]").on("change","[b-checked*="+de+"]",function(e){var t=this.checked;Y(M.call(this,"b-checked")[0].keyname,t),Fe=[],e.stopPropagation()})}function O(e){var t=e;t.off("click.bui","[b-click*="+de+"]").on("click.bui","[b-click*="+de+"]",function(e){var t=I.call(this,e,"b-click");if(!1===t)return!1;void 0===t&&e.stopPropagation()}),t.off("touchstart","[b-touchstart*="+de+"]").on("touchstart","[b-touchstart*="+de+"]",function(e){if(!1===I.call(this,e,"b-touchstart"))return!1}),t.off("touchmove","[b-touchmove*="+de+"]").on("touchmove","[b-touchmove*="+de+"]",function(e){if(!1===I.call(this,e,"b-touchmove"))return!1}),t.off("touchend","[b-touchend*="+de+"]").on("touchend","[b-touchend*="+de+"]",function(e){if(!1===I.call(this,e,"b-touchend"))return!1}),t.off("focus","[b-focus*="+de+"]").on("focus","[b-focus*="+de+"]",function(e){if(!1===I.call(this,e,"b-focus"))return!1}),t.off("change","[b-change*="+de+"]").on("change","[b-change*="+de+"]",function(e){if(!1===I.call(this,e,"b-change"))return!1}),t.off("blur","[b-blur*="+de+"]").on("blur","[b-blur*="+de+"]",function(e){if(!1===I.call(this,e,"b-blur"))return!1}),t.off("submit","[b-submit*="+de+"]").on("submit","[b-submit*="+de+"]",function(e){if(!1===I.call(this,e,"b-submit"))return!1})}function I(e,n){var i=M.call(this,n),r=i[0].keyname,a=i[0].param,o=null;a.push(e);try{o=y(r,qe);var l="function"==typeof o&&o.apply(qe,a);return Fe=[],ae(r,{target:this,value:o,action:"set",keyname:r,param:a,origin:De}),l}catch(e){t.showLog(e)}}function j(e){var n=e,i=n.find("[b-template*="+de+"]"),r=[];if(Oe={},i.length)try{i.each(function(e,n){var i=this,a=Ne(i),o=M.call(this,"b-template"),l=o[0].keyname,c=o[0].param,u=de+pe;if(!c[0])return void console.error('b-template 需要传数据源, 格式为: b-template="page.template(page.sources)"');var s="string"==typeof c[0]&&c[0].replace(new RegExp(u),"")||"",d=a.attr("b-command"),f=d||"html",p=a.attr("b-children")||a.children()[0]&&a.children()[0].tagName;y(s,qe);me&&re(s),Oe.hasOwnProperty(s)?Oe[s].push(s):Oe[s]=[s],ne(s,function(e){try{var n,i=e.param;switch(e.action){case"push":case"unshift":n=i;break;case"splice":n=i.slice(2)||"";break;default:n=e.value}if(l in ge){c=c.map(function(e,t){if("string"==typeof e&&0==e.indexOf(de+pe)&&t>0){return y(e.replace(new RegExp(u),""),De)}return e}),c[0]=n;var r=void 0!==n&&"undefined"!==n&&ge[l]&&ge[l].apply(qe,c);void 0===r&&(r="",t.showLog(l+"模板方法需要返回内容，例如：return html;")),me&&(a=Ne('[b-template*="'+(u+s)+'"]'));var o=e.preValue||[];0==o.length&&a.empty();var d=p?a.children(p):a.children(),h=d,g=i&&i.length||0,v=null;switch(Ce=!0,e.action){case"push":if(a.append(r),d=a.children(p),g&&g==d.length)b(d);else if(g>1)for(var m=h.length,w=m;w<d.length;w++)v=d.eq(m+w-1),b(v);else v=d.last(),b(v);break;case"unshift":if(a.prepend(r),d=a.children(p),g&&g==d.length)b(d);else if(g>1)for(var w=0;w<g;w++)v=d.eq(w),b(v);else v=d.first(),b(v);break;case"pop":d.last().remove(),d=a.children(p),v=d.last(),b(v);break;case"shift":d.first().remove(),d=a.children(p),v=d.first(),b(v);break;case"length":break;case"splice":var x=parseInt(i[0]),k=parseInt(i[1]);k>=o.length&&(a.empty(),d=a.children(p));var O=d.length,I=O>0;if(0==k)if(I&&O-1>=x){d.eq(x).before(r),d=a.children(p);for(var w=0;w<n.length;w++)v=d.eq(x+w),b(v)}else{a.append(r),d=a.children(p);for(var w=0;w<n.length;w++)v=d.eq(O+w),b(v)}else if(k>0){if(void 0!==i[2])if(I&&O-1>=x){d.eq(x).before(r),d=a.children(p);for(var w=0;w<n.length;w++)v=d.eq(x+w),b(v)}else{a.append(r),d=a.children(p);for(var w=0;w<n.length;w++)v=d.eq(O+w),b(v)}for(var w=0;w<k;w++)d.eq(x+n.length+w).remove()}break;case"reverse":case"sort":a.html(r);break;default:a[f](r)}ae.call(qe,"nexttick",e)}else t.showLog("找不到对应的模板,请检查下 scope:"+de+" 的templates是否存在"+l,"bui.store")}catch(e){t.showLog(e)}}),t.array.compare(r,s)||r.push(s),Fe=[]}),w(r)}catch(e){t.showLog(e)}}function L(e){var n=E.call(this,e,"b-text"),i="",r=t.typeof(e.value),a=n.attr("b-text"),o=M.call(this,"b-text"),l=(o[0].keyname,o[0].param);switch(r){case"array":i=S(e,a);break;case"function":i=e.value.apply(qe,l);break;default:i=e.value}n.text(i),Fe=[]}function E(e,t){var i=de+pe+e.keyname;return me?n("["+t+'="'+i+'"]'):Ne(this)}function S(e,t){return t.indexOf(".length")>-1?e.value.length||0:e.value instanceof Array?e.value.join(","):e.value}function N(e){var n=E.call(this,e,"b-html"),i="",r=t.typeof(e.value),a=n.attr("b-html"),o=M.call(this,"b-html"),l=(o[0].keyname,o[0].param);switch(r){case"array":i=S(e,a);break;case"function":i=e.value.apply(qe,l);break;default:i=e.value}n.html(i),Fe=[]}function T(e){var t=E.call(this,e,"b-value");me?t.each(function(t,n){P.call(this,e)}):P.call(t[0],e),Fe=[]}function P(e){var n=this.getAttribute("type"),i=this.value,r=this,a=this.getAttribute("b-value");switch(n){case"radio":i==e.value?this.checked=!0:this.checked=!1;break;case"checkbox":"array"===t.typeof(e.value)&&e.value.forEach(function(e,t){i==e&&(r.checked=!0)});break;default:this.value=S(e,a)}}function R(e){var t=E.call(this,e,"b-model");me?t.each(function(t,n){F.call(this,e)}):F.call(t[0],e)}function F(e){var t=this.getAttribute("type"),i=this.value,r=(e.param,this);if("SELECT"===this.nodeName&&this.multiple)return void(e.value.length>1?e.value.forEach(function(e,t){"string"==typeof e?n(r).find("option[value="+e+"]").attr("selected",!0):n(r).find("option[value="+e.value+"]").attr("selected",!0)}):this.value=e.value[0]);switch(t){case"radio":i==e.value?this.checked=!0:this.checked=!1;break;case"checkbox":if(i&&e.value instanceof Array)switch(e.action){case"push":case"unshift":e.param.filter(function(e,t){if(i===e)return void(r.checked=!0)});break;case"pop":case"shift":e.param.filter(function(e,t){i===e&&(r.checked=!1)});break;case"splice":var a=e.param,o=parseInt(a[1]),l=a.slice(2);0==o?l.forEach(function(e,t){i===e&&(r.checked=!0)}):o>0&&(e.preValue.forEach(function(t,n){n<=e.param[1]&&(r.checked=!1)}),e.value.forEach(function(e,t){i===e&&(r.checked=!0)}));break;case"length":break;default:e.value.filter(function(e,t){i==e&&(r.checked=!0)})}else e.value===i?this.checked=!0:this.checked=!1;break;default:this.value=e.value}Fe=[]}function A(e){var t=E.call(this,e,"b-show");e.value?this.removeAttribute("style"):t.css("display","none"),Fe=[]}function C(e){var t="!"+de+pe+e.keyname,i=me?n('[b-show="'+t+'"]'):Ne(this);e.value?i.css("display","none"):i.css("display","block")}function D(e){this.checked=!!e.value,Fe=[]}function z(t){var n=E.call(this,t,"b-bind"),i=this,r=t.keyname,a=t.value;if("object"===(void 0===a?"undefined":e(a))){for(var o in a)!function(e){ne(r+"."+e,function(n){U(E.call(i,t,"b-bind"),e,n.value)}),U(n,e,a[e])}(o)}else{var l="string"==typeof r&&r.split(".");U(n,l[l.length-1],a)}}function U(t,n,i){switch(n){case"disabled":i?t.attr(n,i):t.removeAttr(n);break;case"checked":t.prop(n,i);break;default:var r="object"===(void 0===i?"undefined":e(i))?JSON.stringify(i):i;t.attr(n,r)}Fe=[]}function B(e){var t=E.call(this,e,"b-src");t.attr("src",e.value),Fe=[]}function $(e){var t=E.call(this,e,"b-id");t.attr("id",e.value),Fe=[]}function V(e){var t=E.call(this,e,"b-href");t.attr("href",e.value),Fe=[]}function W(t){var n=E.call(this,t,"b-style"),i=this;if("object"===e(t.value)){for(var r in t.value)!function(e){ne(t.keyname+"."+e,function(n){E.call(i,t,"b-style").css(e,n.value)}),n.css(t.value)}(r)}else n.css(t.keyname,t.value);Fe=[]}function q(n){var i=E.call(this,n,"b-class"),r=this;this.classList;if("object"===e(n.value))if("array"===t.typeof(n.value))i.attr("class",""),n.value.forEach(function(e,t){!i.hasClass(e)&&i.addClass(e)});else{for(var a in n.value)!function(e){var t=n.value[e],a=n.preValue&&n.preValue[e]||"";ne(n.keyname+"."+e,function(t){_(E.call(r,n,"b-class"),e,t.value)}),_(i,e,t,a)}(a)}else{var o="string"==typeof n.keyname&&n.keyname.split(".");_(i,o[o.length-1],n.value,n.preValue)}Fe=[]}function _(e,t,n,i){"boolean"==typeof n?(n&&e.addClass(t),!n&&e.removeClass(t)):"string"==typeof n?(me&&e.removeClass(n),i&&e.removeClass(i),n&&!e.hasClass(n)&&e.addClass(n),""===n&&e.removeClass(i)):(Boolean(n)&&e.addClass(t),!Boolean(n)&&e.removeClass(t))}function M(e){var n=[],i=this,r=this.getAttribute(e)||"",a=r.indexOf("&")>-1?r.split("&"):r&&[r]||[];try{a.forEach(function(t,r){var a={},o=H.call(i,t,e);a.scope=de,a.rule=o.rule,a.keyname=o.name,a.param=o.param,a.eventType=o.eventType,a.eventProperty=o.eventProperty,n.push(a)})}catch(e){t.showLog("参数处理出错")}return n}function H(e,i){try{var r=/([^\(|\)]+)/g,a=e?e.match(r):[],o="",l="",c=null,u=[],s=null,d=this,f="",p=n(d).attr("b-target"),h=p?n(d).parents(p)[0]||d:d,g="",v="";if(c=a[0]&&a[0].indexOf(de+pe)>-1?a[0].split(de+pe):[de,a[0]],f=c[0].split(de),f=f[0]||f[1]||"",o=de,l=c[1]||"",l.indexOf("$index")>-1){var m=n(h).index();l=l.replace("$index",m)}else if(l.indexOf("$id")>-1){var y=h.id;l=l.replace("$id",y)}else if(l.indexOf("$parentIndex")>-1){var b=n(h).parent().index();l=l.replace("$parentIndex",b)}if(void 0!==a[1]){var w=a[1]||"";try{var x=/\{.+\}$/g,k=/\[.+\]$/g,O=/(\"(.*?)\".*?)|(\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14})|(^((https|http|ftp|rtsp|mms)?:\/\/)[^\,]+)|([a-zA-Z0-9][-a-zA-Z0-9\._]{0,62})|(\{.+\})|(\[.+])|([$\w\.]+)|([\d\.]+)|([\u4e00-\u9fa5|\w|\d]+)/g,I=w?w.match(O):[];u=I.map(function(e,r){var a=e.replace(/^\"|\"$/g,""),o=n(h).attr("b-target"),l=o?n(h).parents(o)[0]||h:h;switch(e){case"$this":a=l;break;case"$index":a=n(l).index();break;case"$parentIndex":a=n(l).parent().index();break;case"$parent":a=l.parentNode;break;case"$children":a=n(l).children();break;case"$id":a=l.id;break;case"$text":a=l.textContent;break;case"$value":a=l.value;break;case"$html":a=l.innerHTML}if("b-template"!==i){var c=de+pe;t.unit.startWithStr(a,c)&&(a=t.unit.getKeyValue(a.split(c)[1],qe))}return x.test(e)||k.test(e)?JSON.parse(e):a})}catch(e){t.showLog(e,"getArguments"),u=[]}}void 0!==a[2]&&(s=a[2].indexOf(".")>-1?a[2].split("."):[a[2]],g=s[0],v=s[1]||"")}catch(n){t.showLog("参数格式错误:"+e)}return{scope:o,rule:f,name:l,param:u,eventType:g,eventProperty:v}}function J(e,t){return K(e,t)}function K(e,n){function i(e,n){var i=e[n];if(i instanceof Array?X(i,n):Q(e,n),i&&"object"===t.typeof(i))return J(i)}if(n&&"array"===t.typeof(n))if(n.length>1){var r=n.pop(),a=t.unit.getKeyValue(n.join("."),e);i(a,r)}else i(e,n[0]);else Object.keys(e).forEach(function(t){i(e,t)})}function Q(n,i){var r=n[i],a="function"==typeof r?r.call(qe):r,o=[];Object.defineProperty(n,i,{enumerable:!0,configurable:!0,get:function(e){return Ue&&console.log("3. data getting "+i+":",a),Ee.target=this,(we||!we&&xe)&&Fe.push(i),Se.target&&o.push(Se.target),a},set:function(n){if(n===a)return Fe=[],je=!1,we=!1,xe=!0,!0;Ee.target===this&&(Fe=[]),Ee.target=this,(!xe||!we&&xe)&&Fe.push(i);var r=Fe.join(".");!je&&ae.call(qe,"beforeupdate",{action:"set",value:n,preValue:a,keyname:r,origin:De}),!je&&ue.beforeUpdates.forEach(function(e,t){e.call(qe,{action:"set",value:n,preValue:a,keyname:r,origin:De})}),Ue&&console.log("4. data setting "+r,n);var l=t.unit.getKeyValue(r,De);return a=n,o.forEach(function(e){return e()}),!je&&ae(r,{action:"set",value:a,preValue:l,keyname:r,origin:De}),t.unit.setKeyValue(r,a,De),a instanceof Array?J(se,Fe):"object"===(void 0===a?"undefined":e(a))&&(ue.deep&&J(n),a&&Object.keys(a).forEach(function(e,t){var n=i+"."+e;Fe=[],ae(n,{target:null,value:a[e],preValue:l&&l[e],action:"set",keyname:n,origin:De})})),!je&&ae.call(qe,"updated",{action:"set",value:a,preValue:l,keyname:r,origin:De}),!je&&ue.updateds.forEach(function(e,t){e.call(qe,{action:"set",value:a,preValue:l,keyname:r,origin:De})}),Fe=[],je=!1,we=!1,xe=!0,!0}})}function X(e,n){var i=[],r=Array.prototype,a=Object.create(r);return["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(e){var o=r[e];Object.defineProperty(a,e,{enumerable:!0,configurable:!0,value:function(r){var a=[].concat(Array.prototype.slice.call(arguments));ae.call(qe,"beforeupdate",{target:null,action:e,param:a,value:this,prevValue:[],keyname:n,origin:De}),i.push(n),se.hasOwnProperty(n)||i.unshift(Fe.join("."));var l=i.join("."),c=this.slice(0),u=o.apply(this,a);switch(Ue&&console.log("5. "+l+" action "+e+" "),e){case"pop":case"shift":a=[u]}t.unit.setKeyValue(l,this,De);var s=Te.find('[b-template*="'+de+"."+l+'"]');return ae(l,{target:s,action:e,param:a,value:this,preValue:c,keyname:n,origin:De}),ke[i[0]]&&"array"===t.typeof(ke[i[0]])&&ke[i[0]].forEach(function(e){return e()}),i=[],Fe=[],we=!1,xe=!0,ae.call(qe,"updated",{target:s,action:e,param:a,value:this,preValue:c,keyname:n,origin:De}),ue.updateds.forEach(function(t,i){t.call(qe,{target:s,action:e,param:a,value:this,preValue:c,keyname:n,origin:De})}),u}})}),a.$index=function(e,n){return t.array.index(this,e,n)},a.$include=function(e,n){return t.array.compare(this,e,n)},a.$empty=function(){return t.array.empty(this)},a.$replace=function(e){return t.array.replace(this,e)},a.$merge=function(){var e;return(e=t.array).merge.apply(e,[this].concat(Array.prototype.slice.call(arguments)))},a.$get=function(e,n){return t.array.get(this,e,n)},a.$set=function(e,n,i){return t.array.set(this,e,n,i)},a.$delete=function(e,n){return t.array.delete(this,e,n)},e.__proto__=a,e}function Z(e){if(void 0===e)return De=De;if("string"==typeof e){var n=t.unit.getKeyValue(e,De);return Fe=[],n}return De}function Y(r,a){var o="string"==typeof r,l=[],c=null;if(Fe=[],o&&void 0!==a){var u,s;Ue&&console.log("set "+r+" "),je=!0,ae.call(qe,"beforeupdate",(u={action:"set",target:null,value:c,preValue:d},i(u,"action","set"),i(u,"keyname",r),i(u,"origin",De),u)),ue.beforeUpdates.forEach(function(e,t){var n;e.call(qe,(n={action:"set",target:null,value:c,preValue:d},i(n,"action","set"),i(n,"keyname",r),i(n,"origin",De),n))});var d=t.unit.getKeyValue(r,De);a&&"object"===t.typeof(a)?(c=n.extend(!0,{},a),l.push(r),Object.keys(a).forEach(function(e,t){var n=r+"."+e;ae.call(qe,n,{target:null,value:a[e],preValue:d,action:"set",keyname:n,origin:De})})):c=a,t.unit.setKeyValue(r,a,se),t.unit.setKeyValue(r,c,De),ze[r]=c,ae.call(qe,r,{target:null,value:c,preValue:d,action:"set",keyname:r,origin:De}),ae.call(qe,"updated",(s={action:"set",target:null,value:c,preValue:d},i(s,"action","set"),i(s,"keyname",r),i(s,"origin",De),s)),ue.updateds.forEach(function(e,t){var n;e.call(qe,(n={action:"set",target:null,value:c,preValue:d},i(n,"action","set"),i(n,"keyname",r),i(n,"origin",De),n))}),"object"===(void 0===a?"undefined":e(a))&&(a instanceof Array?J(se,r.split(pe)):J(a)),Fe=[]}else r&&"object"===t.typeof(r)&&(De=n.extend(!0,{},De,r),te(r));return De}function G(e,n){return"string"==typeof e&&(t.unit.delKey(e,De),n&&n.call(qe,e)),De}function ee(e,t){return G(e,function(t){ae(e)}),De}function te(e,n){for(var i in e){var r=void 0===n?i:n+i,a=e[i];ae(r,{target:null,value:a,preValue:De[i]||"undefined",action:"set",param:null,keyname:r,origin:De}),a&&"object"===t.typeof(a)&&te(a,i+".")}}function ne(e,n){var i="";return i=e&&"array"===t.typeof(e)?e.map(function(e,t){return de+pe+e}):de+pe+e,Ee.on.call(qe,i,n),this}function ie(e,t){return Ie.hasOwnProperty(e)?this:(ne(e,t),Ie[e]=t,this)}function re(e,t){if(e){var n=de+pe+e;Ee.off.call(qe,n,t)}else qe.handle={};return this}function ae(e){var t=de+pe+e;return Ue&&console.warn(t,"trigger"),arguments[0]=t,Ee.trigger.apply(qe,arguments),we=!1,xe=!0,this}function oe(){return Fe=[],we=!1,xe=!0,je=!1,this}function le(){return Fe=[],ue.beforeDestroys.forEach(function(e,t){e.call(qe)}),we=!1,xe=!0,je=!1,re(),ue.beforeMounts=[],ue.beforeCompiles=[],ue.compileds=[],ue.mounteds=[],ue.beforeUpdates=[],ue.updateds=[],ue.destroyeds.forEach(function(e,t){e.call(qe)}),this}var ce={el:null,scope:"",data:null,extends:null,mixins:[],beforeMounts:[],beforeCompiles:[],compileds:[],beforeUpdates:[],mounteds:[],updateds:[],beforeDestroys:[],destroyeds:[],computed:null,methods:null,watch:null,templates:null,beforeMount:null,mounted:null,beforeCompile:null,compiled:null,beforeUpdate:null,updated:null,beforeDestroy:null,destroyed:null,isPublic:!1,modelEvent:"input",scopeSplit:".",delayInput:200,needStatic:!1,needCompile:!0,deep:!0,log:!1,autoinit:!0},ue=null;ue=function(e){var i=null,r=e&&e.extends?[e.extends]:[];t.array.merge(ce.mixins,r,e.mixins||[],[e]);var a=n.extend(!0,{},ce,t.config.store);return ce.mixins.forEach(function(e,t){e.beforeMount&&ce.beforeMounts.push(e.beforeMount),e.beforeCompile&&ce.beforeCompiles.push(e.beforeCompile),e.beforeUpdate&&ce.beforeUpdates.push(e.beforeUpdate),e.updated&&ce.updateds.push(e.updated),e.compiled&&ce.compileds.push(e.compiled),e.mounted&&ce.mounteds.push(e.mounted),e.beforeDestroy&&ce.beforeDestroys.push(e.beforeDestroy),e.destroyed&&ce.destroyeds.push(e.destroyed),i=n.extend(!0,a,e)}),i=n.extend(!0,ce,i)}(r);var se=ue.data,de=ue.scope||t.guid(),fe=ue.computed,pe=ue.scopeSplit,he=ue.methods,ge=ue.templates,ve=ue.watch||ce.watch,me=(ue.delayInput,ue.isPublic),ye=ue.modelEvent,be=ue.needStatic,we=!1,xe=!0,ke={},Oe={},Ie={},je=!1,Le={},Ee=t.emitter(),Se={target:null};ue.el?ue.el=ue.el:ue.el=me?"body":".bui-page";var Ne=null,Te=null,Pe=null,Re=null,Fe=[],Ae=!1,Ce=!0,De=se,ze={},Ue=void 0===ue.log?ce.log:ue.log,Be=/b-text|b-html|b-value|b-show|b-hide|b-checked|b-src|b-href|b-bind|b-style|b-class|b-model/gim,$e={"b-text":L,"b-html":N,"b-value":T,"b-show":A,"b-hide":C,"b-checked":D,"b-bind":z,"b-src":B,"b-id":$,"b-href":V,"b-class":q,"b-model":R,"b-style":W},Ve={"b-text":[],"b-html":[],"b-value":[],"b-show":[],"b-hide":[],"b-checked":[],"b-bind":[],"b-src":[],"b-href":[],"b-class":[],"b-model":[],"b-style":[]},We={},qe=(n.extend(!0,{},se,he,ve,fe,ge),{$methods:he,$refs:Le,$options:ue,$templates:ge,config:ue,watch:d,nextTick:u,oneTick:s,get:Z,set:Y,delete:ee,del:ee,observer:J,compile:g,$mount:g,compileHtml:m,clearKey:oe,destroy:le,init:a,on:ne,off:re,one:ie,trigger:ae});try{ue.autoinit&&a()}catch(e){t.showLog(e)}return qe}}(window.bui||{},window.libs),function(e,t){function n(n,i){function r(t){var n=i||750,r=document.head.parentNode,a=t||(h/n*100).toFixed(2);return s=a||48,e.config.viewport.zoom&&(r.style.fontSize=s+"px"),e.trigger.call(e,"viewportinit"),this}function a(e){return h||t("body").width()||t("#bui-router").width()||t(".bui-page").width()}function o(e){return g||t("body").height()||t("#bui-router").height()||t(".bui-page").height()}function l(e){return v}function c(e){return m}function u(e){return p}e.trigger.call(e,"viewportbefore");var s,d=document.querySelector("meta[name=viewport]"),f="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no",p=window.devicePixelRatio,h=document.documentElement.clientWidth,g=document.documentElement.clientHeight,v=parseInt(h)*parseInt(p),m=parseInt(g)*parseInt(p);if(d)e.config.viewport.create&&(d.content=f);else{var y=document.createElement("meta");y.name="viewport",y.content=f;var b=document.head;e.config.viewport.create&&b.appendChild(y),y=null}var w=[240,320,360,375,384,412,414,435,480,512,540,768,1024,1536,2048,2732,534,854,750],x=[32,42.67,48,50,51.2,54.93,55.2,58,64,68.27,60,60,60,60,60,60,60,60,60],k=e.array.index(w,document.documentElement.clientWidth);return k>-1&&void 0===n?s=x[k]:r(n),{width:a,height:o,fontSize:s,screenWidth:l,screenHeight:c,ratio:u,init:r}}e.viewport=n}(window.bui||{},window.libs),function(t,n){t.loader=function(i){function r(e){return e=e||{},
T=n.extend({},T,e),this}function o(t){if(void 0===t)return A;if("object"===(void 0===t?"undefined":e(t))&&("modules"in t||"baseUrl"in t))A=n.extend(!0,{},A,t),C=A.modules;else if("object"===(void 0===t?"undefined":e(t))&&"moduleName"in t){var i=s(t);C[t.moduleName]=i||{},A=n.extend(!1,A,{modules:C}),C=A.modules}return A}function l(e){if("string"==typeof e)return A.modules[e]||null}function c(e,n){return n&&"object"===t.typeof(n)&&(n.moduleName=e,o(n)),this}function u(e,t){var n=e,i=t.lastIndexOf("/"),r=t.substr(0,i);return e.indexOf("../")>-1?(e=e.replace(/\..\//g,function(e){var t=r.lastIndexOf("/");return r=r.substr(0,t),""}),n=r?r+"/"+e:e):e.indexOf("./")>-1&&(n=r+"/"+e.replace(/\.\//g,"")),n}function s(e){var t={id:"",moduleName:"",template:"",data:null,depend:[],script:"",style:[],isDefined:!1,isLoaded:!1,beforeCreate:null,created:null,beforeLoad:null,loaded:null,show:null,beforeDestroy:null,destroyed:null,exports:{},dependExports:[]},i={};return e.moduleName in C&&(i=C[e.moduleName]),n.extend(!0,{},t,i,e)}function d(e){T.log&&console.log("destroy "+e);var i="string"==typeof e?C[e]:null;if(i){i.beforeDestroy&&i.beforeDestroy.call(i);var r=n('script[name="'+e+'"]').attr("src");P=t.array.remove(P,r),n('script[name="'+e+'"]').remove(),delete A.modules[e],C=A.modules,i.destroyed&&i.destroyed.call(i)}}function f(e,i,r){var a={moduleName:"",template:"",data:null,depend:[],beforeCreate:null,created:null,beforeLoad:null,loaded:null,hide:null,show:null,beforeDestroy:null,destroyed:null},l={},c="";try{var s=h().name?h():p(),d=s.name}catch(e){}var f=[],v=[];if(void 0===e)return t.showLog("define第1个参数不能为空"),this;"function"==typeof e?(r=e,c=d,i=[]):"object"===t.typeof(e)?(c=d,i=e.depend||[],r=e.loaded,l=n.extend(!0,{},a,e)):"array"===t.typeof(e)?(r=i,i=e,c=d):"function"==typeof i?(c=e,r=i,i=[]):(c=e,i=i,r=r);var m=c in C?C[c].script||s.src:s.src;if(T.log&&console.log("define "+c),i.length)for(var y=0;y<i.length;y++){var b=i[y],w=b.indexOf("./")>-1?u(b,m):b;if(w.indexOf(".css")>-1)w.indexOf("css!")>-1?v.push(w.substr(4)):v.push(w);else{var x=w.indexOf(".js");x>-1&&(w=w.substr(0,x)),f.push(w),w in C||o({moduleName:w})}}if("string"==typeof c&&"function"==typeof r){var k=function(){var e=[g,C[d]&&C[d].exports,C[d]],t=[];f.length&&f.forEach(function(e,n){C[e]&&t.push(C[e].exports)});var n=t.concat(e);return r&&r.apply(this,n)};l=e&&"object"===t.typeof(e)?n.extend(!0,{},a,C[c],e):n.extend(!0,{},a,C[c]),l.moduleName=c,l.depend=f,l.style=v,l.script=m,l.loaded=k,o(l)}else t.showLog("define "+c+"模块的参数格式不对");return this}function p(e){var t=window.location.pathname,n=t.indexOf(".html"),i="",r="";return n>-1?(i=t.substr(0,n),r=i+".js"):(i=t,r=i+".js"),{name:i,src:r}}function h(){var e,t,i=window.location.href,r=[],o=document.currentScript;if(i.indexOf("#")>-1?r=i.split("#"):r.push(i),S=r[0].replace("/index.html","")+"/",o)return e=o.src.replace(S,""),t=o.getAttribute("name")||e.substr("0",e.indexOf(T.scriptSuffix)),{name:t,src:e};try{a()}catch(e){var l=e.stack||e.sourceURL||e.stacktrace||"",c=l.split(/[@ ]/g).pop(),u=c.replace(/(:\d+)?:\d+$/i,""),u=u.replace(new RegExp(S,"g"),"");return o=n('script[src="'+u+'"]')[0],t=o?o.getAttribute("name"):u.replace(T.scriptSuffix,""),{name:t,src:u}}}function g(e,n){T.log&&console.log("require "+e);if(e&&"string"==typeof e){var i=e.indexOf(".css");if(i>-1)return void w(e);var i=e.indexOf(".html");e=i>-1?e.substr(0,i):e,e=[e]}if(n&&"function"!=typeof n)return t.showLog("require第2个参数格式为function","bui.loader.require"),this;try{e=e.map(function(e,n){return t.unit.resolvePath(e)}),v(e,n)}catch(e){t.showLog(e,"bui.loader.require")}return this}function v(e,n){function i(e,n){function a(t,r){var a=C[t];a&&(a.isDefined=!0),a&&a.beforeLoad&&a.beforeLoad.call(a,a.depend),a&&a.depend&&a.depend.length&&i(a.depend,n),r==e.length-1&&n&&n.apply(a)}e=e||[],C=A.modules;e.length>1&&e.forEach(function(t,n){C[t]&&1==C[t].isLoaded&&e.splice(n,1)}),e.forEach(function(i,o){var l=C[i];if(C[i]&&C[i].style&&C[i]&&C[i].style.length&&O(C[i].style),t.array.compare(r,i)||r.unshift(i),l&&l.isLoaded)o==e.length-1&&(n&&n.apply(l),r=[]);else if(l&&l.loaded){var c=C[i].beforeCreate&&C[i].beforeCreate.call(C[i]);if(!1===c)return!1;C[i].created&&C[i].created.call(C[i]),a(i,o)}else k(i,function(){var e=C[i];if(!1===(e&&e.beforeCreate&&e.beforeCreate.call(C[i])))return!1;e&&e.style&&e.style.length&&O(e.style),e&&e.created&&e.created.call(C[i]),a(i,o)},function(){o==e.length-1&&(n&&n.apply(null),r=[])})})}var r=[];i(e,function(){if(y(r)){var t=[];e.forEach(function(i,r){m(i),t.push(C[i]&&C[i].exports),r===e.length-1&&n&&n.apply(D,t||[])})}})}function m(e){C=A.modules;var n="string"==typeof e?C[e]||{}:e,i=n.depend||[],r=null,a=[];n.dependExports=[];try{if(i.length)for(var o=0;o<i.length;o++){var l=i[o],c=C[l];c.isLoaded?a[o]=c.exports:a[o]=m(c)||c.exports,c.exports=a[o],n.dependExports.push(a[o]),c.isLoaded=!0}r=n.isLoaded?n.exports:n.loaded&&n.loaded.apply(n,a),n.exports=r||C[n.moduleName]&&C[n.moduleName].exports,n.isLoaded=!0,T.log&&console.log("execute "+n.moduleName)}catch(e){t.showLog(e,"bui.loader.execute")}return r}function y(e){var t=!0,n=e||[];if(C=A.modules,n.length)n.forEach(function(e,n){C[e]&&!1===C[e].isDefined&&(t=!1)});else for(var i in C)C[i]&&!1===C[i].isDefined&&(t=!1);return t}function b(e){var n=!0,i=[];if(C=A.modules,"string"==typeof e){e.indexOf(",")>-1?i=e.split(","):i.push(e)}else e&&"array"===t.typeof(e)&&(i=e||[]);if(i.length)i.forEach(function(e,t){e in C||(n=!1),C[e]&&!1===C[e].isLoaded&&(n=!1)});else for(var r in C)C[r]&&!1===C[r].isLoaded&&(n=!1);return n}function w(e,n,i){return"string"==typeof e?(e=t.unit.resolvePath(e),e.indexOf(".css")>-1?(I(e),n&&n(e)):e.indexOf(".html")>-1||e.indexOf(".htm")>-1?x(e,n,i):k(e,n,i)):e&&"array"===t.typeof(e)&&e.forEach(function(r,a){r=t.unit.resolvePath(r),r.indexOf(".css")>-1?(I(r),a==e.length-1&&n&&n(e)):r.indexOf(".html")>-1||r.indexOf(".htm")>-1?x(r,n,i):a==e.length-1?k(r,n,i):k(r)}),this}function x(e,i,r){var a="function"==typeof i;if(F.hasOwnProperty(e))return a?i&&i.call(D,F[e],200):"string"==typeof i&&t.$(i).html(F[e]),this;"string"==typeof e&&n.ajax({url:e,dataType:"html",success:function(n,o,l){l.url=e,F[e]=n,a?i&&i.call(D,n,o,l):"string"==typeof i&&(t.$(i).html(n),r&&r.call(D,n,o,l))},error:function(e,t,n){a&&r&&r.call(D,e,t,n)}})}function k(e,i,r){var a,o=this;if(C=A.modules,void 0===e||""==e)return r&&r.call(o,e),this;if(e in C)a=e,e=C[e].script||a+T.scriptSuffix;else{var l=e.indexOf(T.scriptSuffix);l>-1?(e=e,a=e.substr(0,l)):(a=e,e+=T.scriptSuffix)}var c=document.createElement("script")||{},u=T.cache?"":"?t="+(new Date).getTime(),s=e.indexOf("http://")>-1||e.indexOf("https://")>-1;c.type="text/javascript",c.src=s?e+u:A.baseUrl+e+u,c.setAttribute("name",a),c.onload=function(){T.log&&console.log("create "+e),i&&i(e)},c.onerror=function(t){T.log&&console.log("createError "+e),r&&r(e)};var d=t.array.index(P,e),f=n('script[name="'+a+'"]').length||n('script[src="'+e+'"]').length;return d>-1||f?i&&i(e):d<0&&(document.body&&document.body.appendChild(c),T.cache&&P.push(e)),c=null,this}function O(e){var n,i=e.length;if("array"===t.typeof(e))for(n=0;n<i;n++){var r=e[n];I(r)}else I(e)}function I(e){if("string"!=typeof e)return void t.showLog(e+"的格式不正确");if(t.array.index(R,e)<0){var n=document.createElement("link")||{};n.href=e+(T.cache?"":"?t="+(new Date).getTime()),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),document.head&&document.head.appendChild(n),n=null,R.push(e)}}function j(e,n){return t.on.apply(D,arguments),this}function L(e,n){return t.off.apply(D,arguments),this}function E(e){D.self=this==window||this==D?null:this,t.trigger.apply(D,arguments)}var S,N={cache:!0,log:!1,scriptSuffix:".js"},T=n.extend({},N,t.config.loader,i),P=[],R=[],F={},A={baseUrl:"",modules:{}},C={},D={init:r,define:f,require:g,destroy:d,map:o,import:w,checkLoad:b,get:l,set:c,on:j,off:L,trigger:E};return D}}(window.bui||{},window.libs),function(e,t){e.toggle=function(n){function i(t){if(t=t||m,b=!1,!t.id)return void e.showLog("toggle id不能为空","bui.toggle");x=e.objId(t.id),m=v.config=t,g=x.attr("class")||"";var n=t.effect,i=t.inOrder?e.array.index(w.hideInOrder,n):e.array.index(w.hide,n),r=n&&(e.array.index(w.show,n)>-1?e.array.index(w.show,n):i);return I=!(x[0]&&"none"==x[0].style.display||"none"==x.css("display")),r<0?(h=w.show[0],p=t.inOrder?w.hideInOrder[0]:w.hide[0]):(h=w.show[r],p=t.inOrder?w.hideInOrder[r]:w.hide[r]),this}function r(){return I}function a(t,n){if(!b)return x=e.objId(m.id),!(!k&&!O)&&(k=!1,"function"==typeof t?(t=t,n=n||h||""):(n=t||h||"",t=null),x[0]&&"none"==x[0].style.display&&x.css("display",y),x.addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n?(m.revert&&x.removeClass("animated "+n),t&&t.call(v,this),I=!0,k=!0):x.one("webkitAnimationEnd",function(){try{!I&&x.css("display",y),m.revert&&x.removeClass("animated "+n),t&&t.call(v,this),I=!0,k=!0}catch(t){e.showLog(t,"toggle show method")}}),this)}function o(t,n){if(!b&&(x=e.objId(m.id),k||O))return O=!1,"function"==typeof t?(t=t,n=n||p||""):(n=t||p||"",t=null),x.css("display",y).addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n?(x.css("display","none"),m.revert&&x.removeClass("animated "+n),t&&t.call(v,this),I=!1,O=!0):x.one("webkitAnimationEnd",function(){try{x.css("display","none"),m.revert&&x.removeClass("animated "+n),t&&t.call(v,this),I=!1,O=!0}catch(t){e.showLog(t,"toggle hide method")}}),this}function l(){return x.remove(),this}function c(e){var e=1==e;x&&(x.off(),e&&x.remove()),b=!0}function u(t){var n={};return e.widget.call(n,t)}function s(t,n){return e.option.call(v,t,n)}var d={id:"",effect:"fadeIn",useBox:!1,revert:!0,inOrder:!1};if("string"==typeof n){var f=n||"";n={},n.id=f}var p,h,g,v={show:a,hide:o,remove:l,isShow:r,destroy:c,widget:u,option:s,config:m,init:i},m=v.config=t.extend(!0,{},d,n),y=m.useBox?"-webkit-box":"block",b=!1,w={show:["fadeIn","fadeInLeft","fadeInRight","fadeInDown","fadeInUp","fadeInLeftBig","fadeInRightBig","fadeInUpBig","fadeInDownBig","zoomIn","bounceIn","rotateIn","rollIn","flipInX","flipInY","lightSpeedIn","showIn","slideInRight","slideInLeft","coverInLeft","coverInRight","zoomSlideInLeft","zoomSlideInRight","pushInLeft","pushInRight"],hide:["fadeOut","fadeOutLeft","fadeOutRight","fadeOutUp","fadeOutDown","fadeOutLeftBig","fadeOutRightBig","fadeOutDownBig","fadeOutUpBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutRight","slideOutLeft","coverOutLeft","coverOutRight","zoomSlideOutLeft","zoomSlideOutRight","pushOutLeft","pushOutRight"],hideInOrder:["fadeOut","fadeOutRight","fadeOutLeft","fadeOutDown","fadeOutUp","fadeOutRightBig","fadeOutLeftBig","fadeOutUpBig","fadeOutDownBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutLeft","slideOutRight","coverOutRight","coverOutLeft","zoomSlideOutRight","zoomSlideOutLeft","pushOutRight","pushOutLeft"]},x=null,k=!0,O=!0,I=!1;return m.id&&i(m),v}}(window.bui||{},window.libs),function(t,n){t.router=function(i){function r(e){if(be.store=e.store||null,delete e.store,e=n.extend(!0,{},q,t.config.router,e),q=be.config=e,t.hasRouter=!0,me=!0,"pages/main/main.html"===e.indexModule.template&&"pages/main/main.js"===e.indexModule.script||(he=loader.map(e.indexModule)),te&&"effect"in e&&ae.forEach(function(t,n){t.effect=e.effect}),!e.id)return t.showLog("id 不能为空","bui.router.init"),!1;if(B=t.objId(e.id),V=bui.mask({appendTo:B,opacity:0,autoClose:!1}),$=t.loading({display:"block",width:30,height:30,opacity:0}),H=B.children(".bui-router-main"),X=e.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",Z=e.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",!H.length){var i=E(e);B.html(i),H=B.children(".bui-router-main")}return(e.width>0||String(e.width).indexOf("%")>-1)&&H.width(e.width),(e.height>0||String(e.height).indexOf("%")>-1)&&H.height(e.height),Q||l(e),A.call(this,"init",{target:B[0]}),be}function a(e){var e=e||{};return e.width=e.width||q.width,e.height=e.height||q.height,window.viewport=bui.viewport(),X=e.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",Z=e.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",H.css({width:X,height:Z}),A.call(this,"resize",{target:ae[ae.length-1]}),this}function o(){var e=ve.get("hasCache",0);Boolean(e)&&q.reloadCache?fe.load():c(),se=!0}function l(e){return o(),window.addEventListener("beforeunload",function(e){q.reloadCache&&fe.save(),A.call(M,"beforeunload",{target:ae[ae.length-1]})}),e.hash?(window.addEventListener("hashchange",function(e){var n=u(),i=""==n.pid||"undefined"==n.pid?"main":n.pid,r=t.array.index(ae,i,"pid");r>-1?(g({index:-(ae.length-r-1)}),A.call(M,"popstate",{type:"back",prevTarget:ae[r-1],target:ae[r]})):(d({url:i,param:n.param,replace:!0}),A.call(M,"popstate",{type:"load",prevTarget:ae[ae.length-2],target:ae[ae.length-1]}))}),this):(q.syncHistory&&"pushState"in window.history&&window.addEventListener("popstate",function(e){var n=u(),i=""==n.pid?q.indexModule.moduleName:n.pid,r=m(i);t.array.index(ae,i,"pid")>-1?(g({index:r,param:n.param}),A.call(M,"popstate",{type:"back",prevTarget:ae[r-1],target:ae[r]})):(d({url:i,param:n.param}),A.call(M,"popstate",{type:"load",prevTarget:ae[ae.length-2],target:ae[ae.length-1]}))}),this)}function c(e){try{var n=u();if(n.pid){if(n.pid.indexOf("http://")>-1||n.pid.indexOf("https://")>-1)return void d({url:n.pid,param:n.param,iframe:!0});d({url:n.pid,param:n.param})}else d({url:q.indexModule.moduleName,param:n.param||{}})}catch(e){t.showLog(e,"bui.router.loadUrl")}}function u(e){function t(t,n){for(var i=t&&t.substr(n+1),r=i&&i.split("&"),a=0;a<r.length;a++){var o=e?decodeURIComponent(r[a].split("=")[1]):r[a].split("=")[1];s[r[a].split("=")[0]]=o}}var n=window.location.hash||window.location.search,i=window.location.search,r=i&&i.indexOf("?"),e=0!=e,a=n&&n.indexOf("?"),o=a>-1?n&&n.substr(1,a-1):window.location.hash.substr(1),l=o&&o.indexOf(q.pageSuffix),c=l>-1?o.substr(0,l):o,u=l>-1?o:o+q.pageSuffix,s={};return a>-1&&(t(i,r),t(n,a)),{pid:c,url:u,param:s}}function s(e){var i=n.Deferred(),r=function(n,r){return y(n.url,function(i){var a=t.guid(),o=h(n.url),l=o.pid,c=(N({id:a,content:i,pid:l}),[]);fe.add(l,{id:a,pid:l,template:i}),c.push(l),n.style&&"array"===t.typeof(n.style)?n.style.forEach(function(e,t){c.push(e)}):n.style&&"string"===t.typeof(n.style)&&c.push(n.style),n.script&&"array"===t.typeof(n.script)?n.script.forEach(function(e,t){c.push(e)}):n.script&&"string"===t.typeof(n.script)&&c.push(n.script),loader.import(c,function(){A.call(be,"preloadafter",{prevTarget:null,target:null}),r&&r(e)},function(){A.call(be,"preloadafter",{prevTarget:null,target:null}),r&&r(e)})},function(e){t.showLog(n.url+"请求失败"),i.reject(n.url)}),i.promise()};return e&&"object"===t.typeof(e)?"url"in e&&r(e,function(){i.resolve(e)}):e&&"array"===t.typeof(e)&&e.forEach(function(t,n){n==e.length-1?"url"in t&&r(t,function(){i.resolve(e)}):"url"in t&&r(t)}),i}function d(e){function i(e){V&&V.hide(),d.progress&&$&&$.hide(),oe.removeLast(),q.syncHistory&&window.history.back(),f.reject(e)}function r(e){ee||O in re?(c({pid:O}),ue&&o(),e&&e()):(loader.checkLoad(O)?(c({pid:O}),e&&e()):loader.require(O,function(n){try{if(d.firstAnimate&&d.progress&&$&&$.hide(),re[O]=n||null,f.resolve(n),Y||d.firstAnimate||d.replace){var i=loader.get(O);i&&i.show&&i.show({type:"firstload",target:E})}e&&e()}catch(e){t.showLog(e,"bui.router.load"),f.reject()}}),d.callback&&d.callback({prevTarget:g,target:E}),d.loaded&&d.loaded({prevTarget:g,target:E}),A.call(be,"complete",{prevTarget:g,target:E}))}function a(){_=t.objId(C.id);var e=_&&_.find(".bui-page");e&&e.length&&d.autoInit&&t.init({id:e,height:Z})}function o(e){_=t.objId(b),j(),L();try{if(Y||ee||d.replace||d.part){!d.firstAnimate&&d.progress&&$&&$.hide(),e&&e(),V&&V.hide(),_&&_.css("zIndex",5);var n=oe.getLast(),i="pageshow-"+n.pid;A.call(be,"pageshow",{type:"load",target:oe.getLast()}),A.call(be,i,{type:"load",target:oe.getLast()})}else J&&J.hide(),K&&K.show(function(){!d.firstAnimate&&d.progress&&$&&$.hide(),e&&e(),_&&_.css("zIndex",5),V&&V.hide();var t=ae[ae.length-2]||{},n=oe.getLast(),i=loader.get(n.pid),r=t&&t.pid&&loader.get(t.pid)||null,a="pageshow-"+n.pid,o="pagehide-"+t.pid;A.call(be,o,{type:"load",target:ae[ae.length-2]}),A.call(be,a,{type:"load",target:oe.getLast()}),A.call(be,"pagehide",{type:"load",target:ae[ae.length-2]}),A.call(be,"pageshow",{type:"load",target:oe.getLast()}),r&&r.hide&&r.hide({type:"load",target:ae[ae.length-2]}),i&&i.show&&i.show({type:"load",target:oe.getLast()})})}catch(e){t.showLog(e,"bui.router.doAnimate")}}function l(e){var n="";if(be.store&&(e=be.store.compileHtml(e)),d.part)n=T({content:e}),d.id?w.html(n):t.showLog("id 不能为空","router.loadPart");else if(d.replace){var i=oe.getLast();w=ae.length?t.objId(i.id):H,i.pid=O,i.url=I,i.param=v;t.array.index(ae,O,"pid");n=O in le?fe.get(O,"template"):T({content:e}),w.html(n).attr("data-page",O)}else ee||(n=N({id:b,content:e,pid:O}),H&&H.attr("data-main",b).append(n));return n}function c(e){var t=e||oe.getLast(),n=ge[t.pid]&&ge[t.pid]||{},i=n.loaded,r=i&&i.apply(n,n.dependExports)||n.exports;re[t.pid]=r||null,n.exports=r,ee=!1,Y=!1,A.call(be,"refresh",{prevTarget:g,target:t}),V&&V.hide(),q.progress&&$&&$.hide(),f.resolve(r)}function u(){var e=ae[ae.length-2]||null,t=oe.getLast();Y&&!d.part&&(A.call(be,"firstload",{prevTarget:e,target:t}),Y=!1),d.part?A.call(be,"loadpart",{prevTarget:e,target:t}):A.call(be,"load",{prevTarget:e,target:t})}var s={id:"",url:"",param:{},effect:"",command:"html",path:q.path,firstAnimate:q.firstAnimate,progress:q.progress,reload:q.reload,autoInit:q.autoInit,replace:!1,iframe:!1,decode:!1,part:!1,cache:q.cache,callback:null,beforeLoad:q.beforeLoad,loaded:q.loaded},d=n.extend(!0,{},s,e),f=n.Deferred(),g=oe.getLast()||null;ae[ae.length-2];d.url.indexOf("./")>-1&&(d.url=p(d.url,g)),d.path&&(d.path="/"==d.path[d.path.length-1]?d.path:d.path+"/"),d.url=d.url in ge||d.iframe||d.url.indexOf("http:")>-1?d.url:d.path+d.url,document.activeElement.blur();var v=null,m={};d.id=(d.id&&d.id.indexOf("#")>-1?d.id.substr(1):d.id)||"";var b=d.replace?g.id:d.id||t.guid(),w=t.objId(b);if(!d.url)return t.showLog("url 不能为空","bui.router.load"),f.promise();if(d.url=d.decode?decodeURIComponent(d.url):d.url,d.url.indexOf("tel:")>=0||d.url.indexOf("mailto:")>=0||d.url.indexOf("sms:")>=0)return t.unit.openExtral(d.url),f.promise();if(d.url&&d.url.indexOf("?")>-1){var x=d.url.split("?");m=t.unit.keyStringToObject(x[1]),d.url=x[0]}v=n.extend(!0,{},m,d.param),"undefined"==d.url&&(d.url="main"),d.iframe=Boolean(d.iframe);var k=h(d.url),O=k.pid,I=d.iframe?d.url:k.url,E={id:b,pid:O,url:"function"==typeof I?d.url:I,replace:d.replace,param:v,part:{},effect:e.effect||q.effect};ne=d.part?g:E;var P="function"==typeof d.beforeLoad?d.beforeLoad.call(be,{prevTarget:g,target:E}):d.beforeLoad;if(A.call(be,"loadbefore",{prevTarget:g,target:E}),A.call(be,"beforeload",{prevTarget:g,target:E}),!1===P)return Y=!1,this;V&&V.show(),d.progress&&$&&$.show(),loader.map({moduleName:O,id:b});var R=loader.get(E.pid);if(R&&R.beforeLoad&&R.beforeLoad(),ae.length&&d.effect){var F=ae.length-1;ae[F].effect=d.effect}!ee&&!d.part&&!d.replace&&oe.add(E),d.replace&&oe.replace(E);var C=oe.getLast();if(d.part&&(C.part&&(C.part[b]={id:b,pid:O,url:I,param:v}),C.currentPart=b,C.part&&ae.splice(ae.length-1,1,C)),d.part||(de=E),O in le)!function(e){l(fe.get(e.pid,"template")),e.part?c(e):(a(),!ee&&o(function(){e.progress&&$&&$.hide()}),c(e))}({pid:O,progress:d.progress,part:d.part}),d.callback&&d.callback({prevTarget:g,target:E}),d.loaded&&d.loaded({prevTarget:g,target:E}),A.call(be,"complete",{prevTarget:g,target:E});else{if(d.iframe)return function(e){var t=S({id:e.id,pid:e.pid,url:e.url,param:e.param});H&&H.attr("data-main",e.id).append(t),o(function(){d.progress&&$&&$.hide()})}({id:b,pid:O,url:d.url,param:v}),f.promise();if(d.part)return function(){y(I,function(e,n,i){t.objId(b)[d.command](e),r(u),d.cache&&fe.add(O,{id:b,pid:O,template:e}),V&&V.hide(),d.progress&&$&&$.hide()},function(e,t,n){i(I),A.call(be,"loadfail",e,t,n)})}(),f.promise();!function(){y(I,function(e,t,n){if(l(e),d.cache&&fe.add(O,{id:b,pid:O,template:e}),a(),d.firstAnimate)return void o(function(){r(u),d.progress&&$&&$.hide(),pe.add(O,{id:b,pid:O,param:v})});o(function(){d.progress&&$&&$.hide()}),r(u),pe.add(O,{id:b,pid:O,param:v})},function(e,t,n){i(I),A.call(be,"loadfail",e,t,n)})}()}return f.promise()}function f(e){var t={id:"",url:"",command:"html",param:{},part:!0};return d(n.extend(!0,{},t,e)).promise()}function p(e,t){var n=e,i=t.url.lastIndexOf("/"),r=t.url.substr(0,i);return e.indexOf("../")>-1?(e=e.replace(/\..\//g,function(e){var t=r.lastIndexOf("/");return r=r.substr(0,t),""}),n=r?r+"/"+e:e):e.indexOf("./")>-1&&(n=r+"/"+e.replace(/\.\//g,"")),n}function h(e){var t="",n=e;he=loader.map(),ge=he.modules;var i=n.indexOf(q.pageSuffix);return i>-1?(t=n,n=t.substr(0,i),ge.hasOwnProperty(n)&&(t=ge[n]&&ge[n].template||t||"")):(n=n,t=ge[n]&&ge[n].template||n+q.pageSuffix||""),{pid:n,url:t}}function g(e){var i=this,r={};"function"==typeof e?r.callback=e:r=e||{};var a=n.extend(!0,{index:-1,name:"",beforeBack:q.beforeBack,callback:null,loaded:q.loaded},r),o=parseInt(a.index),l=ae.length;if(he=loader.map(),ge=he.modules,o>0)return void t.showLog("index 参数只能是负数","bui.router.back");var c=oe.getLast(),u=l-1,s="function"==typeof a.beforeBack?a.beforeBack.call(be,{prevTarget:null,target:c}):r.beforeBack;A.call(be,"beforeback",{prevTarget:null,target:c});var d=loader.get(c.pid);return d&&d.beforeDestroy&&d.beforeDestroy(),!1===s?this:(a.name&&(o=m(a.name)),Math.abs(o)>u&&(o=-u),l>1&&G&&(o<-1&&L(o),G=!1,r.effect&&(J.option({effect:r.effect}),K.option({effect:r.effect})),J&&J.show(),K&&K.hide(function(){var e=l+o;I(e),oe.removeNext(e),L();var n=j(),r=n.pid;t.objId(n.id).css("zIndex",5),function(){var e={};e=re[r]||{};var t=loader.get(n.pid);a.callback&&a.callback.call(i,e,n),a.backed&&a.backed.call(be,{prevTarget:c,target:n}),A.call(be,"back",{prevTarget:c,target:n}),de=n;var o="pageshow-"+n.pid,l="pagehide-"+c.pid;d&&d.hide&&d.hide({type:"back",target:c}),t&&t.show&&t.show({type:"back",target:n}),A.call(be,l,{type:"back",target:c}),A.call(be,o,{type:"back",target:n}),A.call(be,"pageshow",{type:"back",target:n}),A.call(be,"pagehide",{type:"back",target:c}),d&&d.destroyed&&d.destroyed(),G=!0}()})),this)}function v(e){return"string"==typeof e&&"main"!==e?(loader.destroy(e),fe.del(e),e in re&&delete re[e]):t.showLog("参数只能是字符串"),this}function m(e){var n,i=t.array.indexs(ae,e,"pid"),r=i.length;if(r){var a=-(ae.length-i[r-1]-1);n=0==a?-1:a}else n=-1;return n}function y(e,i,r){if("string"==typeof e){var a=null;e.indexOf(".js")>-1&&(a=loader.get(de.pid))&&a.beforeCreate&&a.beforeCreate(),n.ajax({url:e,dataType:"html",async:q.async,success:function(t,n,r){r.url=e,""===t&&A.call(be,"fail",t,n,r),i&&i(t,n,r),A.call(be,"success",t,n,r),a&&a.created&&a.created()},error:function(e,t,n){r&&r(e,t,n),A.call(be,"fail",e,t,n)}})}else if("function"==typeof e){var o=e&&e();i&&i(o,200,{}),A.call(be,"success",o,200,{})}else t.showLog("url 不能为空","bui.router.requestUrl")}function b(){ee=!0;var e=ae.length-1,t=ae[e];return d({id:t.id,url:t.pid,param:t.param}),this}function w(e){return e=e||{},d({url:e.url||"",param:e.param||{},replace:!0}),this}function x(){return oe.getLast().param}function k(e){var t=oe.getLast(),n=e||t.currentPart,i=null,r=n in t.part?t.part[n]:{};return"param"in r&&(i=r.param),i}function O(e){var t;return e&&(t=e in re),t}function I(e){H.children().each(function(t,i){t>=e&&n(i).remove()})}function j(){var e=oe.getLast(),n=e.id||"",i=e.effect||q.effect;return n&&(A.call(be,"beforepageshow",{target:e}),K=null,K=t.toggle({id:document.getElementById(n),effect:ie[i].inRight||""}),H&&H.attr("data-main",n)),e}function L(e){e=e||-1;var n=ae.length+e-1,i=ae[n],r=i&&i.id||"",a=i&&i.effect||q.effect;return r&&(A.call(be,"beforepagehide",{target:i}),J=null,J=t.toggle({id:document.getElementById(r),effect:ie[a].inLeft||""})),i}function E(e){e=e||{};var t="";String(X).indexOf("%"),String(Z).indexOf("%");return t+='<div class="bui-router-main">',t+="</div>"}function S(e){var n=e.param?t.setUrlParams(e.url,e.param):e.url,i="";return i+='<div id="'+e.id+'" class="bui-router-item" data-page="'+e.pid+'">',i+='<iframe class="bui-router-iframe" src="'+n+'"></iframe>',i+="</div>"}function N(e){var t="";return t+='<div id="'+e.id+'" class="bui-router-item" data-page="'+e.pid+'">',t+=e.content||"",t+="</div>"}function T(e){var t="";return t+=e.content}function P(e,n){return te=!0,t.option.call(be,e,n)}function R(e,n){return t.on.apply(be,arguments),this}function F(e,n){return t.off.apply(be,arguments),this}function A(e){be.self=this==window||this==be?null:this,t.trigger.apply(be,arguments)}function C(){return oe.getLast()}function D(){var e=oe.getLast();return document.getElementById(e.id)}function z(e){return oe.getLast().id}function U(i){var r=oe.getLast(),a=t.objId(r.id),o="object"===(void 0===i?"undefined":e(i))?n(i):a.find(".bui-page");return o.length&&t.init({id:o,height:Z}),this}var B,$,V,W={id:"",progress:!1,syncHistory:!0,autoInit:!0,firstAnimate:!1,path:"",indexModule:{moduleName:"main",template:"pages/main/main.html",script:"pages/main/main.js"},hash:!1,cache:!0,reloadCache:!1,reload:!1,useScroll:".bui-scroll-x",beforeBack:null,beforeLoad:null,loaded:null,store:null,width:0,height:0,async:!0,effect:"push",hashPrefix:"#",scriptSuffix:".js",pageSuffix:".html"},q=n.extend({},W,t.config.router,i),_=null,M=this,H=null,J=null,K=null,Q=!1,X="",Z="",Y=!0,G=!0,ee=!1,te=!1,ne=null,ie={none:{inRight:"showIn",inLeft:"showIn"},fadein:{inRight:"fadeIn",inLeft:"fadeIn"},fadeinslide:{inRight:"fadeInRight",inLeft:"fadeInLeft"},slide:{inRight:"slideInRight",inLeft:"slideInLeft"},push:{inRight:"pushInRight",inLeft:"pushInLeft"},zoom:{inRight:"zoomIn",inLeft:"zoomIn"},cover:{inRight:"coverInRight",inLeft:"coverInLeft"},zoomslide:{inRight:"zoomSlideInRight",inLeft:"zoomSlideInLeft"},fadeinslideback:{inRight:"fadeInLeft",inLeft:"fadeInRight"},slideback:{inRight:"slideInLeft",inLeft:"slideInRight"},pushback:{inRight:"pushInLeft",inLeft:"pushInRight"},coverback:{inRight:"coverInLeft",inLeft:"coverInRight"},zoomslideback:{inRight:"zoomSlideInLeft",inLeft:"zoomSlideInRight"}},re={},ae=[],oe={},le={},ce={},ue=!1,se=!1,de={},fe={},pe={},he=loader.map(q.indexModule),ge=he.modules,ve=t.storage({local:!1}),me=!1;oe.get=function(){return ae},oe.add=function(e){e=e||{};var n=window.location.origin+window.location.pathname+"#"+e.pid,i=t.setUrlParams(n,e.param);return ae.push(e),Y?void(q.syncHistory&&"replaceState"in window.history&&window.history.replaceState(e,null,i)):(q.syncHistory&&"pushState"in window.history&&window.history.pushState(e,null,i),ae)},oe.prepend=function(e){e=e||{};var n=window.location.origin+window.location.pathname+"#"+e.pid;t.setUrlParams(n,e.param);return ae.unshift(e),ae},oe.replace=function(e){e=e||{};var n=ae.length-1,i=window.location.origin+window.location.pathname+"#"+e.pid,r=t.setUrlParams(i,e.param);return n>-1&&(ae.splice(n,1,e),q.syncHistory&&"replaceState"in window.history&&window.history.replaceState(e,null,r)),ae},oe.getLast=function(e){var t=ae.length-1,n=ae[t]||{};return e?n[e]:n},oe.removeNext=function(e){var n=ae.length-e;ae.splice(e,n);var i=oe.getLast(),r=window.location.origin+window.location.pathname+"#"+i.pid,a=t.setUrlParams(r,i.param);q.syncHistory&&"replaceState"in window.history&&window.history.replaceState(i.param,null,a)},oe.removeLast=function(){var e=ae.length-1;oe.removeNext(e)},oe.checkLoad=function(e){return t.array.compare(ae,e,"pid")||t.array.compare(ae,e,"url")||t.array.compare(ae,e,"id")},fe.add=function(e,t){return le[e]=t||{},le[e]},fe.del=function(e){delete le[e]},fe.get=function(e,t){if(t){return(le[e]||{})[t]}return le[e]},fe.save=function(){if(ae.length>1){var e=B.html();ve.set("cacheHtml",e),ve.set("cacheHistory",ae),ve.set("hasCache","true")}},fe.load=function(){var e=ve.get("cacheHtml",0),n=ve.get("cacheHistory",0),i=[];if(n.length>1){B.html(e),H=B.children(".bui-router-main");g({name:u().pid});try{n.forEach(function(e,t){var n="string"==typeof e?JSON.parse(e):e;i.push(n)});var r=i[i.length-1];de=r,loader.require(r.pid,function(e){re[r.pid]=e||null}),R("back",function(e){loader.require(e.target.pid,function(t){re[e.target.pid]=t||null})})}catch(e){t.showLog(e)}ae=i,j(),L(),Y=!1,ue=!0,fe.clear()}},fe.clear=function(){ve.remove("cacheHistory"),ve.remove("cacheHtml"),ve.remove("hasCache")},pe.add=function(e,t){return ce[e]=t||{},ce[e]},pe.get=function(e,t){if(t){return(ce[e]||{})[t]}return ce[e]};var ye=function(e){var n=oe.getLast(),i=document.getElementById(n.id)||document;return t.obj(e,i)},be={init:r,option:P,config:q,data:{},on:R,off:F,trigger:A,load:d,resize:a,destroy:v,loadPart:f,replace:w,refresh:b,back:g,isLoad:O,$:ye,currentId:z,currentPage:D,currentModule:C,getPageParams:x,getPartParams:k,getHistory:oe.get,preload:s,initScroll:U,history:{get:oe.get,check:oe.checkLoad,getLast:oe.getLast}};return be}}(window.bui||{},window.libs),function(i,r){var a=function(){function a(e){t(this,a),this._default={log:!1,hasLife:!0,onBeforeInit:null,onInited:null},this._plugin=e||{name:"",depend:null,config:null,param:null,callback:null};var n=i.config.hasOwnProperty(this._plugin.name)?i.config[this._plugin.name]:null;this.config=r.extend(!0,{},this._default,n,this._plugin.config,this._plugin.param),this.initStatus=!1,this.reinitStatus=!1,this.widgets=Object.create(null),this.init()}return n(a,[{key:"widget",value:function(e){return e&&e in this.widgets?this.widgets[e]:this.widgets}},{key:"init",value:function(e){var t=this,n=e||null;t.config=r.extend(!0,this.config,n);var i=t.config,a=i.hasLife&&i.onBeforeInit&&i.onBeforeInit.call(t,i);return i.log&&console.log(t._plugin.name+" before init"),!1===a?t:(t._plugin.callback&&t._plugin.callback.call(t,i),i.log&&console.log(t._plugin.name+" init"),i.hasLife&&i.onInited&&i.onInited.call(t,i),i.log&&console.log(t._plugin.name+" after inited"),this.initStatus=!0,t)}},{key:"reinit",value:function(){return this.destroy(),this.init(),this.config.log&&console.log(this._plugin.name+" reinit"),this}},{key:"destroy",value:function(e){return this.beforeDestroy&&this.beforeDestroy(),this.beforeDestroy=null,this.widgets={},this.off(),this.initStatus=!1,e&&e.call(this),this.config.log&&console.log(this._plugin.name+" destroyed"),this}},{key:"prefix",value:function(e){return i.config.classNamePrefix+e}},{key:"showLog",value:function(t,n){n=n||"";var r="";return"object"==(void 0===t?"undefined":e(t))&&"message"in t&&"name"in t?r=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(r=t),i.log&&console.error(n+" "+r),i.trace&&console.trace&&console.trace(),this}},{key:"option",value:function(e,t){if("object"!==i.typeof(e)&&void 0===t)return"string"==typeof e?this.config[e]:this.config;var n=this;if("id"==e)return i.showLog("不允许修改控件的ID参数"),this;if(e&&"object"===i.typeof(e)){var a=r.extend(this.config,e);return n&&n.init(a)}if(this.config.hasOwnProperty(e)){var o={};o[e]=t;var l=r.extend(this.config,o);return n&&n.init(l)}return this}},{key:"emitter",get:function(){return i.emitter()}},{key:"on",get:function(){return this.emitter.on}},{key:"off",get:function(){return this.emitter.off}},{key:"trigger",get:function(){return this.emitter.trigger}}]),a}();i.extend=function(e){var r=function(){function r(e){t(this,r),this.init(e)}return n(r,[{key:"init",value:function(t){var n=t.name;return this.checkName(n)?(i[n]=function(t){return e.param=t,new a(e)},this):this}},{key:"checkName",value:function(e){return e?!i.hasOwnProperty(e)||(console.warn("已有相同名为"+e+"的插件或方法,请重新换个名称注册."),!1):(console.warn("插件名字不能为空"),!1)}}]),r}();new r(e)}}(window.bui||{},window.libs),function(t,n){t.setUrlParams=function(n,i,r){
var r=0!=r,i="object"==(void 0===i?"undefined":e(i))?i:{},a=t.unit.objectToKeyString(i,r);return""==a?n:n+"?"+a},t.getUrlParams=function(e){var e=0!=e,n=window.location.search,i={};if(n.indexOf("?")>-1){var r=n.substr(1);i=t.unit.keyStringToObject(r,e)}return i},t.getUrlParam=function(e){var t=window.location.search,n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),i=t.substr(1).match(n);return null!=i?decodeURIComponent(i[2]):null},t.typeof=function(e){var t=Object.prototype.toString.call(e).slice(8,-1);return t=t.toLowerCase()},t.setting=function(n,i){return"string"==typeof n&&"object"===(void 0===i?"undefined":e(i))?t.config[n]=i:"string"==typeof n&&void 0===i?t.config[n]:t.config}}(window.bui||{},window.libs),function(e,t){e.array={},e.array.index=e.inArray=function(e,t,n){var i,r;e instanceof Array?(i=e||[],r=t):(i=t||[],r=e);for(var a=0;a<i.length;a++){var o=i[a];if((o&&o[n]||o)==r)return parseInt(a)}return-1},e.array.compare=e.compareArray=function(e,t,n){var i,r;e instanceof Array?(i=e||[],r=t):(i=t||[],r=e);for(var a=0;a<i.length;a++){var o=i[a];if((o&&o[n]||o)==r)return!0}return!1},e.array.remove=e.removeArray=function(t,n,i){function r(e){l.forEach(function(t,n){try{("string"==typeof i||"number"==typeof i?t[i]||t:t)==e&&l.splice(n,1)}catch(e){}})}var a,o;t instanceof Array?(a=t||[],o=n):(a=n||[],o=t||[]);var l=a||[];return o&&"array"===e.typeof(o)?o.forEach(function(e,t){r("string"==typeof i||"number"==typeof i?e[i]||e:e)}):r(o),l},e.array.filter=e.filterArray=function(e,t,n){var i,r;e instanceof Array?(i=e||[],r=t):(i=t||[],r=e);var a=[];for(var o in i)try{var l=i[o]&&i[o][n]||i[o];new RegExp(r).test(l)&&a.push(i[o])}catch(e){}return a},e.array.indexs=e.indexArray=function(e,t,n){var i,r;e instanceof Array?(i=e||[],r=t):(i=t||[],r=e);var a=[];for(var o in i)try{(i[o]&&i[o][n]||i[o])===r&&a.push(+o)}catch(e){}return a},e.array.excess=e.excessArray=function(e,t,n){var i;e instanceof Array?i=e||[]:i=t||[];var r={},a=[];for(var o in i)try{var l=i[o]&&i[o][n]||i[o];r[l]!=l&&(r[l]=l,a.push(i[o]))}catch(e){}return a},e.array.uniq=function(t,n){for(var i=[],r=0;r<t.length;r++){var a=void 0===n,o=a?t[r]:t[r][n]||t[r];(a?-1==e.array.index(i,o,n):-1==i.indexOf(o))&&i.push(o)}return i},e.array.copy=e.copyArray=function(t,n,i){var r=[];if(n=n||0,i=i||t&&t.length,!t||"array"===e.typeof(t)){t.forEach(function(e,t){r.push(e)});return r.splice(n,i)||[]}},e.array.empty=function(t){if(!t||"array"===e.typeof(t))return t.splice(0,t.length)},e.array.replace=function(t,n){if(!(t&&"array"!==e.typeof(t)||n&&"array"!==e.typeof(n))){var i=[0,t.length].concat(n);return t.splice.apply(t,i)}},e.array.merge=function(t){var n;if(!t||"array"===e.typeof(t)){var i=arguments,a=i.length-1,o=i[a];if("string"==typeof o&&i.length>1){for(var l,c=a,u=[],s=0;s<c;s++)!function(e){var n=Array.prototype.slice.call(i[e],0);t.forEach(function(e,t){var i=e[o]||e;n instanceof Array&&n.forEach(function(t,r){var a=t[o]||t;if(i===a){for(var l in t)e[l]=t[l];n.splice(r,1)}})}),u.push(n)}(s);return(l=e.array).merge.apply(l,[t].concat(u))}var d=(n=[t.length,0]).concat.apply(n,r(Array.prototype.slice.call(arguments,1)));return t.splice.apply(t,d),t}},e.array.get=function(t,n,i){if(!t||"array"===e.typeof(t)){for(var r,a=null,o=0;o<t.length;o++){a=t[o];(a&&a[i]||a)==n&&(r=a)}return r}},e.array.getAll=function(e,t,n){var e=e||[],i=[],r=null;for(var a in e)try{r=e[a];var o=r&&r[n]||r;t&&t instanceof Array?t.forEach(function(e,t){o==e&&i.push(r)}):o==t&&i.push(r)}catch(e){}return i},e.array.set=function(t,n,i,r){if(!t||"array"===e.typeof(t)){for(var a=/\d/.test(n),o=0;o<t.length;o++){var l=t[o],c=void 0===r?l:l[r]||l;if(a?o===n:c===n){if(r){if(i&&"object"==e.typeof(i))for(var u in i)l[u]=i[u];else l[r]=i;t.splice(o,1,l)}else t.splice(o,1,i);return t}}return t}},e.array.setAll=function(t,n,i,r){if(!t||"array"===e.typeof(t))return t.filter(function(a,o){var l=void 0===r?a:a[r]||a;if(o==n||l===n)if(r){if(i&&"object"==e.typeof(i))for(var c in i)a[c]=i[c];else a[r]=i;t.splice(o,1,a)}else t.splice(o,1,i)}),t},e.array.delete=function(t,n,i){function r(e){t.forEach(function(n,r){try{("string"==typeof i||"number"==typeof i?n[i]||n:n)!=e&&r!=e||t.splice(r,1)}catch(e){}})}if(!t||"array"===e.typeof(t)){var a=e.array.indexs(t,n,i);return n&&"array"===e.typeof(n)?n.forEach(function(e,t){r("string"==typeof i||"number"==typeof i?e[i]||e:e)}):r(n),a}}}(window.bui||{},window.libs),function(t,n){t.storage=function(n){function i(e,n,i){e=s+e;var r=1==c?null:h.getItem(e),a=[],o="",l=i?n[i]:n;if(null===r){a.push(n),o=JSON.stringify(a);try{h.setItem(e,o)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{var u=JSON.parse(r);if(i?t.array.compare(u,l,i):t.array.compare(u,l)){t.array.remove(u,l,i),u[p](n);try{o=JSON.stringify(u),h.setItem(e,o)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{u[p](n),u.length>c&&0!=c&&u.pop();try{o=JSON.stringify(u),h.setItem(e,o)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}}return this}function r(e,n,i){e=s+e;var r,a=h.getItem(e)||"";try{r=d?a&&t.unit.stringToJson(a):a&&JSON.parse(a)}catch(e){r=a,t.showLog(e.name+": "+e.message,"bui.storage.get")}if("number"==typeof n&&i)r=r&&r[n]&&r[n][i]||void 0;else if("string"==typeof n){var o=t.array.index(r,n,i);r=r&&r[o]}else r="number"==typeof n?r&&r[n]||void 0:r;return r}function a(e,n,i){if("string"!=typeof(e=s+e))return void t.showLog("要删除的字段名只能是字符串","bui.storage.remove");var a=r(e)||[];if("number"==typeof n){var o="number"==typeof i?i:o;a.splice(n,o);try{var l=JSON.stringify(a)||"";h.setItem(e,l)}catch(e){t.showLog(e.name+": "+e.message,"bui.storage.remove")}}else if("string"==typeof n){var c=t.array.remove(a,n,i);try{var l=JSON.stringify(c)||"";h.setItem(e,l)}catch(e){t.showLog(e.name+": "+e.message,"bui.storage.remove")}}else h.removeItem(e);return this}function o(){if(s)for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);0===t.indexOf(s)&&h.removeItem(t)}else h.clear();return this}function l(e){for(var t={},n=parseInt(e)||0,i=0;i<localStorage.length;i++){var r=localStorage.key(i);r.substr(s.length);if(s&&0===r.indexOf(s))try{var a=JSON.parse(h.getItem(r));t[r]=void 0!==e?a[n]:a}catch(e){t[r]=h.getItem(r)}if(""===s)try{t[r]=JSON.parse(h.getItem(r))}catch(e){t[r]=h.getItem(r)}}return t}var c=1,u=!0,s="",d=!1,f=!0;"number"==typeof n||"string"==typeof n?c=0==parseInt(n)?0:parseInt(n)||1:"object"===(void 0===n?"undefined":e(n))&&(c=n&&0==n.size?0:n.size||1,f=!n||0!=n.local,u=!n||0!=n.reverse,d=!(!n||1!=n.deep),s=n.prefix||"");var p=u?"push":"unshift",h=f?localStorage:sessionStorage;return{get:r,getAll:l,set:i,remove:a,clear:o}}}(window.bui||{},window.libs),function(t,n){t.unit={},t.unit.remToPx=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100,e=(parseFloat(e)*t).toFixed(2);return e},t.unit.pxToRem=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100,e=(parseFloat(e)/t).toFixed(2);return e},t.unit.pxToRemZoom=function(e){var e=(parseFloat(e)/100).toFixed(2);return e},t.unit.debounce=function(e,t,n){var i;return function(){var r=n||this,a=arguments,o=function(){i=null,e.apply(r,a)};clearTimeout(i),i=setTimeout(o,t)}},t.unit.throttle=function(e,t,n){t||(t=250);var i,r;return function(){var a=n||this,o=+new Date,l=arguments;i&&o<i+t?(clearTimeout(r),r=setTimeout(function(){i=o,e.apply(a,l)},t)):(i=o,e.apply(a,l))}},t.unit.startWithCss=function(e){var t=new RegExp("^\\.|^#");return"string"==typeof e&&t.test(e)},t.unit.startWithStr=function(e,t){var n=new RegExp("^"+t);return"string"==typeof e&&n.test(e)},t.unit.startWithId=function(e){var t=new RegExp("^#");return"string"==typeof e&&t.test(e)},t.unit.startWithClass=function(e){var t=new RegExp("^\\.");return"string"==typeof e&&t.test(e)},t.unit.endWithImage=function(e){var t=new RegExp("(.png|.jpg|.gif)$");return"string"==typeof e&&t.test(e)},t.unit.tel=function(e){var n,e=String(e),i="tel:";return 0==e.indexOf("+")&&(i="wtai://wp/mc;"),n=e,window.location.href=i+n,t},t.unit.sms=function(e,n){var i=navigator.userAgent,r=/(iPhone|iPad|iOS)/i.test(i),a=r?"&":"?";return window.location.href="sms:"+e+a+"body="+n,t},t.unit.mailto=function(e){var e="email"in e?e:{};return"string"==typeof e.email&&e.email.indexOf("@")>0?window.location.href="mailto:"+e.email+"?subject="+(e.subject||"")+"&body="+(e.body||"")+"&cc="+(e.cc||""):t.showLog(email+"格式不正确"),t},t.unit.openExtral=function(e){var n=[],i="",e=String(e);if(e.indexOf("mailto:")>=0)if(n=e.split("mailto:"),i=n[1],i.indexOf("?")>-1){var r=i.split("?"),a=t.unit.keyStringToObject(r[1]);a.email=r[0],t.unit.mailto(a)}else t.unit.mailto({email:i});if(e.indexOf("tel:")>=0&&(n=e.split("tel:"),i=parseInt(n[1]),t.unit.tel(i)),e.indexOf("sms:")>=0)if(n=e.split("sms:"),i=n[1],e.indexOf("=")>=0){var o=e.split("="),l=o[1];t.unit.sms(i,l)}else t.unit.sms(i);return t},t.unit.objectToKeyString=function(e,t){var n="";for(var i in e){n+="&"+i+"="+(t?encodeURIComponent(e[i]):e[i])}return n.substr(1)},t.unit.keyStringToObject=function(e,n){var i,r={},a=[];try{for(a=e.split("&"),i=0;i<a.length;i++){var o=n?decodeURIComponent(a[i].split("=")[1]):a[i].split("=")[1];r[a[i].split("=")[0]]=o}}catch(e){t.showLog(e)}return r},t.unit.checkTargetInclude=function(e,t){var i=t,r=[];if(i.indexOf(",")>-1){r=i.split(",");var a,o=r.length;for(a=0;a<o;a++){var l=r[a];l.indexOf(".")>-1&&(r[a]=l.substr(1))}}else i.indexOf(".")>-1?r[0]=i.substr(1):r[0]=i;var c,u=r.length;for(c=0;c<u;c++)if(n(e).hasClass(r[c]))return!0;return!1},t.unit.jsonToString=function(n){function i(n){if(n&&"object"===t.typeof(n)){for(var i in n){var r=n[i];"object"===(void 0===r?"undefined":e(r))&&(n[i]=JSON.stringify(r))}return n}}function r(n){if(n&&"array"===t.typeof(n))return n.forEach(function(t,i){"object"===(void 0===t?"undefined":e(t))&&(n[i]=JSON.stringify(t))}),n}return"object"===(void 0===n?"undefined":e(n))?function(e){function n(e,n){var a=e[n];return a&&"object"===t.typeof(a)?e[n]=i(a):a&&"array"===t.typeof(a)?e[n]=r(a):e[n]=a,e[n]}var a;if("object"===t.typeof(e)){for(var o in e)e[o]=n(e,o);a=JSON.stringify(e)}else"array"===t.typeof(e)?(e.forEach(function(t,i){e[i]=n(e,i)}),a=JSON.stringify(e)):a=e;return a}(n):n},t.unit.stringToJson=function(n){function i(n){var r,a;try{if(r="object"===(void 0===n?"undefined":e(n))?n:JSON.parse(n),"array"===t.typeof(r))r.forEach(function(e,t){r[t]=i(e)});else if("object"===t.typeof(r))for(var o in r){var l=r[o];r[o]=i(l)}a=r}catch(e){a=n}return a}return n&&i(n)},t.unit.setKeyValue=function(e,t,n){function i(e,n){if(r.length)return i(r.shift(),n[e]||{});n[e]=t}var r=e&&e.indexOf(".")>-1?e.split("."):[e];return i(r.shift(),n)},t.unit.getKeyValue=function(e,t){function n(e,t){var r=t[e];if(r&&"string"==typeof r&&r.indexOf("{")>-1&&r.indexOf("}")>-1)try{t[e]=JSON.parse(r)}catch(n){t[e]=r}return void 0!==r&&i.length?n(i.shift(),r):r}var i=e&&e.indexOf(".")>-1?e.split("."):[e];return n(i.shift(),t)},t.unit.getKeyObj=function(e,t){function n(e,t){var r=t[e];return!r instanceof Array&&r instanceof Object?n(i.shift(),r):r}var i=e&&e.indexOf(".")>-1?e.split("."):[e];return n(i.shift(),t)},t.unit.delKey=function(e,t){function n(e,r){return i.length?n(i.shift(),r[e]):(delete r[e],t)}var i=e&&e.indexOf(".")>-1?e.split("."):[e];return n(i.shift(),t)},t.unit.calcHeight=function(e,t){var i=n(e);i[0]&&(i[0].style.height="calc(100% - "+t+")")},t.unit.resolvePath=function(e){if(!t.hasRouter)return e;var n=e,i=router&&router.history&&router.history.getLast()||{url:n},r=i.url.lastIndexOf("/"),a=i.url.substr(0,r);return e.indexOf("../")>-1?(e=e.replace(/\..\//g,function(e){var t=a.lastIndexOf("/");return a=a.substr(0,t),""}),n=a?a+"/"+e:e):e.indexOf("./")>-1&&(n=a+"/"+e.replace(/\.\//g,"")),n},t.unit.filterField=function(n,i){var r={};if("object"===(void 0===i?"undefined":e(i))){var a="object"===t.typeof(n),o="object"===t.typeof(i),l="array"===t.typeof(n),c="array"===t.typeof(i);if(a){if(o)for(var u in i)r[u]=i[u]?n[i[u]]:n[u];else c&&i.forEach(function(e,t){r[e]=n[e]});return r}return l?(r=[],c?n.forEach(function(e,t){var n={};i.forEach(function(t,i){n[t]=e[t]}),r.push(n)}):o&&n.forEach(function(e,t){var n={};for(var a in i)n[a]=i[a]?e[i[a]]:e[a];r.push(n)}),r):void 0}}}(window.bui||{},window.libs),function(e,t){e.platform=function(){function e(e){return/Windows NT/i.test(u)}function t(){return/Macintosh/i.test(u)}function n(e){return/(Android|Linux)/i.test(u)}function i(e){return/(iPhone)/i.test(u)}function r(e){var t=!1;return 3==window.devicePixelRatio&&375==document.documentElement.clientWidth&&812==document.documentElement.clientHeight&&(t=!0),t}function a(e){return/(iPad)/i.test(u)}function o(e){return/(iPhone|iPad|iOS)/i.test(u)}function l(e){return/(micromessenger)/i.test(u)}function c(e){return/(crosswalk)/i.test(u)}var u=navigator.userAgent;return{isAndroid:n,isIphone:i,isIpad:a,isIos:o,isWeiXin:l,isBingotouch:c,isMac:t,isIphoneX:r,isWindow:e}}()}(window.bui||{},window.libs),function(t,n){t.ajax=function(i){function r(e){var t=function(t,n,i){var r=null;if("string"==typeof t&&"json"==e.dataType)try{r=JSON.parse(t)}catch(e){r=t}else r=t||{};r=e.transformResponse?e.transformResponse.call(a,r)||r:r,u&&u(r,n,i),a.resolve(r,n,i)},i=function(t,n,i){var r;if("string"==typeof t&&"json"==e.dataType)try{r=JSON.parse(t)}catch(e){r=t}else r=t||{};s&&s(r,n,i),a.reject(r,n,i)};e.success=t,e.error=i;var r=e.type&&e.type.toUpperCase();e.type=r||e.method.toUpperCase(),o=n.ajax(e)}var a=n.Deferred(),o=null,l={baseUrl:"",data:{},method:"GET",dataType:"json",timeout:6e4,headers:{},processData:!0,mimeType:"none",cache:!1,async:!0,needJsonString:!1,contentType:null,localData:null,transformRequest:null,transformResponse:null,native:!0,needNative:!1},c=n.extend(!0,{},l,t.config.ajax,i),u=c.success,s=c.fail||c.error;null===c.contentType&&"GET"==c.method?c.contentType="text/html;charset=UTF-8":null===c.contentType&&"POST"==c.method?c.contentType="application/x-www-form-urlencoded":c.contentType=c.contentType;"object"===(void 0===i?"undefined":e(i))&&void 0!==i.needNative?i.needNative:t.isWebapp;if(c.needJsonString)try{c.data="object"===e(c.data)?JSON.stringify(c.data):c.data}catch(e){c.data=c.data}if(c.data=c.transformRequest?c.transformRequest.call(a,c.data)||c.data:c.data,!c.url)return t.showLog("url不能为空","bui.ajax"),a;if(c.url.indexOf("://")>-1?c.url=c.url:c.url=c.baseUrl+c.url,c.proxy){var d=c.url.indexOf(c.proxy),f=d>-1?d+1:-1;c.url=c.url.substr(f)}if(a.abort=function(){o&&o.abort()},c.localData)return c.localData=c.transformResponse?c.transformResponse.call(a,c.localData)||c.localData:c.localData,u&&u(c.localData,200),a.resolve(c.localData,200),a;if(c.needNative){if(void 0===t.native.ajax)return r(c),a;a=t.native.ajax&&t.native.ajax(c)||a}else r(c);return a},t.get=function(e,i,r){var a={};a.method="GET",a.url=e,a.data=i||{};var o=null,l=r&&r[0];return o=r&&"array"===t.typeof(r)&&"object"==t.typeof(l)?n.extend(!0,{},t.config.get,a,l):a,bui.ajax(o)},t.post=function(i,r,a){var o={};o.method="POST",o.contentType="application/x-www-form-urlencoded",o.url=i,o.data=r||{};var l=null,c=a&&a[0];return l=a&&"array"===t.typeof(a)&&"object"==t.typeof(c)?n.extend(!0,{},t.config.post,o,c):o,l.contentType.indexOf("application/json")>-1&&(l.data="object"===e(l.data)?JSON.stringify(l.data):l.data),bui.ajax(l)},t.put=function(i,r,a){var o={};o.method="PUT",o.contentType="application/json",o.url=i,o.data=r||{};var l=null,c=a&&a[0];return l=a&&"array"===t.typeof(a)&&"object"==t.typeof(c)?n.extend(!0,{},t.config.put,o,c):o,l.contentType.indexOf("application/json")>-1&&(l.data="object"===e(l.data)?JSON.stringify(l.data):l.data),bui.ajax(l)},t.delete=function(i,r,a){var o={};o.method="DELETE",o.contentType="application/json",o.url=i,o.data=r||{};var l=null,c=a&&a[0];return l=a&&"array"===t.typeof(a)&&"object"==t.typeof(c)?n.extend(!0,{},t.config.delete,o,c):o,l.contentType.indexOf("application/json")>-1&&(l.data="object"===e(l.data)?JSON.stringify(l.data):l.data),bui.ajax(l)},t.all=function(e){var i=null;return i=e&&"array"===t.typeof(e)?e:Array.prototype.slice.apply(arguments),n.when.apply(null,i)}}(window.bui||{},window.libs),function(e,t){e.load=function(n){var i,r={url:"",param:{},reload:!1,replace:!1,native:!0,needNative:!1},a=t.extend(!0,{},r,e.config.load,n),o={},l=a.url;if(!a.url)return void e.showLog("url 不能为空!","bui.load:web");if(document.activeElement.blur(),l.indexOf("tel:")>=0||l.indexOf("mailto:")>=0||l.indexOf("sms:")>=0)return void e.unit.openExtral(l);if(l&&l.indexOf("?")>-1){var c=l.split("?");o=e.unit.keyStringToObject(c[1]),a.url=c[0]}try{var u="string"==typeof a.param&&JSON.parse(a.param)||a.param||{};a.param=t.extend(!0,{},o,u)}catch(t){return void e.showLog("param 参数值必须是一个{}对象","bui.load:web")}if(n&&n.needNative)return void(e.native.load&&e.native.load(a));if(i=e.setUrlParams(a.url,a.param),a.reload&&e.isWebapp)return void(window.location.href=i);if(a.reload&&!e.isWebapp)return void(e.native.load&&e.native.load(a));if(a.replace&&!("load"in window.router))return void window.location.replace(i);if("load"in window.router)window.router.load(a);else if(a.native&&e.isWebapp||!a.native&&!e.isWebapp)window.location.href=i;else{if(void 0===e.native.load)return void(window.location.href=i);e.native.load&&e.native.load(a)}}}(window.bui||{},window.libs),function(t,n){t.getPageParams=function(i){var r=n.Deferred(),a={callback:null,native:!0,needNative:!1};i=i||{};var o=n.extend(!0,{},a,t.config.getPageParams);"function"==typeof i?o.callback=i:i&&"object"===t.typeof(i)&&(o=n.extend(!0,{},a,t.config.getPageParams,i));"object"===(void 0===i?"undefined":e(i))&&void 0!==i.needNative?i.needNative:t.isWebapp;if(i&&i.needNative)return r=t.native.getPageParams&&t.native.getPageParams(o)||r;if("getPageParams"in window.router){var l=window.router.getPageParams&&window.router.getPageParams()||t.getUrlParams();o.callback&&o.callback(l),r.resolve(l)}else if(o.native&&t.isWebapp||!o.native&&!t.isWebapp){var c=t.getUrlParams();o.callback&&o.callback(c),r.resolve(c)}else{if(void 0===t.native.getPageParams){var c=t.getUrlParams();return o.callback&&o.callback(c),r.resolve(c),r}r=t.native.getPageParams&&t.native.getPageParams(o)||r}return r}}(window.bui||{},window.libs),function(t,n){t.back=function(i){function r(){if(window.history.go(a.index),f)try{clearTimeout(f)}catch(e){}a.delay&&a.callback?f=setTimeout(function(){if(t.hasRouter){var e=router.history.getLast(),n=loader.map().modules[e.pid].exports;a.callback.call(router,n)}else a.callback()},500):a.callback&&a.callback()}var a,o={index:-1,name:"",delay:!0,native:!0,beforeBack:!0,callback:null};"function"==typeof i?(o.callback=i,a=n.extend(!0,{},o,t.config.back)):a=i&&"object"===t.typeof(i)?n.extend(!0,{},o,t.config.back,i):n.extend(!0,{},o,t.config.back);var l=("object"===(void 0===i?"undefined":e(i))&&void 0!==i.needNative?i.needNative:t.isWebapp,t.hasRouter?router.history&&router.history.getLast()||null:null);if(!1!==("function"==typeof a.beforeBack?a.beforeBack.call(this,{prevTarget:null,target:l}):a.beforeBack)){if(i&&i.needNative)return void(t.native.back&&t.native.back(a));if("back"in window.router)if(window.router.config.syncHistory){var c=router.history.get(),u=c.length-1;if(a.name){var s=t.array.indexs(c,a.name,"pid"),d=s.length;a.index=d?-(c.length-s[d-1]-1):-1}if(Math.abs(a.index)>=c.length&&(a.index=-u),Math.abs(a.index)>=window.history.length&&window.router.config.hash&&(a.index=window.router.config.reloadCache?-u:-(window.history.length-1)),0==a.index&&(a.index=-1),window.router.config.hash&&!window.router.config.reloadCache)return void r();c.length>1&&r()}else window.router.back&&window.router.back(a);else if(a.native&&t.isWebapp||!a.native&&!t.isWebapp)r();else{if(void 0===t.native.back)return void r();t.native.back&&t.native.back(a)}var f}}}(window.bui||{},window.libs),function(e,t){e.refresh=function(n){var i={native:!0,needNative:!1},r=t.extend(!0,{},i,e.config.refresh,n);if(n&&n.needNative)return void(e.native.refresh&&e.native.refresh());if("refresh"in window.router)window.router.refresh();else if(r.native&&e.isWebapp||!r.native&&!e.isWebapp)window.location.reload(!0);else{if(void 0===e.native.refresh)return void window.location.reload(!0);e.native.refresh&&e.native.refresh()}}}(window.bui||{},window.libs),function(t,n){t.run=function(i){var r={},a={id:"",name:"",data:null,onFail:null,native:!0,needNative:!0};"string"==typeof i?r.id=i:i&&"object"===t.typeof(i)&&(r=n.extend(!0,{},a,t.config.run,i));var o=String(r.id);"object"===(void 0===i?"undefined":e(i))&&void 0!==i.needNative?i.needNative:t.isWebapp;if(i.needNative)t.native.run&&t.native.run(r);else if(o.indexOf("http://")>-1||o.indexOf("https://")>-1){var l=t.setUrlParams(r.id,r.data);if(t.platform.isIos())return void(window.location.href=l);var c=window.open("","_blank")||window.open("","_newtab");c.location.href=l}}}(window.bui||{},window.libs),function(t,n){t.fileselect=function(i){function r(e){var i=n.extend(!0,O,e);switch(O.appendTo=i.appendTo||(t.hasRouter?router.currentPage()||"body":"body"),i.mediaType){case"allmedeia":T="*";break;case"picture":case"image":T="image/*";break;case"video":T="video/*";break;case"audio":T="audio/*";break;default:T=i.mediaType}return S=[],R=new Image,F=new FileReader,A=document.createElement("canvas"),C=A.getContext("2d"),N?(f(),P||a(i)):x=t.native.fileselect&&t.native.fileselect.call(this,e,{module:j})||{},this}function a(e){return w.on("change",function(e){var n=this.files;if(!(n.length<1)){n.length>1&&t.showLog("一次只能选一张图片","bui.fileselect:web");var i=n[0];L=i;var r={name:i.name,data:i,type:i.type,size:i.size};if(S.push(r),E.needCompress){E.data=i,E.mimeType=E.mimeType?E.mimeType:i.type;o(E)}else E.onSuccess&&E.onSuccess.call(I,i,S);this.value=""}}),P=!0,this}function o(e){var i=n.extend(!0,{destinationType:"file",data:null,mimeType:"",quality:.8,width:800,height:800,needCompress:!0,needChangeData:!1,onSuccess:null,onFail:null},O,e);R.onload=function(){var e=this.width,n=this.height,r=null,a=i.width,o=i.height,c=e,u=n;i.needCompress&&(e>a||n>o)&&(e/n>a/o?(c=a,u=Math.round(a*(n/e))):(u=o,c=Math.round(o*(e/n)))),A.width=c,A.height=u,C.clearRect(0,0,c,u),C.drawImage(R,0,0,c,u);var f=A.toDataURL(i.mimeType||i.data&&i.data.type||"image/jpeg",i.quality),p=l(i.data.name)||"";switch(i.destinationType){case"file":r=s(f,p);break;case"blob":r=d(f);break;case"data":r=f}if(i.needChangeData){L=r;var h=t.array.index(S,i.data.name,"name");h>-1&&(S[h].data=r,r.size&&(S[h].size=r.size),r.type&&(S[h].type=r.type))}return i.onSuccess&&i.onSuccess.call(I,r,S),r},R.onerror=function(){i.onFail&&i.onFail.call(I,R.src)},F.onload=function(e){R.src=e.target.result},i.data&&0==i.data.type.indexOf("image")&&F.readAsDataURL(e.data)}function l(e){return e.indexOf(".png")>-1||e.indexOf(".jpg")>-1||e.indexOf(".gif")>-1||e.indexOf(".jpeg")>-1?e.substr(0,e.lastIndexOf(".")):e}function c(e){L=null;var i=n.extend(!0,{needChangeData:!0,needCompress:!1,name:"resize.jpg"},O,e);return E=i,E.mimeType=e.mimeType?e.mimeType:"",N?(e.from?"picture"===e.from||"photo"===e.from||"savephoto"===e.from?w.removeAttr("capture"):w.attr("capture",e.from):w.removeAttr("capture"),t.platform.isIos()&&"function"==typeof FastClick?w[0].dispatchEvent(new Event("click")):w.trigger("click")):x.add(i),this}function u(e){var i=n.extend(!0,{needCompress:!1,destinationType:"data",mimeType:"",needChangeData:!1},e);if(i.data=i.data||L,i.mimeType=e.mimeType?e.mimeType:i.data&&i.data.type||"image/jpeg",N)try{o(i)}catch(e){t.showLog(e)}else x.toBase64(i);return this}function s(e,n){try{n=n||"file";for(var i=e.split(","),r=i[0].match(/:(.*?);/)[1],a=r.split("/")[1],o=atob(i[1]),l=o.length,c=new Uint8Array(l);l--;)c[l]=o.charCodeAt(l);return new File([c],n+"."+a,{type:r})}catch(e){t.showLog(e)}}function d(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),r=i.length,a=new Uint8Array(r);r--;)a[r]=i.charCodeAt(r);return new Blob([a],{type:n})}function f(){if(void 0==w){b=bui.guid();var e=O.from?'capture="'+O.from+'"':"",t='<input type="file" accept="'+T+'" name="uploadFiles" id="'+b+'" '+e+' style="display:none"/>';n(O.appendTo).append(t),w=n("#"+b)||n('input[name="uploadFiles"]')}}function p(e,n){var n=n||"name";if(!N)return S=x.remove(e,n);if("string"==typeof e){S.length&&t.array.remove(S,e,n);var i=S.length?S[S.length-1].data:null;return L=i,w[0].value="",S}return this}function h(){return S=[],L=null,N?w[0].value="":x.clear(),S}function g(){return S=N?S:x.data()}function v(){return L=N?L:x.value()}function m(){return N?S[S.length-1].name:x.value().name}function y(){return N?S.length-1:x.data().length-1}var b,w,x,k={native:!0,needNative:!1,needCompress:!1,appendTo:"",quality:.8,from:"camera",width:800,height:800,onSuccess:null,onFail:null,mediaType:"picture"},O=n.extend(!0,{},k,t.config.fileselect,i),I=this,j={add:c,remove:p,clear:h,value:v,data:g,toFile:s,toBase64:u,resize:o,toBlob:d,currentIndex:y,currentName:m,init:r},L=null,E=null,S=[],N="object"===(void 0===i?"undefined":e(i))&&void 0!==i.needNative?!i.needNative:t.isWebapp,T="*",P=!1,R=null,F=null,A=null,C=null;return r(O),j}}(bui||{},libs),function(t,n){t.file=function(i){function r(e){return b=t.fileselect(e),v=a(e),!e.needNative&&(m=o({root:!0,create:!0})),this}function a(e){function i(e){var t="";try{switch(e.code){case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}}catch(e){}var n={msg:t};r.reject(n)}var r=n.Deferred();return e.needNative?w=t.native.file&&t.native.file(e,{fileselect:b,module:O})||{}:(h="bui.app",g=window,y=1024*parseInt(I.size)*1024,window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,navigator.webkitPersistentStorage&&navigator.webkitPersistentStorage.requestQuota(y,function(e){window.requestFileSystem(window.PERSISTENT,e,function(e){r.resolve(e)},i)})),r}function o(e){var t={folderName:h,root:!1,create:!1,msg:"",param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},i=n.extend({},t,e),r="";if(i.create?(r="创建 ",i.param.create=!0):(r="获取 ",i.param.create=!1),I.needNative)w.getFolder(i);else{var a=l(i.folderName);a=i.root?a:h+"/"+a,v.done(function(e){e.root.getDirectory(a,i.param,function(t){i.onSuccess&&i.onSuccess.call(O,t,e)},function(e){var t={msg:r+a+" 文件夹失败"};i.onFail&&i.onFail.call(O,t)})}).fail(function(e){var t={msg:"文件系统还没准备好."};i.onFail&&i.onFail.call(O,t)})}return this}function l(e){var t;return"."==e[0]||"/"==e[0]||" "==e[0]?(t=e.slice(1),l(t)):"."!=e[0]&&"/"!=e[0]&&" "!=e[0]?e:void 0}function c(e){return e&&e.indexOf("/")>-1?e.slice(e.lastIndexOf("/")+1,e.indexOf("?")>-1?e.indexOf("?"):void 0):e}function u(e){var t={fileName:"",folderName:"",root:!1,create:!1,param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},i=n.extend({},t,e),r="";if(i.create?(r="创建 ",i.param.create=!0):(r="获取 ",i.param.create=!1),!i.fileName||i.fileName.indexOf(".")<0)return void(i.onFail&&i.onFail());if(I.needNative)w.getFile(i);else{var a=c(i.fileName);o({root:i.root,folderName:i.folderName,create:!0,onSuccess:function(e,t){var n=e.name==h?e.name+"/"+a:h+"/"+e.name+"/"+a;t.root.getFile(n,i.param,function(e){x=e,i.onSuccess&&i.onSuccess.call(O,e,t)},function(e){var t={msg:r+a+" 文件失败"};i.onFail&&i.onFail.call(O,t)})},onFail:function(e){i.onFail&&i.onFail(e)}})}return this}function s(e){var t=n.extend(!0,{},e);return I.needNative?w.removeFolder(t):o({root:t.root,folderName:t.folderName,create:t.create,onSuccess:function(e,n){e.removeRecursively(function(){t.onSuccess&&t.onSuccess.call(O,e,n)},function(n){var i={msg:"删除 "+t.folderName+" 文件失败"};t.onFail&&t.onFail.call(O,i,e)})},onFail:function(e){var n={msg:"删除 "+t.folderName+" 文件失败"};t.onFail&&t.onFail.call(O,n)}}),this}function d(e){var t=n.extend(!0,{},e);return I.needNative?w.removeFile(t):u({root:t.root,create:t.create,folderName:t.folderName,fileName:t.fileName,onSuccess:function(e,n){e.remove(function(){t.onSuccess&&t.onSuccess.call(O,e,n)},function(n){var i={msg:"删除 "+t.fileName+" 文件失败"};t.onFail&&t.onFail.call(O,i,e)})},onFail:function(e){var n={msg:"删除 "+t.fileName+" 文件失败"};t.onFail&&t.onFail.call(O,n)}}),this}function f(e){var n=e||{};if(n.url)return I.needNative?w.open(n):t.showLog("web暂不支持open方法","bui.file.open:web"),this}function p(e){return b.toBase64(e),this}var h,g,v,m,y,b,w,x,k={size:10,native:!0,needNative:!1},O={getFolder:o,removeFolder:s,getFile:u,getFileName:c,removeFile:d,toBase64:p,open:f,init:r},I=O.config=n.extend(!0,{},k,t.config.file,i);"object"===(void 0===i?"undefined":e(i))&&void 0!==i.needNative?i.needNative:t.isWebapp;return r(I),O}}(window.bui||{},window.libs),function(t,n){t.upload=function(i){function r(e){return x=t.loading({display:"block",width:30,height:30,opacity:0,autoClose:e.autoClose,callback:e.onMask}),k=t.fileselect.call(P,{native:e.native,needNative:e.needNative,from:e.from,mediaType:e.mediaType}),e&&e.needNative&&(I=t.native.upload&&t.native.upload(e,{loading:x,fileselect:k,module:P})||{}),e.data?(d(e),this):this}function a(e){return k.resize(e),this}function o(e){return e.onSuccess=e.onSuccess?e.onSuccess.bind(P):null,e.onFail=e.onFail?e.onFail.bind(P):null,k.add(e),this}function l(e,t){var n=s(),i=n.length;return i<1?this:(/\d/.test(e)&&e.indexOf(".")<0?k.remove(n[e].name,t):"string"==typeof e?k.remove(e,t):k.remove(n[i-1].name,t),this)}function c(){return k.clear(),this}function u(e){return k.toBase64(e),this}function s(){return k.data()}function d(e){var t=n.extend(!0,{},N,e);if(L=t.url,j=k.value(),R=t.showProgress,j){if(R&&x.show(),t&&t.needNative)return I.start(t)||T;var i=t.data,r=new FormData;r.append(t.fileKey,j);for(var a in i)t.fileKey===a&&r.delete(a),r.append(a,i[a]);return t.data=r,h(t)}}function f(e){var t=n.extend(!0,{needFileinfo:!1},N,e),i=t[t.fileKey]||k.data();return null===t.data&&(t.data={}),i.forEach(function(e,n){!function(e){if(t.data[t.fileKey]=i[e].data,t.needFileinfo)for(var n in i[e])"data"!==n&&(t.data[n]=i[e][n]);d(t)}(n)}),T}function p(e){return N&&N.needNative?I.stop(e):(x&&x.stop(),O&&O.abort(),e&&e.call(P,x,O)),this}function h(e){var t=e.onSuccess,i=e.onFail;return O=n.ajax({url:L,type:e.method,data:e.data,cache:e.cache,headers:e.headers,dataType:e.dataType,contentType:e.contentType,processData:e.processData,timeout:e.timeout,xhr:function(){var e=n.ajaxSettings.xhr();if(g&&e.upload)return e.upload.addEventListener("progress",g,!1),e},success:function(e){m(),t&&t.call(P,e),T.resolve(e)},error:function(e,t,n){m(),i&&i.call(P,e,t),T.reject(e,t,n)}}),T}function g(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.requestAnimationFrame(function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);E=t.toString()+"%",t<100?v(E):m(),F&&F.call(P,E)}})}function v(e){return R&&x&&x.show({text:e}),this}function m(){return x&&x.stop(),this}function y(){return k.currentName()}function b(){return k.currentIndex()}function w(e){var n={loading:x,fileselect:k,ajax:O};return t.widget.call(n,e)}var x,k,O,I,j,L,E,S={url:"",data:null,headers:{},showProgress:!0,timeout:6e4,contentType:!1,processData:!1,autoClose:!0,native:!0,needNative:!1,method:"POST",fileKey:"file",dataType:"json",mediaType:"picture",from:"picture",onProgress:null,onMask:function(){p()},onSuccess:null,onFail:null},N=n.extend(!0,{},S,t.config.upload,i),T=n.Deferred(),P={init:r,add:o,remove:l,resize:a,currentIndex:b,currentName:y,clear:c,data:s,start:d,startAll:f,stop:p,toBase64:u,widget:w},R=N.showProgress,F=N.onProgress;"object"===(void 0===i?"undefined":e(i))&&void 0!==i.needNative?i.needNative:t.isWebapp;return r(N),P}}(window.bui||{},window.libs),function(t,n){t.download=function(i){function r(e){return T=e.showProgress&&t.loading({display:"block",width:30,height:30,opacity:0,callback:function(){s()}}),m=t.file({native:e.native,needNative:e.needNative}),e.needNative?y=t.native.download&&t.native.download(e,{file:m,loading:T,module:I
})||{}:function(e){m.getFolder({folderName:e.folderName,create:!1,onSuccess:function(e,t){w=e.fullPath},onFail:function(t){m.getFolder({folderName:e.folderName,create:!0,onSuccess:function(e,t){w=e.fullPath},onFail:function(e){N&&N.call(I,e)}})}}),e.url&&a(e)}(e),this}function a(e){var t=n.extend(!0,{},j,e);b=t.needEncode?encodeURI(t.url):t.url,S=t.onProgress,E=t.showProgress,E&&T&&T.show({text:"0%"}),x=w+"/"+(e.fileName||m.getFileName(t.url)),t.needNative?y.start(t):(t.cache=!1,t.contentType=!1,t.processData=!1,v=n.ajax({url:b,type:t.method,data:t.data,cache:t.cache,headers:t.headers,contentType:t.contentType,processData:t.processData,timeout:t.timeout,xhr:function(){var e=n.ajaxSettings.xhr();if(d&&e)return e.addEventListener("progress",d,!1),e},success:function(n){var i=e.fileName||m.getFileName(t.url);m.getFile({fileName:i,folderName:t.folderName,create:!0,onSuccess:function(e,n){t.onSuccess&&t.onSuccess.call(I,e.fullPath,n)}})},fail:function(e){p(),t.onFail&&t.onFail.call(I,e)}}))}function o(e){var t=n.extend(!0,{autoDown:!0},j,e),i=e.fileName||m.getFileName(t.url);m.getFile({fileName:i,folderName:t.folderName,onSuccess:function(e,n){t.onSuccess&&t.onSuccess.call(I,e.fullPath||e,e,n)},onFail:function(e){t.autoDown=a(t)}})}function l(e){return e.fileName?(e.folderName=e.folderName||j.folderName,m.removeFile(e),this):(t.showLog("请告诉我们你要删除哪个文件, fileName "),this)}function c(e){return e.folderName=e.folderName||j.folderName,m.removeFolder(e),this}function u(e){return m.open(e),this}function s(e){L?(p(),v&&v.abort(),P&&window.cancelAnimationFrame(P)):y.stop(),e&&e.call(I,T,v)}function d(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,P=window.requestAnimationFrame(function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);k=t.toString()+"%",t<100?f(k):p(),S&&S.call(I,k)}})}function f(e){E&&T&&T.show({text:e})}function p(){E&&T&&T.stop()}function h(e){return m.toBase64(e),this}function g(e){var n={loading:T,file:m,ajax:v};return t.widget.call(n,e)}var v,m,y,b,w,x,k,O={url:"",data:{},headers:{},method:"GET",showProgress:!0,timeout:6e4,fileName:"",folderName:"download",native:!0,needNative:!0,onProgress:null,onSuccess:null,onFail:null},I={open:u,getFile:o,removeFile:l,removeFolder:c,start:a,stop:s,toBase64:h,init:r,widget:g},j=I.config=n.extend(!0,{},O,t.config.download,i),L="object"===(void 0===i?"undefined":e(i))&&void 0!==i.needNative?!i.needNative:t.isWebapp,E=j.showProgress,S=j.onProgress,N=j.onFail,T=null,P=null;return r(j),I}}(window.bui||{},window.libs),function(e,t){e.currentPlatform="webapp",e.on("pagereadybefore",function(){e.platform.isWindow()||e.platform.isMac()?window.viewport=e.viewport(40):window.viewport=e.viewport(),e.config.init.auto&&e.init()}),e.webready=function(n){t(document).ready(function(){e.trigger.call(e,"pagereadybefore"),n&&n.call(e),e.trigger.call(e,"pageready")})},e.ready=function(n){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp;var i=t.Deferred();if(e.isWebapp)t(document).ready(function(){e.trigger.call(e,"pagereadybefore"),n&&n.call(e),e.trigger.call(e,"pageready"),i.resolve()});else{if(void 0===e.native.ready)return e.showLog("当前 bui.isWebapp = false; 但bui.js为webapp版本,不支持原生方法,请使用 buijs update -p xxx, 更换bui.js为对应xxx平台版本;"),e.webready(n),i;i=e.native.ready&&e.native.ready(n)||i}return i}}(window.bui||{},window.libs),function(e,t){e.mask=function(n){function i(n){E=!1;var i=t.extend(!0,b,x,n);return i.onBeforeInit&&i.onBeforeInit.call(w,i),i.appendTo=i.appendTo||"body",I=e.objId(i.appendTo),x=w.config=i,m=I.css("position"),i.autoTrigger&&o(i),j=e.objId(i.id),i.onInited&&i.onInited.call(w,i),this}function r(e){var t=function(t){e.callback&&e.callback.call(w,t),e.autoClose&&u(),t.stopPropagation()};j.off("click.bui").on("click.bui",t),L=!0}function a(t){var n=t.background?t.background:"rgba(0,0,0,"+t.opacity+")",i="";return i+='<div id="'+O+'" class="'+e.prefix("mask")+'" style="background:'+n+";z-index:"+t.zIndex+'"></div>'}function o(n){if(!E){var i=t.extend(!0,{},b,x,n),o=a(i);return j=e.objId(O),j&&j.length?j.css("display","block"):(I.append(o).css("position","relative"),j=e.objId(O)),y=!0,v.call(w,"show"),L||r(i),this}}function l(){if(!E)return j&&j.remove(),j=null,I.css("position",m||"static"),y=!1,L=!1,v.call(w,"hide"),this}function c(t){if(!E)return j=e.objId(O),j&&j.length?(j.css("display","block"),I.css("position","relative"),y=!0):o(x),v.call(w,"show"),this}function u(){if(!E)return j&&j.css("display","none"),I.css("position","relative"),y=!1,v.call(w,"hide"),this}function s(){return y}function d(e){l(),I&&I.off("click.mask"),g("show"),g("hide"),E=!0}function f(t){var n={};return e.widget.call(n,t)}function p(t,n){return e.option.call(w,t,n)}function h(t,n){return e.on.apply(w,arguments),this}function g(t,n){return e.off.apply(w,arguments),this}function v(t){w.self=this==window||this==w?null:this,e.trigger.apply(w,arguments)}var m,y,b={id:"",appendTo:"",opacity:.3,background:"",zIndex:100,autoTrigger:!1,autoClose:!1,onBeforeInit:null,onInited:null,callback:null},w={handle:{},on:h,off:g,hide:u,show:c,isShow:s,remove:l,destroy:d,widget:f,option:p,config:x,init:i},x=w.config=t.extend(!0,{},b,e.config.mask,n),k=e.guid(),O=x.id?x.id.indexOf("#")>-1?x.id.substring(1):x.id:k,I=(t("body"),e.objId(x.appendTo)),j=null,L=!1,E=!1;return i(x),w}}(window.bui||{},window.libs),function(e,t){e.loading=function(n){function i(i){P=!1;var r=t.extend(!0,{},j,i);return r.onBeforeInit&&r.onBeforeInit.call(I,n),r.appendTo=r.appendTo||"body",L=t(r.appendTo),j=I.config=r,r.autoTrigger&&N.length<1&&o(r),N=e.objId(E),r.onInited&&r.onInited.call(I,r),this}function r(e){var t=e||j,n=function(e){t.callback&&t.callback.call(I,e),e.stopPropagation()};return L.off("click.bui","#"+E).on("click.bui","#"+E,n),T=!0,this}function a(t){t=t||{};var n=t.text,i=L.width()||document.documentElement.clientWidth,r=n&&"block"==t.display?parseInt(t.height)+30:parseInt(t.height),a=-i/2,o=-r/2,l="block"==t.display?e.prefix("loading-block"):e.prefix("loading-inline"),c="";return c+='<div id="'+E+'" class="'+e.prefix("loading")+" "+l+'" style="width:'+i+"px;height:"+r+"px;line-height:"+r+"px;margin-left:"+a+"px;margin-top:"+o+"px;"+(t.zIndex?"z-index:"+t.zIndex:"")+'" >',t.onlyText||(c+='<div class="'+e.prefix("loading-cell")+'" style="width:'+parseFloat(t.width)+"px;height:"+parseFloat(t.height)+'px;"></div>'),c+='<div class="'+e.prefix("loading-text")+'">'+t.text+"</div>",c+="</div>",t&&t.template?t.template.call(I,t):c}function o(n){if(!P){var i=t.extend(!0,{},j,n);if(N=e.objId(E),k=N.children(".bui-loading-cell"),N.hasClass("bui-loading-pause"))N.removeClass("bui-loading-pause"),w.call(this,"start");else{N.length&&N.remove();var o=a(i);L.append(o),D&&D.show(),w.call(this,"show")}return i.timeout&&(F&&clearTimeout(F),F=setTimeout(function(){d()},i.timeout)),T||r(i),R=!0,this}}function l(t){if(!P){N=e.objId(E),x=N.children(".bui-loading-text");return void 0===t?x&&x.text():(x&&x.text(t),this)}}function c(){if(!P)return N=e.objId(E),k=N.children(".bui-loading-cell"),k.css("display","inline-block"),N.removeClass("bui-loading-pause"),this}function u(){if(!P)return N=e.objId(E),k=N.children(".bui-loading-cell"),k.css("display","none"),N.addClass("bui-loading-pause"),this}function s(){return R}function d(){if(!P)return N=e.objId(E),N&&N.remove(),N=null,D&&D.remove(),T=!1,R=!1,w.call(this,"remove"),w.call(this,"hide"),this}function f(){if(!P)return N&&N.addClass("bui-loading-pause"),w.call(this,"pause"),this}function p(n){var i=n||{};if(!P){var r=t.extend(!0,j,i);return N=e.objId(r.id),N&&N.length?(l(r.text),N[0].style.display="-webkit-box",D&&D.show(),w.call(this,"show")):o(r),j.timeout&&(F&&clearTimeout(F),F=setTimeout(function(e){h()},j.timeout)),R=!0,this}}function h(){if(!P)return N=e.objId(E),j.appendTo?(N.css("display","none"),D&&D.hide()):N&&N.length&&(N.css("display","none"),D&&D.hide()),R=!1,w.call(this,"hide"),this}function g(e){var e=1==e;d(),L&&L.off("click.bui"),b("show"),b("hide"),b("start"),b("stop"),b("pause"),b("remove"),D&&D.destroy(e),P=!0}function v(t){var n={mask:D||{}};return e.widget.call(n,t)}function m(t,n){return e.option.call(I,t,n)}function y(t,n){return e.on.apply(I,arguments),this}function b(t,n){return e.off.apply(I,arguments),this}function w(t){I.self=this==window||this==I?null:this,e.trigger.apply(I,arguments)}var x,k,O={appendTo:"",width:30,height:30,text:"",onlyText:!1,mask:!0,zIndex:"",autoTrigger:!1,autoClose:!0,timeout:0,opacity:0,display:"block",template:null,onBeforeInit:null,onInited:null,callback:null},I={handle:{},on:y,off:b,start:o,stop:d,isLoading:s,pause:f,text:l,showRing:c,hideRing:u,show:p,hide:h,destroy:g,widget:v,option:m,config:j,init:i},j=I.config=t.extend(!0,{},O,e.config.loading,n),L=(t("body"),null),E=e.guid(),S=E+"-mask",N=e.objId(E),T=!1,P=!1,R=!1,F=null;j.id=E;var A=j.callback;j.callback=function(e){j.autoClose&&d(),A&&A.call(I,e)};var C=t.extend(!0,{},j,{id:S}),D=j.mask?e.mask(C):null;return i(j),I}}(window.bui||{},window.libs),function(e,t){e.init=function(n){var i,r={id:".bui-page",height:0,header:"header",main:"main",footer:"footer",reduceRem:0};if("object"==e.typeof(n))i=t.extend({},r,e.config.init,n);else{var a={};a.height=n,i=t.extend({},r,a)}var o=i.height||document.documentElement.clientHeight||t("body").height()||t("#bui-router").height()||t(".bui-page").height();if(!(e.obj(i.main).length<1)){try{var l=e.obj(i.id),c=i.header.indexOf("#")>-1?e.obj(i.header)[0]:l.children(i.header)[0],u=i.footer.indexOf("#")>-1?e.obj(i.footer)[0]:l.children(i.footer)[0],s=i.main.indexOf("#")>-1?e.obj(i.main):l.children(i.main),d=c?c.offsetHeight:0,f=u?u.offsetHeight:0,p=i.reduceRem>0?e.unit.remToPx(i.reduceRem):0,h=o-d-f-p;if(parseInt(h)>0)s.height(h);else{var g=d+f+p+"px";e.unit.calcHeight(s,g)}}catch(t){e.showLog(t,"bui.init")}return h}},window.addEventListener?window.addEventListener("load",function(t){e.trigger.call(e,"onload")},!1):window.attachEvent("onload",function(t){e.trigger.call(e,"onload")}),window.loader=e.loader(),e.define=loader.define,e.require=loader.require,e.map=loader.map,e.import=loader.import,e.checkLoad=loader.checkLoad,e.checkDefine=loader.checkDefine,t(document).ready(function(){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp,e.trigger.call(e,"pagebefore"),"function"==typeof FastClick&&FastClick.attach(document.body),e.trigger.call(e,"pageinit")});try{var n="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"",i=n.replace(/hidden/i,"visibilitychange"),r=function(t){document[n]?e.trigger.call(e,"pagehide",t):e.trigger.call(e,"pageshow",t)};document.addEventListener(i,r)}catch(e){}try{navigator.control.gesture(!1),navigator.control.longpressMenu(!1)}catch(e){}}(window.bui||{},window.libs)});
