function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function asyncGeneratorStep(e,t,n,i,a,o,r){try{var l=e[o](r),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(i,a)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function r(e){asyncGeneratorStep(o,i,a,r,l,"next",e)}function l(e){asyncGeneratorStep(o,i,a,r,l,"throw",e)}r(void 0)}))}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/* @preserve 
 * @name: BUI v1.7.0  
 * @detail: BUI 是一个更快的UI开发框架，专注Webapp快速开发，完美嵌入各平台或打包，媲美APP体验。 
 * @site: http://www.easybui.com/ 
 * Copyright © 2018-2022 BUI. All Rights Reserved. 
 */!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e;function t(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}window.libs=window.Zepto||window.jQuery||{},window.bui={},window.router={},(e=window.bui).debug=!0,e.hasRouter=!1,e.nativeRouter=!1,e.isWebapp,e.currentPlatform="",e.log=!0,e.trace=!1,e.native={},e.config={},e.config.namespace="bui",e.config.classNamePrefix=e.config.namespace+"-",e.config.version="1.7.0",e.config.versionCode=20220301,e.version=e.config.version,e.versionCode=e.config.versionCode,e.config.icon={close:"icon-close",minus:"icon-minus",plus:"icon-plus",search:"icon-search",remove:"icon-removefill"},e.config.viewport={},e.config.init={auto:!0},e.config.ready={},e.config.ajax={},e.config.get={},e.config.put={},e.config.delete={},e.config.post={},e.config.back={},e.config.load={},e.config.getPageParams={},e.config.refresh={},e.config.run={},e.config.checkVersion={},e.config.component={auto:!0},e.config.dialog={},e.config.confirm={},e.config.alert={},e.config.hint={},e.config.prompt={},e.config.loading={},e.config.mask={},e.config.list={},e.config.listview={},e.config.scroll={},e.config.pullrefresh={},e.config.select={},e.config.sidebar={},e.config.slide={},e.config.actionsheet={},e.config.dropdown={},e.config.accordion={},e.config.stepbar={},e.config.rating={},e.config.number={},e.config.file={},e.config.fileselect={},e.config.upload={},e.config.download={},e.config.swipe={},e.config.router={},e.config.loader={},e.config.loader.define={},e.config.loader.load={},e.config.loader.component={},e.config.store={},e.config.floor={},function(e,t){e.prefix=function(t){return e.config.classNamePrefix+t},e.showLog=function(t,n){n=n||"";var i="";"object"==_typeof(t)&&"message"in t&&"name"in t?i=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(i=t),e.log&&console.error(n+" "+i),e.trace&&console.trace&&console.trace(),e.trigger("catcherror",t,n)},e.guid=function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(e=void 0===e?"bui":e||"")+t().substr(e.length)+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e.swipeDirection=function(e,t,n,i){var a=t-e,o=i-n,r=Math.abs(a),l=Math.abs(o);return!(r<9&&l<9)&&(r/l>3?a>0?"swiperight":"swipeleft":o>0?"swipedown":"swipeup")},e.obj=function(n,i){var a=null;i=i||null;var o=e.hasRouter&&router.currentPage()||"html",r=t(o=i||o),l="string"==typeof n;if("object"===_typeof(n))return a=t(n);if(l&&/^(\d)/.test(n))return a=r.find("[id='"+n+"']");if(l&&/^[a-zA-z]/.test(n)){var c=/^(html|head|body|header|main|footer|ul|li|section|dt|dd|div|span|img|article|i|strong|input|textarea|select|h1|h2|h3|h4|h5|h6|p|view|component|components|iframe)$/gi.test(n)||/^\[.+\]$/.test(n)||n.indexOf("[")>-1?n:"#"+n;return a=r.find(c)}return/^#\d/.test(n)?a=r.find("[id='"+n.substr(1)+"']"):/^\.\d/.test(n)?a=r.find("[class='"+n.substr(1)+"']"):n&&(a=r.find(n)),a},e.$=e.obj,e.objId=function(t){return e.obj(t,"html")},e.selector=function(e){return void 0===e?this:t(e,this)},e.widget=function(e){return e&&e in this?this[e]:this},e.option=function(n,i){if("object"!==e.typeof(n)&&void 0===i)return"string"==typeof n?this.config[n]:this.config;if("id"==n)return e.showLog("不允许修改控件的ID参数"),this;if(n&&"object"===e.typeof(n)){var a=t.extend(this.config,n);return this.init(a)}if(this.config.hasOwnProperty(n)){var o={};o[n]=i;a=t.extend(this.config,o);return this.init(a)}return this}}(window.bui||{},window.libs),function(e,t){e.emitter=function(){function t(){this.handle=Object.create(null)}return t.prototype.on=function(t,n,i){return"function"==typeof n?(i=n,n=this):(i=i,n=n||this),n.handle=n.handle||{},e.unit.stringToArray(t).forEach((function(e,t){void 0===n.handle[e]&&(n.handle[e]=[]),n.handle[e].push(i)})),n},t.prototype.off=function(t,n,i){"function"==typeof n?(i=n,n=this):"function"==typeof i?(i=i,n=n||this):n=this;var a=e.typeof(t);if(void 0===t)n.handle=Object.create(null);else if("string"===a&&"function"==typeof i){var o=n.handle[t]||[];e.array.remove(o,i)}else if("string"===a||"array"===a){"object"!==_typeof(n.handle)&&(n.handle={}),e.unit.stringToArray(t).forEach((function(e,t){n.handle[e]=[]}))}return n},t.prototype.one=function(e,t){var n=this;return this.on(e,(function i(){t&&t.apply(n,arguments),n.off(e,i)})),this},t.prototype.has=function(e){return this.handle.hasOwnProperty(e)},t.prototype.wait=function(t,n){var i=this,a=e.unit.stringToArray(t),o=[],r=!0;return a.forEach((function(t,l){i.on(t,(function(t){o[l]=t,o.length===a.length&&r&&(a.forEach((function(t,n){o[n]=e.history.getLast().component[t]||{}})),n&&n.apply(i,o),r=!1)}))})),this},t.prototype.waited=function(t,n){var i=this,a=e.unit.stringToArray(t),o=[],r=!0;return a.forEach((function(t,l){i.on(t,(function(t){o[l]=t.exports||t,o.length===a.length&&r&&(a.forEach((function(t,n){var i=e.history.getLast().component[t];o[n]=i?i.exports:{}})),n&&n.apply(i,o),r=!1)}))})),this},t.prototype.trigger=function(t){try{var n=this.handle[arguments[0]];if("array"===e.typeof(n)){var i=[].slice.apply(arguments);i.shift();for(var a=0,o=n.length;a<o;a++)n[a]&&n[a].apply(this.self||this,i)}}catch(e){}return this},t.prototype.notify=function(){try{for(var t in this.handle){var n=this.handle[t];if("array"===e.typeof(n))for(var i=0,a=n.length;i<a;i++)n[i]&&n[i].apply(this.self||this)}}catch(e){}return this},function(e){return new t}}();var n=e.emitter();e.on=n.on,e.off=n.off,e.trigger=n.trigger,e.one=n.one}(window.bui||{}),function(e,t){e.store=function(n){var i={el:null,uid:"",scope:"",data:null,extends:null,mixins:[],beforeMounts:[],beforeCompiles:[],compileds:[],beforeUpdates:[],mounteds:[],updateds:[],beforeDestroys:[],destroyeds:[],computed:null,methods:null,watch:null,templates:null,beforeMount:null,mounted:null,beforeCompile:null,compiled:null,beforeUpdate:null,updated:null,beforeDestroy:null,destroyed:null,isPublic:!1,modelEvent:"input",scopeSplit:".",paramSplit:"｜",delayInput:200,needStatic:!1,needView:!0,needComponent:!1,needCompile:!0,needNative:!1,deep:!0,log:!1,autoinit:!0},a=null,o=!1;function r(n){var a=null,o=n&&n.extends?[n.extends]:[];e.array.merge(i.mixins,o,n.mixins||[],[n]);var r=t.extend(!0,{},i,e.config.store);return function e(n){var o=0;for(o=0;o<n.length;o++){var l=n[o];l.beforeMount&&i.beforeMounts.push(l.beforeMount),l.beforeCompile&&i.beforeCompiles.push(l.beforeCompile),l.beforeUpdate&&i.beforeUpdates.push(l.beforeUpdate),l.updated&&i.updateds.push(l.updated),l.compiled&&i.compileds.push(l.compiled),l.mounted&&i.mounteds.push(l.mounted),l.beforeDestroy&&i.beforeDestroys.push(l.beforeDestroy),l.destroyed&&i.destroyeds.push(l.destroyed),a=t.extend(!0,r,l),l.mixins&&l.mixins.length&&o<n.length-1&&e(l.mixins)}}(i.mixins),a=t.extend(!0,i,a)}var l,c="function"==typeof(a=r(n)).data?a.data.call(V):a.data,s=a.scope||e.guid(),u=a.computed,d=a.scopeSplit,f=a.methods,p=a.templates,h=a.watch||i.watch,m=a.delayInput,g=a.isPublic,v=a.modelEvent,y=a.needStatic,b="",w=!1,x=!0,k={},O={},I={},L=!1,S={},P=e.emitter(),C={target:null};c=function n(i){for(var a in i){var o=i[a];o&&"array"===e.typeof(o)?i[a]=e.array.copy(o):o&&"object"===e.typeof(o)&&(i[a]=t.extend(!0,{},o),n(i[a]))}return i}(c),a.el?a.el=a.el:a.el=g||!e.hasRouter?"body":".bui-page",l=a.el,b=0==l.indexOf(".")||0==l.indexOf("#")?l.substr(1):l;var T=null,j=null,N=null,E=null,R=[],_=!0,$=c,A=void 0===a.log?i.log:a.log,D=/b-text|b-html|b-value|b-show|b-hide|b-checked|b-src|b-href|b-bind|b-style|b-class|b-model-lazy|b-model|b-id|b-data|b-placeholder|b-title|b-visible|b-props|b-prop/gim,F={"b-text":function(t){var n="b-text",i=se.call(this,t,n),a=ce.call(this,n),o="",r=e.typeof(t.value),l=i.attr(n),c=me.call(this,n);c[0]&&c[0].keyname;var s=c[0]&&c[0].param||{};switch(r){case"array":o=ue(t,l);break;case"function":o=t.value.apply(V,s);break;default:o=t.value}o=a?!o:o,this.innerText=o,R=[]},"b-html":function(t){var n="b-html",i=se.call(this,t,n),a=ce.call(this,n),o="",r=e.typeof(t.value),l=i.attr(n),c=me.call(this,n);c[0]&&c[0].keyname;var s=c[0]&&c[0].param||{};switch(r){case"array":o=ue(t,l);break;case"function":o=t.value.apply(V,s);break;default:o=t.value}o=a?!o:o,i.html(o),R=[]},"b-value":function(e){var t=se.call(this,e,"b-value");g?t.each((function(t,n){de.call(this,e)})):de.call(t[0],e);R=[]},"b-show":function(e){var t=se.call(this,e,"b-show");e.value&&e.value.length||"object"!==_typeof(e.value)&&1==Boolean(e.value)?this.removeAttribute("style"):(""===e.value||e.value&&!e.value.length||0==Boolean(e.value))&&t.css("display","none");R=[]},"b-visible":function(e){var t=se.call(this,e,"b-visible");e.value&&e.value.length&&"object"!==_typeof(e.value)&&1==Boolean(e.value)?this.removeAttribute("style"):(""===e.value||e.value&&!e.value.length||0==Boolean(e.value))&&t.css("visibility","hidden");R=[]},"b-hide":function(n){var i="!"+s+d+n.keyname,a=g?t('[b-show="'.concat(i,'"]')):T(this);"array"===e.typeof(n.value)&&n.value.length||"object"!==_typeof(n.value)&&1==Boolean(n.value)?a.css("display","none"):(""===n.value||n.value&&!n.value.length||0==Boolean(n.value))&&a.removeAttr("style")},"b-checked":function(e){this.checked=!!e.value,R=[]},"b-bind":function(e){var t=se.call(this,e,"b-bind"),n=this,i=e.keyname,a=e.value;if("object"===_typeof(a)){var o=function(o){Le(i+"."+o,(function(t){pe(se.call(n,e,"b-bind"),o,t.value)})),pe(t,o,a[o])};for(var r in a)o(r)}else{var l="string"==typeof i&&i.split("."),c=l[l.length-1];pe(t,c,a)}},"b-src":function(e){se.call(this,e,"b-src").attr("src",e.value),R=[]},"b-placeholder":function(e){se.call(this,e,"b-placeholder").attr("placeholder",e.value),R=[]},"b-title":function(e){se.call(this,e,"b-title").attr("title",e.value),R=[]},"b-data":function(e){se.call(this,e,"b-data").attr("data",e.value),R=[]},"b-id":function(e){se.call(this,e,"b-id").attr("id",e.value),R=[]},"b-href":function(e){se.call(this,e,"b-href").attr("href",e.value),R=[]},"b-class":function(n){var i=se.call(this,n,"b-class"),a=this;this.classList;var o=n.keyname||"";if("object"===_typeof(n.value))if("array"===e.typeof(n.value)){n.value.length||i.attr("class",""),n.value.forEach((function(e,t){!i.hasClass(e)&&i.addClass(e)}));var r=o.indexOf(".$index");r>-1?Le(o.substr(0,r)+"."+t(i).index(),(function(e){var t=se.call(a,n,"b-class");he(t,e.value[t.index()],e.value)})):Le(o,(function(e){var t=se.call(a,n,"b-class");he(t,e.value[t.index()],e.value)}))}else{var l=function(e){var t=n.value[e],r=n.preValue&&n.preValue[e]||"";Le(o+"."+e,(function(t){he(se.call(a,n,"b-class"),e,t.value)})),he(i,e,t,r)};for(var c in n.value)l(c)}else if("function"==typeof n.value){var s=me.call(this,"b-class"),u=s[0]&&s[0].keyname||"",d=s[0]&&s[0].param||{},f=n.value.apply(V,d);he(i,u,f,n.preValue)}else{var p="string"==typeof n.keyname&&n.keyname.split("."),h=p[p.length-1];he(i,h,n.value,n.preValue)}R=[]},"b-model":function(e){var t=se.call(this,e,"b-model");g?t.each((function(t,n){fe.call(this,e)})):fe.call(t[0],e)},"b-model-lazy":function(e){var t=se.call(this,e,"b-model-lazy");g?t.each((function(t,n){fe.call(this,e)})):fe.call(t[0],e)},"b-style":function(e){var t=se.call(this,e,"b-style"),n=this;if("object"===_typeof(e.value)){var i=function(i){Le(e.keyname+"."+i,(function(t){se.call(n,e,"b-style").css(i,t.value)})),t.css(e.value)};for(var a in e.value)i(a)}else t.css(e.keyname,e.value);R=[]},"b-prop":function(t){se.call(this,t,"b-prop");var n="";if("object"===e.typeof(t.value))n=t.value;else{var i=t.keyname.indexOf(".")>-1?t.keyname.split(".").pop():t.keyname,a={};a[i]=t.value,n=a}var o=this.id?this.id:e.guid();!this.id&&(this.id=o);var r="false"!==this.getAttribute("everytime");e.$("#".concat(this.id)).attr(n),loader.delay({id:"#".concat(this.id),everytime:r,param:n}),R=[]},"b-props":function(n){se.call(this,n,"b-props");var i="";if("object"===e.typeof(n.value))i=n.value;else{var a=n.keyname.indexOf(".")>-1?n.keyname.split(".").pop():n.keyname,o={};o[a]=n.value,i=o}var r=e.history.getLast().component[this.id],l=r&&r.param,c=t.extend(!0,{},l,i),s=this.id?this.id:e.guid();!this.id&&(this.id=s);var u="false"!==this.getAttribute("everytime");e.$("#".concat(this.id)).attr(c),loader.delay({id:"#".concat(this.id),everytime:u,param:c}),R=[]}},z={"b-text":[],"b-html":[],"b-value":[],"b-show":[],"b-hide":[],"b-checked":[],"b-bind":[],"b-src":[],"b-title":[],"b-data":[],"b-id":[],"b-href":[],"b-class":[],"b-model":[],"b-model-lazy":[],"b-style":[],"b-prop":[],"b-props":[]},B={},U=t.extend(!0,{},c,f,h,u,p),V={$methods:f,$refs:S,mixin:r,$options:a,$templates:p,config:a,watch:q,nextTick:function(t){return Le("nexttick",(function(n){try{t&&t.call(V,n)}catch(n){e.showLog(n)}})),this},oneTick:function(t,n){var i="nexttick-"+t;if(I.hasOwnProperty(i))return this;return I[i]=n,Le("nexttick",(function(n){if(n.keyname===t)try{O[t]&&O[t].pop(),0==O[t].length&&I[i]&&I[i].call(V,n)}catch(n){e.showLog(n)}})),this},get:function(t){if(void 0===t)return $=$;if("string"==typeof t){var n=e.unit.getKeyValue(t,$);return R=[],n}return $},set:ke,setState:function(n,i){var r="string"==typeof n,l="array"===e.typeof(i),u=i,f="",p=null,h=/\.\d$/.test(n);n.match(/\d+/g),R=[];var m=e.unit.getKeyValue(n,$);if(o=!0,!r||"$data"===n&&"$root"===n||void 0===i)"$data"!==n&&"$root"!==n||"object"!==e.typeof(i)||($=t.extend(!0,{},$,i),Ie(i),R=[]);else{if(A&&console.log("set ".concat(n," ")),L=!0,!l&&Ce.call(V,"beforeupdate",{target:null,value:u,preValue:m,action:"setState",keyname:n,origin:$}),!l&&a.beforeUpdates.forEach((function(e,t){e.call(V,{target:null,value:u,preValue:m,action:"setState",keyname:n,origin:$})})),u="object"===e.typeof(i)?t.extend(!0,{},m,i):"array"===e.typeof(i)?e.array.copy(i):i,h&&(f=n.replace(/\.\d$/,""),p=e.unit.getKeyValue(f,$)),e.unit.setKeyValue(n,u,c),e.unit.setKeyValue(n,u,$),"array"!==e.typeof(m)&&Ce.call(V,n,{target:null,value:u,preValue:m,action:"setState",keyname:n,origin:$}),h){var g=n.replace(/\.\d$/,""),v=e.unit.getKeyValue(g,$);be(g)&&Ce.call(V,g,{target:null,value:v,preValue:p,action:"setState",keyname:g,origin:$})}i&&e.typeof(i);var y=h?j.find('[b-template*="'.concat(s,".").concat(f,'"]')):j.find('[b-template*="'.concat(s,".").concat(n,'"]'));y.length&&y.each((function(e,n){t(n).length&&G({el:t(n),action:"setState"})})),"array"!==e.typeof(m)&&(Ce.call(V,"updated",{target:null,value:u,preValue:m,action:"setState",keyname:n,origin:$}),a.updateds.forEach((function(e,t){e.call(V,{target:null,value:u,preValue:m,action:"setState",keyname:n,origin:$})}))),"object"===_typeof(i)&&("array"===e.typeof(i)?ye(c,n.split(d)):ye(i)),R=[]}return this},delete:Oe,del:Oe,observer:ye,compile:K,$mount:K,compileHtml:X,clearKey:function(){return R=[],w=!1,x=!0,L=!1,this},destroy:function(){return R=[],a.beforeDestroys.forEach((function(e,t){e.call(V)})),w=!1,x=!0,L=!1,Pe(),a.beforeMounts=[],a.beforeCompiles=[],a.compileds=[],a.mounteds=[],a.beforeUpdates=[],a.updateds=[],a.destroyeds.forEach((function(e,t){e.call(V)})),this},init:M,connect:function(t,n,i){if("object"!==_typeof(t)||!t.hasOwnProperty("$refs"))return V;var a=this;if("string"==typeof n){xe(t,n);var o=e.unit.getKeyValue(n,a.$data);"object"===e.typeof(o)?d(n,o,i||n):u(i||n,o,n)}else for(var r=Object.keys($),l=0;l<r.length;l++){var c=r[l];if(e.array.compare(we,c,"field"))break;if(xe(t,c),t.$data.hasOwnProperty(c)){t.$data[c];var s=a.$data[c];"object"===e.typeof(s)?d(c,s):u(c,s)}}function u(n,i,a){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i);var o=null;a&&(o=q(a,(function(i){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i)}))),n&&(o=q(n,(function(i){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i)})));var r=e.array.index(we,n,"field");(r<0||we[r]&&t.$options.el!==we[r].el)&&we.push({field:a||n,el:t.$options.el,disconnect:o})}function d(n,o,r){for(var l,c=Object.keys(o),s=function(o){var r=c[o],l=n+"."+r,s=void 0===i,u=s||""==i?r:i+"."+r;xe(t,l);var f=e.unit.getKeyValue(l,a.$data);s?t.set(l,f):t.set(u,f);var p=q(l,(function(e){void 0!==i?t.set(u,e):t.set(l,e)}));((d=e.array.index(we,l,"field"))<0||we[d]&&t.$options.el!==we[d].el)&&we.push({field:l,el:t.$options.el,disconnect:p})},u=0;u<c.length;u++){var d;s(u)}t.trigger.call(t,r||n,(_defineProperty(l={action:"set",target:null,value:$[n],preValue:null},"action","set"),_defineProperty(l,"keyname",n),_defineProperty(l,"origin",$),l))}return V},disconnect:function(t){if("string"==typeof t){var n=e.array.get(we,t,"field");n&&n.disconnect()}else we.forEach((function(e,t){e.disconnect()}));return V},on:Le,off:Pe,one:Se,trigger:Ce,emitter:P,triggerkey:function(t,n){var i=n||[],o=[];t.indexOf(a.paramSplit)>-1?o=t.split(a.paramSplit):o.push(t);return o.forEach((function(t){var n=e.unit.getKeyValue(t,$),a=e.unit.getKeyValue(t,V);if("function"==typeof a)return L=!1,void a.apply(V,i);Ce(t,{target:null,value:a,preValue:n,action:"set",keyname:t,param:{},origin:$})})),this}};try{a.autoinit&&M()}catch(t){e.showLog(t)}function M(){var n,i=(T=e.hasRouter?router.$:t)(a.el);for(var o in j="object"===_typeof(a.el)?t(a.el):i.length?i:t(a.el),N=j&&j.parent(),E=j&&j.children(),V.$el=j,V.$parent=N,V.$children=E,V.$data=c,f)f[o]=f[o].bind(V);return V.$methods=f,f&&function(){try{Object.keys(f).forEach((function(t){c.hasOwnProperty(t)?e.showLog("不能跟data的键值相同:"+t):Object.defineProperty(V,t,{get:function(){return f[t].bind(this)},set:function(){}})}))}catch(t){e.showLog(t)}}(),p&&function(){try{Object.keys(p).forEach((function(t){c.hasOwnProperty(t)?e.showLog("不能跟data的键值相同:"+t):Object.defineProperty(V,t,{get:function(){return p[t].bind(this)},set:function(){}})}))}catch(t){e.showLog(t)}}(),Ce.call(V,"beforemount"),a.beforeMounts.forEach((function(e,t){e.call(V)})),ye(c),function(){var e=function(e){Object.defineProperty(V,e,{configurable:!0,get:function(){this===V||!w&&x?(w=!0,x=!1,R=[]):(w=!1,x=!1);var t=c[e];return Array.isArray(t)&&C.target&&(Array.isArray(k[e])||(k[e]=[]),k[e].push(C.target)),t},set:function(t){A&&console.log("2. data setting ".concat(e),t),R=[],L=!1,c[e]=t,$[e]=t}})};for(var t in c)e(t)}(),h&&function(t){try{H(t)}catch(t){e.showLog(t)}}(h),u&&function(){try{Object.keys(u).forEach((function(t){if(c.hasOwnProperty(t))e.showLog("不能跟data的键值相同:"+t);else{var n=u[t];Object.defineProperty(V,t,{get:function(){var e,i="function"==typeof n?n.bind(this):n.get.bind(this);return C.target&&(k[t]=[],k[t].push(C.target)),C.target=function(){var e=i();k[t]&&k[t].forEach((function(e){return e()})),Ce(t,{target:null,value:e,action:"set",keyname:t,param:[],origin:$}),C.target=null,R=[]},e=i(),C.target=null,R=[],e},set:n&&"object"===e.typeof(n)&&n.set||function(){}})}}))}catch(t){e.showLog(t)}}(),g?a.needCompile&&router&&router.on("complete",(function(e){a.needCompile&&K(),_&&a.mounteds.forEach((function(t,n){t.call(V,e)})),$=t.extend(!0,{},c),w=!1,x=!0,Ce.call(V,"mounted",e),_=!1,R=[]})):(_||Pe(),y&&(n=X(n=j.html()),j.html(n)),a.needView?function(e){loader.views({id:e.id,loaded:function(e){K(e.el)},compiled:e.compiled})}({id:j,compiled:function(){a.needCompile&&K(),a.mounteds.forEach((function(e,t){e.call(V)})),j.removeAttr("b-cloak")}}):(a.needCompile&&K(),a.mounteds.forEach((function(e,t){e.call(V)})),j.removeAttr("b-cloak")),$=t.extend(!0,{},c),w=!1,x=!0,R=[],Ce.call(V,"mounted"),_=!1),a.uid&&e.history.setUI&&e.history.setUI({uid:a.uid,ui:V}),this}function H(t,n,i){t=t||h;try{var a=Object.keys(t),o=[];a.forEach((function(a,r){var l=i||("object"===_typeof(t[a])?t[a].handler:t[a]);o.push(a),n&&o.unshift(n);var s=o.join("."),u=t[a];if("object"===e.typeof(u)){var d=u.deep?Object.keys(c[a]):Object.keys(t[a]),f=e.unit.getKeyValue(a,c);d.forEach((function(t,n){var i=s+"."+t,a=f[t];"object"===e.typeof(a)&&H(a,i,l),q(i,l),o=[]})),u.immediate&&u.handler&&u.handler.call(V,c[a],$[a])}q(s,l),o=[]}))}catch(t){e.showLog(t)}}function q(t,n){var i=function(t){try{var i=[t.value,t.preValue||"",t];if("init"!==t.action){var a=n;switch(e.typeof(a)){case"function":a.apply(V,i);break;case"array":a.forEach((function(e,t){e.apply(V,i)}));break;case"string":new Function(a+"(".concat(t.value,",").concat(t.preValue||"",")"))();break;default:a.apply(V,i)}}}catch(t){e.showLog(t)}};return Le(t,i),Pe.bind(this,t,i)}function K(n){try{var i=null,o=null;void 0===n?(i=j,o=a):"string"==typeof n?(i=T(n),o=a):n&&"object"===_typeof(n)&&(i=T(n)||t(n),o=t.extend(!0,{},a,n));var r=!0;if(o.beforeCompiles.forEach((function(e,t){if(!1===(r=e.call(V,o)))return!1})),!1===r)return R=[],!1;if(re(i),G({el:i,action:"first"}),function(t){var n=t,i=n.find("[b-watch*=".concat(s,"]")),a=n.find("[b-one*=".concat(s,"]"));if(i.length)try{le(i,"b-watch",Le)}catch(t){e.showLog(t)}if(a.length)try{le(a,"b-one",Se)}catch(t){e.showLog(t)}}(i),o.needComponent)return loader.components({id:i,compiled:function(){ne(i),te(i),ae(i),ie(i),!0,J(),R=[],o.compileds.forEach((function(e,t){e.call(V,o)}))}}),this;ne(i),te(i),ae(i),ie(i),!0,J(),R=[],o.compileds.forEach((function(e,t){e.call(V,o)}))}catch(t){e.showLog(t)}return this}function W(t){("string"==typeof t?e.$(t).find("component"):t.find("component")).each((function(e,t){loader.component({id:t})}))}function J(){return j.find("[ref]").each((function(){var t=this.getAttribute("ref"),n=S.hasOwnProperty(t),i=null;n&&"htmldivelement"===e.typeof(S[t])?((i=[S[t]]).push(this),S[t]=i):n&&"array"===e.typeof(S[t])?S[t].push(this):S[t]=this})),this}function X(n){try{var i=this,a="string"==typeof n?n:"",o=new RegExp("{{[\\s]?"+s+d+"(.*?)}}","mg");return a=a.replace(o,(function(n,a){var o=a.split(s+d);""===t.trim(o[0])&&o.shift();var r=o.length>0&&e.unit.getKeyValue(o.join("."),$)||"";return"function"==typeof r?r.call(i):r}))}catch(t){e.showLog(t)}}function Y(e){var n=t(e).closest("[b-template]"),i=n.length?n.children()[0]:null,a=i&&i.classList[0]?"."+i.classList[0]:i&&i.nodeName||"";return a&&t(e).closest(a)}function Z(t,n){var i;return B&&B.hasOwnProperty(t)?i=B[t]:(void 0===(i=e.unit.getKeyValue(t,n))&&A&&console.warn("请检查 ".concat(t," 在bui.store scope:").concat(s," 中有没有声明定义")),B[t]=i),i}function G(n){var i=1==n.replace;try{var a="object"===e.typeof(n)?n.el:n,o=[],r=(a.prop("outerHTML")||a.html()||"").match(D)||[],l=e.array.uniq(r).reverse();l.length&&l.forEach((function(r,l){var c=a.find("[".concat(r,"*=").concat(s,"]"));c.length<1&&(c=a.closest("[".concat(r,"*=").concat(s,"]"))),c.length&&c.each((function(l,c){var u=this,f="",p=me.call(this,"".concat(r)),h=p[0]&&p[0].keyname||"",m=h.indexOf(".length"),v=m>-1?h.substr(0,m):h,y=p[0]&&p[0].param;Z(v,V);var b=me.call(this,"b-linked");if(b.length&&b.forEach((function(t,n){Le(t.keyname,(function(t){Ce(h,{target:null,value:e.unit.getKeyValue(h,V),action:"set",keyname:h,param:y,origin:$})}))})),"b-show"===r)switch(p[0]&&p[0].rule){case"!":f="b-hide";break;default:f="b-show"}else f=r;if(g){var k=e.array.compare(z[f],v);!k&&z[f].push(v),!k&&Le(v,F[f].bind(u))}else{var O=function(i){var o=arguments;try{if(L.indexOf("$index")>-1){var l=v.match(/([0-9]+)/g),c=l[l.length-1],p=a.find("[".concat(r,'="').concat(I,'"]')),h=p.attr("b-target");p.each((function(e,n){h=t(n).attr("b-target")}));var m=h?a.find(h).eq(c):null,g=arguments;return void(h&&m&&m.length?(m.find("[".concat(r,'="').concat(I,'"]')).each((function(e,t){var n=t||u;F[f].apply(n,g)})),m.closest("[".concat(r,'="').concat(I,'"]')).each((function(e,t){var n=t||u;F[f].apply(n,g)}))):(p.each((function(e,t){var i=t||u;e!=c||"first"!==n.action?"first"!==n.action&&F[f].apply(i,g):F[f].apply(i,g)})),a.closest("[".concat(r,'="').concat(I,'"]')).each((function(e,t){var n=t||u;F[f].apply(n,g)}))))}if(L.indexOf("$key")>-1){var y=Y(u),b=y&&y.index(),w=b||0;L.indexOf("$key1")>-1?w=b+1:L.indexOf("$key01")>-1&&(w=b<10?"0"+(b+1):b+1),i.value=w}if(L.includes("$itemIndex")){var x=i.keyname.match(/[\d]+/g),k=+x[x.length-1],O=null;if(L.includes("$parentItemIndex")){var S=s+d+L.replace(/\.\$parentItemIndex.+/,""),P=s+d+L.replace(/\.\$itemIndex.+/,"").replace(/\$parentItemIndex/,"$itemIndex");j.find('[b-template$="'.concat(S,')"]')).each((function(e,n){var i=t(n).children().eq(x[0]);O=i.find('[b-template*="'.concat(P,'"]')).children().eq(k).find("[".concat(f,'*="').concat(L,'"]'))}))}else O=j.find("[".concat(f,'*="').concat(L,'"]')).closest("[b-template]").children().eq(k).find("[".concat(f,'*="').concat(L,'"]'));O.each((function(e,t){F[f].apply(t,o)}))}else F[f].apply(u,arguments)}catch(t){e.showLog(t)}};!_&&0===l&&Pe(v,O),i&&Pe(v,O);var I=this.getAttribute(r)||"",L=I.replace(s+d,"");Le(v,(function(){O.apply(u,arguments)}))}e.array.compare(o,v)||o.push(v),R=[],w=!1,x=!0}))})),ee(o,n)}catch(t){e.showLog(t)}}function Q(){var t=me.call(this,"b-trigger"),n=t&&t[0]&&t[0].keyname||"",i=t&&t[0]&&t[0].param||[],o=[];return n.indexOf(a.paramSplit)>-1?o=n.split(a.paramSplit):o.push(n),o.forEach((function(t){var n=e.unit.getKeyValue(t,$),a=e.unit.getKeyValue(t,V);if("function"==typeof a)return L=!1,void a.apply(V,i);Ce(t,{target:null,value:a,preValue:n,action:"set",keyname:t,param:{},origin:$})})),this}function ee(t,n){t.forEach((function(t,i){var a=e.unit.getKeyValue(t,V);Ce(t,{target:null,action:"object"===e.typeof(n)&&n.action||"init",value:a,param:null,keyname:t,origin:$}),R=[]}))}function te(t){var n=t,i='[type="text"][b-model-lazy*='.concat(s,'],\n                                 [type="search"][b-model-lazy*=').concat(s,'],\n                                 [type="password"][b-model-lazy*=').concat(s,'],\n                                 [type="url"][b-model-lazy*=').concat(s,'],\n                                 [type="number"][b-model-lazy*=').concat(s,'],\n                                 [type="email"][b-model-lazy*=').concat(s,'],\n                                 [type="range"][b-model-lazy*=').concat(s,'],\n                                 [type="tel"][b-model-lazy*=').concat(s,"],\n                                 textarea[b-model-lazy*=").concat(s,"]");if("input"===a.modelEvent){var o=!1;n.off("input compositionstart compositionend",i).on(v,i,e.unit.debounce((function(e){o||r.call(e.target,e)}),m)).on("compositionstart",i,(function(e){o=!0,e.stopPropagation()})).on("compositionend",i,e.unit.debounce((function(e){o=!1,r.call(e.target,e),e.stopPropagation()}),m))}function r(t){var n=t.target.value,i=me.call(this,"b-model-lazy"),a=i[0]&&i[0].keyname||"";if(""===a)return e.showLog("b-model-lazy的值不能为空"),!1;ke(a,n),Q.call(this),R=[],t.stopPropagation()}}function ne(n){var i=n,o='[type="text"][b-model*='.concat(s,'],\n                                 [type="search"][b-model*=').concat(s,'],\n                                 [type="password"][b-model*=').concat(s,'],\n                                 [type="url"][b-model*=').concat(s,'],\n                                 [type="number"][b-model*=').concat(s,'],\n                                 [type="email"][b-model*=').concat(s,'],\n                                 [type="range"][b-model*=').concat(s,'],\n                                 [type="tel"][b-model*=').concat(s,"],\n                                 textarea[b-model*=").concat(s,"]");if("input"===a.modelEvent){var r=!1;i.off("input compositionstart compositionend",o).on(v,o,(function(e){r||l.call(e.target,e)})).on("compositionstart",o,(function(e){r=!0,e.stopPropagation()})).on("compositionend",o,(function(e){r=!1,l.call(e.target,e),e.stopPropagation()}))}else i.off(v,o).on(v,o,l);function l(t){var n=t.target.value,i=me.call(this,"b-model"),a=i[0]&&i[0].keyname||"";if(""===a)return e.showLog("b-model的值不能为空"),!1;ke(a,n),Q.call(this),R=[],t.stopPropagation()}var c='[type="checkbox"][b-model*='.concat(s,'],\n                                 [type="radio"][b-model*=').concat(s,"]");i.off("change",c).on("change",c,(function(t){try{var n,a=this,o=this.getAttribute("value")||this.checked,r=this.getAttribute("type"),l=me.call(this,"b-model")[0].keyname,c=this.getAttribute("check-value"),u=this.getAttribute("uncheck-value"),d=this.getAttribute("check"),f=this.getAttribute("uncheck");(d||f||c||u)&&(o=this.checked?c||this.value||d:u||f||""),n=Z(l,V);var p=/\{.+\}$/g.test(o),h=p?null:i.find('[type="checkbox"][b-model="'.concat(s+"."+l,'"][value="').concat(o,'"],\n                 [type="radio"][b-model="').concat(s+"."+l,'"][value="').concat(o,'"]'));switch(r){case"checkbox":var m=p?JSON.parse(o):o;this.checked&&(n&&"array"===e.typeof(n)?!e.array.compare(n,o)&&e.unit.getKeyValue(l,V).push(m):ke(l,m),this.checked=!0),this.checked||(n&&"array"===e.typeof(n)?e.array.remove(e.unit.getKeyValue(l,V),m):ke(l,m),this.checked=!1),h&&h.each((function(e,t){this.checked=a.checked})),Q.call(this);break;case"radio":default:var g=e.unit.getKeyValue(l,V);n&&"array"===e.typeof(n)?g.splice(0,1,o):ke(l,o),Q.call(this)}R=[],t.stopPropagation()}catch(t){e.showLog(t)}}));var u="select[b-model*=".concat(s,"]");i.off("change",u).on("change",u,(function(n){try{var i=t(this).val(),a=(this.selectedIndex,this.multiple),o=me.call(this,"b-model")[0].keyname,r=null;switch(r=Z(o,V),a){case!0:"array"!==e.typeof(r)&&e.showLog("".concat(o,"的类型必须为数组")),i.splice(0,0,0,i.length+1),r.splice.apply(r,i);break;default:ke(o,i)}Q.call(this),R=[],n.stopPropagation()}catch(n){e.showLog(n)}}))}function ie(e){e.off("change","[b-checked*=".concat(s,"]")).on("change","[b-checked*=".concat(s,"]"),(function(e){var t=this.checked;ke(me.call(this,"b-checked")[0].keyname,t),Q.call(this),R=[],e.stopPropagation()}))}function ae(t){var n=t;["b-click","b-submit","b-change","b-scroll-lazy","b-scroll","b-keydown","b-keyup","b-keypress","b-focus","b-input-lazy","b-input","b-blur","b-mousedown","b-mouseover","b-mouseup","b-touchstart","b-touchmove","b-touchend"].forEach((function(t,i){var a=t.substr(2),o=function(e){var n=oe.call(this,e,t);if(!1===n)return!1;void 0===n&&e.stopPropagation()};if("scroll-lazy"===a||"scroll"===a){var r=n.find("[".concat(t,"*=").concat(s,"]")),l=r.attr("lazy")?parseInt(r.attr("lazy")):300;o="scroll-lazy"===a?e.unit.debounce(o,l):o,r.off("scroll").on("scroll",o)}else if("input-lazy"===a||"input"===a){var c=n.find("[".concat(t,"*=").concat(s,"]")),u=c.attr("lazy")?parseInt(c.attr("lazy")):300;o="input-lazy"===a?e.unit.debounce(o,u):o,c.off("input").on("input",o)}else n.off(a,"[".concat(t,"*=").concat(s,"]")).on(a,"[".concat(t,"*=").concat(s,"]"),o)}))}function oe(t,n){var i=me.call(this,n),a=i[0].keyname,o=i[0].param,r=null;o.push(t);try{var l="function"==typeof(r=Z(a,V))&&r.apply(V,o);return R=[],Ce(a,{target:this,value:r,action:"set",keyname:a,param:o,origin:$}),l}catch(t){e.showLog(t)}}function re(t){var n=t&&t.find("[b-template*=".concat(s,"]"))||[],i=[];if(n.length)try{n.each((function(t,n){var a=T(this),o=me.call(this,"b-template"),r=this.getAttribute("b-template"),l=o[0].keyname,c=o[0].param,u=s+d;c[0]||console.error('b-template 没有找到数据源, 格式为: b-template="page.template(page.sources)"');var f="string"==typeof c[0]&&c[0].replace(new RegExp(u),"")||"",h=a.attr("b-command")||"html",m=a.attr("b-children")||a.children()[0]&&a.children()[0].tagName;Z(f,V);g&&Pe(f),O.hasOwnProperty(f)?O[f].push(f):O[f]=[f],Le(f,(function(t){try{if(r.includes("$itemIndex")){t.keyname.replace(/\d+/,"$itemIndex");var n=t.keyname.match(/\d+/);a=j.find('[b-template*="'.concat(r,'"]')).eq(n[0])}var i,o=t.param;switch(t.action){case"push":case"unshift":i=o;break;case"splice":i=o.slice(2)||"";break;case"setState":h="html",i=t.value;break;default:i=t.value}if(p&&p.hasOwnProperty(l)){(c=c.map((function(e,t){return"string"==typeof e&&0==e.indexOf(s+d)&&t>0?Z(e.replace(new RegExp(u),""),$):e})))[0]=i;var v=void 0!==i&&"undefined"!==i&&p[l]&&p[l].apply(V,c);void 0===v&&(v="",e.showLog("".concat(l,"模板方法需要返回内容，例如：return html;"))),g&&(a=T('[b-template*="'.concat(u+f,'"]')));var y=t.preValue||[];0==y.length&&"html"==h&&a.empty();var b=m?a.children(m):a.children(),w=b,x=o&&o.length||0,k=null;switch(_=!0,t.action){case"push":if(a.append(v),b=a.children(m),x&&x==b.length)G({el:b,action:"push"}),re(k);else if(x>1)for(var O=w.length,I=O;I<b.length;I++)G({el:k=b.eq(O+I-1),action:"push"}),W(k),re(k);else G({el:k=b.last(),action:"push"}),W(k),re(k);break;case"unshift":if(a.prepend(v),b=a.children(m),x&&x==b.length)G({el:b,action:"unshift"});else if(x>1)for(I=0;I<x;I++)G({el:k=b.eq(I),action:"unshift"}),W(k),re(k);else G({el:k=b.first(),action:"unshift"}),W(k),re(k);break;case"pop":b.last().remove(),G({el:k=(b=a.children(m)).last(),action:"pop"}),W(k),re(k);break;case"shift":b.first().remove(),G({el:k=(b=a.children(m)).first(),action:"shift"}),W(k),re(k);break;case"length":break;case"splice":var L=parseInt(o[0]),S=parseInt(o[1]);S>=y.length&&"html"==h&&(a.empty(),b=a.children(m));var P=b.length,C=P>0,N=!1;if(0==S)if(C&&P-1>=L){b.eq(L).before(v),b=a.children(m);for(I=0;I<i.length;I++)G({el:k=b.eq(L+I),action:"splice"}),W(k),re(k)}else{a.append(v),b=a.children(m);for(I=0;I<i.length;I++)G({el:k=b.eq(P+I),action:"splice"}),W(k),re(k)}else if(S>0){var E=e.unit.getKeyValue(t.keyname,t.origin);if(o[1]-o[0]>=(E&&E.length)&&(N=!0),void 0!==o[2])if(C&&P-1>=L){b.eq(L).before(v),b=a.children(m);for(I=0;I<i.length;I++)G({el:k=b.eq(L+I),action:"splice",replace:N}),W(k),re(k)}else{a.append(v),b=a.children(m);for(I=0;I<i.length;I++)G({el:k=b.eq(P+I),action:"splice",replace:N}),W(k),re(k)}var R=0;switch(h){case"append":R=b.length-t.preValue.length||0;break;case"prepend":case"html":default:R=0}for(I=0;I<S;I++)b.eq(L+i.length+I+R).remove();v&&!t.value.length&&a.html(v)}break;case"reverse":case"sort":a.html(v),G({el:a,action:t.action}),W(a),re(a);break;default:a[h](v),G({el:a,action:t.action}),W(a),re(a)}Ce.call(V,"nexttick",t)}else e.showLog("找不到对应的模板,请检查下 scope:".concat(s," 的templates是否存在").concat(l),"bui.store")}catch(t){e.showLog(t)}})),e.array.compare(i,f)||i.push(f),R=[]})),ee(i)}catch(t){e.showLog(t)}}function le(e,t,n){e.each((function(e,i){T(this);var a=me.call(this,t);a[0].keyname;var o=a[0].param,r=s+d;o[0]||console.error("".concat(t," 没有找到数据源, 格式为: ").concat(t,'="page.doit(page.sources)"')),Z("string"==typeof o[0]&&o[0].replace(new RegExp(r),"")||"",V);var l=this;function c(e){var n=me.call(l,t),i=n[0].keyname,a=n[0].param;a.push(e),U[i].apply(V,a)}a[0].paramKeyname.forEach((function(e,t){n(e,c)}))}))}function ce(e){return 0==this.getAttribute(e).indexOf("!")}function se(e,n){var i=s+d+e.keyname;return g?t("[".concat(n,'="').concat(i,'"]')):T(this)}function ue(t,n){if(n.indexOf(".length")>-1)return t.value.length||0;if("object"!==e.typeof(t.value))return"array"===e.typeof(t.value)?(t.value=t.value.map((function(e,t){if("object"!==_typeof(e))return e;try{return JSON.stringify(e)}catch(t){return e}})),t.value.join(",")):t.value;try{return JSON.stringify(t.value)}catch(t){return t.value}}function de(t){var n=this.getAttribute("type"),i=this.value,a=this,o=this.getAttribute("b-value");switch(n){case"radio":i==t.value?this.checked=!0:this.checked=!1;break;case"checkbox":"array"===e.typeof(t.value)&&t.value.forEach((function(e,t){i==e&&(a.checked=!0)}));break;default:this.value=ue(t,o)}}function fe(n){var i=this,a=i.getAttribute("type"),o=i.value;if(n.param,"SELECT"===i.nodeName&&i.multiple)n.value.length>1?n.value.forEach((function(e,n){"string"==typeof e?t(i).find("option[value=".concat(e,"]")).attr("selected",!0):t(i).find("option[value=".concat(e.value,"]")).attr("selected",!0)})):i.value=n.value[0];else if("COMPONENT"!==i.nodeName){switch(a){case"radio":o==n.value?i.checked=!0:i.checked=!1;break;case"checkbox":if(o&&"array"===e.typeof(n.value))switch(n.action){case"push":case"unshift":n.param&&n.param.filter((function(e,t){o!==e||(i.checked=!0)}));break;case"pop":case"shift":n.param&&n.param.filter((function(e,t){o===e&&(i.checked=!1)}));break;case"splice":var r=n.param,l=r&&r[1]&&parseInt(r[1]),c=r&&r.slice(2);0==l?c.forEach((function(e,t){o===e&&(i.checked=!0)})):l>0&&(n.preValue.forEach((function(e,t){t<=n.param[1]&&(i.checked=!1)})),n.value.forEach((function(e,t){o===e&&(i.checked=!0)})));break;case"length":break;default:n.value.filter((function(e,t){o==e&&(i.checked=!0)}))}else n.value===o||1==n.value?i.checked=!0:i.checked=!1;break;default:if(event&&event.target&&"INPUT"===event.target.nodeName&&event.target===i&&i.value===n.value)break;i.value=n.value}R=[]}else{var s=i.id?i.id:e.guid();!i.id&&(i.id=s);var u="true"===i.getAttribute("everytime");loader.delay({id:"#".concat(i.id),everytime:u,param:{value:n.value,keyname:n.keyname}})}}function pe(e,t,n){switch(t){case"disabled":n?e.attr(t,n):e.removeAttr(t);break;case"checked":e.prop(t,n);break;default:var i="object"===_typeof(n)?JSON.stringify(n):n;e.attr(t,i)}R=[]}function he(e,t,n,i){"boolean"==typeof n?(n&&e.addClass(t),!n&&e.removeClass(t)):"string"==typeof n?(g&&e.removeClass(n),i&&e.removeClass(i),n&&!e.hasClass(n)&&e.addClass(n),void 0!==i&&""===n&&e.removeClass(i)):(Boolean(n)&&e.addClass(t),!Boolean(n)&&e.removeClass(t))}function me(t){var n=[],i=this,o=this.getAttribute(t)||"",r=o.indexOf(a.paramSplit)>-1?o.split(a.paramSplit):o&&[o]||[];try{r.forEach((function(e,a){var o={},r=ge.call(i,e,t);o.scope=s,o.rule=r.rule,o.keyname=r.name,o.param=r.param,o.paramKeyname=r.paramKeyname,o.eventType=r.eventType,o.eventProperty=r.eventProperty,n.push(o)}))}catch(t){e.showLog("参数处理出错")}return n}function ge(n,i){try{var a=n?n.match(/([^\(|\)]+)/g):[],o=[],r="",l="",c=null,u=[],f=null,p=this,h="",m=(P=t(p).attr("b-target"))&&t(p).parents(P)[0]||p,g=null,v="",y="";if(h=(h=(c=(a=a.map((function(e,n){var i=e;if(p.getAttribute("b-template")&&i.indexOf("$itemIndex")>-1){var a=t(p).parents("[b-template]").children()[0],o=a.classList[0]?"."+a.classList[0]:a.nodeName,r=t(p).closest(o).index();i=i.replace(/\$itemIndex/g,r)}return i})))[0]&&a[0].indexOf(s+d)>-1?a[0].split(s+d):[s,a[0]])[0].split(s))[0]||h[1]||"",r=s,(l=c[1]||"").indexOf("$index")>-1){var b=t(m).index();l=l.replace("$index",b)}else if(l.indexOf("$id")>-1){var w=m.id;l=l.replace("$id",w)}else if(l.indexOf("$parentIndex")>-1){var x=t(m).parent().index();l=l.replace("$parentIndex",x)}var k=null,O="";if(!p.getAttribute("b-template")&&(n.indexOf("$itemIndex")>-1||n.indexOf("$itemId")>-1||n.indexOf("$item")>-1)){var I=(k=t(p).closest("[b-template]")||t(p).closest(".bui-template")||t(p).closest(".bui-list")||t(p).closest("ul")).children()[0];O=k?k.attr("b-children")||(I.classList[0]?"."+I.classList[0]:null)||I.nodeName:"";var L=(g=t(p).closest(O)).index();l=l.replace("$itemIndex",L)}if(l.includes("$parentItemIndex")){var S=ve(p);l=l.replace(/\$parentItemIndex/g,S)}if(void 0!==a[1]){var P,C=(P=t(m).attr("b-target"))&&t(m).closest(P)[0]||m,T=a[1].replace(/\$index/g,t(C).index())||"";try{var j=/\{.+\}$/g,N=/\[.+\]$/g,E=T?T.match(/(\'(.*?)\'.*?)|(\"(.*?)\".*?)|(\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14})|(^((https|http|ftp|rtsp|mms)?:\/\/)[^\,]+)|([a-zA-Z0-9][-a-zA-Z0-9\._]{0,62})|(\{.+\})|(\[.+])|([$\w\.]+)|([\d\.]+)|([\u4e00-\u9fa5|\w|\d]+)/g):[];a[1].split(",").forEach((function(e,n){e.indexOf(s+d)>-1&&o.push(e.replace(s+d,"").replace(/\$index/g,t(C).index()))})),u=E.map((function(n,a){var o=n.replace(/^\"|^\'|\"$|\'$/g,"");switch(n){case"$this":o=C;break;case"$index":o=t(C).index();break;case"$parentItemIndex":o=ve(p);break;case"$itemIndex":o=g.index();break;case"$itemId":o=g.attr("id");break;case"$itemText":o=g.text();break;case"$itemHtml":o=g.html();break;case"$item":o=g[0];break;case"$parentIndex":o=t(C).parent().index();break;case"$parent":o=C.parentNode;break;case"$children":o=t(C).children();break;case"$prev":o=t(C).prev();break;case"$next":o=t(C).next();break;case"$id":o=C.id;break;case"$text":o=C.textContent;break;case"$value":o=C.value;break;case"$html":o=C.innerHTML}if("b-template"!==i){var r=s+d;if(e.unit.startWithStr(o,r)){var l=e.unit.getKeyValue(o.split(r)[1],V);o=void 0===l?o:l}}return o=/^\d+$/.test(o)&&o.length<17?parseFloat(o):o,j.test(n)||N.test(n)?JSON.parse(n):o}))}catch(t){e.showLog(t,"getArguments"),u=[]}}void 0!==a[2]&&(v=(f=a[2].indexOf(".")>-1?a[2].split("."):[a[2]])[0],y=f[1]||"")}catch(t){e.showLog("参数格式错误:"+n)}return{scope:r,rule:h,name:l,param:u,paramKeyname:o,eventType:v,eventProperty:y}}function ve(e){var n=t(e).parents("[b-template]"),i=(n[1]||n[0]).children[0],a=i.classList[0]?"."+i.classList[0]:i.nodeName;return t(e).closest(a).index()}function ye(n,i){if(!n||!n.hasOwnProperty("widget")||"function"!=typeof n.widget)return function(n,i){if(i&&"array"===e.typeof(i)){if(i.length>1){var r=i.pop();l(e.unit.getKeyValue(i.join("."),n),r)}else l(n,i[0]);return}function l(n,i){var r=n&&n[i];if(n&&function(n,i){var r=n[i],l="function"==typeof r?r.call(V):r,u=[];Object.defineProperty(n,i,{enumerable:!0,configurable:!0,get:function(){return P.target=this,(w||!w&&x)&&R.push(i),C.target&&u.push(C.target),l},set:function(n){if(n===l)return R=[],L=!1,o=!1,w=!1,x=!0,!0;P.target===this&&(R=[]),P.target=this;var r="array"===e.typeof(l)&&"array"===e.typeof(n);(!x||!w&&x)&&R.push(i);var d=R.join("."),f=e.array.copy(R);!r&&!L&&Ce.call(V,"beforeupdate",{action:"set",value:n,preValue:l,keyname:d,origin:$}),!r&&!L&&a.beforeUpdates.forEach((function(e,t){e.call(V,{action:"set",value:n,preValue:l,keyname:d,origin:$})})),A&&console.log("4. data setting ".concat(d),n);var p=e.unit.getKeyValue(d,$);if(r){var h,m=t.extend(!0,[],n);(h=l).splice.apply(h,[0,l.length].concat(_toConsumableArray(m)))}else l="object"===e.typeof(n)?t.extend(!0,{},n):n,!L&&Ce(d,{action:"set",value:l,preValue:p,keyname:d,origin:$});u.forEach((function(e){return e()})),e.unit.setKeyValue(d,l,$),"array"===e.typeof(l)?ye(c,f):"object"===e.typeof(l)&&(a.deep&&ye(l),l&&Object.keys(l).forEach((function(e,t){var n=d+"."+e;R=[],be(n)&&Ce(n,{target:null,value:l[e],preValue:p&&p[e],action:"set",keyname:n,origin:$})}))),!r&&!L&&Ce.call(V,"updated",{action:"set",value:l,preValue:p,keyname:d,origin:$}),!r&&!L&&a.updateds.forEach((function(e,t){e.call(V,{action:"set",value:l,preValue:p,keyname:d,origin:$})}));var g=j.find('[b-template*="'.concat(s,".").concat(d,'"]'));return g.length&&!o&&g.each((function(e,n){G({el:t(n),action:"set"})})),R=[],L=!1,o=!1,w=!1,x=!0,!0}})}(n,i),"array"===e.typeof(r)&&function(t,n){var i=[],o=Array.prototype,r=Object.create(o);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var l=o[t];Object.defineProperty(r,t,{enumerable:!0,configurable:!0,value:function(o){var r=Array.prototype.slice.call(arguments);Ce.call(V,"beforeupdate",{target:null,action:t,param:r,value:this,prevValue:[],keyname:n,origin:$});var u=i.join(".")||n;!c.hasOwnProperty(n)&&R.length?(i.unshift(R.join(".")),u=i.join(".")||n):(i.push(n),u=i.join(".")),R.length>1&&R[0]!==n&&(u=R.join("."));var d=this.slice(0),f=l.apply(this,r);switch(A&&console.log("5. ".concat(u," action ").concat(t,", param:").concat(r," ")),t){case"pop":case"shift":r=[f]}e.unit.setKeyValue(u,this,$);var p=j.find('[b-template*="'.concat(s,".").concat(u,'"]'));if("splice"===t&&r[1]>=0)if(void 0!==r[2]){var h=_toConsumableArray(r);h.splice(0,2);for(var m=0,g=r[0]+r[1],v=r[0];v<g;v++){var y=u+"."+v,b=e.unit.getKeyValue(y,$),O=h[m];void 0!==O&&Ce(y,{target:p,action:t,param:r,value:O,preValue:b,keyname:y,origin:$}),m++}}else for(var I=r[0]+r[1],L=r[0];L<I;L++){var S=u+"."+L,P=e.unit.getKeyValue(S,$);Ce(S,{target:p,action:t,param:r,value:"",preValue:P,keyname:S,origin:$})}Ce(u,{target:p,action:t,param:r,value:this,preValue:d,keyname:u,origin:$});var C=i[0]||n;return k[C]&&"array"===e.typeof(k[C])&&k[C].forEach((function(e){return e()})),be(u+".$key")&&Ce.call(V,u+".$key",{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:$}),be(u+".$key1")&&Ce.call(V,u+".$key1",{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:$}),be(u+".$key01")&&Ce.call(V,u+".$key01",{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:$}),Ce.call(V,"updated",{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:$}),a.updateds.forEach((function(e,i){e.call(V,{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:$})})),i=[],R=[],w=!1,x=!0,f}})})),r.$index=function(t,n){return e.array.index(this,t,n)},r.$include=function(t,n){return e.array.compare(this,t,n)},r.$filter=function(t,n){return e.array.filter(this,t,n)},r.$empty=function(){return e.array.empty(this)},r.$replace=function(t){return e.array.replace(this,t)},r.$merge=function(){var t;return(t=e.array).merge.apply(t,[this].concat(Array.prototype.slice.call(arguments)))},r.$get=function(t,n){return e.array.get(this,t,n)},r.$set=function(t,n,i){return e.array.set(this,t,n,i)},r.$delete=function(t,n){return e.array.delete(this,t,n)},r.$deleteIndex=function(t){return e.array.deleteIndex(this,t)},t.__proto__=r}(r,i),r&&"object"===e.typeof(r))return ye(r)}n&&Object.keys(n).forEach((function(e){l(n,e)}))}(n,i)}function be(e){var t=s+d,n=e.includes(s+t)?b+"_"+e:b+"_"+t+e;return P.has.call(V,n)}var we=[];function xe(t,n){var i=e.array.index(we,n,"field");return!!(i>-1&&we[i]&&t.$options.el===we[i].el)&&(we[i].disconnect&&we[i].disconnect(),!0)}function ke(n,i){var o="string"==typeof n,r=i;R=[];var l=e.unit.getKeyValue(n,$);if(o&&void 0!==i){var s,u;if(A&&console.log("set ".concat(n," ")),L=!0,Ce.call(V,"beforeupdate",(_defineProperty(s={action:"set",target:null,value:r,preValue:l},"action","set"),_defineProperty(s,"keyname",n),_defineProperty(s,"origin",$),s)),a.beforeUpdates.forEach((function(e,t){var i;e.call(V,(_defineProperty(i={action:"set",target:null,value:r,preValue:l},"action","set"),_defineProperty(i,"keyname",n),_defineProperty(i,"origin",$),i))})),i&&"object"===e.typeof(i)?(r=t.extend(!0,{},l,i),Object.keys(i).forEach((function(e,t){var a=n+"."+e;Ce.call(V,a,{target:null,value:i[e],preValue:l,action:"set",keyname:a,origin:$})}))):r=i,"array"===e.typeof(r)){var f=e.unit.getKeyValue(n,V);f.splice.apply(f,[0,f.length].concat(_toConsumableArray(r)))}else e.unit.setKeyValue(n,r,c),e.unit.setKeyValue(n,r,$);Ce.call(V,n,{target:null,value:r,preValue:l,action:"set",keyname:n,origin:$}),Ce.call(V,"updated",(_defineProperty(u={action:"set",target:null,value:r,preValue:l},"action","set"),_defineProperty(u,"keyname",n),_defineProperty(u,"origin",$),u)),a.updateds.forEach((function(e,t){var i;e.call(V,(_defineProperty(i={action:"set",target:null,value:r,preValue:l},"action","set"),_defineProperty(i,"keyname",n),_defineProperty(i,"origin",$),i))})),"object"===_typeof(i)&&("array"===e.typeof(i)?ye(c,n.split(d)):ye(i)),R=[]}else n&&"object"===e.typeof(n)&&($=t.extend(!0,{},$,n),Ie(n));return $}function Oe(t,n){return function(t,n){"string"==typeof t&&(e.unit.delKey(t,$),n&&n.call(V,t))}(t,(function(e){Ce(t)})),$}function Ie(t,n){for(var i in t){var a=void 0===n?i:n+i,o=t[i];Ce(a,{target:null,value:o,preValue:$[i]||"undefined",action:"set",param:null,keyname:a,origin:$}),o&&"object"===e.typeof(o)&&Ie(o,i+".")}}function Le(t,n){var i="";return i=t&&"array"===e.typeof(t)?t.map((function(e,t){return b+"_"+s+d+e})):b+"_"+s+d+t,P.on.call(V,i,n),this}function Se(e,t){return I.hasOwnProperty(e)||(Le(e,t),I[e]=t),this}function Pe(e,t){if(e){var n=b+"_"+s+d+e;P.off.call(V,n,t)}else V.handle={};return this}function Ce(e){var t=b+"_"+s+d+e;arguments[0]=t;var n=arguments[1]&&arguments[1].value||arguments[1];return A&&console.warn(t,n,"trigger"),P.trigger.apply(V,arguments),w=!1,x=!0,this}return V}}(window.bui||{},window.libs),function(e,t){e.viewport=function(n,i){e.trigger.call(e,"viewportbefore");var a,o=t.extend(!0,{uid:"",width:"device-width",initScale:1,maxScale:1,minScale:1,fit:"cover",scalable:"no",zoom:!0,hd:!0,base:750,size:0,create:!1},e.config.viewport),r="object"==_typeof(n)?t.extend(!0,o,n):o,l=document.querySelector("meta[name=viewport]"),c='"width='.concat(r.width,", initial-scale=").concat(r.initScale,", maximum-scale=").concat(r.maxScale,", minimum-scale=").concat(r.minScale,", user-scalable=").concat(r.scalable,",viewport-fit=").concat(r.fit,'"'),s=window.devicePixelRatio,u=document.documentElement.clientWidth||window.innerWidth,d=document.documentElement.clientHeight||window.innerHeight,f=parseInt(u)*parseInt(s),p=parseInt(d)*parseInt(s);if(u=u>d&&d>1?d+24:u,r.size="number"==typeof n?n:r.size||(u/r.base*100).toFixed(2),l)r.create&&(l.content=c);else{var h=document.createElement("meta");h.name="viewport",h.content=c,document.head.appendChild(h),h=null}var m=e.array.index([240,320,360,375,384,393,412,414,435,480,512,540,768,1024,1080,1536,2048,2732,534,854,750],document.documentElement.clientWidth);m>-1&&void 0===n?a=[32,42.67,48,50,51.2,52.4,54.93,55.2,58,64,68.27,60,60,60,60,60,60,60,60,60,60][m]:v(r);var g={width:function(e){return u||t("body").width()||t("#bui-router").width()||t(".bui-page").width()},height:function(e){return d||t("body").height()||t("#bui-router").height()||t(".bui-page").height()},fontSize:a,screenWidth:function(e){return f},screenHeight:function(e){return p},ratio:function(e){return s},init:v};function v(t){var n=document.head.parentNode,i=t.size;return t.hd&&(i+=s>2?10*(s-2):0),a=i||48,r.zoom&&(n.style.fontSize=a+"px"),r.uid&&e.history.setUI&&e.history.setUI({uid:r.uid,ui:g}),e.trigger.call(e,"viewportinit"),this}return g}}(window.bui||{},window.libs),function(e,t){e.loader=function(n){var i,o=t.extend({},{cache:!0,log:!1,baseUrl:"",relativePath:"pages",needNative:!1,deepView:!1,viewTag:"view",componentTag:"component",deepComponent:!0,scriptSuffix:".js"},e.config.loader,n),r=e.emitter(),l=[],c=[],s={},u={baseUrl:"",modules:{},globals:{}},d={},f={init:function(e){return e=e||{},o=t.extend({},o,e),f.config=o,this},config:o,define:function(n,i,a){var r={moduleName:"",template:"",script:"",path:"",props:null,isComponent:!1,params:null,data:null,depend:[],beforeCreate:null,created:null,beforeLoad:null,loaded:null,hide:null,exports:null,show:null,beforeDestroy:null,destroyed:null},l={},c="";try{var s=v().name?v():function(e){var t=window.location.pathname,n=t.indexOf(".html"),i="",a="";a=n>-1?(i=t.substr(1,n))+".js":(i=t.substr(1))+".js";return{name:i,src:a}}(),f=s.name}catch(e){}var h=[];if(void 0===n)return e.showLog("define第1个参数不能为空"),this;"function"==typeof n?(a=n,c=f,i=[]):"object"===e.typeof(n)?(c=f,i=n.depend||[],a=n.loaded,l=t.extend(!0,{},r,n)):"array"===e.typeof(n)?(a=i,i=n,c=f):"function"==typeof i?(c=n,a=i,i=[]):(c=n,i=i,a=a);var m=d.hasOwnProperty(c)&&d[c].script||s.src,b=window.location.href.substr(0,window.location.href.indexOf("#")).replace("index.html","");m=m.replace(b,""),o.log&&console.log("define "+c),i.length&&(h=g(i,m));if("string"==typeof c&&"function"==typeof a){(l=n&&"object"===e.typeof(n)?t.extend(!0,{},r,d[c],e.config.loader.define,n):t.extend(!0,{},r,d[c],e.config.loader.define)).moduleName=c,l.depend=h,l.style=[],l.script=m,l.path=m.substr(0,m.lastIndexOf("/")+1),l.loaded=function(){var e=[y,d[f]&&d[f].exports,d[f],u.globals],t=[];h.length&&h.forEach((function(e,n){d[e]&&t.push(d[e].exports)}));var n=t.concat(e);return a&&a.apply(this,n)},l.isDefined=!0,p(l)}else e.showLog("define "+c+"模块的参数格式不对");return l},global:function(e){if("object"===_typeof(e))p({globals:e});else{if("function"!=typeof e)return"string"==typeof e?p().globals[e]:p().globals;p({globals:e.call(f,u.globals)})}return f},require:y,destroy:function(n){o.log&&console.log("destroy "+n);var i="string"==typeof n?d[n]:null;if(i){i.beforeDestroy&&i.beforeDestroy.call(i);var a=t('script[name="'+n+'"]').attr("src");l=e.array.remove(l,a),t('script[name="'+n+'"]').remove(),delete u.modules[n],d=u.modules,i.destroyed&&i.destroyed.call(i)}},map:p,import:P,importCss:function(t,n){return new Promise((function(i,a){if("string"==typeof t){var r=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),l=document.createElement("link")||{};l.href=r+(o.cache?"":"?t="+(new Date).getTime()),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),n&&l.setAttribute("id",n),document.head&&document.head.appendChild(l),l=null,i(t,n)}else e.showLog(t+"的格式不正确")}))},importSync:C,importHtml:T,load:w,syncLoad:function(n){return new Promise((function(i,a){_asyncToGenerator(regeneratorRuntime.mark((function a(){var o,r,l,c,s,u,d,f,p,h;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o=t.extend(!0,{id:"",url:"",param:null,beforeLoad:null,loaded:null},n),r=e.$(o.id),l=[],c=0;case 4:if(!(c<r.length)){a.next=20;break}return s=r[c],u=e.unit.getAttributes(s),d=e.$(s).parents("component"),f=d[0]&&d[0].id||"",(p=f&&e.history.getComponent(f,"name"))?(u.parentId=f,u.parentName=p):(h=e.history.getLast(),u.parentId=h.id,u.parentName=h.name),o.url=o.url||u.url||u.name+".html",o.param=t.extend(!0,{},u,o.param),o.id=u.id,a.next=16,w(o);case 16:l[c]=a.sent;case 17:c++,a.next=4;break;case 20:n.id.indexOf("#")>-1?i(l[0]):i(l);case 21:case"end":return a.stop()}}),a)})))()}))},checkLoad:function(t){var n=!0,i=[];if(d=u.modules,"string"==typeof t){t.indexOf(",")>-1?i=t.split(","):i.push(t)}else t&&"array"===e.typeof(t)&&(i=t||[]);if(i.length)i.forEach((function(e,t){d.hasOwnProperty(e)||(n=!1),d[e]&&!1===d[e].isLoaded&&(n=!1)}));else for(var a in d)d[a]&&!1===d[a].isLoaded&&(n=!1);return n},components:k,component:x,delay:function(n){for(var i=t.extend(!0,{id:"",deepView:o.deepView,deepComponent:o.deepComponent,delay:!1,everytime:!1,param:null,beforeLoad:null,loaded:null,compiled:null},n),a=e.$(i.id),r=0;r<a.length;r++){var l=a[r],c=l&&l.getAttribute("delay"),s=l&&l.tagName.toLowerCase();("true"===c||i.everytime)&&("true"===c&&s===o.componentTag||i.everytime?(i.isSelf=!0,i.id=l,i.everytime?l.removeAttribute("delay"):l.setAttribute("delay","false"),x(i)):"true"===c&&s===o.viewTag||i.everytime?(i.isSelf=!0,i.id=l,l.removeAttribute("delay"),S(i)):(i.isSelf=!1,s=t(l).find('[delay="true"]')[0]&&t(l).find('[delay="true"]')[0].tagName.toLowerCase(),t(l).find('[delay="true"]').removeAttr("delay"),s===o.componentTag&&x(i),s===o.viewTag&&S(i)))}return this},views:L,view:S,get:function(e){if("string"==typeof e)return u.modules[e]||null},set:h,one:function(e,t){return r.one.apply(f,arguments),this},wait:function(e,t){return r.wait.apply(f,arguments),this},waited:function(e,t){return r.waited.apply(f,arguments),this},on:function(t,n){var i=e.history.getLast("id"),a=arguments,o=e.unit.stringToArray(t);return o.forEach((function(e,t){a[0]=i+"-"+e,r.on.apply(f,a)})),this},off:function(t,n){var i=e.history.getLast("id"),a=arguments,o=e.unit.stringToArray(t);return o.forEach((function(e,t){a[0]=i+"-"+e,r.off.apply(f,a)})),this},trigger:R};function p(n){if(void 0===n)return u;if("object"===_typeof(n)&&(n.hasOwnProperty("modules")||n.hasOwnProperty("baseUrl")||n.hasOwnProperty("globals")))u=t.extend(u,n),d=u.modules;else if("object"===_typeof(n)&&n.hasOwnProperty("moduleName")){var i=function(n){var i={id:"",moduleName:"",template:"",data:null,props:null,isComponent:!1,params:null,depend:[],script:"",style:[],isDefined:!1,isLoaded:!1,beforeCreate:null,created:null,beforeLoad:null,loaded:null,show:null,hide:null,beforeDestroy:null,destroyed:null,path:"",exports:{},dependExports:[]},a=(d=u.modules)[n.moduleName]||i,o=d[n.moduleName]||i,r=t.extend(a,o,n);n.props&&(r.props=n.props);return r.params=e.history.getParams("url"),r}(n);d[n.moduleName]=i||{}}return u}function h(t,n){if(n&&"object"===e.typeof(n)){if(n.moduleName=t,n.hasOwnProperty("loaded")&&"function"==typeof n.loaded){var i=n.loaded;n.loaded=function(){d=u.modules;var e=n.moduleName,t=d[e].depend,a=[y,d[e]&&d[e].exports,d[e],u.globals],o=[];t.length&&t.forEach((function(e,t){d[e]&&o.push(d[e].exports)}));var r=o.concat(a);return i&&i.apply(this,r)},n.script=n.moduleName+".js",n.path=n.script.substr(0,n.script.lastIndexOf("/")+1)}n.depend&&n.depend.length&&(n.depend=g(n.depend,n.script)),p(n)}return this}function m(e,t){var n=e,i=t.lastIndexOf("/"),a=t.substr(0,i);return e.indexOf("../")>-1?(e=e.replace(/\..\//g,(function(e){var t=a.lastIndexOf("/");return a=a.substr(0,t),""})),n=a?a+"/"+e:e):e.indexOf("./")>-1?n=a+"/"+e.replace(/\.\//g,""):0===e.indexOf("/")&&(n=e.substr(1)),n}function g(e,t){for(var n=[],i=0;i<e.length;i++){var a=e[i],o=a.indexOf("./")>-1||0===a.indexOf("/")?m(a,t):a;if(o.indexOf(".css")>-1)o.indexOf("css!")>-1?styles.push(o.substr(4)):styles.push(o);else{var r=o.indexOf(".js");r>-1&&(o=o.substr(0,r)),n.push(o),d.hasOwnProperty(o)||p({moduleName:o})}}return n}function v(){var e,n=window.location.href,r=[],l=document.currentScript;if(n.indexOf("#")>-1?r=n.split("#"):r.push(n),i=r[0].replace("/index.html","")+"/",l)return e=l.src.replace(i,""),{name:l.getAttribute("name")||e.substr("0",e.indexOf(o.scriptSuffix)),src:e};try{a()}catch(e){var c=(c=(e.stack||e.sourceURL||e.stacktrace||"").split(/[@ ]/g).pop().replace(/(:\d+)?:\d+$/i,"")).replace(new RegExp(i,"g"),"");return{name:(l=t('script[src="'+c+'"]')[0])?l.getAttribute("name"):c.replace(o.scriptSuffix,""),src:c}}}function y(t,n,i){if(o.log&&console.log("require "+t),i=1==i,"boolean"==typeof n&&(i=n,n=function(){}),t&&"string"==typeof t){if(t.indexOf(".css")>-1)return P(t,n);if(t.indexOf(".html")>-1)return P(t,n);t=0===t.indexOf("/")?[t.substr(1)]:[t]}if(n&&"function"!=typeof n&&"boolean"!=typeof n)return e.showLog("require第2个参数格式为函数或布尔值","bui.loader.require"),this;try{return function(t,n,i){var a=[];function r(t,n){t=t||[],d=u.modules;var i=e.array.uniq(t);i.length>1&&i.forEach((function(e,t){var n=d[e];(n&&1==n.isLoaded||n.loaded)&&i.splice(t,1)})),i.forEach((function(t,l){var c=d[t];if(d[t]&&d[t].style&&d[t]&&d[t].style.length&&N(d[t].style),e.array.compare(a,t)||a.unshift(t),c&&c.isLoaded){if(!1===(c&&c.beforeLoad&&c.beforeLoad.call(c,c.depend)))return!1;l==i.length-1&&(n&&n.apply(c),a=[])}else if(c&&c.loaded){if(s(t,l),!1===(d[t].beforeCreate&&d[t].beforeCreate.call(d[t])))return!1;d[t].created&&d[t].created.call(d[t])}else j(t,(function(){var e=d[t];if(!1===(e&&e.beforeCreate&&e.beforeCreate.call(d[t])))return!1;e&&e.style&&e.style.length&&N(e.style),e&&e.created&&e.created.call(d[t]),s(t,l)}),(function(){l==i.length-1&&(n&&n.apply(null),a=[])}));function s(e,t){var a=d[e];return a&&(a.isDefined=!0),a.id=c?c.id:"",a.props=c?c.props:{},!1!==(a&&a.beforeLoad&&a.beforeLoad.call(a,a.depend))&&(a&&a.depend&&a.depend.length?(o.log&&console.warn(a.moduleName+" depend:"),o.log&&console.log(a.depend),void r(a.depend,n)):void(t==i.length-1&&n&&n.apply(a)))}}))}return new Promise((function(e,l){r(t,(function(){if(function(e){var t=!0,n=e||[];if(d=u.modules,n.length)for(var i=0;i<n.length;i++){var a=n[i],r=d[a];if(r&&!1===r.isDefined)return t=!1,o.log&&console.warn("check defined false:"+r.moduleName),o.log&&console.warn("wait modules:"),o.log&&console.warn(n),t}else for(var l in d)if(d[l]&&!1===d[l].isDefined)return t=!1,o.log&&console.warn("check defined false:"+r.moduleName),t;return t}(a)){var r=[];t.forEach((function(a,o){b(a,i),r.push(d[a]&&d[a].exports),o===t.length-1&&(n&&n.apply(f,r||[]),e.apply(f,r||[]))}))}}))}))}(t=t.map((function(t,n){return e.unit.resolvePath(t)})),n,i)}catch(t){e.showLog(t,"bui.loader.require")}return this}function b(t,n){d=u.modules;var i="string"==typeof t?d[t]||{}:t,a=i.depend||[],r=null,l=[];i.dependExports=[];try{if(a.length)for(var c=0;c<a.length;c++){var s=a[c],f=d[s];f.isLoaded?l[c]=f.exports:l[c]=b(f)||f.exports,f.exports=l[c],i.dependExports.push(l[c]),f.isLoaded=!0}r=i.isLoaded&&!i.isComponent||i.isLoaded&&!n?i.exports:i.loaded&&i.loaded.apply(i,l),i.exports=r||d[i.moduleName]&&d[i.moduleName].exports,i.isLoaded=!0,R(i.moduleName,i,i.exports),o.log&&console.log("execute "+i.moduleName)}catch(t){e.showLog(t,"bui.loader.execute")}return r}function w(n){return new Promise((function(i,a){var o=t.extend(!0,{id:"",cacheHtml:!1,cache:!1,url:"",script:"",param:null,template:null,beforeLoad:null,reload:!0,loaded:null},e.config.loader.load,n);if(o.id)if(o.url){if(!1===("function"==typeof o.beforeLoad?o.beforeLoad.call(f):o.beforeLoad))return this;var r=function(e){var t=d,n={},i=e&&e.indexOf(".html");i>-1?(n.url=e,n.module=e.substr(0,i)):(n.url=t[e]&&t[e].template||e+".html",n.module=e);return n}(o.url);if(o.script){var l=o.script.indexOf(".js");r.module=o.script.substr(0,l)}var c="string"==typeof o.id&&(o.id.indexOf("#")>-1||o.id.indexOf(".")>-1)?o.id.substr(1):o.id;o.id=c,o.name=r.module,o.url=r.url,o.param=e.unit.changeParamBoolean(o.param),p({id:c,moduleName:r.module,props:o.param}),e.history.getLast().currentComponent=c,e.history.setComponent({id:o.id,name:o.name,url:o.url,param:o.param||null});var s=p().modules[o.name];if(s&&"function"==typeof s.template){var u=s.template.call(s)||"";return u=(u=(u=e.unit.handleContent(u)).replace(/#module\.id/g,"#"+o.id)).replace(/#module\.path/g,s.path),!o.cacheHtml&&e.obj(o.id).html(u),v(o),this}if(o.cacheHtml)return v(o),this;if("function"==typeof r.url){var m=r.url(o)||"";m=(m=e.unit.handleContent(m)).replace(/#module\.id/g,"#"+o.id);var g=r.url.substr(0,r.url.lastIndexOf("/")+1);return m=m.replace(/#module\.path/g,g),!o.cacheHtml&&e.obj(o.id).html(m),v(o),this}P(r.url,(function(t){t=(t=e.unit.handleContent(t)).replace(/#module\.id/g,"#"+o.id);var n=r.url.substr(0,r.url.lastIndexOf("/")+1);t=t.replace(/#module\.path/g,n),!o.cacheHtml&&e.obj(o.id).html(t),v(o)}),(function(e){o.onFail&&o.onFail.call(this,r),a(r)}))}else e.showLog("url不能为空");else e.showLog("id不能为空");function v(n){var a=p().modules[n.name];if(!1===(a.beforeLoad&&a.beforeLoad.call(a,a.depend)))return!1;if(h(n.name,{id:n.id,props:n.param||null,isComponent:!0,$:function(e){return t("#"+n.id).find(e)}}),a.isLoaded&&"function"==typeof a.loaded&&!n.cache){a.id=n.id,a.exports=a.loaded&&a.loaded.call(a,a.exports)||a.exports;var o={id:n.id,name:n.name,url:n.url,param:n.param||null,exports:a.exports||{}};return e.history.setComponent(o),window.store&&window.store.$mount&&window.store.$mount(n.id),n.loaded&&n.loaded.call(a,a.exports),i(a.exports),R(n.id,o),f}e.checkLoad(n.name),y(n.name,(function(t){var o={id:n.id,name:n.name,url:n.url,param:n.param||null,exports:t||{}};e.history.setComponent(o),window.store&&window.store.$mount&&window.store.$mount(n.id),n.loaded&&n.loaded.call(a,t),i(t),R(n.id,o)}),n.reload)}}))}function x(n){var i=t.extend(!0,{id:"",isSelf:!0,deepComponent:o.deepComponent,cache:!1,cacheHtml:!1,delay:!0,param:null,beforeLoad:null,loaded:null,compiled:null},e.config.loader.component,n),a=null;a=""===i.id?e.$(o.componentTag):i.isSelf?e.$(i.id):e.$(i.id).find(o.componentTag);for(var r=[],l=[],c=[],s=[],u=p().modules,d=0;d<a.length;d++){var f=a[d],h=e.guid();!f.id&&f.setAttribute("id",h);var m=e.unit.getAttributes(f),g=m.parentId=i&&i.id||e.history.getLast().id||"bui-page",v=e.$(g).parents("component"),y=i.isSelf?v[0]&&v[0].id:i.id;"array"===e.typeof(g)?y=i.isSelf?v&&v[0].id:g[0].id:"object"==_typeof(m.parentId)&&e.typeof(m.parentId).indexOf("element")>-1&&(y=i.isSelf?v[0]&&v[0].id:g.id);var b=y&&e.history.getComponent(y,"name");if(b)m.parentId=y,m.parentName=b;else{var x=e.history.getLast();m.parentId=x.id,m.parentName=x.name}var k=m.name||f.getAttribute("name"),I="true"===m.rendered||i.cacheHtml;if(k&&(!m.delay||!i.delay)){m=t.extend(!0,{},m,i.param);var L=u[k],S=f.innerHTML,P=L&&"string"==typeof L.template?L.template:k+".html",T=L&&L.script?L.script:k+".js";P=P||k+".html",L&&"function"==typeof L.template?r.push({id:f.id,el:f,name:k,cacheHtml:I,cache:i.cache,deepComponent:i.deepComponent,template:L.template||"",url:P,srcript:T,slot:S,param:m}):(c.push(P),s.push(T),l.push({id:f.id,el:f,name:k,cacheHtml:I,cache:i.cache,deepComponent:i.deepComponent,url:P,srcript:T,slot:S,param:m}))}}return r.length&&(r.forEach((function(e,t){w({id:e.id,url:e.url,param:e.param||null,template:e.template,cacheHtml:e.cacheHtml,cache:e.cache,beforeLoad:i.beforeLoad})})),i.data=r,O(i)),l.length?(C(e.array.merge(c,s),(function(e){!function t(n){var a=l[n];return n==l.length?(i.data=l,O(i),this):a?(a.template=e[n],void w({id:a.id,url:a.url,param:a.param||null,cacheHtml:a.cacheHtml,cache:a.cache,beforeLoad:i.beforeLoad,loaded:function(e){t(n+1)},onFail:function(){t(n+1)}})):this}(0)})),this):(i.compiled&&i.compiled(i.data),R("componentcompiled",i.data),!1)}function k(e){return x(t.extend(!0,{id:"",isSelf:!1,deepComponent:o.deepComponent,cache:!1,cacheHtml:!1,beforeLoad:null,loaded:null,compiled:null},e)),this}function O(t){for(var n=0;n<t.data.length;n++){var i=t.data[n];new RegExp("<".concat(o.viewTag,".+name="),"gi").test(i.template)&&L({id:i.id});var a=new RegExp("<".concat(o.componentTag,".+name="),"gi");new RegExp("<".concat(o.componentTag,'.+name="').concat(i.name,'"'),"gi").test(i.template)?e.showLog("请检查代码, <".concat(o.componentTag,' name="').concat(i.name,'"></').concat(o.componentTag,">的模板里面存在循环嵌套")):(t.deepComponent&&a.test(i.template)&&k({id:i.id}),t.loaded&&t.loaded(i),R("componentloaded",i))}t.compiled&&t.compiled(t.data),R("componentcompiled",t.data)}function I(n){for(var i=0;i<n.data.length;i++){var a=n.data[i];if(!a.cacheHtml){a.el.innerHTML=a.template;var r=new RegExp("<".concat(o.componentTag,".+name"),"gi");new RegExp("<".concat(o.componentTag,'.+name="').concat(a.name,'"'),"gi"),r.test(a.template)&&k({id:a.id});var l=new RegExp("<".concat(o.viewTag,'.+name="').concat(a.name,'"'),"gi"),c=new RegExp("<".concat(o.viewTag,'.+name="').concat(a.name,'"'),"gi");if(c.test(a.template)){e.showLog("请检查代码, <".concat(o.viewTag,' name="').concat(a.name,'"></').concat(o.viewTag,">的模板里面存在循环嵌套"));continue}n.deepView&&l.test(a.template)&&!c.test(a.template)&&L({id:t(a.el)})}n.loaded&&n.loaded(a),R("viewloaded",a)}n.compiled&&n.compiled(n.data),R("viewcompiled",n.data)}function L(e){return S(t.extend(!0,{id:"",isSelf:!1,deepView:o.deepView,loaded:null,compiled:null},e)),this}function S(n){var i=t.extend(!0,{id:"",isSelf:!0,deepView:o.deepView,loaded:null,compiled:null},n),a=null;a=""===i.id?e.$(o.viewTag):i.isSelf?e.$(i.id):e.$(i.id).find(o.viewTag);for(var r=[],l=[],c=loader.map().modules,s=0;s<a.length;s++){var u=a[s],d=u.getAttribute("name"),f=u.getAttribute("delay"),p=c[d],h="true"===u.getAttribute("rendered"),m=e.guid();if(!u.id&&u.setAttribute("id",m),"true"!==f){var g=u.innerHTML,v=p&&p.template?p.template:d+".html";p&&"function"==typeof p.template?l.push({id:u.id,el:u,name:d,cacheHtml:h,template:p.template.call(p)||"",url:v,slot:g}):r.push({id:u.id,el:u,name:d,cacheHtml:h,url:v,slot:g})}}return l.length&&(l.forEach((function(e,t){e.el.innerHTML=e.template,window.store&&window.store.$mount&&window.store.$mount(i.id)})),i.data=l,I(i)),function e(t){if(t==r.length)return i.data=r,void I(i);r[t]&&T(r[t].url,(function(n){r[t].template=n,e(t+1)}),(function(n){r[t].template="",e(t+1)}))}(0),this}function P(n,i,a){return new Promise((function(o,r){if("string"==typeof n)(n=e.hasRouter?e.unit.resolvePath(n):e.unit.relativePath(n)).indexOf(".css")>-1?(i&&i(n),E(n).then((function(e){o(n)}))):n.indexOf(".html")>-1||n.indexOf(".htm")>-1?T(n).then((function(e){if("function"!=typeof i)return t(i).html(e),a&&a(e),void o(e);i&&i(e),o(e)}),(function(e){a&&a(e),r(e)})):j(n).then((function(e){i&&i(e),o(e)}),(function(e){a&&a(e),r(e)}));else if(n&&"array"===e.typeof(n)){var l=n.map((function(t,n){return(t=e.unit.resolvePath(t)).indexOf(".css")>-1?E(t):t.indexOf(".html")>-1||t.indexOf(".htm")>-1?T(t):j(t)}));Promise.all(l).then((function(e){i&&i(e),o(e)}),(function(e){a&&a(e),r(e)}))}}))}function C(t,n,i){return new Promise((function(a,o){if("string"==typeof t)P(t,n,i);else if(t&&"array"===e.typeof(t)){var r=[];!function i(o){if(o==t.length)return n&&n(r),void a(r);var l=e.unit.resolvePath(t[o]);return l.indexOf(".css")>-1?E(l,(function(e){r.push(e),i(o+1)})):l.indexOf(".html")>-1||l.indexOf(".htm")>-1?T(l,(function(e){r.push(e),i(o+1)}),(function(e){i(o+1)})):j(l,(function(e){r.push(e),i(o+1)}),(function(e){i(o+1)}))}(0)}}))}function T(t,n,i){return new Promise((function(a,r){var l="function"==typeof n;if(t=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),s.hasOwnProperty(t))return l?n&&n.call(f,s[t],200):"string"==typeof n&&e.$(n).html(s[t]),a(s[t],200),this;"string"==typeof t&&bui.ajax({baseUrl:o.baseUrl,url:t,dataType:"html",contentType:"text/html;charset=UTF-8",mimeType:"html",processData:!1,needNative:o.needNative,cache:o.cache,data:null,success:function(o,r,c){s[t]=o,l?n&&n.call(f,o,r,c):"string"==typeof n&&(e.$(n).html(o),i&&i.call(f,o,r,c)),a(o,r)},error:function(e,t,n){l&&i&&i.call(f,e,t,n),r(e,t,n)}})}))}function j(n,i,a){return new Promise((function(r,c){var s;if(d=u.modules,void 0===n||""==n)return a&&a.call(this,n),c(n),this;if(n in d)s=n,n=d[n].script||s+o.scriptSuffix;else{var f=n.indexOf(o.scriptSuffix);f>-1?s=(n=n).substr(0,f):(s=n,n+=o.scriptSuffix)}n=e.hasRouter?n:e.unit.relativePath(n,o.relativePath);var p=document.createElement("script")||{},h=o.cache?"":"?t="+(new Date).getTime(),m=n.indexOf("http://")>-1||n.indexOf("https://")>-1;p.type="text/javascript",p.async=!1,p.src=m?n+h:u.baseUrl+n+h,p.setAttribute("name",s),p.onload=function(){o.log&&console.log("create "+n),i&&i(n),r(n)},p.onerror=function(e){o.log&&console.log("createError "+n),a&&a(n),c(n)};var g=e.array.index(l,n);return d[s]&&d[s].isDefined?(i&&i(n),r(n)):(g>-1&&d.hasOwnProperty(s)&&t('script[name="'+s+'"]').remove(),g>-1&&!d.hasOwnProperty(s)&&t('script[name="'+s+'"]').remove(),document.body&&document.body.appendChild(p),o.cache&&l.push(n)),p=null,this}))}function N(t){return new Promise((function(n,i){if(t.length,"array"===e.typeof(t)){var a=t.map((function(e){return E(e)}));return Promise.all(a)}return E(t)}))}function E(t,n){return new Promise((function(i,a){if("string"==typeof t){if(e.array.index(c,t)<0){var r=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),l=document.createElement("link")||{};l.href=r+(o.cache?"":"?t="+(new Date).getTime()),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),document.head&&document.head.appendChild(l),l=null,c.push(t)}i(t,n)}else e.showLog(t+"的格式不正确")}))}function R(t){f.self=this==window||this==f?null:this;var n=e.history.getLast("id");arguments[0]=n+"-"+t,r.trigger.apply(f,arguments)}return f},window.loader=e.loader(),e.define=loader.define,e.require=loader.require,e.map=loader.map,e.import=loader.import,e.checkLoad=loader.checkLoad,e.checkDefine=loader.checkDefine,e.checkImport=loader.checkImport}(window.bui||{},window.libs),function(e,t){e.toggle=function(n){if("string"==typeof n){var i=n||"";(n={}).id=i}var a,o,r={show:function(t,n){if(s)return;if(d=e.objId(l.id),!f&&!p)return!1;f=!1,"function"==typeof t?(t=t,n=n||o||""):(n=t||o||"",t=null);d[0]&&"none"==d[0].style.display&&d.css("display",c);if(d.addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n)l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),h=!0,f=!0;else{var i=e.platform.isIE()?"animationend":"webkitAnimationEnd";d.one(i,(function(){try{!h&&d.css("display",c),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),h=!0,f=!0}catch(t){e.showLog(t,"toggle show method")}}))}return this},hide:function(t,n){if(s)return;if(d=e.objId(l.id),!f&&!p)return;p=!1,"function"==typeof t?(t=t,n=n||a||""):(n=t||a||"",t=null);if(d.css("display",c).addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n)d.css("display","none"),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),h=!1,p=!0;else{var i=e.platform.isIE()?"animationEnd":"webkitAnimationEnd";d.one(i,(function(){try{d.css("display","none"),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),h=!1,p=!0}catch(t){e.showLog(t,"toggle hide method")}}))}return this},remove:function(){return d.remove(),this},isShow:function(){return h},destroy:function(e){e=1==e;d&&(d.off(),e&&d.remove());s=!0},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(r,t,n)},config:l,init:m},l=r.config=t.extend(!0,{},{id:"",uid:"",effect:"fadeIn",useBox:!1,revert:!0,inOrder:!1},n),c=l.useBox?"-webkit-box":"block",s=!1,u={show:["fadeIn","fadeInLeft","fadeInRight","fadeInDown","fadeInUp","fadeInLeftBig","fadeInRightBig","fadeInUpBig","fadeInDownBig","zoomIn","bounceIn","rotateIn","rollIn","flipInX","flipInY","lightSpeedIn","showIn","slideInRight","slideInLeft","coverInLeft","coverInRight","zoomSlideInLeft","zoomSlideInRight","pushInLeft","pushInRight"],hide:["fadeOut","fadeOutLeft","fadeOutRight","fadeOutUp","fadeOutDown","fadeOutLeftBig","fadeOutRightBig","fadeOutDownBig","fadeOutUpBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutRight","slideOutLeft","coverOutLeft","coverOutRight","zoomSlideOutLeft","zoomSlideOutRight","pushOutLeft","pushOutRight"],hideInOrder:["fadeOut","fadeOutRight","fadeOutLeft","fadeOutDown","fadeOutUp","fadeOutRightBig","fadeOutLeftBig","fadeOutUpBig","fadeOutDownBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutLeft","slideOutRight","coverOutRight","coverOutLeft","zoomSlideOutRight","zoomSlideOutLeft","pushOutRight","pushOutLeft"]},d=null,f=!0,p=!0,h=!1;function m(t){if(s=!1,(t=t||l).id){d=e.objId(t.id),l=r.config=t,d.attr("class");var n=t.effect,i=t.inOrder?e.array.index(u.hideInOrder,n):e.array.index(u.hide,n),c=n&&(e.array.index(u.show,n)>-1?e.array.index(u.show,n):i);return h=!(d[0]&&"none"==d[0].style.display||"none"==d.css("display")),c<0?(o=u.show[0],a=t.inOrder?u.hideInOrder[0]:u.hide[0]):(o=u.show[c],a=t.inOrder?u.hideInOrder[c]:u.hide[c]),t.uid&&e.history.setUI&&e.history.setUI({uid:t.uid,ui:r}),this}e.showLog("toggle id不能为空","bui.toggle")}return l.id&&m(l),r}}(window.bui||{},window.libs),function(e,t){e.unit={},e.unit.remToPx=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100;return e=(parseFloat(e)*t).toFixed(2)},e.unit.pxToRem=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100;return e=(parseFloat(e)/t).toFixed(2)},e.unit.pxToRemZoom=function(e){return e=(parseFloat(e)/100).toFixed(2)},e.unit.debounce=function(e,t,n){var i;return function(){var a=n||this,o=arguments,r=function(){i=null,e.apply(a,o)};clearTimeout(i),i=setTimeout(r,t)}},e.unit.throttle=function(e,t,n){var i,a;return t||(t=250),function(){var o=n||this,r=+new Date,l=arguments;i&&r<i+t?(clearTimeout(a),a=setTimeout((function(){i=r,e.apply(o,l)}),t)):(i=r,e.apply(o,l))}},e.unit.startWithCss=function(e){var t=new RegExp("^\\.|^#");return"string"==typeof e&&t.test(e)},e.unit.startWithStr=function(e,t){var n=new RegExp("^"+t);return"string"==typeof e&&n.test(e)},e.unit.startWithId=function(e){var t=new RegExp("^#");return"string"==typeof e&&t.test(e)},e.unit.startWithClass=function(e){var t=new RegExp("^\\.");return"string"==typeof e&&t.test(e)},e.unit.endWithImage=function(e){var t=new RegExp("(.png|.jpg|.gif)$");return"string"==typeof e&&t.test(e)},e.unit.tel=function(t){var n,i="tel:";return 0==(t=String(t)).indexOf("+")&&(i="wtai://wp/mc;"),n=t,window.location.href=i+n,e},e.unit.sms=function(t,n){var i=navigator.userAgent,a=/(iPhone|iPad|iOS)/i.test(i)?"&":"?";return window.location.href="sms:"+t+a+"body="+n,e},e.unit.mailto=function(t){return"string"==typeof(t="email"in t?t:{}).email&&t.email.indexOf("@")>0?window.location.href="mailto:"+t.email+"?subject="+(t.subject||"")+"&body="+(t.body||"")+"&cc="+(t.cc||""):e.showLog(email+"格式不正确"),e},e.unit.openExtral=function(t){var n=[],i="";if((t=String(t)).indexOf("mailto:")>=0)if((i=(n=t.split("mailto:"))[1]).indexOf("?")>-1){var a=i.split("?"),o=e.unit.keyStringToObject(a[1]);o.email=a[0],e.unit.mailto(o)}else e.unit.mailto({email:i});if(t.indexOf("tel:")>=0&&(n=t.split("tel:"),i=parseInt(n[1]),e.unit.tel(i)),t.indexOf("sms:")>=0)if(i=(n=t.split("sms:"))[1],t.indexOf("=")>=0){var r=t.split("=")[1];e.unit.sms(i,r)}else e.unit.sms(i);return e},e.unit.objectToKeyString=function(e,t){var n="";for(var i in e){n+="&"+i+"="+(t?encodeURIComponent(e[i]):e[i])}return n.substr(1)},e.unit.keyStringToObject=function(t,n){var i,a={},o=[];try{for(o=t.split("&"),i=0;i<o.length;i++){var r=n?decodeURIComponent(o[i].split("=")[1]):o[i].split("=")[1];a[o[i].split("=")[0]]=r}}catch(t){e.showLog(t)}return a},e.unit.checkTargetInclude=function(e,n){var i=n,a=[];if(i.indexOf(",")>-1){var o,r=(a=i.split(",")).length;for(o=0;o<r;o++){var l=a[o];l.indexOf(".")>-1&&(a[o]=l.substr(1))}}else i.indexOf(".")>-1?a[0]=i.substr(1):a[0]=i;var c,s=a.length;for(c=0;c<s;c++)if(t(e).hasClass(a[c])||t(e).closest("."+a[c]).length)return!0;return!1},e.unit.jsonToString=function(t){return"object"===_typeof(t)?function(t){var n;if("object"===e.typeof(t)){for(var i in t)t[i]=a(t,i);n=JSON.stringify(t)}else"array"===e.typeof(t)?(t.forEach((function(e,n){t[n]=a(t,n)})),n=JSON.stringify(t)):n=t;function a(t,n){var i=t[n];return i&&"object"===e.typeof(i)?t[n]=function(t){if(t&&"object"===e.typeof(t)){for(var n in t){var i=t[n];"object"===_typeof(i)&&(t[n]=JSON.stringify(i))}return t}}(i):i&&"array"===e.typeof(i)?t[n]=function(t){if(t&&"array"===e.typeof(t))return t.forEach((function(e,n){"object"===_typeof(e)&&(t[n]=JSON.stringify(e))})),t}(i):t[n]=i,t[n]}return n}(t):t},e.unit.stringToJson=function(t){return t&&function t(n){var i,a;try{if(i="object"===_typeof(n)?n:JSON.parse(n),"array"===e.typeof(i))i.forEach((function(e,n){i[n]=t(e)}));else if("object"===e.typeof(i))for(var o in i){var r=i[o];i[o]=t(r)}a=i}catch(e){a=n}return a}(t)},e.unit.stringToArray=function(t){var n=e.typeof(t);return"array"===n?t:"string"===n&&t.indexOf(",")>-1?t.split(","):[t]},e.unit.setKeyValue=function(e,t,n){var i=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(n,a){if(i.length)return e(i.shift(),a[n]||{});a[n]=t}(i.shift(),n)},e.unit.getKeyValue=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(t,i){var a=i[t];if(a&&"string"==typeof a&&a.indexOf("{")>-1&&a.indexOf("}")>-1)try{i[t]=JSON.parse(a)}catch(e){i[t]=a}return a&&void 0!==a&&n.length?e(n.shift(),a):a}(n.shift(),t)},e.unit.getKeyObj=function(t,n){var i=t&&t.indexOf(".")>-1?t.split("."):[t];return function t(n,a){var o=a[n];return"array"!==e.typeof(o)&&"object"===e.typeof(o)?t(i.shift(),o):o}(i.shift(),n)},e.unit.getKeyName=function(t){var n=field&&field.indexOf(".")>-1?field.split("."):[field];return function t(i,a){var o=a[i];return"array"!==e.typeof(o)&&"object"===e.typeof(o)?t(n.shift(),o):o}(n.shift(),t)},e.unit.delKey=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(i,a){return n.length?e(n.shift(),a[i]):(delete a[i],t)}(n.shift(),t)},e.unit.calcHeight=function(e,n){var i=t(e);i[0]&&(i[0].style.height="calc(100% - "+n+")")},e.unit.resolvePath=function(t){if(!e.hasRouter)return t;var n=t=t||"",i=(router&&router.history&&router.history.getLast()||{url:n}).url||"";if("function"==typeof i)return n;var a=i.lastIndexOf("/"),o=i.substr(0,a);return t.indexOf("../")>-1?(t=t.replace(/\..\//g,(function(e){var t=o.lastIndexOf("/");return o=o.substr(0,t),""})),n=o?o+"/"+t:t):t.indexOf("./")>-1?n=o+"/"+t.replace(/\.\//g,""):0===t.indexOf("/")&&(n=t.substr(1)),n},e.unit.filterField=function(t,n){var i={};if("object"===_typeof(n)){var a="object"===e.typeof(t),o="object"===e.typeof(n),r="array"===e.typeof(t),l="array"===e.typeof(n);if(a){if(o)for(var c in n)i[c]=n[c]?s(t,n[c]):t[c];else l&&n.forEach((function(e,n){i[e]=s(t,e)}));return i}return r?(i=[],l?t.forEach((function(e,t){var a={};n.forEach((function(t,n){a[t]=s(e,t)})),i.push(a)})):o&&t.forEach((function(e,t){var a={};for(var o in n)a[o]=n[o]?s(e,n[o]):e[o];i.push(a)})),i):void 0}function s(t,n){return n.indexOf(".")>-1?e.unit.getKeyValue(n,t):t[n]}},e.unit.fixZero=function(e){return e<10?"0"+e:e},e.unit.getAttributes=function(t){if("object"!==_typeof(t))return null;var n={},i=/\{.+\}$/g,a=/\[.+\]$/g;return t.attributes&&Object.keys(t.attributes).forEach((function(o,r){var l=t.attributes[o],c=l.value;if(i.test(c)||a.test(c))try{c=JSON.parse(c)}catch(t){c=c,e.showLog(t)}n[l.name]=c})),n},e.unit.resolvePathname=function(e,t){t=t||0;var n=e.lastIndexOf("/"),i=e.substring(t,n);return i.indexOf("/")>-1?i.split("/"):[i]},e.unit.relativeUrl=function(e,t){var n=[];return t.length>=e.length?t.forEach((function(t,i){var a=e[i];a&&t===a||(a&&t!==a?(n.unshift(".."),n.push(t)):n.push(t))})):e.forEach((function(e,i){var a=t[i];a&&e===a||(a&&e!==a?(n.unshift(".."),n.push(a)):n.unshift(".."))})),n},e.unit.relativePath=function(t,n){n=n||"pages";var i=window.self.location.href;if(i.indexOf("source.html?url=")>-1&&i.indexOf("code=")>-1)return t;if(0===t.indexOf("http://")||0===t.indexOf("https://")||0===t.indexOf("./"))return t;var a=window.location.href,o=a.indexOf(n),r=t&&t.indexOf("/")>-1?t.split("/"):[t],l=[];if(o<0){var c=window.location.pathname.toLocaleLowerCase(),s=c.indexOf("www"),u=c.indexOf("src"),d=c.indexOf("dist");if(s>-1){var f=e.unit.resolvePathname(c,s+4);l=e.unit.relativeUrl(f,r)}else if(d>-1){var p=e.unit.resolvePathname(c,d+5);l=e.unit.relativeUrl(p,r)}else{if(!(u>-1))return 0==t.indexOf("/")?t.replace("/",""):t;var h=e.unit.resolvePathname(c,u+4);l=e.unit.relativeUrl(h,r)}}else{var m=e.unit.resolvePathname(a,o);l=e.unit.relativeUrl(m,r)}return l.join("/")},e.unit.between=function(t,n,i){var a=!0,o=new Date;if(n=n||0,i=i||e.date.convert(o.getFullYear+"/12/31").getTime(),"number"==typeof t)(t<n||t>i)&&(a=!1);else{n||e.showLog("bui.unit.between 第2个参数为最小日期");try{n=e.date.convert(n).getTime(),i=e.date.convert(i).getTime(),((t=e.date.convert(t).getTime())<n||t>i)&&(a=!1)}catch(t){e.showLog("bui.unit.between 用来检测数字或者日期,请检查参数格式是否正确")}}return a},e.unit.numberunit=function(e){var t=+e,n=t;return t>1e4&&(n=parseFloat(t/1e4).toFixed(1)+"万"),n},e.unit.handleStyleScope=function(e){var t=e.match(/(?=[#|\.|\w]).*[,|\{][\s\S]*?}/gm)||[];return t=t.map((function(e){var t=e.indexOf(","),n=e.indexOf("{");return t>-1&&t<n&&e.indexOf(",#module.id")<0&&(e=e.replace(/,/g,",#module.id ")),0!=e.indexOf("#module.id")?"#module.id "+e:e})).join("")},e.unit.getStyleStr=function(e){return e.match(/<style[\s\S]*?<\/style>/g).join("")},e.unit.getStyleContent=function(t){var n=e.unit.getStyleStr(t);return(n=n.replace(/<\/style>/g,"")).replace(/<style[\s\S]*?>/g,"")},e.unit.changeParamBoolean=function(e){for(var t in e)"false"===e[t]?e[t]=!1:"true"===e[t]&&(e[t]=!0);return e},e.unit.handleContent=function(t){var n=/<style[\s\S]*?<\/style>/g,i=t&&t.match(n);if(!i)return t;var a=t&&t.match(/@import url.+\)[;]?/g),o=a?a.join(""):"",r=i.join(""),l=t.replace(n,""),c=e.unit.getStyleContent(r);return"<style>".concat(o).concat(e.unit.handleStyleScope(c),"</style>")+l+""}}(window.bui||{},window.libs),function(e,t){var n,i,a,o;e.history=(a=[],o={get:function(t,n){if(void 0===t)return a;var i=n||"name";return e.array.get(a,t,i)},getLast:function(e){var t=a.length-1,n=a[t]||{};return e?n[e]:n},getPrev:function(e){var t=a.length-2,n=a[t]||{};return e?n[e]:n},getParams:function(e){var t=this.getLast(),n={};switch(e){case"page":n=this.getPageParam()||n;break;case"part":case"component":n=this.getComponentParam()||n;break;case"url":n=t.param||bui.getUrlParams();break;default:n=this.getComponentParam(e)||this.getPageParam(e)||t.param||bui.getUrlParams()}return n},setComponent:function(t){var n=this.getLast();return(t.param?Object.keys(t.param):[]).length&&(t.param=e.unit.changeParamBoolean(t.param)),n.component[t.id]=t,t},setUI:function(e){var t=this.getLast(),n=e.uid;return t.ui[n]=e.ui,o},getUI:function(t){return t?this.getLast().ui[t]||null:e.showLog("uid不能为空，指ui自定义唯一的名字")},getComponentParam:function(e){var t=this.getLast(),n=e||t.currentComponent;return n&&t.component[n]&&t.component[n].param||null},getComponent:function(t,n){if(void 0!==t){n=n||"exports";var i=this.getLast();return i.component[t]&&i.component[t][n]||null}e.showLog("必须传component id 才能获取实例")},getComponents:function(t,n){if(void 0!==t){for(var i=this.getLast().component,a=Object.keys(i),o=[],r=0;r<a.length;r++){var l=i[a[r]];l.name===t&&o.push(l)}return o}e.showLog("必须传component name 才能获取实例")},getParentComponent:function(){var e=this.getComponentParam();return e&&e.parentId&&this.getComponent(e.parentId)||this.getLast("exports")},getParentParams:function(){var e=this.getComponentParam();return this.getParams(e.parentId)||this.getLast("param")||null},getPage:function(t,n){if(void 0!==t){n=n||"exports";var i=this.getLast(),a=null,o=i.page;if(o.hasOwnProperty(t))a=o[t]&&o[t][n]||{};else if(t)for(var r=Object.keys(o),l=0;l<r.length;l++){var c=o[r[l]]||{};if(c.name===t)return c[n]}else{var s=i.currentPage;a=o[s]&&o[s][n]||{}}return a}e.showLog("必须传page id 或者 模块名才能获取实例")},getPageDialog:function(t){if(void 0!==t){var n=this.getLast();return n.page[t]&&n.page[t].dialog||null}e.showLog("必须传page id才能获取对话框信息")},setPage:function(n){var i=this.getLast();if("object"!==_typeof(n))return n;if(n&&n.hasOwnProperty("id")){var a,o=t.extend(!0,{},i.page[n.id],n);for(a in o.param)o.param[a]&&"array"==e.typeof(o.param[a])&&(o.param[a]=n.param[a]||[]);return o.param=e.unit.changeParamBoolean(o.param),i.page[n.id]=o,n}},getPageParam:function(e){var t=this.getLast(),n=e||t.currentPage;return n&&t.page[n]&&t.page[n].param||null},add:function(n){var i=t.extend(!0,{id:"",name:"",url:"",replace:!1,syncHistory:!0,component:{},param:{},ui:{},part:{},page:{},toggle:null,effect:"push"},n),o=a;if(n.toggle){var r=t.extend(!0,{},i,n);i.toggle=null,o.push(r)}else o.push(i);var l=window.location.origin+window.location.pathname+"#"+i.name,c=e.setUrlParams(l,i.param);return i.syncHistory&&"pushState"in window.history&&window.history.pushState(i,null,c),o},replace:function(n){n=t.extend(!0,{id:"",name:"",url:"",replace:!1,syncHistory:!0,param:{},part:{},ui:{},page:{},toggle:null,effect:"push"},opts);var i=a,o=i.length-1,r=window.location.origin+window.location.pathname+"#"+n.name,l=e.setUrlParams(r,n.param);if(o>-1){if(opts.toggle){var c=t.extend(!0,{},n,opts);n.toggle=null,i.splice(o,1,c)}else i.splice(o,1,n);n.syncHistory&&"replaceState"in window.history&&window.history.replaceState(n,null,l)}return i},refresh:function(){if(e.hasRouter){var n=o.getLast(),i=loader.get(n.name);loader.import(n.url,(function(a){t("#"+n.id).html(a),e.config.init.auto&&e.init(),router.config.needView&&loader.views(),i.loaded(),router.config.needComponent&&loader.components()}))}else window.location.reload(!0)},removeNext:function(t){var n=a,i=t.index;if(parseInt(i)<0)return e.showLog("index 必须大于或者等于0"),n;var o=n.length-i;n.splice(i,o);var r=this.getLast(),l=window.location.origin+window.location.pathname+"#"+r.name,c=e.setUrlParams(l,r.param);return t.syncHistory&&"replaceState"in window.history&&window.history.replaceState(r.param,null,c),n},removeLast:function(e){var t=a.length-1;return this.removeNext({index:t,syncHistory:!1!==e})},check:function(t){var n=a;return e.array.compare(n,t,"name")||e.array.compare(n,t,"url")||e.array.compare(n,t,"id")},checkComponent:function(t){var n=this.getLast(),i=Object.keys(n.component);return e.array.compare(i,t)},checkPage:function(e,t){for(var n=this.getLast(),i=Object.keys(n.page),a=0;a<i.length;a++){var o=i[a],r=n.page[o];if(r.name===e||r.id===e)return!0}return!1},epmty:function(e){return a=[]}},n=function(t){var n=(t=t&&t.replace(window.location.origin,"")||window.location.pathname).indexOf(".html"),i=t.indexOf("?"),a="",o="",r="",l=null,c=loader.map().modules;if(i>-1){var s=t.substr(i+1);l=e.unit.keyStringToObject(s,!0)}return n>-1?(o=(a=0==t.indexOf("/")?t.substr(1,n-1):t.substr(0,n-1))+".html",r=a+".js"):(o=c[a=t]&&c[a].template||"",r=c[a]&&c[a].script||""),{pid:a,name:a,url:o,src:r,param:l}}(window.location.href),i=e.guid(),t(document).ready((function(){document.body.setAttribute("id",i)})),a.push({id:e.guid(),pid:n.pid,name:n.pid,url:n.url,src:n.src,param:n.param,page:{},ui:{},component:{}}),o)}(window.bui||{},window.libs),function(e,t){e.router=function(n){var i,a,o,r=t.extend({},{id:"",uid:"",progress:!1,syncHistory:!0,autoInit:!0,firstAnimate:!1,path:"",indexModule:{moduleName:"main",template:"pages/main/main.html",script:"pages/main/main.js"},repairPath:!0,parseurl:!0,errorPage:"",hash:!1,cache:!0,reloadCache:!1,reload:!1,swipe:!1,swipeBack:!1,distance:100,startDistance:5,swipeDistance:50,onSwipeRight:null,onSwipeLeft:null,onSwipeUp:null,onSwipeDown:null,onBeforeSwipeRight:null,onSwipeCancel:null,pageMove:!0,needNative:!1,needView:!1,needComponent:!0,useScroll:"main,.bui-tab-main>ul>li,.bui-dialog-main,.bui-scroll,.bui-scroll-x",beforeBack:null,beforeLoad:null,loaded:null,store:null,width:0,height:0,async:!0,effect:"push",hashPrefix:"#",scriptSuffix:".js",pageSuffix:".html"},e.config.router,n),l=null,c=this,s=null,u=null,d=null,f="",p="",h=!0,m=!0,g=!1,v=!1,y=!0,b={none:{inRight:"showIn",inLeft:"showIn"},fadein:{inRight:"fadeIn",inLeft:"fadeIn"},fadeinslide:{inRight:"fadeInRight",inLeft:"fadeInLeft"},slide:{inRight:"slideInRight",inLeft:"slideInLeft"},push:{inRight:"pushInRight",inLeft:"pushInLeft"},zoom:{inRight:"zoomIn",inLeft:"zoomIn"},cover:{inRight:"coverInRight",inLeft:"coverInLeft"},zoomslide:{inRight:"zoomSlideInRight",inLeft:"zoomSlideInLeft"},fadeinslideback:{inRight:"fadeInLeft",inLeft:"fadeInRight"},slideback:{inRight:"slideInLeft",inLeft:"slideInRight"},pushback:{inRight:"pushInLeft",inLeft:"pushInRight"},coverback:{inRight:"coverInLeft",inLeft:"coverInRight"},zoomslideback:{inRight:"zoomSlideInLeft",inLeft:"zoomSlideInRight"}},w={},x={},k={},O={},I=!1,L={},S={},P=loader.map(r.indexModule),C=e.history.epmty(),T=P.modules,j=e.storage({local:!1});function N(e){var t=window.location.hash||window.location.search,n=window.location.search,i=n&&n.indexOf("?"),a=(e=0!=e,t&&t.indexOf("?")),o=a>-1?t&&t.substr(1,a-1):window.location.hash.substr(1),l=o&&o.indexOf(r.pageSuffix),c=l>-1?o.substr(0,l):o,s=l>-1?o:o+r.pageSuffix,u={};function d(t,n){var i=t&&t.substr(n+1);if(i.indexOf("?")>-1){var a=i.split("?");o(a[0]),o(a[1])}else o(i);function o(t){for(var n=t&&t.split("&"),i=0;i<n.length;i++){var a=n[i],o=e?decodeURIComponent(a.split("=")[1]):a.split("=")[1];"false"===o?o=!1:"true"===o&&(o=!0),u[a.split("=")[0]]=o}}}return a>-1&&(d(n,i),d(t,a)),{pid:c,url:s,param:u}}function E(n){var i={id:"",url:"",param:{},effect:"",command:"html",path:r.path,repairPath:r.repairPath,firstAnimate:r.firstAnimate,progress:r.progress,reload:r.reload,autoInit:r.autoInit,needView:r.needView,needComponent:r.needComponent,replace:!1,iframe:!1,decode:!1,part:!1,cache:r.cache,callback:null,beforeLoad:r.beforeLoad,loaded:r.loaded},c=t.extend(!0,{},i,n),f=t.Deferred(),m=x.getLast()||null;C[C.length-2],c.url.indexOf("./")>-1&&(c.url=function(e,t){var n=e,i=t.url.lastIndexOf("/"),a=t.url.substr(0,i);e.indexOf("../")>-1?(e=e.replace(/\..\//g,(function(e){var t=a.lastIndexOf("/");return a=a.substr(0,t),""})),n=a?a+"/"+e:e):e.indexOf("./")>-1?n=a+"/"+e.replace(/\.\//g,""):0===e.indexOf("/")&&(n=e.substr(1));return n}(c.url,m)),c.repairPath&&0===c.url.indexOf("/")&&(c.url=c.url.substr(1)),c.path&&(c.path="/"==c.path[c.path.length-1]?c.path:c.path+"/"),c.url=c.url in T||c.iframe||c.url.indexOf("http:")>-1?c.url:c.path+c.url,document.activeElement.blur();var v=null,b={};c.id=(c.id&&c.id.indexOf("#")>-1?c.id.substr(1):c.id)||"";var O=c.replace||c.part?m.id:c.id||e.guid(),P=e.objId(O);if(!c.url)return e.showLog("url 不能为空","bui.router.load"),f.promise();if(c.url=c.decode?decodeURIComponent(c.url):c.url,c.url.indexOf("tel:")>=0||c.url.indexOf("mailto:")>=0||c.url.indexOf("sms:")>=0)return e.unit.openExtral(c.url),f.promise();if(c.url&&c.url.indexOf("?")>-1){var j=c.url.split("?");b=e.unit.keyStringToObject(j[1]),c.url=j[0]}v=t.extend(!0,{},b,c.param),v=e.unit.changeParamBoolean(v),"wechat_redirect"==c.url?c.url="main":"undefined"==c.url&&(c.url=r.errorPage||"main"),c.iframe==v.iframe&&v.iframe.toString();var N=R(c.url),_=N.pid||params.errorPage||"main",$=c.iframe?c.url:N.url,U=$.substr(0,$.lastIndexOf("/")+1),H={id:O,pid:_,name:_,url:"function"==typeof $?c.url:$,path:U,replace:c.replace,param:v,component:{},page:{},part:{},ui:{},toggle:null,exports:{},effect:n.effect||r.effect,syncHistory:r.syncHistory},q="function"==typeof c.beforeLoad?c.beforeLoad.call(M,{prevTarget:m,target:H}):c.beforeLoad;if(V.call(M,"loadbefore",{prevTarget:m,target:H}),V.call(M,"beforeload",{prevTarget:m,target:H}),!1===q)return h=!1,this;if(c.part,o&&o.show(),c.progress&&a&&a.show(),loader.map({moduleName:_,id:O}),loader.get(H.pid),C.length&&c.effect){var K=C.length-1;C[K].effect=c.effect}!g&&!c.part&&!c.replace&&x.add(H),c.replace&&x.replace(H);var W=H;if(c.part&&(e.history.setComponent({id:O,pid:_,url:$,param:v}),W.currentComponent=O,C.splice(C.length-1,1,W)),c.part||H,k[_])!function(e){Q(L.get(e.pid,"template")),e.part?ee(e):(Z(),!g&&G((function(){e.firstAnimate&&(ee(e),e.loaded&&e.loaded({prevTarget:m,target:H}),e.callback&&e.callback({prevTarget:m,target:H})),e.progress&&a&&a.hide()})),!e.firstAnimate&&ee(e))}({pid:_,progress:c.progress,part:c.part,firstAnimate:c.firstAnimate}),r.needComponent&&loader.components(),c.firstAnimate||(c.loaded&&c.loaded({prevTarget:m,target:H}),c.callback&&c.callback({prevTarget:m,target:H})),V.call(M,"complete",{prevTarget:m,target:H});else{if(c.iframe)return function(t){var n=function(t){var n=t.url.indexOf(".html")>-1||0==t.url.indexOf("http")?t.url:t.url+".html",i=t.param?e.setUrlParams(n,t.param):n,a="",o=e.platform.isIos()?'scrolling="no"':"";return a+='<div id="'+t.id+'" class="bui-router-item bui-router-fixiframe" data-page="'+t.pid+'">',a+='<iframe class="bui-router-iframe" src="'+i+'" '+o+' name="'+t.pid+'"></iframe>',a+="</div>"}({id:t.id,pid:t.pid,url:t.url,param:t.param});s&&s.attr("data-main",t.id).append(n),G((function(){c.progress&&a&&a.hide()}))}({id:O,pid:_,url:c.url,param:v}),f.promise();if(c.part)return A($,(function(t,n,i){e.objId(O)[c.command](t),X(te),c.cache&&L.add(_,{id:O,pid:_,template:t}),o&&o.hide(),c.progress&&a&&a.hide()}),(function(e,t,n){J($,e),V.call(M,"loadfail",e,t,n)})),f.promise();A($,(function(e,t,n){if("object"===_typeof(e))return J($,e),!1;Q(e),c.cache&&L.add(_,{id:O,pid:_,template:e}),Z(),c.firstAnimate?G((function(){X(te),c.progress&&a&&a.hide(),S.add(_,{id:O,pid:_,param:v})})):(G((function(){c.progress&&a&&a.hide()})),X(te),S.add(_,{id:O,pid:_,param:v}))}),(function(e,t,n){J($,e),V.call(M,"loadfail",e,t,n)}))}function J(t,n,i,l){if(o&&o.hide(),c.progress&&a&&a.hide(),x.removeLast(),f.reject(t),"object"===_typeof(n)){switch(e.showLog("找不到页面"+t,"bui.router.load"),window.location.protocol){case"file:":e.hasRouter&&e.showLog("PC调试预览单页时，需要开启跨域的Chrome，或使用部署站点才能访问，具体请查看官网调试章节");break;case"http:":case"https:":e.showLog("请检查下网络是否正常")}return r.errorPage&&function(e){!function(e){var t,n=window.location.href,i=(t=(t=n.indexOf(r.hashPrefix))>-1?t:0)>-1?n.substr(0,t):n;E({url:r.errorPage||i,param:{error:e}}),V.call(M,"error",{target:e,status:404})}(e)}(t),!1}}function X(n){loader.set(_,{props:v,$:function(e){return t("#"+O).find(e)}}),g||w[_]?(W.exports=w[_],ee({pid:_}),I&&G(),n&&n(),r.needComponent&&loader.components(),Y()):(loader.checkLoad(_)?(ee({pid:_}),r.needComponent&&loader.components(),n&&n(),Y()):(r.needComponent&&loader.components(),loader.require(_,(function(t){try{if(c.firstAnimate&&c.progress&&a&&a.hide(),w[_]=t||null,H.exports=t,f.resolve(t),h||c.firstAnimate||c.replace){var i=loader.get(_);i&&i.show&&i.show({type:"firstload",target:H})}n&&n(),c.loaded&&c.loaded({prevTarget:m,target:H}),c.callback&&c.callback({prevTarget:m,target:H}),Y(),!y&&c.firstAnimate&&V.call(M,"pageshow",{type:"load",target:H})}catch(t){e.showLog(t,"bui.router.load"),f.reject()}}))),V.call(M,"complete",{prevTarget:m,target:H}))}function Y(e){if(y){var t=x.getLast(),n="pageshow-"+t.pid;!c.firstAnimate&&V.call(M,"pageshow",{type:"load",target:t}),V.call(M,n,{type:"load",target:t}),y=!1}}function Z(){var t=(l=e.objId(W.id))&&l.find(".bui-page");t&&t.length&&c.autoInit&&e.init({id:t,height:p})}function G(t){l=e.objId(O),D(),F();try{h||g||c.replace||c.part?(t&&t(),!c.firstAnimate&&c.progress&&a&&a.hide(),o&&o.hide(),l&&l.css("zIndex",5)):(u&&u.hide(),d&&d.show((function(){t&&t(),!c.firstAnimate&&c.progress&&a&&a.hide(),l&&l.css("zIndex",5),o&&o.hide();var e=C[C.length-2]||{},n=x.getLast(),i=loader.get(n.pid),r=e&&e.pid&&loader.get(e.pid)||null,s="pageshow-"+n.pid,u="pagehide-"+e.pid;r&&r.hide&&r.hide({type:"load",target:e}),i&&i.show&&i.show({type:"load",target:x.getLast()}),V.call(M,u,{type:"load",target:e}),V.call(M,s,{type:"load",target:x.getLast()}),V.call(M,"pagehide",{type:"load",target:e}),c.firstAnimate?loader.checkLoad(C[C.length-1].pid)&&V.call(M,"pageshow",{type:"load",target:n}):V.call(M,"pageshow",{type:"load",target:n})})))}catch(t){e.showLog(t,"bui.router.doAnimate")}}function Q(t){var n="";M.store&&(t=M.store.compileHtml(t));var i=e.history.getLast();if(t=(t=(t=e.unit.handleContent(t)).replace(/#module\.id/g,"#"+i.id)).replace(/#module\.path/g,i.path),c.part)n=B({content:t}),c.id?P.html(n):e.showLog("id 不能为空","router.loadPart");else if(c.replace){var a=x.getLast();P=C.length?e.objId(a.id):s,a.pid=_,a.url=$,a.param=v,e.array.index(C,_,"pid"),n=_ in k?L.get(_,"template"):B({content:t}),P.html(n).attr("data-page",_)}else g||(n=z({id:O,content:t,pid:_}),s&&s.attr("data-main",O).append(n));return r.needView&&loader.views({compiled:function(){M.store&&!M.store.config.isPublic&&M.store.config.needCompile&&M.store.compile("#"+O)}}),!M.store||r.needView||M.store.config.isPublic||M.store.config.needCompile&&M.store.compile("#"+O),n}function ee(e){var n=x.getLast(),i=T[e.pid]&&T[e.pid]||{},a=i.loaded;loader.set(e.pid,{props:n.param,$:function(e){return t("#"+n.id).find(e)}});var r=a&&a.apply(i,i.dependExports)||i.exports;w[e.pid]=r||null,i.exports=r,n.exports=r,g&&V.call(M,"refresh",{prevTarget:m,target:n}),o&&o.hide(),f.resolve(r),g=!1,h=!1}function te(){var e=C[C.length-2]||null,t=x.getLast();h&&!c.part&&(V.call(M,"firstload",{prevTarget:e,target:t}),h=!1),c.part?V.call(M,"loadpart",{prevTarget:e,target:t}):V.call(M,"load",{prevTarget:e,target:t})}return f.promise()}function R(e){var t="",n=e;P=loader.map(),T=P.modules;var i=n.indexOf(r.pageSuffix);return i>-1?(n=(t=n).substr(0,i),T.hasOwnProperty(n)&&(t=T[n]&&T[n].template||t||"")):t=T[n=n]&&T[n].template||n+r.pageSuffix||"",{pid:n,url:t}}function _(n){var i=this,a={};"function"==typeof n?a.callback=n:a=n||{};var o=t.extend(!0,{index:-1,name:"",beforeBack:r.beforeBack,callback:null,loaded:r.backed},a),l=parseInt(o.index),c=C.length;if(P=loader.map(),T=P.modules,!(l>0)){var f=x.getLast(),p=c-1,h=f.toggle;if(h)return h.hide(),void D();var g="function"==typeof o.beforeBack?o.beforeBack.call(M,{prevTarget:null,target:f}):a.beforeBack;V.call(M,"beforeback",{prevTarget:null,target:f});var v=loader.get(f.pid);return v&&v.beforeDestroy&&v.beforeDestroy(),!1===g?this:(o.name&&(l=$(o.name)),Math.abs(l)>p&&(l=-p),c>1&&m&&(l<-1&&F(l),m=!1,a.effect&&(u.option({effect:a.effect}),d.option({effect:a.effect})),u&&u.show(),d&&d.hide((function(){var n=c+l;!function(e){s.children().each((function(n,i){n>=e&&t(i).remove()}))}(n),x.removeNext(n),F();var a=D(),r=a.pid;e.objId(a.id).css("zIndex",5),function(){var e;e=w[r]||{};var t=loader.get(a.pid);o.callback&&o.callback.call(i,e,a),o.backed&&o.backed.call(M,{prevTarget:f,target:a}),V.call(M,"back",{prevTarget:f,target:a}),a;var n="pageshow-"+a.pid,l="pagehide-"+f.pid;v&&v.hide&&v.hide({type:"back",target:f}),t&&t.show&&t.show({type:"back",target:a}),V.call(M,l,{type:"back",target:f}),V.call(M,n,{type:"back",target:a}),V.call(M,"pageshow",{type:"back",target:a}),V.call(M,"pagehide",{type:"back",target:f}),v&&v.destroyed&&v.destroyed(),m=!0}()}))),this)}e.showLog("index 参数只能是负数","bui.router.back")}function $(t){var n,i=e.array.indexs(C,t,"pid"),a=i.length;if(a){var o=-(C.length-i[a-1]-1);n=0==o?-1:o}else n=-1;return n}function A(t,n,i){if("string"==typeof t){loader.importHtml(t,(function(t,i,a){t=function(e){var t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,n=/<body[^>]*>([\s\S]*)<\/body>/.exec(e);if(n&&2===n.length)return n[1].replace(t,"");return e}(t),e.history.getLast(),n&&n(t,i,a),V.call(M,"success",t,i,a)}),(function(e,t,n){i&&i(e,t,n),V.call(M,"fail",e,t,n)}))}else if("function"==typeof t){var a=t&&t();n&&n(a,200,{}),V.call(M,"success",a,200,{})}else e.showLog("url 不能为空","bui.router.requestUrl")}function D(){var t=x.getLast(),n=t.id||"",i=t.effect||r.effect;return n&&(V.call(M,"beforepageshow",{target:t}),d=null,d=e.toggle({id:document.getElementById(n),effect:b[i]&&b[i].inRight||""}),s&&s.attr("data-main",n)),t}function F(t){t=t||-1;var n=C.length+t-1,i=C[n],a=i&&i.id||"",o=i&&i.effect||r.effect;return a&&(V.call(M,"beforepagehide",{target:i}),u=null,u=e.toggle({id:document.getElementById(a),effect:b[o]&&b[o].inLeft||""})),i}function z(e){var t="";return t+='<div id="'+e.id+'" class="bui-router-item" data-page="'+e.pid+'">',t+=e.content||"",t+="</div>"}function B(e){var t="";return t+=e.content}function U(t,n){return e.on.apply(M,arguments),this}function V(t){M.self=this==window||this==M?null:this,e.trigger.apply(M,arguments)}e.hasRouter=!0,x.get=function(){return C},x.add=function(n){if((n=n||{}).toggle){var i=t.extend(!0,{},n);n.toggle=null,C.push(i)}else C.push(n);var a=window.location.origin+window.location.pathname+"#"+n.pid,o=e.setUrlParams(a,n.param);if(!h)return r.syncHistory&&"pushState"in window.history&&window.history.pushState(n,null,o),C;r.syncHistory&&"replaceState"in window.history&&window.history.replaceState(n,null,o)},x.prepend=function(t){t=t||{};var n=window.location.origin+window.location.pathname+"#"+t.pid;return e.setUrlParams(n,t.param),C.unshift(t),C},x.replace=function(t){t=t||{};var n=C.length-1,i=window.location.origin+window.location.pathname+"#"+t.pid,a=e.setUrlParams(i,t.param);return n>-1&&(C.splice(n,1,t),r.syncHistory&&"replaceState"in window.history&&window.history.replaceState(t,null,a)),C},x.getLast=function(e){var t=C.length-1,n=C[t]||{};return e?n[e]:n},x.removeNext=function(t){var n=C.length-t;C.splice(t,n);var i=x.getLast(),a=window.location.origin+window.location.pathname+"#"+i.pid,o=e.setUrlParams(a,i.param);r.syncHistory&&"replaceState"in window.history&&window.history.replaceState(i.param,null,o)},x.removeLast=function(){var e=C.length-1;x.removeNext(e)},x.checkLoad=function(t){return e.array.compare(C,t,"pid")||e.array.compare(C,t,"url")||e.array.compare(C,t,"id")},L.add=function(e,t){return k[e]=t||{},k[e]},L.del=function(e){delete k[e]},L.get=function(e,t){return t?(k[e]||{})[t]:k[e]},L.save=function(){if(C.length>1){var e=i.html();j.set("cacheHtml",e),j.set("cacheHistory",C),j.set("hasCache","true")}},L.load=function(){var t=j.get("cacheHtml",0),n=j.get("cacheHistory",0),a=[];if(n.length>1){i.html(t),s=i.children(".bui-router-main"),_({name:N().pid});try{n.forEach((function(e,t){var n="string"==typeof e?JSON.parse(e):e;a.push(n)}));var o=a[a.length-1];o,loader.require(o.pid,(function(e){w[o.pid]=e||null})),U("back",(function(e){loader.require(e.target.pid,(function(t){w[e.target.pid]=t||null}))}))}catch(t){e.showLog(t)}C=a,D(),F(),h=!1,I=!0,L.clear()}},L.clear=function(){j.remove("cacheHistory"),j.remove("cacheHtml"),j.remove("hasCache")},S.add=function(e,t){return O[e]=t||{},O[e]},S.get=function(e,t){return t?(O[e]||{})[t]:O[e]};var M={init:function(n){M.store=n.store||null,delete n.store,n=t.extend(!0,{},r,e.config.router,n),r=M.config=n;var l,u=e.history.getParams("url");if(u.module&&n.parseurl){var d=u.module;delete u.module;var h=e.setUrlParams(d,u);return window.location.href=window.location.origin+window.location.pathname+"#"+h,this}if("pages/main/main.html"===n.indexModule.template&&"pages/main/main.js"===n.indexModule.script||(P=loader.map(n.indexModule)),v&&"effect"in n&&C.forEach((function(e,t){e.effect=n.effect})),!n.id)return e.showLog("id 不能为空","bui.router.init"),!1;if(i=e.objId(n.id),o=bui.mask({appendTo:i,opacity:0,autoClose:!1}),a=e.loading({display:"block",width:30,height:30,opacity:0}),s=i.children(".bui-router-main"),f=n.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",p=n.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",!s.length){var m=(l="",String(f).indexOf("%"),String(p).indexOf("%"),l+='<div class="bui-router-main">',l+="</div>");i.html(m),s=i.children(".bui-router-main")}return(n.width>0||String(n.width).indexOf("%")>-1)&&s.width(n.width),(n.height>0||String(n.height).indexOf("%")>-1)&&s.height(n.height),function(n){if(function(){var t=j.get("hasCache",0);Boolean(t)&&r.reloadCache?L.load():function(t){try{var n=N();if(n.pid){if(n.pid.indexOf("http://")>-1||n.pid.indexOf("https://")>-1)return n.param.iframe=!0,void E({url:n.pid,param:n.param,iframe:!0});E({url:n.pid,param:n.param})}else E({url:r.indexModule.moduleName,param:n.param||{}})}catch(t){e.showLog(t,"bui.router.loadUrl")}}()}(),n.swipe&&function(n){var a=/hp-tablet/gi.test(navigator.appVersion),o="ontouchstart"in window&&!a,l=0,c=0,s=!1,u=null,d=null,f={x1:0,x2:0,y1:0,y2:0,direction:""};i.on("touchstart",(function(i){var a=i.originalEvent&&i.originalEvent.targetTouches||i.targetTouches,l=o?a[0]:i;f.x1=l.pageX,f.y1=l.pageY,s=t(i.target).closest(r.useScroll).length,C.length>1&&f.x1>0&&f.x1<n.distance&&(u=t("#".concat(x.getLast().id)),d=e.history.getPrev().id?t("#".concat(e.history.getPrev().id)):null)})),i.on("touchmove",(function(i){var a=i.originalEvent&&i.originalEvent.targetTouches||i.targetTouches,p=o?a[0]:i;f.x2=p.pageX,f.y2=p.pageY,a.length>1||i.scale&&1!==i.scale||(s=t(i.target).closest(r.useScroll).length,f.x2-f.x1>0&&!s&&i.preventDefault(),f.direction||(f.direction=e.swipeDirection(f.x1,f.x2,f.y1,f.y2)),"swipeleft"!==f.direction&&"swiperight"!==f.direction||(i.preventDefault(),i.stopPropagation()),l=Math.abs(f.x2-f.x1),c=Math.abs(f.y2-f.y1),"swiperight"===f.direction&&l>n.startDistance&&n.swipeBack&&(d&&d.css("display","block"),n.pageMove&&u&&u.css("transform","translateX(".concat(l,"px)")),i.preventDefault()))})),i.on("touchend",(function(e){(s=t(e.target).closest(r.useScroll).length,"swiperight"===f.direction&&f.x1>n.distance&&n.swipeBack&&(l=0),"swiperight"===f.direction&&l>n.swipeDistance)&&(!1!==(n.onBeforeSwipeRight&&n.onBeforeSwipeRight())&&n.swipeBack&&bui.back(),n.onSwipeRight&&n.onSwipeRight(e),V.call(M,"swiperight"));"swipeleft"===f.direction&&l>n.swipeDistance&&(n.onSwipeLeft&&n.onSwipeLeft(e),V.call(M,"swipeleft")),"swipeup"===f.direction&&c>n.swipeDistance&&!s&&(n.onSwipeUp&&n.onSwipeUp(e),V.call(M,"swipeup")),"swipedown"===f.direction&&c>n.swipeDistance&&!s&&(n.onSwipeDown&&n.onSwipeDown(e),V.call(M,"swipedown")),l<n.swipeDistance&&(d&&d.css("display","none"),u&&u.css("transform","translateX(0)")),l=0,s=!1,f={x1:0,x2:0,y1:0,y2:0,direction:""},u=null,d=null,e.stopPropagation()}))}(n),window.addEventListener("beforeunload",(function(e){r.reloadCache&&L.save(),V.call(c,"beforeunload",{target:C[C.length-1]})})),n.hash)return window.addEventListener("hashchange",(function(t){var n=N(),i=""==n.pid||"undefined"==n.pid?"main":n.pid,a=e.array.indexs(C,i,"pid"),o=a[a.length-1];i="wechat_redirect"==n.pid?"main":i,o>-1?(_({index:-(C.length-o-1||1)}),V.call(c,"popstate",{type:"back",prevTarget:C[o-1],target:C[o]})):(E({url:i,param:n.param,iframe:"true"==n.param.iframe,replace:!0}),V.call(c,"popstate",{type:"load",prevTarget:C[C.length-2],target:C[C.length-1]}))})),this;r.syncHistory&&"pushState"in window.history&&window.addEventListener("popstate",(function(t){var n=N(),i=""==n.pid?r.indexModule.moduleName:n.pid,a=$(i);e.array.index(C,i,"pid")>-1?(_({index:a,param:n.param}),V.call(c,"popstate",{type:"back",prevTarget:C[a-1],target:C[a]})):(E({url:i,param:n.param,iframe:"true"==n.param.iframe}),V.call(c,"popstate",{type:"load",prevTarget:C[C.length-2],target:C[C.length-1]}))}))}(n),n.uid&&e.history.setUI&&e.history.setUI({uid:n.uid,ui:M}),V.call(this,"init",{target:i[0]}),M},option:function(t,n){return v=!0,e.option.call(M,t,n)},config:r,data:{},on:U,off:function(t,n){return e.off.apply(M,arguments),this},trigger:V,load:E,resize:function(e){return(e=e||{}).width=e.width||r.width,e.height=e.height||r.height,window.viewport=bui.viewport(),f=e.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",p=e.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",s.css({width:f,height:p}),V.call(this,"resize",{target:C[C.length-1]}),this},destroy:function(t){return"string"==typeof t&&"main"!==t?(loader.destroy(t),L.del(t),t in w&&delete w[t]):e.showLog("参数只能是字符串"),this},loadPart:function(e){var n=t.Deferred(),i=t.extend(!0,{},{id:"",url:"",param:{},loaded:null},e);return i.loaded=function(t){e.loaded&&e.loaded.call(M,t),n.resolve(t),V.call(M,"loadpart",t)},loader.load(i),n.promise()},replace:function(e){return E({url:(e=e||{}).url||"",param:e.param||{},replace:!0}),this},refresh:function(){var t=C.length-1,n=C[t],i=C.length>1?C[C.length-2]:null;return e.history.refresh(),V.call(M,"refresh",{prevTarget:i,target:n}),this},back:_,isLoad:function(e){var t;return e&&(t=e in w),t},$:function(t){var n=x.getLast(),i=document.getElementById(n.id)||document;return e.obj(t,i)},currentId:function(e){return x.getLast().id},currentPage:function(){var e=x.getLast();return document.getElementById(e.id)},currentModule:function(){return x.getLast()},getPageParams:function(){return x.getLast().param},getPartParams:function(t){return e.history.getComponentParam(t)},getHistory:x.get,preload:function(n){var i=t.Deferred(),a=function(t,a){return A(t.url,(function(i){var o=e.guid(),r=R(t.url).pid;z({id:o,content:i,pid:r});var l=[];L.add(r,{id:o,pid:r,template:i}),l.push(r),t.style&&"array"===e.typeof(t.style)?t.style.forEach((function(e,t){l.push(e)})):t.style&&"string"===e.typeof(t.style)&&l.push(t.style),t.script&&"array"===e.typeof(t.script)?t.script.forEach((function(e,t){l.push(e)})):t.script&&"string"===e.typeof(t.script)&&l.push(t.script),loader.import(l,(function(){V.call(M,"preloadafter",{prevTarget:null,target:null}),a&&a(n)}),(function(){V.call(M,"preloadafter",{prevTarget:null,target:null}),a&&a(n)}))}),(function(n){e.showLog(t.url+"请求失败"),i.reject(t.url)})),i.promise()};return n&&"object"===e.typeof(n)?"url"in n&&a(n,(function(){i.resolve(n)})):n&&"array"===e.typeof(n)&&n.forEach((function(e,t){t==n.length-1?"url"in e&&a(e,(function(){i.resolve(n)})):"url"in e&&a(e)})),i},initScroll:function(n){var i=x.getLast(),a=e.objId(i.id),o="object"===_typeof(n)?t(n):a.find(".bui-page");return o.length&&e.init({id:o,height:p}),this},history:{get:x.get,check:x.checkLoad,getLast:x.getLast,add:x.add,removeLast:x.removeLast,replace:x.replace}};return M}}(window.bui||{},window.libs),function(e,t){var n=function(){function n(i){_classCallCheck(this,n),this._default={log:!1,hasLife:!0,onBeforeInit:null,onInited:null},this._plugin=i||{name:"",depend:null,config:null,param:null,callback:null};var a=e.config.hasOwnProperty(this._plugin.name)?e.config[this._plugin.name]:null;this.config=t.extend(!0,{},this._default,a,this._plugin.config,this._plugin.param),this.initStatus=!1,this.reinitStatus=!1,this.widgets=Object.create(null),this.init()}return _createClass(n,[{key:"widget",value:function(e){return e&&e in this.widgets?this.widgets[e]:this.widgets}},{key:"init",value:function(n){var i=this,a=n||null;i.config=t.extend(!0,this.config,a);var o=i.config,r=o.hasLife&&o.onBeforeInit&&o.onBeforeInit.call(i,o);return o.log&&console.log("".concat(i._plugin.name," before init")),!1===r||(i._plugin.callback&&i._plugin.callback.call(i,o),o.log&&console.log("".concat(i._plugin.name," init")),o.hasLife&&o.onInited&&o.onInited.call(i,o),o.log&&console.log("".concat(i._plugin.name," after inited")),this.initStatus=!0,i.config.uid&&e.history.setUI&&e.history.setUI({uid:i.config.uid,ui:i})),i}},{key:"reinit",value:function(){return this.destroy(),this.init(),this.config.log&&console.log("".concat(this._plugin.name," reinit")),this}},{key:"destroy",value:function(t){this.beforeDestroy&&this.beforeDestroy(),this.beforeDestroy=null,this.widgets={},this.off(),this.initStatus=!1,t&&t.call(this);var n=this.config.uid;n&&(e.history.getLast().ui[n]=null);return this.config.log&&console.log("".concat(this._plugin.name," destroyed")),this}},{key:"prefix",value:function(t){return e.config.classNamePrefix+t}},{key:"showLog",value:function(t,n){n=n||"";var i="";return"object"==_typeof(t)&&"message"in t&&"name"in t?i=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(i=t),e.log&&console.error(n+" "+i),e.trace&&console.trace&&console.trace(),this}},{key:"option",value:function(n,i){if("object"!==e.typeof(n)&&void 0===i)return"string"==typeof n?this.config[n]:this.config;if("id"==n)return e.showLog("不允许修改控件的ID参数"),this;if(n&&"object"===e.typeof(n)){var a=t.extend(this.config,n);return this&&this.init(a)}if(this.config.hasOwnProperty(n)){var o={};o[n]=i;var r=t.extend(this.config,o);return instance&&instance.init(r)}return this}},{key:"emitter",get:function(){return e.emitter()}},{key:"on",get:function(){return this.emitter.on}},{key:"off",get:function(){return this.emitter.off}},{key:"trigger",get:function(){return this.emitter.trigger}}]),n}();e.extend=function(t){new(function(){function i(e){_classCallCheck(this,i),this.init(e)}return _createClass(i,[{key:"init",value:function(i){var a=i.name;return this.checkName(a)?(e[a]=function(e){return t.param=e,new n(t)},this):this}},{key:"checkName",value:function(t){return t?!e.hasOwnProperty(t)&&(this.name=t,!0):(console.warn("插件名字不能为空"),!1)}}]),i}())(t)}}(window.bui||{},window.libs),t((function(e){!function(t,n){var i;t.extend({name:"page",config:(i={uid:"",dialogid:"",url:"",param:null,script:"",appendTo:"",className:"bui-dialog-page",effect:"",pageSuffix:".html",height:0,width:0,iframe:!1,openFirst:!0,closeFirst:!1,autoClose:!1,needRemove:!1,useBox:!1,syncHistory:!1,title:"",buttons:null,mask:!1,life:!0,scroll:!1,needView:!1,needComponent:!0,cache:!0,close:!1,autoload:!0,fullscreen:!0},_defineProperty(i,"effect","fadeInRight"),_defineProperty(i,"onError",null),_defineProperty(i,"beforeClose",null),_defineProperty(i,"closed",null),_defineProperty(i,"beforeOpen",null),_defineProperty(i,"opened",null),_defineProperty(i,"beforeLoad",null),_defineProperty(i,"loaded",null),i),callback:function(i){var a=this,o=a.config,r="body"==a.appendTo?n:t.obj,l="",c=!1,s=(loader.map().modules,a.widgets.dialog=t.dialog({autoinit:!1,needRemove:i.needRemove})),u=null,d=!1;function f(e,n){var i="",a=n.close?'<div class="bui-dialog-close"><i class="'+t.config.icon.close+'"></i></div>':"",o=n.title?'<div class="bui-dialog-head">'.concat(n.title,"</div>"):"";return i+="".concat(o,'<div class="bui-dialog-main">').concat(e,"</div>").concat(a)}function p(e){var n=loader.map().modules[u.module]||{};if(n.hide&&o.life){var i=t.hasRouter?t.history.getLast():{};n.hide({type:"page",target:i})}"function"==typeof e&&e.call(a,n.exports),o.closed&&o.closed.call(a,n)}function h(n,i){var r=t.history.getLast(),l=(loader.map().modules||{})[n];if(o.cache&&c&&!d)return!o.openFirst&&s.open(),"function"==typeof i&&i.call(a,l.exports),a;if(t.history.setPage({id:s.config.id,name:n,url:o.url,dialog:s,param:o.param}),loader.set(n,{props:o.param}),d=!1,l&&"function"==typeof l.loaded){var u=l.loaded&&l.loaded.call(e,l.exports)||l.exports;t.history.setPage({id:s.config.id,name:n,url:o.url,dialog:s,exports:u,param:o.param});var f=loader.map().modules[n]||{};return f.show&&o.life&&f.show({type:"page",target:r}),"function"==typeof i&&i.call(a,u),a.compile({id:s.config.id}),o.opened&&o.opened.call(a,u),!o.openFirst&&s.open(),c=!0,this}loader.require(n,(function(e){var l=loader.map().modules[n]||{};t.history.setPage({id:s.config.id,name:n,url:o.url,dialog:s,exports:e,param:o.param}),l.show&&o.life&&l.show({type:"page",target:r}),"function"==typeof i&&i.call(a,e),a.compile({id:s.config.id}),o.opened&&o.opened.call(a,e),c=!0}))}function m(e){var t=loader.map().modules,n={},i=e.indexOf(o.pageSuffix);return i>-1?(n.url=e,n.module=e.substr(0,i)):(n.url=t[e]&&t[e].template||e+o.pageSuffix,n.module=e),n}return a.init=function(e){var i=n.extend(!0,{},a.config,e);if(i.onClose=function(){t.hasRouter&&i.syncHistory&&bui.back(),p()},u=m(i.url),i.iframe){var o=t.platform.isIos()?'scrolling="no"':"";return i.content='<iframe class="bui-router-iframe" src="'.concat(i.url,'" ').concat(o," ></iframe>"),s.create(i),i.autoload&&s.open(),i.loaded&&i.loaded.call(a,u),a}if(i.script){var c=i.script.indexOf(".js");u.module=i.script.substr(0,c)}return!1===(i.beforeLoad&&i.beforeLoad.call(a,u))?this:(loader.import(u.url,(function(e){if("object"!==_typeof(e)){if(l=f(e,i),i.id){s.init(i),e=(e=t.unit.handleContent(e)).replace(/#module\.id/g,"#"+i.id);var n=u.url.substr(0,u.url.lastIndexOf("/")+1);e=e.replace(/#module\.path/g,n),r(i.id).html(e)}else i.content=e,s=s.create(i);i.autoload&&a.open(),i.loaded&&i.loaded.call(a,u)}else i.onError&&i.onError.call(a,e)})),a)},a.compile=function(e){var t=n.extend(!0,{id:s.config.id,cacheHtml:!1,cache:!1,needComponent:o.needComponent,needView:o.needView},e);t.needView&&loader.views(t),t.needComponent&&loader.components(t)},a.reload=function(e){var i=o=n.extend(!1,a.config,o,e);if(i.param=e.param||{},d=!0,u=m(i.url),i.script){var c=i.script.indexOf(".js");u.module=i.script.substr(0,c)}if(!1===(i.beforeLoad&&i.beforeLoad.call(a,u)))return this;loader.import(u.url,(function(e){if("object"!==_typeof(e)){e=(e=t.unit.handleContent(e)).replace(/#module\.id/g,"#"+(s.config.id||i.dialogid));var n=u.url.substr(0,u.url.lastIndexOf("/")+1);e=e.replace(/#module\.path/g,n),l=f(e,i),r("#"+(s.config.id||i.dialogid)).html(l),h(u.module),i.loaded&&i.loaded.call(a,u)}else i.onError&&i.onError.call(a,e)}))},a.toggle=function(e,t){return a.isOpen()?a.close(t):a.open(e),a},a.isOpen=s.isOpen,a.close=function(e){return!1===(i.beforeClose&&o.beforeClose.call(a))?this:(t.hasRouter&&o.syncHistory&&t.history.removeLast(o.syncHistory),o.closeFirst?(s.close((function(){a.trigger("close"),p(e)})),a):(p(e),s.close(),a.trigger("close"),a))},a.remove=function(e){return s.remove(e),a.trigger("remove"),a},a.open=function(e){if(!1===(o.beforeOpen&&o.beforeOpen.call(a)))return this;if(o.iframe)return s.open(e),a;var n={hide:a.close,show:a.open};return t.hasRouter&&o.syncHistory&&t.history.add({id:s.config.id,name:u.module,url:o.url,replace:!1,param:o.param||{},part:{},page:{},effect:"push",toggle:n,syncHistory:o.syncHistory}),loader.map({moduleName:u.module,id:s.config.id}),t.history.getLast().currentPage=s.config.id,o.openFirst?(s.open((function(){a.trigger("open"),h(u.module,e)})),a):(h(u.module,e),s.open(),a.trigger("open"),a)},a.setParam=function(e){var i=n.extend(!1,{},o.param,e);t.history.setPage({id:s.config.id,param:i})},a.init(o),a}})}(window.bui||{},window.libs)})),function(e,t){e.setUrlParams=function(t,n,i){i=0!=i,n="object"==_typeof(n)?n:{};var a=e.unit.objectToKeyString(n,i);return""==a?t:t.indexOf("?")>-1?t+"&"+a:t+"?"+a},e.getUrlParams=function(n){n=0!=n;var i=window.location.href,a=i.indexOf("?"),o={};if(a>-1){var r=i.substr(a+1);if(r.indexOf("?")>-1){var l=r.split("?"),c=l[0],s=l[1],u=e.unit.keyStringToObject(c,n),d=e.unit.keyStringToObject(s,n);o=t.extend(!0,u,d)}else o=e.unit.keyStringToObject(r,n)}return o},e.getUrlParam=function(e){var t=window.location.href,n=new RegExp("(^|&|.)"+e+"=([^&]*)(&|$)","i"),i=t.substr(1).match(n);return null!=i?decodeURIComponent(i[2]):null},e.typeof=function(e){var t=Object.prototype.toString.call(e).slice(8,-1);return t=t.toLowerCase()},e.setting=function(t,n){return"string"==typeof t&&"object"===_typeof(n)?e.config[t]=n:"string"==typeof t&&void 0===n?e.config[t]:e.config},e.cmd=function(t){var n=t.split(":")||[],i=e.history.getUI(n[0]);if(n.length>1){var a=[].slice.apply(arguments);a.shift();var o=i[n[1]];return o?o.apply(i,a):void e.showLog("找不到该实例的".concat(n[1],"方法"))}return i}}(window.bui||{},window.libs),function(e,t){e.array={},e.array.index=e.inArray=function(t,n,i){var a,o;"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t);for(var r=0;r<a.length;r++){var l=a[r];if((l&&l[i]||l)===o)return parseInt(r)}return-1},e.array.compare=e.compareArray=function(t,n,i){var a,o;"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t);for(var r=0;r<a.length;r++){var l=a[r],c=l&&l[i]||l;if("object"===_typeof(c)&&"object"===_typeof(o))try{if(JSON.stringify(c)===JSON.stringify(o))return!0}catch(e){if(c===o)return!0}else if(c===o)return!0}return!1},e.array.remove=e.removeArray=function(t,n,i){var a,o;return"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t||[]),e.array.delete(a,o,i),a},e.array.filter=e.filterArray=function(t,n,i){var a,o;t&&"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t);var r=[];for(var l in a)try{var c=a[l],s=c&&c[i]||c;new RegExp(o).test(s)&&r.push(c)}catch(t){e.showLog(t)}return r},e.array.indexs=e.indexArray=function(t,n,i){var a,o;"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t);var r=[];for(var l in a){(a[l]&&a[l][i]||a[l])===o&&r.push(+l)}return r},e.array.excess=e.excessArray=function(t,n,i){var a;a="array"===e.typeof(t)?t||[]:n||[];var o={},r=[];for(var l in a)try{var c=a[l]&&a[l][i]||a[l];o[c]!==c&&(o[c]=c,r.push(a[l]))}catch(e){}return r},e.array.uniq=function(t,n){for(var i=[],a=0;a<t.length;a++){var o=void 0===n,r=t[a],l=o?r:r[n]||r;e.array.index(i,l,n)<0&&i.push(r)}return i},e.array.copy=e.copyArray=function(t,n,i){var a=[];if(n=n||0,i=i||t&&t.length,!t||"array"===e.typeof(t))return t.forEach((function(e,t){a.push(e)})),a.splice(n,i)||[]},e.array.empty=function(t){if(!t||"array"===e.typeof(t))return t.splice(0,t.length)},e.array.replace=function(t,n){if(!(t&&"array"!==e.typeof(t)||n&&"array"!==e.typeof(n))){var i=[0,t.length].concat(n);return t.splice.apply(t,i)}},e.array.merge=function(t){var n;if(!t||"array"===e.typeof(t)){var i=arguments,a=i.length-1,o=i[a],r="string"==typeof o;if(r&&i.length>1){for(var l,c=a,s=[],u=function(n){var a=Array.prototype.slice.call(i[n],0);t.forEach((function(t,n){var i=t[o]||t;"array"===e.typeof(a)&&a.forEach((function(e,n){var r=e[o]||e;if(i===r){for(var l in e)t[l]=e[l];a.splice(n,1)}}))})),s.push(a)},d=0;d<c;d++)u(d);return(l=e.array).merge.apply(l,[t].concat(s))}var f=(n=[t.length,0]).concat.apply(n,_toConsumableArray(Array.prototype.slice.call(arguments,1)));return t.splice.apply(t,f),t}},e.array.get=function(t,n,i){if(!t||"array"===e.typeof(t)){for(var a,o=i||"id",r=null,l=0;l<t.length;l++){((r=t[l])&&r[o]||r)===n&&(a=r)}return a}},e.array.getAll=function(t,n,i){t=t||[];var a=[],o=null;for(var r in t)try{var l=(o=t[r])&&o[i]||o;n&&"array"===e.typeof(n)?n.forEach((function(e,t){l===e&&a.push(o)})):l===n&&a.push(o)}catch(e){}return a},e.array.set=function(t,n,i,a){if(a=a||!0,!t||"array"===e.typeof(t)){var o=/\d/.test(n)&&"number"==typeof n;if(o&&void 0!==i){var r=t[n]||{};if(!0===a)return t.splice(n,1,i),t;if("object"===e.typeof(i))for(var l in i)r[l]=i[l];else"object"!==e.typeof(i)&&"string"==typeof a&&(r[a]=i);return t.splice(n,1,r),t}for(var c=0;c<t.length;c++){var s=t[c],u=void 0===a?s:s[a]||s;if(o?c===n:u===n){if("string"==typeof a){if(i&&"object"===e.typeof(i))for(var d in i)s[d]=i[d];else s[a]=i;t.splice(c,1,s)}else t.splice(c,1,i);return t}}return t}},e.array.setAll=function(t,n,i,a){if(!t||"array"===e.typeof(t))return t.filter((function(o,r){var l=void 0===a?o:o[a]||o;if(r==n||l===n)if(a){if(i&&"object"===e.typeof(i))for(var c in i)o[c]=i[c];else o[a]=i;t.splice(r,1,o)}else t.splice(r,1,i)})),t},e.array.delete=function(t,n,i){if(!t||"array"===e.typeof(t)){var a=[],o=e.array.copy(t);return n&&"array"===e.typeof(n)?n.forEach((function(e,t){r(void 0!==i&&e[i]||e)})):r(n),a}function r(e){for(var r=0,l=0;l<o.length;l++){var c=l-r,s=t.length!==o.length,u=s?t[c]||{}:t[l]||{},d=void 0!==i?u[i]:u,f="function"==typeof d?d.name.replace("bound ",""):d,p="function"==typeof e?e.name:e;if("object"===_typeof(d)&&"object"===_typeof(n))try{JSON.stringify(d)===JSON.stringify(n)&&(s?t.splice(c,1):t.splice(l,1),a.push(l),++r)}catch(e){}else d!==e&&f!==p||(s?t.splice(c,1):t.splice(l,1),a.push(l),++r)}}},e.array.deleteIndex=function(t,n){if(!t||"array"===e.typeof(t)){var i=[];return n&&"array"===e.typeof(n)?n.forEach((function(n,a){i.push(t[n]),e.array.remove(t,t[n])})):(i.push(t[n]),e.array.remove(t,t[n])),i}}}(window.bui||{}),function(e,t){e.storage=function(n){var i=1,a="",o="",r=null,l=null,c={size:i,reverse:!0,deep:!1,local:!0,uid:"",prefix:""},s={init:u,get:d,getAll:function(e){for(var t={},n=parseInt(e)||0,i=0;i<localStorage.length;i++){var a=localStorage.key(i);if(a.substr(o.length),o&&0===a.indexOf(o))try{var r=JSON.parse(l.getItem(a));t[a]=void 0!==e?r[n]:r}catch(e){t[a]=l.getItem(a)}if(""===o)try{t[a]=JSON.parse(l.getItem(a))}catch(e){t[a]=l.getItem(a)}}return t},set:function(t,n,r){t=o+t;var c=1==i?null:l.getItem(t),s=[],u="",d=r?n[r]:n;if(null===c){s.push(n),u=JSON.stringify(s);try{l.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{var f=JSON.parse(c);if(e.array.compare(f,d,r)){e.array.remove(f,d,r),f[a](n);try{u=JSON.stringify(f),l.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{f[a](n),f.length>i&&0!=i&&("unshift"==a?f.pop():f.shift());try{u=JSON.stringify(f),l.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}}return this},remove:function(t,n,i){if("string"!=typeof(t=o+t))return void e.showLog("要删除的字段名只能是字符串","bui.storage.remove");var a=d(t)||[];if("number"==typeof n){var r="number"==typeof i?i:1;a.splice(n,r);try{var c=JSON.stringify(a)||"";l.setItem(t,c)}catch(t){e.showLog(t.name+": "+t.message,"bui.storage.remove")}}else if("string"==typeof n){var s=e.array.remove(a,n,i);try{c=JSON.stringify(s)||"";l.setItem(t,c)}catch(t){e.showLog(t.name+": "+t.message,"bui.storage.remove")}}else l.removeItem(t);return this},clear:function(){if(o)for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);0===t.indexOf(o)&&l.removeItem(t)}else l.clear();return this}};function u(n){var u;return"number"!=typeof n&&"string"!=typeof n||(n={size:n}),u=r=t.extend(!0,c,n),i=+u.size,o=u.prefix||"",a=u.reverse?"push":"unshift",l=u.local?localStorage:sessionStorage,u.uid&&e.history.setUI&&e.history.setUI({uid:u.uid,ui:s}),this}function d(t,n,i){t=o+t;var a,c=l.getItem(t)||"";try{a=r.deep?c&&e.unit.stringToJson(c):c&&JSON.parse(c)}catch(t){a=c,e.showLog(t.name+": "+t.message,"bui.storage.get")}if("number"==typeof n&&i)a=a&&a[n]&&a[n][i]||void 0;else if("string"==typeof n){var s=e.array.index(a,n,i);a=a&&a[s]}else a="number"==typeof n?a&&a[n]||void 0:a;return a}return u(n),s}}(window.bui||{},window.libs),function(e,t){e.platform=function(){var e=navigator.userAgent;function t(){return n()||i()||a()}function n(t){return/(Android|Linux)/i.test(e)}function i(t){return/(iPhone)/i.test(e)}function a(t){return/(iPad)/i.test(e)}return{isAndroid:n,isIphone:i,isIpad:a,isIos:function(t){return/(iPhone|iPad|iOS)/i.test(e)},isWeiXin:function(t){return/(micromessenger)/i.test(e)},isPC:function(){return!t()},isMobile:t,isWeiXinMini:function(e){return"miniprogram"===window.__wxjs_environment},isBingotouch:function(t){return/(crosswalk)/i.test(e)},isMac:function(){return/macintosh;.+mac os x/i.test(e)},isIE:function(t){return/(trident)/i.test(e)},isIphoneX:function(e){var t=!1,n=3==window.devicePixelRatio&&375==window.screen.width&&812==window.screen.height,i=2==window.devicePixelRatio&&414==window.screen.width&&896==window.screen.height,a=3==window.devicePixelRatio&&414==window.screen.width&&896==window.screen.height;return(n||i||a)&&(t=!0),t},isWindow:function(t){return/Windows NT/i.test(e)}}}()}(window.bui||{}),function(e,t){e.date={},e.date.format=function(e,t){if(null==e)return"";var n=this.convert(e);t=t||"yyyy-MM-dd";var i={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[a]:("00"+i[a]).substr((""+i[a]).length)));return t},e.date.convert=function(e,t){if(e&&e.constructor==Date)return e;if("number"==typeof e&&13===String(e).length)return new Date(e);e=String(e);var n=new Date,i=n.getFullYear(),a=n.getMonth()+1,o=n.getDate();if((e=e.replace(/[-|年|月]/gim,"/").replace(/[时|分|秒|小时|分钟]/gim,":").replace(/^(\d{4}\/\d+?)($|\s)/,(function(e,t){return t+"/1"})).replace(/[日|号]/gim,"").replace(/^(\d{1,2}\/\d{1,2}?)($|\s)/,(function(e,t){return n.getFullYear()+"/"+t}))).indexOf("T")>-1&&-1==e.indexOf("GMT")){var r=(e=e.replace("T"," ")).indexOf(".")>-1?e.split("."):[e];return new Date(r[0])}if(e.indexOf("GMT")>-1){var l=(r=e.split(" "))[3]+"/"+{Jan:"1",Feb:"2",Mar:"3",Apr:"4",May:"5",Jun:"6",Jul:"7",Aug:"8",Sep:"9",Oct:"10",Nov:"11",Dec:"12"}[r[1]]+"/"+r[2]+" "+r[4];return new Date(l)}return e.indexOf("/")<0&&e.indexOf(":")>-1&&(e=i+"/"+a+"/"+o+" "+e),4===e.length?e+="/1/1 00:00:00":"MM"===t||"M"===t?e=i+"/"+e+"/1 00:00:00":"dd"!==t&&"d"!==t||(e=i+"/"+a+"/"+e+" 00:00:00"),new Date(e)},e.date.after=function(e,t,n){t=0===t?0:t||1;var i=this.convert(e).getTime()+1e3*parseInt(t)*3600*24;return this.format(i,n||"yyyy-MM-dd")},e.date.afterTime=function(e,t,n){var i=0===t?0:t||30,a=this.format(new Date,"yyyy/MM/dd")+" "+e,o=new Date(a).getTime()+1e3*i*60;return this.format(o,n||"hh:mm")},e.date.count=function(t,n,i){var a,o;switch(i){case"number":a=t,o=n;break;case"hour":var r=this.format(new Date,"yyyy/MM/dd"),l=r+" "+t,c=this.convert(l),s=r+" "+n,u=this.convert(s);a=c.getTime(),o=u.getTime();break;case"date":default:a=this.convert(t).getTime(),o=this.convert(n).getTime()}var d=a-o;d=Math.abs(d);var f=parseInt(d/1e3/3600/24,10),p=parseInt(d/1e3/3600%24,10),h=parseInt(d/1e3/60%60,10),m=parseInt(d/1e3%60,10);return{value:d,day:f,hour:p,minute:h,second:m,tip:"".concat(f,"天 ").concat(e.unit.fixZero(p),":").concat(e.unit.fixZero(h),":").concat(e.unit.fixZero(m))}},e.date.countMonth=function(e){var t=this.convert(e),n=t.getMonth()+1;return t.setMonth(n),t.setDate(0),t.getDate()},e.date.toWeek=function(e,t){var n=this.convert(e),i=null;switch(t){case 1:i=["周日","周一","周二","周三","周四","周五","周六"];break;default:i=t||["星期天","星期一","星期二","星期三","星期四","星期五","星期六"]}return i[n.getDay()]},e.date.today=function(e){return e=e||"M-d",this.format(new Date,e)},e.date.fromnow=function(e){var t=+new Date,n=this.convert(e).getTime(),i="",a=this.count(t,n,"date"),o=t>n?"前":"后";return a.day?i=a.day+"天"+o:a.hour?i=a.hour+"小时"+o:a.minute?i=a.minute+"分钟"+o:a.second&&(i=a.second+"秒"+o),i}}(window.bui||{}),function(e,t){e.ajax=function(n){var i=t.Deferred(),a=null,o=t.extend(!0,{},{baseUrl:"",data:{},method:"GET",dataType:"json",timeout:6e4,headers:{},processData:!0,mimeType:"none",cache:!0,async:!0,needJsonString:!1,contentType:null,localData:null,transformRequest:null,transformResponse:null,native:!0,needNative:!1},e.config.ajax,n),r=o.success,l=o.fail||o.error;if(null===o.contentType&&"get"==o.method.toLocaleLowerCase()?o.contentType="text/html;charset=UTF-8":null===o.contentType&&"post"==o.method.toLocaleLowerCase()?o.contentType="application/x-www-form-urlencoded":o.contentType=o.contentType,"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,o.needJsonString)try{o.data="object"===_typeof(o.data)?JSON.stringify(o.data):o.data}catch(e){o.data=o.data}if(o.data=o.transformRequest&&o.transformRequest.call(i,o.data)||o.data,!o.url)return e.showLog("url不能为空","bui.ajax"),i;if(o.url.indexOf("://")>-1?o.url=o.url:o.url.indexOf("./")>-1||o.url.indexOf("../")>-1?o.url=bui.unit.resolvePath(o.url):o.url=o.baseUrl+o.url,o.proxy){var c=o.url.indexOf(o.proxy),s=c>-1?c+1:-1;o.url=o.url.substr(s)}if(i.abort=function(){a&&a.abort()},o.localData)return o.localData=o.transformResponse&&o.transformResponse.call(i,o.localData)||o.localData,r&&r(o.localData,200),i.resolve(o.localData,200),i;if(o.needNative){if(void 0===e.native.ajax)return u(o),i;try{i=e.native.ajax&&e.native.ajax(o)||i}catch(e){}}else u(o);function u(e){e.success=function(t,n,a){var o=null;if("string"==typeof t&&"json"==e.dataType)try{o=JSON.parse(t)}catch(e){o=t}else o=t||{};o=e.transformResponse&&e.transformResponse.call(i,o)||o,r&&r(o,n,a),i.resolve(o,n,a)},e.error=function(t,n,a){var o;if("string"==typeof t&&"json"==e.dataType)try{o=JSON.parse(t)}catch(e){o=t}else o=t||{};l&&l(o,n,a),i.reject(o,n,a)};var n=e.type&&e.type.toUpperCase();e.type=n||e.method.toUpperCase(),a=t.ajax(e)}return i},e.get=function(n,i,a){var o={method:"GET"};o.url=n,o.data=i||{};var r=null,l=a&&a[0];return r=a&&"array"===e.typeof(a)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.get,o,l):o,bui.ajax(r)},e.post=function(n,i,a){var o={method:"POST",contentType:"application/x-www-form-urlencoded"};o.url=n,o.data=i||{};var r=null,l=a&&a[0];return(r=a&&"array"===e.typeof(a)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.post,o,l):o).contentType.indexOf("application/json")>-1&&(r.data="object"===_typeof(r.data)?JSON.stringify(r.data):r.data),bui.ajax(r)},e.put=function(n,i,a){var o={method:"PUT",contentType:"application/json"};o.url=n,o.data=i||{};var r=null,l=a&&a[0];return(r=a&&"array"===e.typeof(a)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.put,o,l):o).contentType.indexOf("application/json")>-1&&(r.data="object"===_typeof(r.data)?JSON.stringify(r.data):r.data),bui.ajax(r)},e.delete=function(n,i,a){var o={method:"DELETE",contentType:"application/json"};o.url=n,o.data=i||{};var r=null,l=a&&a[0];return(r=a&&"array"===e.typeof(a)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.delete,o,l):o).contentType.indexOf("application/json")>-1&&(r.data="object"===_typeof(r.data)?JSON.stringify(r.data):r.data),bui.ajax(r)},e.all=function(n){var i=null;return i=n&&"array"===e.typeof(n)?n:Array.prototype.slice.apply(arguments),t.when.apply(null,i)}}(window.bui||{},window.libs),function(e,t){e.load=function(n){var i,a={url:"",param:{},reload:!!e.hasRouter&&router.config.reload,replace:!1,native:!0,needNative:!1},o=t.extend(!0,{},a,e.config.load,n),r={},l=o.url;if(o.url)if(document.activeElement.blur(),l.indexOf("tel:")>=0||l.indexOf("mailto:")>=0||l.indexOf("sms:")>=0)e.unit.openExtral(l);else{if(l&&l.indexOf("?")>-1){var c=l.split("?");r=e.unit.keyStringToObject(c[1]),o.url=c[0]}try{var s="string"==typeof o.param&&JSON.parse(o.param)||o.param||{};o.param=t.extend(!0,{},r,s)}catch(t){return void e.showLog("param 参数值必须是一个{}对象","bui.load:web")}if(n&&n.needNative||e.nativeRouter)e.native.load&&e.native.load(o);else if(i=e.setUrlParams(o.url,o.param),"_blank"!==o.target)o.reload?window.location.href=e.hasRouter?"index.html#"+i:i:!o.replace||e.hasRouter?e.hasRouter?window.router.load(o):window.location.href=i:window.location.replace(i);else window.open("about:blank").location.href=e.hasRouter&&0!==i.indexOf("http")?"index.html#"+i:i}else e.showLog("url 不能为空!","bui.load:web")}}(window.bui||{},window.libs),function(e,t){e.getPageParams=function(n){var i=t.Deferred(),a={callback:null,native:!0,needNative:!1};n=n||{};var o=t.extend(!0,{},a,e.config.getPageParams);if("function"==typeof n?o.callback=n:n&&"object"===e.typeof(n)&&(o=t.extend(!0,{},a,e.config.getPageParams,n)),"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,n&&n.needNative||e.nativeRouter)return i=e.native.getPageParams&&e.native.getPageParams(o)||i;if(e.hasRouter){var r=window.router.getPageParams&&window.router.getPageParams()||e.getUrlParams();o.callback&&o.callback(r),i.resolve(r)}else{var l=e.getUrlParams();o.callback&&o.callback(l),i.resolve(l)}return i}}(window.bui||{},window.libs),function(e,t){e.back=function(n){var i,a={index:-1,name:"",delay:!0,param:null,native:!0,beforeBack:!0,callback:null};"function"==typeof n?(a.callback=n,i=t.extend(!0,{},a,e.config.back)):i=n&&"object"===e.typeof(n)?t.extend(!0,{},a,e.config.back,n):t.extend(!0,{},a,e.config.back),"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp;var o=e.hasRouter&&router.history&&router.history.getLast()||null;if(!1!==("function"==typeof i.beforeBack?i.beforeBack.call(this,{prevTarget:null,target:o}):i.beforeBack))if(n&&n.needNative||e.nativeRouter)e.native.back&&e.native.back(i);else{if(e.hasRouter)if(window.router.config.syncHistory){var r=e.history.get(),l=r.length-1;if(i.name){var c=e.array.indexs(r,i.name,"name"),s=c.length;i.index=s?-(r.length-c[s-1]-1):-1}if(Math.abs(i.index)>=r.length&&(i.index=-l),Math.abs(i.index)>=window.history.length&&window.router.config.hash&&(i.index=window.router.config.reloadCache?-l:-(window.history.length-1)),0==i.index&&(i.index=-1),window.router.config.hash&&!window.router.config.reloadCache)return void d();(r.length>1||window.history.length>1)&&d()}else window.router.back&&window.router.back(i);else d();var u=null}function d(){var t=e.hasRouter&&e.history.getPrev()||{},n=t.exports||{};if(window.history.go(i.index),e.hasRouter&&i.param){t.param=i.param;var a=window.location.origin+window.location.pathname+"#"+t.pid,o=e.setUrlParams(a,t.param);t.component={},t.page={},window.history.hasOwnProperty("replaceState")&&window.history.replaceState(t,null,o)}u&&clearTimeout(u),i.delay&&i.callback?u=setTimeout((function(){e.hasRouter?i.callback.call(router,n):i.callback.call(e,{})}),500):i.callback&&i.callback()}}}(window.bui||{},window.libs),function(e,t){e.refresh=e.history.refresh}(window.bui||{}),function(e,t){e.run=function(n){var i={};"string"==typeof n?i.id=n:n&&"object"===e.typeof(n)&&(i=t.extend(!0,{},{id:"",name:"",data:null,onFail:null,native:!0,needNative:!0},e.config.run,n));var a=String(i.id);if("object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,n.needNative)e.native.run&&e.native.run(i);else if(a.indexOf("http://")>-1||a.indexOf("https://")>-1){var o=e.setUrlParams(i.id,i.data);if(e.platform.isIos())return void(window.location.href=o);(window.open("","_blank")||window.open("","_newtab")).location.href=o}}}(window.bui||{},window.libs),function(e,t){e.fileselect=function(n){var i,a,o,r=t.extend(!0,{},{uid:"",native:!0,needNative:!1,needCompress:!1,appendTo:"",quality:.8,from:"camera",width:800,height:800,duration:10,multiple:!1,onSuccess:null,onChange:null,onFail:null,mediaType:"picture"},e.config.fileselect,n),l=this,c={add:function(n){s=null;var i=t.extend(!0,{needChangeData:!0,needCompress:!1,name:"resize.jpg"},r,n);if((u=i).mimeType=n.mimeType?n.mimeType:"",r.onChange=n.onChange||r.onChange,f){switch(n.from){case"picture":case"photo":case"savephoto":a.removeAttr("capture"),a.attr("accept","image/*");break;case"*":case"file":a.removeAttr("capture"),a.attr("accept","*");break;case"camera":a.attr("capture",n.from),a.attr("accept",p);break;default:a.removeAttr("capture"),a.attr("accept",p)}e.platform.isIos()&&"function"==typeof FastClick?a[0].dispatchEvent(new Event("click")):a.trigger("click")}else o.add(i);return this},remove:function(t,n){n=n||"name";if(!f)return d=o.remove(t,n);if("string"==typeof t){d.length&&e.array.remove(d,t,n);var i=d.length?d[d.length-1].data:null;return s=i,a[0].value="",d}return this},clear:function(){d=[],s=null,f?a[0].value="":o.clear();return d},value:function(){s=f?s:o.value();return s},data:function(){d=f?d:o.data();return d},toFile:x,toBase64:function(n){var i=t.extend(!0,{needCompress:!1,destinationType:"data",mimeType:"",needChangeData:!1},n);if(i.data=i.data||s,i.mimeType=n.mimeType?n.mimeType:i.data&&i.data.type||"image/jpeg",f)try{w(i)}catch(t){e.showLog(t)}else o.toBase64(i);return this},resize:w,toBlob:k,currentIndex:function(){var e="";e=f?d.length-1:o.data().length-1;return e},currentName:function(){var e="";e=f?d[d.length-1].name:o.value().name;return e},init:b},s=null,u=null,d=[],f="object"===_typeof(n)&&void 0!==n.needNative?!n.needNative:e.isWebapp,p="*",h=!1,m=null,g=null,v=null,y=null;function b(n){var b=t.extend(!0,r,n);switch(r.appendTo=b.appendTo||e.hasRouter&&router.currentPage()||"body",b.mediaType){case"allmedeia":p="*";break;case"picture":case"image":p="image/*";break;case"video":p="video/*";break;case"audio":p="audio/*";break;default:p=b.mediaType}return d=[],m=new Image,g=new FileReader,v=document.createElement("canvas"),y=v.getContext("2d"),f?(!function(){if(null==a){i=bui.guid();var e=r.from?'capture="'+r.from+'"':"",n=r.multiple?"multiple":"",o='<input type="file" accept="'+p+'" name="uploadFiles" id="'+i+'" '+e+" "+n+' style="display:none" />';t(r.appendTo).append(o),a=t("#"+i)||t('input[name="uploadFiles"]')}}(),h||(c.el=a[0],a.on("change",(function(t){var n=this.files;if(!(n.length<1)){if(n.length>1&&e.showLog("一次只能选一张图片","bui.fileselect:web"),!1===(r.onChange&&r.onChange.call(l,t)))return!1;var i=n[0];s=i;var a={name:i.name,data:i,type:i.type,size:i.size};d.push(a),u.needCompress?(u.data=i,u.mimeType=u.mimeType?u.mimeType:i.type,w(u)):u.onSuccess&&u.onSuccess.call(l,i,d),this.value=""}})),h=!0)):o=e.native.fileselect&&e.native.fileselect.call(this,n,{module:c})||{},b.uid&&e.history.setUI&&e.history.setUI({uid:b.uid,ui:c}),this}function w(n){var i=t.extend(!0,{destinationType:"file",data:null,mimeType:"",quality:.8,width:800,height:800,needCompress:!0,needChangeData:!1,onSuccess:null,onFail:null},r,n);i.data=i.data&&"array"===e.typeof(i.data)?i.data.pop():i.data,m.onload=function(){var t=this.width,n=this.height,a=null,o=i.width,r=i.height,c=t,u=n;i.needCompress&&(t>o||n>r)&&(t/n>o/r?(c=o,u=Math.round(o*(n/t))):(u=r,c=Math.round(r*(t/n)))),v.width=c,v.height=u,y.clearRect(0,0,c,u),y.drawImage(m,0,0,c,u);var f=v.toDataURL(i.mimeType||i.data&&i.data.type||"image/jpeg",i.quality),p=function(e){return e.indexOf(".png")>-1||e.indexOf(".jpg")>-1||e.indexOf(".gif")>-1||e.indexOf(".jpeg")>-1?e.substr(0,e.lastIndexOf(".")):e}(i.data.name)||"";switch(i.destinationType){case"file":a=x(f,p);break;case"blob":a=k(f);break;case"data":a=f}if(i.needChangeData){s=a;var h=e.array.index(d,i.data.name,"name");h>-1&&(d[h].data=a,a.size&&(d[h].size=a.size),a.type&&(d[h].type=a.type))}return i.onSuccess&&i.onSuccess.call(l,a,d),a},m.onerror=function(){i.onFail&&i.onFail.call(l,m.src)},g.onload=function(e){m.src=e.target.result};try{var a=i.data&&i.data.type||"";a="object"===_typeof(a)?a.type||"":a||"",i.data&&0==a.indexOf("image")&&g.readAsDataURL(n.data)}catch(t){e.showLog(t)}}function x(t,n){try{n=n||"file";for(var i=t.split(","),a=(i[0].match(/:(.*?);/)||[])[1]||"image/jpeg",o=a.split("/")[1],r=atob(i[1]),l=r.length,c=new Uint8Array(l);l--;)c[l]=r.charCodeAt(l);return new File([c],n+"."+o,{type:a})}catch(t){e.showLog(t)}}function k(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),a=i.length,o=new Uint8Array(a);a--;)o[a]=i.charCodeAt(a);return new Blob([o],{type:n})}return b(r),c}}(bui||{},libs),function(e,t){e.file=function(n){var i,a,o,r,l,c={getFolder:d,removeFolder:function(e){var n=t.extend(!0,{},e);s.needNative?l.removeFolder(n):d({root:n.root,folderName:n.folderName,create:n.create,onSuccess:function(e,t){e.removeRecursively((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}});return this},getFile:h,getFileName:p,removeFile:function(e){var n=t.extend(!0,{},e);s.needNative?l.removeFile(n):h({root:n.root,create:n.create,folderName:n.folderName,fileName:n.fileName,onSuccess:function(e,t){e.remove((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}});return this},toBase64:function(e){return r.toBase64(e),this},open:function(t){var n=t||{};if(!n.url)return;s.needNative?l.open(n):e.showLog("web暂不支持open方法","bui.file.open:web");return this},init:u},s=c.config=t.extend(!0,{},{uid:"",size:10,native:!0,needNative:!1},e.config.file,n);function u(n){return r=e.fileselect(n),a=function(n){var a=t.Deferred();n.needNative?l=e.native.file&&e.native.file(n,{fileselect:r,module:c})||{}:(i="bui.app",o=1024*parseInt(s.size)*1024,window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,navigator.webkitPersistentStorage&&navigator.webkitPersistentStorage.requestQuota(o,(function(e){window.requestFileSystem(window.PERSISTENT,e,(function(e){a.resolve(e)}),u)})));function u(e){var t="";try{switch(e.code){case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}}catch(e){}var n={msg:t};a.reject(n)}return a}(n),!n.needNative&&d({root:!0,create:!0}),n.uid&&e.history.setUI&&e.history.setUI({uid:n.uid,ui:c}),this}function d(e){var n={folderName:i,root:!1,create:!1,msg:"",param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},o=t.extend({},n,e),r="";if(o.create?(r="创建 ",o.param.create=!0):(r="获取 ",o.param.create=!1),s.needNative)l.getFolder(o);else{var u=f(o.folderName);u=o.root?u:i+"/"+u,a.done((function(e){e.root.getDirectory(u,o.param,(function(t){o.onSuccess&&o.onSuccess.call(c,t,e)}),(function(e){var t={msg:r+u+" 文件夹失败"};o.onFail&&o.onFail.call(c,t)}))})).fail((function(e){o.onFail&&o.onFail.call(c,{msg:"文件系统还没准备好."})}))}return this}function f(e){return"."==e[0]||"/"==e[0]||" "==e[0]?f(e.slice(1)):"."!=e[0]&&"/"!=e[0]&&" "!=e[0]?e:void 0}function p(e){return e&&e.indexOf("/")>-1?e.slice(e.lastIndexOf("/")+1,e.indexOf("?")>-1?e.indexOf("?"):void 0):e}function h(e){var n=t.extend({},{fileName:"",folderName:"",root:!1,create:!1,param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},e),a="";if(n.create?(a="创建 ",n.param.create=!0):(a="获取 ",n.param.create=!1),n.fileName&&!(n.fileName.indexOf(".")<0)){if(s.needNative)l.getFile(n);else{var o=p(n.fileName);d({root:n.root,folderName:n.folderName,create:!0,onSuccess:function(e,t){var r=e.name==i?e.name+"/"+o:i+"/"+e.name+"/"+o;t.root.getFile(r,n.param,(function(e){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(e){var t={msg:a+o+" 文件失败"};n.onFail&&n.onFail.call(c,t)}))},onFail:function(e){n.onFail&&n.onFail(e)}})}return this}n.onFail&&n.onFail()}return"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,u(s),c}}(window.bui||{},window.libs),function(e,t){e.upload=function(n){var i,a,o,r,l,c,s,u={uid:"",url:"",data:null,headers:{},showProgress:!0,timeout:6e4,contentType:!1,processData:!1,autoClose:!0,multiple:!1,native:!0,needNative:!1,method:"POST",fileKey:"file",dataType:"json",mediaType:"picture",from:"picture",onProgress:null,onMask:function(){b()},onSuccess:null,onFail:null},d=t.extend(!0,{},u,e.config.upload,n),f=t.Deferred(),p={init:g,add:function(e){return e.onSuccess=e.onSuccess?e.onSuccess.bind(p):null,e.onFail=e.onFail?e.onFail.bind(p):null,a.add(e),this},remove:function(e,t){var n=v(),i=n.length;if(i<1)return this;/\d/.test(e)&&e.indexOf(".")<0?a.remove(n[e].name,t):"string"==typeof e?a.remove(e,t):a.remove(n[i-1].name,t);return this},resize:function(e){return a.resize(e),this},currentIndex:function(){return a.currentIndex()},currentName:function(){return a.currentName()},clear:function(){return a.clear(),this},data:v,start:y,startAll:function(e){var n=t.extend(!0,{needFileinfo:!1},d,e),i=n[n.fileKey]||a.data();n.data||(n.data={});for(var o=[],r=0;r<i.length;r++)i[r],function(e){if(!(e>i.length-1)){if(n.data[n.fileKey]=i[e]&&i[e].data,n.needFileinfo)for(var t in i[e])"data"!==t&&(n.data[t]=i[e]&&i[e][t]);var a=n.onSuccess,r=n.onFail;n.onSuccess=function(t){a&&a.call(p,t),o[e]=t,e==i.length-1&&n.onEnd&&n.onEnd.call(p,o)},n.onFail=function(t){r&&r.call(p,t),o[e]=t,e==i.length-1&&n.onEnd&&n.onEnd.call(p,o)},y(n)}}(r);return f},stop:b,toBase64:function(e){return a.toBase64(e),this},widget:function(t){var n={loading:i,fileselect:a,ajax:o};return e.widget.call(n,t)}},h=d.showProgress,m=d.onProgress;function g(t){return i=e.loading({display:"block",width:30,height:30,opacity:0,autoClose:t.autoClose,callback:t.onMask}),a=e.fileselect.call(p,{native:t.native,needNative:t.needNative,from:t.from,multiple:t.multiple,mediaType:t.mediaType,onChange:t.onChange}),p.el=a.el,t&&t.needNative&&(r=e.native.upload&&e.native.upload(t,{loading:i,fileselect:a,module:p})||{}),t.data?(y(t),t.uid&&e.history.setUI&&e.history.setUI({uid:t.uid,ui:p}),this):this}function v(){return a.data()}function y(e){var n=t.extend(!0,{},d,e);if(c=n.url,l=a.value(),h=n.showProgress,l){if(h&&i.show(),n&&n.needNative)return r.start(n)||f;var s=n.data,u=s&&"object"===_typeof(s)?Object.keys(s):[],m=new FormData,g=!1;return u.forEach((function(e,t){n.fileKey===e&&(g=!0),m.append(e,s[e])})),!g&&m.append(n.fileKey,l),n.data=m,function(e){var n=e.onSuccess,i=e.onFail;return o=t.ajax({url:c,type:e.method,data:e.data,cache:e.cache,headers:e.headers,dataType:e.dataType,contentType:e.contentType,processData:e.processData,timeout:e.timeout,xhr:function(){var e=t.ajaxSettings.xhr();if(w&&e.upload)return e.upload.addEventListener("progress",w,!1),e},success:function(e){x(),n&&n.call(p,e),f.resolve(e)},error:function(e,t,n){x(),i&&i.call(p,e,t),f.reject(e,t,n)}}),f}(n)}}function b(e){return d&&d.needNative?r.stop(e):(i&&i.stop(),o&&o.abort(),e&&e.call(p,i,o)),this}function w(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);s=t.toString()+"%",t<100?(n=s,h&&i&&i.show({text:n})):x(),m&&m.call(p,s)}var n}))}function x(){return i&&i.stop(),this}return"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,g(d),p}}(window.bui||{},window.libs),function(e,t){e.download=function(n){var i,a,o,r,l,c={open:function(e){return a.open(e),this},getFile:function(e){var n=t.extend(!0,{autoDown:!0},s,e),i=e.fileName||a.getFileName(n.url);a.getFile({fileName:i,folderName:n.folderName,onSuccess:function(e,t){n.onSuccess&&n.onSuccess.call(c,e.fullPath||e,e,t)},onFail:function(e){n.autoDown=v(n)}})},removeFile:function(t){if(!t.fileName)return e.showLog("请告诉我们你要删除哪个文件, fileName "),this;return t.folderName=t.folderName||s.folderName,a.removeFile(t),this},removeFolder:function(e){return e.folderName=e.folderName||s.folderName,a.removeFolder(e),this},start:v,stop:y,toBase64:function(e){return a.toBase64(e),this},init:g,widget:function(t){var n={loading:h,file:a,ajax:i};return e.widget.call(n,t)}},s=c.config=t.extend(!0,{},{uid:"",url:"",data:{},headers:{},method:"GET",showProgress:!0,timeout:6e4,fileName:"",folderName:"download",native:!0,needNative:!0,onProgress:null,onSuccess:null,onFail:null},e.config.download,n),u="object"===_typeof(n)&&void 0!==n.needNative?!n.needNative:e.isWebapp,d=s.showProgress,f=s.onProgress,p=s.onFail,h=null,m=null;function g(t){return h=t.showProgress&&e.loading({display:"block",width:30,height:30,opacity:0,callback:function(){y()}}),a=e.file({native:t.native,needNative:t.needNative}),t.needNative?o=e.native.download&&e.native.download(t,{file:a,loading:h,module:c})||{}:function(e){if(a.getFolder({folderName:e.folderName,create:!1,onSuccess:function(e,t){e.fullPath},onFail:function(t){a.getFolder({folderName:e.folderName,create:!0,onSuccess:function(e,t){e.fullPath},onFail:function(e){p&&p.call(c,e)}})}}),!e.url)return;v(e)}(t),t.uid&&e.history.setUI&&e.history.setUI({uid:t.uid,ui:c}),this}function v(e){var n=t.extend(!0,{},s,e);r=n.needEncode?encodeURI(n.url):n.url,f=n.onProgress,(d=n.showProgress)&&h&&h.show({text:"0%"}),e.fileName||a.getFileName(n.url),n.needNative?o.start(n):(n.cache=!1,n.contentType=!1,n.processData=!1,i=t.ajax({url:r,type:n.method,data:n.data,cache:n.cache,headers:n.headers,contentType:n.contentType,processData:n.processData,timeout:n.timeout,xhr:function(){var e=t.ajaxSettings.xhr();if(b&&e)return e.addEventListener("progress",b,!1),e},success:function(t){var i=e.fileName||a.getFileName(n.url);a.getFile({fileName:i,folderName:n.folderName,create:!0,onSuccess:function(e,t){n.onSuccess&&n.onSuccess.call(c,e.fullPath,t)}})},fail:function(e){w(),n.onFail&&n.onFail.call(c,e)}}))}function y(e){u?(w(),i&&i.abort(),m&&window.cancelAnimationFrame(m)):o.stop(),e&&e.call(c,h,i)}function b(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,m=window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);l=t.toString()+"%",t<100?(n=l,d&&h&&h.show({text:n})):w(),f&&f.call(c,l)}var n}))}function w(){d&&h&&h.stop()}return g(s),c}}(window.bui||{},window.libs),function(e,t){e.currentPlatform="webapp",e.on("pagereadybefore",(function(){e.platform.isPC()?window.viewport=e.viewport(40):window.viewport=e.viewport(),e.config.init.auto&&e.init(),!e.hasRouter&&e.config.component.auto&&loader.components({id:"body"})})),e.webready=function(n){t(document).ready((function(){e.trigger.call(e,"pagereadybefore");var t=loader&&loader.map().globals;n&&n.call(e,t),e.trigger.call(e,"pageready")}))},e.ready=function(n){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp;var i=t.Deferred();if(e.isWebapp)t(document).ready((function(){e.trigger.call(e,"pagereadybefore");var t=loader&&loader.map().globals;n&&n.call(e,t),e.trigger.call(e,"pageready"),i.resolve()}));else{if(void 0===e.native.ready)return e.showLog("当前 bui.isWebapp = false; 但bui.js为webapp版本,不支持原生方法,请使用 buijs update -p xxx, 更换bui.js为对应xxx平台版本;"),e.webready(n),i;i=e.native.ready&&e.native.ready(n)||i}return i}}(window.bui||{},window.libs),function(e,t){e.btn=function(n){var i,a,o,r,l={},c={load:function(n){n=n;var s=0;i.off("click.bui",r).on("click.bui",r,(function(i){var r=t(this),u=l.beforeCallback||l.beforeLoad;if(!1===(u&&u.call(c,i)))return i.preventDefault(),i.stopPropagation(),!1;var d=n||r.attr("href"),f=r.attr("target"),p="true"==r.attr("iframe"),h="true"==r.attr("firstAnimate"),m=r.attr("disabled"),g=r.hasClass("disabled")||""==m||"true"==m||"disabled"==m;if(d&&!g&&!(d&&d.indexOf("javascript:")>-1)){var v=r.attr("param")||"",y=v&&v.indexOf("{")>-1&&v.indexOf("}")>-1?JSON.parse(r.attr("param")):{};(r.attr("progress")?"false"!=r.attr("progress"):a)&&e.loading({autoTrigger:!0,display:"block",opacity:0,timeout:l.timeout});var b=+new Date;if(b-s<350)return!1;s=b;var w={url:d,param:y,replace:o,firstAnimate:h,iframe:p};return"_blank"==f?e.run({id:d,data:y}):e.load(w),i.preventDefault(),i.stopPropagation(),!1}}))},submit:function(n,a){a=a||{};var o=null;l.id&&l.handle?i.off("click.bui",r).on("click.bui",r,c):i.click(c);function c(i){if(!1===(l.beforeCallback&&l.beforeCallback.call(this,i)))return i.preventDefault(),i.stopPropagation(),!1;var r=this,c=t(r).css("background-color");if(!t(this).hasClass("disabled")&&"true"!=t(this).attr("disabled")){var s="none"==c?"#fff":c;if(a.appendTo=r,a.background=a.background||s,a.display=a.display||"inline",a.width=a.width||15,a.height=a.height||15,a.text=a.text||"加载中",a.autoClose=1==a.autoClose,a.autoTrigger=0!=a.autoTrigger,o){if(o.isLoading())return;o.show()}else o=e.loading(a);return n&&n.call(r,o,i)}}},click:function(e){var n=0;l.id&&l.handle?i.off("click.bui",r).on("click.bui",r,a):i.click(a);function a(i){if(!1===(l.beforeCallback&&l.beforeCallback.call(this,i)))return i.preventDefault(),i.stopPropagation(),!1;if(!t(this).hasClass("disabled")&&"true"!=t(this).attr("disabled")){var a=+new Date;return!(a-n<350)&&(n=a,e&&e.call(this,i))}}},off:function(){return i.off("click.bui",r),this}};return function(n){n&&"object"===e.typeof(n)?(l.id=n.id||"",l.handle=n.handle||"",l.progress="progress"in n&&n.progress,l.replace="replace"in n&&n.replace,l.timeout=n.timeout||3e3,l.beforeCallback=n.beforeCallback||null,i=t(l.id)):"string"==typeof n&&(l.id=n||"",l.handle="",l.progress=!1,l.replace=!1,l.timeout=3e3,l.beforeCallback=null,i=e.obj(l.id));r=l.handle,a=l.progress,o=l.replace}(n),c}}(window.bui||{},window.libs),function(e,t){e.mask=function(n){var i={id:"",uid:"",appendTo:"",className:"",opacity:.3,background:"",zIndex:100,autoTrigger:!1,autoClose:!1,onBeforeInit:null,onInited:null,callback:null},a={name:"mask",handle:{},on:function(t,n){return e.on.apply(a,arguments),this},off:b,hide:y,show:function(t){if(h)return;(d=e.objId(l))&&d.length?(d.css("display","block"),!p&&u.css("position","relative"),s=!0):g(o);return w.call(a,"show"),this},isShow:function(){return s},remove:v,destroy:function(e){v(),u&&u.off("click.mask");b("show"),b("hide"),h=!0},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(a,t,n)},config:o,init:m},o=a.config=t.extend(!0,{},i,e.config.mask,n),r=e.guid(),l=o.id?o.id.indexOf("#")>-1?o.id.substring(1):o.id:r;t("body");var c,s,u=e.objId(o.appendTo),d=null,f=!1,p=!1,h=!1;function m(n){h=!1;var r=t.extend(!0,i,o,n);return r.onBeforeInit&&r.onBeforeInit.call(a,r),r.appendTo=r.appendTo||"body",u=e.objId(r.appendTo),p=u[0]&&"COMPONENT"===u[0].tagName,o=a.config=r,c=u.css("position"),r.autoTrigger&&g(r),d=e.objId(r.id),r.uid&&e.history.setUI&&e.history.setUI({uid:r.uid,ui:a}),r.onInited&&r.onInited.call(a,r),this}function g(n){if(!h){var r=t.extend(!0,{},i,o,n),c=function(t){var n=t.background?t.background:"rgba(0,0,0,"+t.opacity+")",i="";return i+'<div id="'+l+'" class="'+e.prefix("mask")+" "+t.className+'" style="background:'+n+";z-index:"+t.zIndex+'"></div>'}(r);return(d=e.objId(l))&&d.length?d.css("display","block"):(u.append(c),!p&&u.css("position","relative"),d=e.objId(l)),s=!0,w.call(a,"show"),f||function(e){d.off("click.bui").on("click.bui",(function(t){e.callback&&e.callback.call(a,t),e.autoClose&&y(),t.stopPropagation()})),f=!0}(r),this}}function v(){if(!h)return d&&d.remove(),d=null,u.css("position",c||"static"),s=!1,f=!1,w.call(a,"hide"),this}function y(){if(!h)return d&&d.css("display","none"),!p&&u.css("position","relative"),s=!1,w.call(a,"hide"),this}function b(t,n){return e.off.apply(a,arguments),this}function w(t){a.self=this==window||this==a?null:this,e.trigger.apply(a,arguments)}return m(o),a}}(window.bui||{},window.libs),function(e,t){e.loading=function(n){var i={name:"loading",handle:{},on:function(t,n){return e.on.apply(i,arguments),this},off:k,start:y,stop:w,isLoading:function(){return f},pause:function(){if(d)return;return s&&s.addClass("bui-loading-pause"),O.call(this,"pause"),this},text:b,showRing:function(){if(d)return;return s=e.objId(l),s.children(".bui-loading-cell").css("display","inline-block"),s.removeClass("bui-loading-pause"),this},hideRing:function(){if(d)return;return s=e.objId(l),s.children(".bui-loading-cell").css("display","none"),s.addClass("bui-loading-pause"),this},show:function(n){var i=n||{};if(d)return;var o=t.extend(!0,a,i);(s=e.objId(o.id))&&s.length?(b(o.text),s[0].style.display="-webkit-box",g&&g.show(),o.callback&&r.off("click.bui","#"+l).on("click.bui","#"+l,o.callback),O.call(this,"show")):y(o);a.timeout&&(p&&clearTimeout(p),p=setTimeout((function(e){x()}),a.timeout));return f=!0,this},hide:x,destroy:function(e){e=1==e;w(),r&&r.off("click.bui");k("show"),k("hide"),k("start"),k("stop"),k("pause"),k("remove"),g&&g.destroy(e),d=!0},widget:function(t){var n={mask:g||{}};return e.widget.call(n,t)},option:function(t,n){return e.option.call(i,t,n)},config:a,init:v},a=i.config=t.extend(!0,{},{uid:"",appendTo:"",width:30,height:30,text:"",onlyText:!1,mask:!0,zIndex:"",autoTrigger:!1,autoClose:!0,timeout:0,opacity:0,display:"block",template:null,onBeforeInit:null,onInited:null,callback:null},e.config.loading,n);t("body");var o,r=null,l=e.guid(),c=l+"-mask",s=e.objId(l),u=!1,d=!1,f=!1,p=null;a.id=l;var h=a.callback;a.callback=function(e){a.autoClose&&w(),h&&h.call(i,e)};var m=t.extend(!0,{},a,{id:c}),g=a.mask?e.mask(m):null;function v(o){d=!1;var c=t.extend(!0,{},a,o);return c.onBeforeInit&&c.onBeforeInit.call(i,n),c.appendTo=c.appendTo||"body",r=t(c.appendTo),a=i.config=c,c.autoTrigger&&s.length<1&&y(c),s=e.objId(l),c.uid&&e.history.setUI&&e.history.setUI({uid:c.uid,ui:i}),c.onInited&&c.onInited.call(i,c),this}function y(n){if(!d){var o=t.extend(!0,{},a,n);if(s=e.objId(l),s.children(".bui-loading-cell"),s.hasClass("bui-loading-pause"))s.removeClass("bui-loading-pause"),O.call(this,"start");else{s.length&&s.remove();var c=function(t){var n=(t=t||{}).text,a=r.width()||document.documentElement.clientWidth,o=n&&"block"==t.display?parseInt(t.height)+30:parseInt(t.height),c=-a/2,s=-o/2,u="block"==t.display?e.prefix("loading-block"):e.prefix("loading-inline"),d="";return d+='<div id="'+l+'" class="'+e.prefix("loading")+" "+u+'" style="width:'+a+"px;height:"+o+"px;line-height:"+o+"px;margin-left:"+c+"px;margin-top:"+s+"px;"+(t.zIndex?"z-index:"+t.zIndex:"")+'" >',t.onlyText||(d+='<div class="'+e.prefix("loading-cell")+'" style="width:'+parseFloat(t.width)+"px;height:"+parseFloat(t.height)+'px;"></div>'),d+='<div class="'+e.prefix("loading-text")+'">'+t.text+"</div>",d+="</div>",t&&t.template?t.template.call(i,t):d}(o);r.append(c),g&&g.show(),O.call(this,"show")}return o.timeout&&(p&&clearTimeout(p),p=setTimeout((function(){w()}),o.timeout)),u||function(e){var t=e||a;r.off("click.bui","#"+l).on("click.bui","#"+l,(function(e){t.callback&&t.callback.call(i,e),e.stopPropagation()})),u=!0}(o),f=!0,this}}function b(t){if(!d)return s=e.objId(l),o=s.children(".bui-loading-text"),void 0===t?o&&o.text():(o&&o.html(t),this)}function w(){if(!d)return(s=e.objId(l))&&s.remove(),s=null,g&&g.remove(),u=!1,f=!1,O.call(this,"remove"),O.call(this,"hide"),this}function x(){if(!d)return s=e.objId(l),(a.appendTo||s&&s.length)&&(s.css("display","none"),g&&g.hide()),f=!1,O.call(this,"hide"),this}function k(t,n){return e.off.apply(i,arguments),this}function O(t){i.self=this==window||this==i?null:this,e.trigger.apply(i,arguments)}return v(a),i}}(window.bui||{},window.libs),function(e,t){e.dialog=function(n){var i,a,o,r,l={id:"",dialogid:"",title:"",effect:"zoomIn",content:"",className:"",appendTo:"",position:"center",style:null,fullscreen:!1,useBox:!1,width:0,height:0,mask:!0,opacity:.3,render:!1,needRemove:"",autoClose:!0,close:!0,scroll:!0,closeText:"",zoom:!1,zIndex:101,buttons:[],onBeforeClose:null,onBeforeOpen:null,onBeforeInit:null,autoinit:!0,onInited:null,onMask:null,onClose:null,callback:null},c={name:"dialog",selector:T,$el:T,$:T,handle:{},on:function(t,n){return e.on.apply(c,arguments),this},off:N,open:function(n){if(g||k||h)return this;var o={width:s.width,height:s.height,zoom:s.zoom,fullscreen:s.fullscreen,position:s.position,scroll:s.scroll,onBeforeOpen:s.onBeforeOpen,useBox:s.useBox,effect:"",callback:null},l=o;"function"==typeof n?l.callback=n:"string"==typeof n?l.effect=n:n&&"object"===e.typeof(n)&&(l=t.extend(!0,{},o,n));var u=l.onBeforeOpen&&l.onBeforeOpen.call(c,{toggle:a});if(S.call(c,"beforeopen",{toggle:a}),!1===u)return this;var p=s.useBox?"-webkit-box":"block";if(i&&i.css("display",p),0==(i.attr("status")||0)){d=String(l.width).indexOf("%")>-1?w*parseFloat(l.width)/100:l.width||i.width(),f=String(l.height).indexOf("%")>-1?x*parseFloat(l.height)/100:l.height||i.height();var m=e.unit.pxToRemZoom(d),y=e.unit.pxToRemZoom(f),b=l.zoom?m+"rem":d+"px",O=l.zoom?y+"rem":f+"px",I=l.zoom?"-"+y/2+"rem":"-"+f/2+"px",L=l.zoom?"-"+m/2+"rem":"-"+d/2+"px";l.fullscreen&&"custom"!=l.position||i.css({width:b,height:O}),"center"!=l.position||l.fullscreen||i.css({top:"50%","margin-top":I,left:"50%","margin-left":L,right:"auto"}),l.fullscreen&&i.addClass("bui-dialog-fullscreen");var P=i.children(".bui-dialog-head"),T=i.children(".bui-dialog-foot"),j=i.children(".bui-dialog-main");if(!l.useBox){var N=P.length?P[0].clientHeight:0,E=T.length?T[0].clientHeight:0,R=i.height()-N-E;j.css({height:R})}l.scroll||j.css({overflow:"hidden"}),i.attr("status","1")}r&&r.show(),a.show((function(e){g=!0,l.callback&&l.callback.call(c,{toggle:a}),S.call(c,"openafter",{toggle:a}),S.call(c,"afteropen",{toggle:a})}),l.effect),v||C();return S.call(c,"open",{toggle:a}),this},close:L,isOpen:g,disableOpen:function(){return h=!0,this},enableOpen:function(){return h=!1,this},disableClose:function(){return m=!0,this},enableClose:function(){return m=!1,this},top:function(t){return t=t||s.zIndex+e.$(".bui-dialog").length,e.$(".bui-dialog").css("z-index",s.zIndex),e.$(".bui-mask").css("z-index",s.zIndex-1),i.css("z-index",t),r&&e.$("#"+r.config.id).css("z-index",t-1),c.config.zIndex=t,s.zIndex=t,this},template:I,toggle:function(e,t){c.isOpen()?c.close(t):c.open(e);return this},create:function(e){var n=e||{};l.title=s.title||"提示",l.content=s.content||"",l.close=!1,l.render=!0,l.autoClose=s.autoClose,l.mask=s.mask,l.buttons=s.buttons&&s.buttons.length?s.buttons:["确定"],l.callback=s.callback||null;var i=t.extend(!0,l,n);return S.call(c,"create"),O(i)},remove:P,destroy:function(){var e=1==e;i&&(i.off("click.bui"),i.remove(),i=null,h=!1);N("open"),N("close"),r&&r.destroy(e),a&&a.destroy(e),k=!0},widget:function(t){var n={toggle:a,mask:r};return e.widget.call(n,t)},option:function(t,n){"object"===_typeof(t)&&(t.width||t.height)?j(t):"width"==t?j({width:n}):"height"==t&&j({height:n});return e.option.call(c,t,n)},config:s,init:O},s=c.config=t.extend(!1,{},l,e.config.dialog,n),u="",d="",f="",p="fadeInDown",h=!1,m=!1,g=!1,v=!1,y=""!==s.needRemove?s.needRemove:!!s.render,b={},w=window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth,x=window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight,k=!1;function O(n){var l=t.extend(!0,s,n);switch(l.onBeforeInit&&l.onBeforeInit.call(c,l),l.appendTo=l.appendTo||e.hasRouter&&router.currentPage()||"body",k=!1,o=l.effect,y=""!==l.needRemove?l.needRemove:!!l.render,w=window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth,x=window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight,l.position){case"top":u="bui-dialog-top",o=l.effect||"fadeInDown";break;case"bottom":u="bui-dialog-bottom",o=l.effect||"fadeInUp";break;case"left":u="bui-dialog-left",o=l.effect||"fadeInLeft";break;case"right":u="bui-dialog-right",o=l.effect||"fadeInRight";break;case"center":u="bui-dialog-center",o=l.effect||p;break;case"custom":u="bui-dialog-custom",o=l.effect||p}l.fullscreen&&(u="bui-dialog-fullscreen",o=l.effect||p),l.render?(l.id=l.dialogid||e.guid(),l.content=e.unit.handleContent(l.content),l.content=l.content.replace(/#module\.id/g,"#"+l.id),function(n){var i=I(n),a=e.$("#"+n.id);a.length&&a.remove();t(n.appendTo).append(i)}(l),i=e.objId(l.id)):((i=e.obj(l.id)).addClass(u).css("z-index",l.zIndex),l.useBox&&i.addClass("bui-box-vertical")),l.style&&i.css(l.style),d=i.width()>w?w:i.width(),f=i.height()>x?x:i.height(),i.css("display","none"),a||(a=e.toggle({id:l.id,effect:o,useBox:l.useBox})),s=c.config=l;try{var h="object"===_typeof(l.id)?t(l.id).attr("id")+"-mask":i[0].id+"-mask";n.mask&&!r&&(r=e.mask({id:h,opacity:n.opacity,appendTo:i.parent(),autoTrigger:!1,onlyOne:!0,autoClose:!1,zIndex:parseInt(n.zIndex,10)-1,callback:function(e){if(!1===(n.onMask&&n.onMask.call(c,e)))return!1;s.autoClose&&(y?L(P):L())}}))}catch(t){e.showLog(t)}return v&&!s.render||C(),l.uid&&e.history.setUI&&e.history.setUI({uid:l.uid,ui:c}),l.onInited&&l.onInited.call(c,l),c}function I(t){var n="",i=t.useBox?"bui-box-vertical ":"";return n+='<div id="'+t.id+'" class="bui-dialog '+i+u+" "+t.className+'" style="display:block;z-index:'+t.zIndex+'">',t.title&&(n+='\t<div class="bui-dialog-head">'+t.title+"</div>"),n+='\t<div class="bui-dialog-main">',t.content&&(n+=t.content),n+="\t</div>",t.buttons&&t.buttons.length&&(n+='\t<div class="bui-dialog-foot"><div class="bui-box">',t.buttons.forEach((function(e,t){n+='\t\t<div class="bui-btn span1 '+(e.className||"")+'" value="'+(e.value||"")+'">'+(e.name||e)+"</div>"})),n+="\t</div></div>"),t.close&&(n+='   <div class="bui-dialog-close">'+(t.closeText?t.closeText:'<i class="'+e.config.icon.close+'"></i>')+"</div>"),n+="</div>"}function g(e){return g}function L(t){if(g&&!k&&!m){var n={};"function"==typeof t?n.callback=t:"string"==typeof t?(n.effect=t,n.callback=s.onClose):t&&"object"===e.typeof(t)&&(n=t),n.onBeforeClose=s.onBeforeClose;var i=n.onBeforeClose&&n.onBeforeClose.call(c,{toggle:a});if(S.call(c,"beforeclose",{toggle:a}),!1===i)return this;try{a.hide((function(e){g=!1,n.callback&&n.callback.call(c,{toggle:a})}),n.effect),r&&r.hide(),S.call(this,"close",{toggle:a})}catch(t){e.showLog(t,"bui.dialog.close")}return this}}function S(t,n){var i=b[t];if("array"===e.typeof(i))for(var a=0,o=i.length;a<o;a++)i[a](n)}function P(){try{i.remove(),r&&r.remove(),S.call(this,"remove")}catch(t){e.showLog(t,"bui.dialog.remove")}return this}function C(){return i.off("click.bui",".bui-dialog-close").on("click.bui",".bui-dialog-close",(function(e){y?L(P):L(),s.onClose&&s.onClose.call(c,e,c),e.stopPropagation()})),i.on("click.bui",".bui-dialog-foot .bui-btn",(function(e){if(e.target=this,!1===(s.callback&&s.callback.call(c,e,c)))return!1;s.autoClose&&(y?L(P):L()),e.stopPropagation()})),v=!0,this}function T(t){return e.selector.call(i,t)}function j(e){e.width&&i.css({width:e.width}),e.height&&i.css({height:e.height});var t=parseFloat(e.height)-$dialogHead.height()-$dialogFoot.height();$dialogMain.css({height:t}),"center"==s.position&&(e.height&&i.css({"margin-top":-e.height/2}),e.width&&i.css({"margin-left":-e.width/2}))}function N(t,n){return e.off.apply(c,arguments),this}function S(t){c.self=this==window||this==c?null:this,e.trigger.apply(c,arguments)}return s.id&&s.autoinit&&O(s),c}}(bui||{},libs),function(e,t){e.alert=function(n,i,a){var o=e.dialog(),r={className:"bui-alert",title:"",width:580,height:360,scroll:!0,zIndex:121,position:"center",autoClose:!0,zoom:!0,buttons:[{name:"确定",className:"primary-reverse"}]};r.callback=i||function(){};var l=t.extend(r,e.config.alert,a),c="";try{c="string"==typeof n&&n.indexOf("<")>-1&&n.indexOf(">")>-1?"<xmp>"+n+"</xmp>":!n||"object"!==e.typeof(n)&&"array"!==e.typeof(n)?n&&"function"===e.typeof(n)?n.toString():n:JSON.stringify(n),l.content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+c+"</div>"}catch(t){e.showLog(t,"bui.alert")}return o.create(l).open(),o}}(window.bui||{},window.libs),function(e,t){e.confirm=function(n,i,a){var o=e.dialog(),r={className:"bui-confirm",title:"",width:580,height:360,scroll:!0,zIndex:121,autoClose:!0,zoom:!0,position:"center",buttons:[{name:"取消",className:""},{name:"确定",className:"primary-reverse"}]};r.callback=i||function(){};var l={};return"object"===_typeof(n)?(n.content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+n.content+"</div>",l=t.extend(r,e.config.confirm,n)):((l=t.extend(r,e.config.confirm,a)).content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+n+"</div>",l.callback=i||function(){}),o.create(l).open(),o}}(window.bui||{},window.libs),t((function(e){!function(t,n){t.prompt=function(i,a,o){var r=t.dialog(),l={className:"bui-prompt",title:"",width:580,height:400,scroll:!0,autoClose:!1,needRemove:!1,zoom:!0,zIndex:121,position:"center",buttons:[{name:"取消",className:""},{name:"确定",className:"primary-reverse"}]};l.callback=a||function(){},l.placeholder="",l.row=1,l.type="text",l.value="",l.onChange=null;var c={},s="",u="";switch("object"===_typeof(i)?s=(c=n.extend(l,t.config.prompt,i)).content||"":((c=n.extend(l,t.config.prompt,o)).callback=a||function(){},s=i||""),c.type){case"number":c.content='<div class="bui-prompt-main bui-box-vertical"> <div class="bui-prompt-label">'+s+'</div> <div class="span1"> <input class="bui-prompt-text" placeholder="'+c.placeholder+'" type="'+c.type+'" value="'+c.value+'"/> </div> </div>';break;default:c.content='<div class="bui-prompt-main bui-box-vertical"> <div class="bui-prompt-label">'+s+'</div> <div class="span1"> <textarea class="bui-prompt-text" placeholder="'+c.placeholder+'" rows="'+c.row+'" >'+c.value+"</textarea> </div> </div>"}return r.create(c).open(),n("#"+r.config.id).on("change",".bui-prompt-text",(function(t){u=this.value,c.onChange&&c.onChange.call(e,t)})),r.value=function(e){return void 0===e?u:(n("#"+r.config.id).find(".bui-prompt-text").val(e),u=e)},r.focus=function(e){n("#"+r.config.id).find(".bui-prompt-text").focus()},r}}(window.bui||{},window.libs)})),function(e,t){e.hint=function(n,i){if("number"==typeof n||"string"==typeof n){var a=n||"";(n={}).content=a,n.onClose=i||null}else"object"===_typeof(n)&&(n=n);var o,r,l={name:"hint",handle:{},on:function(t,n){return e.on.apply(l,arguments),this},off:y,remove:g,hide:function(e,t){var n=this;"function"==typeof e?(e=e,t=t||c.effect||""):(t=e||c.effect||"",e=null);u&&u.hide((function(){p=!1,e&&e.call(l,{toggle:u}),c.onHided&&c.onHided.call(l,{toggle:u}),b.call(n,"hide",{toggle:u})}),t);return this},show:v,text:function(e){return d.find(".bui-hint-inner").length&&d.find(".bui-hint-inner").html(e),this},isShow:function(){return p},destroy:function(e){e=1==e;d.off("click.bui"),u&&u.destroy(e),y("show"),y("hide")},widget:function(t){var n={toggle:u};return e.widget.call(n,t)},option:function(t,n){return e.option.call(l,t,n)},config:c,init:m},c=l.config=t.extend(!0,{},{appendTo:"",content:"",uid:"",timeout:2e3,autoClose:!0,showClose:!1,autoTrigger:!0,useBox:!0,opacity:1,background:"",effect:"fadeInUp",skin:"",position:"bottom",width:0,height:0,onBeforeInit:null,onInited:null,onClose:null,onHided:null},e.config.hint,n),s=0,u=null,d=null,f="",p=!1,h=!1;function m(n){var i=t.extend(!0,c,n);return i.onBeforeInit&&i.onBeforeInit.call(l,i),o=e.guid(),f="top"===i.position?"fadeInDown":"bottom"===i.position?"fadeInUp":i.effect,c=l.config=i,function(n,i,a,o){var r,l="12"+a,s=o?e.obj(o):t("body");switch(c.position){case"top":r="bui-hint-top";break;case"bottom":r="bui-hint-bottom";break;case"center":r="bui-hint-center"}var u=c.height;c.width=String(c.width).indexOf("%")>-1?750*parseFloat(c.width)/100:parseFloat(c.width),c.height=parseFloat(c.height)||0;var d=c.background?"background:"+c.background:"",f=c.width>0?"width:"+c.width/100+"rem;margin-left:-"+c.width/100/2+"rem;":"",p=c.height>0?"height:"+c.height/100+"rem;":"",h="auto"==u?"height:auto;":p,m="center"===c.position&&c.width>0?"margin-top:-"+c.height/100/2+"rem;":"",g=d+";display:none;z-index:"+l+";opacity:"+c.opacity+";"+f+h+m,v='<div id="'+n+'" class="bui-hint '+r+" "+c.skin+'" style="'+g+'"><span class="bui-hint-inner">'+i+"</span>"+(c.showClose?'<div class="bui-hint-close"><i class="'+e.config.icon.close+'"></i></div>':"")+"</div>";document.querySelector("#"+n)||s.append(v);o&&s.css("position","relative")}(o,i.content,s,i.appendTo),++s,d=e.objId(o),u||(u=e.toggle({id:d,effect:f,useBox:i.useBox})),i.autoTrigger&&(p=!0,v()),h||function(e){e.showClose&&d.off("click.bui",".bui-hint-close").on("click.bui",".bui-hint-close",(function(t){e.autoTrigger?(p=!1,u&&u.hide(g)):(p=!1,u&&u.hide(e.onHided)),e.onClose&&e.onClose.call(l,t)})),h=!0}(i),i.uid&&e.history.setUI&&e.history.setUI({uid:i.uid,ui:l}),i.onInited&&i.onInited.call(l,i),this}function g(e){return u&&(p=!1,u.remove(),e&&e.call(l),b.call(this,"remove",{toggle:u}),u=null),this}function v(e,t){var n=this;return"function"==typeof e?(e=e,t=t||c.effect||""):(t=e||c.effect||"",e=null),d.css("display","-webkit-box"),u&&(p=!0,u.show((function(t){b.call(n,"show",{toggle:u}),e&&e.call(l,{toggle:u})}),t)),c.autoClose&&(r&&clearTimeout(r),r=setTimeout((function(){c.autoTrigger?u&&u.hide((function(){p=!1,g()})):u&&u.hide((function(){p=!1})),c.onClose&&c.onClose.call(l)}),c.timeout)),this}function y(t,n){return e.off.apply(l,arguments),this}function b(t){l.self=this==window||this==l?null:this,e.trigger.apply(l,arguments)}return m(c),l}}(window.bui||{},window.libs),function(e,t){e.slide=function(n){var i,a,o,r,l,c,s,u,d,f,p,h,m,g,v,y,b,w,x,k,O,I,L,S,P,C={name:"slide",handle:{},on:Oe,off:Ie,trigger:Le,to:ie,load:function(e){var n={id:"",icon:"",title:"",url:"",name:"",index:N,menuTemplate:null,template:null,param:{},animate:!0,preload:!1,needRemove:!1,command:"after",width:0,height:0,loaded:null,beforeLoad:null},i=t.extend(!0,{},n,e);if(!1===(i.beforeLoad&&i.beforeLoad.call(C)))return this;return i.beforeLoad=null,i.menuTemplate=i.menuTemplate||(i.title?'<li class="bui-btn">'.concat(i.title,"</li>"):""),ve(i),this},back:function(e){var n={id:"",url:"",name:"",index:N,loaded:null,beforeLoad:null},i=t.extend(!0,{},n,e);return i.name=i.url||i.name,i.loaded=function(){i.beforeLoad=null,i.loaded=null,ye(i)},se(i),this},add:ve,remove:ye,replace:function(e){var n={id:"",name:"",index:N,param:{},animate:!1,preload:!1,command:"html",width:0,height:0,loaded:null,beforeLoad:null};return ve(t.extend(!0,{},n,e))},resize:ke,getPageParams:be,getItemParam:be,setItemParam:function(e,n){return A[e=typeof e==="number"?e:N]&&(A[e]=t.extend(A[e],n)),A[e].param},getPages:X,getData:function(){return T.data},getItem:function(t){if("string"==typeof t)return e.array.get(T.data,t,"id");var n="number"==typeof t?t:ce();return T.data[n]},$active:we,currentMain:we,currentMenu:function(e){var t=void 0===e?N:e;return o.eq(t)[0]},prev:se,next:ue,stop:oe,start:function(e){ae(e)},lock:pe,index:ce,unlock:me,destroy:function(e){e=1==e;oe(),a&&(a.off("click.bui"),e&&a.remove());i&&(i.off(),e&&i.remove());Ie("stop"),Ie("play"),Ie("first"),Ie("last"),Ie("to")},widget:function(t){var n={loading:_};return e.widget.call(n,t)},option:function(t,n){return e.option.call(C,t,n)},config:T,init:K},T=C.config=t.extend(!0,{},{id:"",uid:"",menu:".bui-slide-head > ul",children:".bui-slide-main > ul",main:".bui-slide-main",header:"header",footer:"footer",item:"li",prev:".bui-slide-prev",next:".bui-slide-next",alignClassName:"",alignPage:"center",stopHandle:"",stopPropagation:!0,width:0,height:0,data:null,zoom:!0,transition:200,interval:5e3,relative:!1,swipe:!0,animate:!0,delay:!1,bufferEffect:!0,visibleNum:1,scrollNum:1,distance:40,direction:"x",autoplay:!1,sideWidth:0,loop:!1,cross:!1,autoheight:!1,autoinit:!0,scroll:!1,index:0,fullscreen:!1,autopage:!1,autoload:!1,needLoading:!1,async:!0,video:{preload:!0,autoplay:!0,fullscreen:!1,muted:!1,loop:!0,controls:!0,width:"100%",height:"100%",poster:""},template:null,callback:null,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeTo:null,onBeforeInit:null,onInited:null,onStart:null,onMove:null,onEnd:null},e.config.slide,n),j={},N=0,E=!1,R={},_=null,$=[],A=T.data,D=!1,F={x:{},y:{}};/hp-tablet/gi.test(navigator.appVersion);var z,B,U="",V=0,M=0,H=!1,q=!1;j={x1:0,x2:0,y1:0,y2:0,direction:""};try{T.autoinit&&K(T)}catch(t){e.showLog(t)}function K(n){var s=t.extend(!1,T,n);if(!1===(s.onBeforeInit&&s.onBeforeInit.call(C,s)))return this;if(s.id){if(i=e.obj(s.id),C.$el=i,s.relative){var u=i.parent().width();s.width=s.sideWidth>0?u-s.sideWidth:u}if(T=C.config=s,U=s.direction,"function"==typeof s.template)i.html(s.template.call(C,s.data||[])||"");else if(s.data&&!s.template){if(i.find(s.main).length<=0){var d=function(e){return'<div class="'.concat(e.main.substr(1),'">\n              <ul class="bui-slide-main-ul">\n              </ul>\n            </div>')}(s);i.html(d)}var f=i.find(s.children),p=xe.call(C,s.data);f.html(p)}if(s.needLoading&&(_=bui.loading({appendTo:i})),a=0==s.menu.indexOf("#")?e.obj(s.menu):i.find(s.menu).eq(0),o=a.children(),r=i.find(s.children).eq(0),l=r.parent(),c=r.children(),S=c.length,s.loop&&c.length){var h=c.eq(c.length-1).clone(!0),m=c.eq(0).clone(!0);r.prepend(h).append(m);var g=(c=r.children()).length-1;Ie("afterto"),Oe("afterto",(function(e){0==e&&ie(g-1,"none"),e==g&&ie(1,"none")})),ie(1,"none"),!i.hasClass(".bui-slide-loop")&&i.addClass("bui-slide-loop")}if(s.cross&&c.length){var v=function(e){var t=c.eq(e);t.removeClass("bui-cross-prev").removeClass("bui-cross-next"),t.prev().removeClass("bui-cross-next").addClass("bui-cross-prev"),t.next().removeClass("bui-cross-prev").addClass("bui-cross-next")};!i.hasClass(".bui-slide-cross")&&i.addClass("bui-slide-cross"),Ie("to",v),Oe("to",v),s.loop?ie(1,"none"):ie(0,"none")}return W(s),J(s),(L=s.autoplay)&&ae(),E||(!function(){me(),T.swipe||pe();var n=function(e){var n=t(this).hasClass("active"),i=t(this).index(),a=t(this).attr("disabled"),o=t(this).hasClass("disabled")||""==a||"true"==a||"disabled"==a;if(e.currentIndex=i,e.prevIndex=N,!1===(T.onBeforeTo&&T.onBeforeTo.call(C,e)))return!1;Le.call(C,"beforeto",e),n||o||(T.animate?ie(i):ie(i,"none"),L&&ae()),T.stopPropagation&&e.stopPropagation()};0==T.menu.indexOf("#")?a.off("click.bui","li").on("click.bui","li",n):i.off("click.bui",T.menu+" li").on("click.bui",T.menu+" li",n);i.off("click.bui",T.prev).on("click.bui",T.prev,se),i.off("click.bui",T.next).on("click.bui",T.next,ue);var o=T.children+" "+T.item;T.data&&i.off("click.bui",o).on("click.bui",o,(function(n){if(q)return!1;var i=t(n.currentTarget),a=i.attr("href"),o=i.attr("data-target")||"",r="true"==i.attr("data-reload"),l="true"==i.attr("data-iframe"),c="true"==i.attr("data-page"),s="true"==i.attr("data-close"),u="true"==i.attr("data-synchistory");a&&c?e.page({url:a,iframe:l,close:s,syncHistory:u}):a&&e.load({url:a,reload:r,target:o,iframe:l}),Le.call(C,"click",n);var d=T.data[ce()]||{};d.callback&&d.callback.call(C,n),T.callback&&T.callback.call(C,n,C),T.stopPropagation&&n.stopPropagation()})),E=!0}(),D=!0),N=r.children(".active").length?r.children(".active").index():N||s.index,parseInt(s.index)>0?ie(s.index,"none"):ie(N,"none"),s.uid&&e.history.setUI&&e.history.setUI({uid:s.uid,ui:C}),s.onInited&&s.onInited.call(C,s),this}e.showLog("slide id不能为空","bui.slide.init")}function W(e){k=document.documentElement.clientWidth,O=document.documentElement.clientHeight,e.height=String(e.height).indexOf("%")>-1?parseFloat(e.height)/100*O:parseFloat(e.height),e.width=String(e.width).indexOf("%")>-1?parseFloat(e.width)/100*k:parseFloat(e.width),c=r.children();var t=i.parents(".bui-page");i.parents("main");var n=i[0]&&i[0].offsetTop||0,o=t.children(e.header);o[0]&&o[0].offsetHeight;var l=t.children(e.footer),u=l[0]&&l[0].offsetHeight||0;b=O-(u||0)-n,b=i.parent("main").length?i.parent("main").height():b,w=0==e.height?b:e.height;var g="static"==a.parent().css("position")?a.css("position"):a.parent().css("position");x=i.find(e.menu).length?"absolute"==g||"fixed"==g?w:w-(a[0]&&a[0].offsetHeight||0):w,h=e.fullscreen?O:0==e.height?x:e.height,p=e.fullscreen?k:e.width||k,s=c.length,m="x"==U?p/T.visibleNum:p,y="y"==U?h/T.visibleNum:h,I="y"==T.direction?y*T.scrollNum:m*T.scrollNum,d=p*s/T.visibleNum,f=h*s/T.visibleNum}function J(t){c=r.children(),S=t.loop?c.length-2:c.length,F={x:{swipeDir:"swipeleft",swipeDir2:"swiperight",width:I},y:{swipeDir:"swipeup",swipeDir2:"swipedown",width:I}},l[(P={x:{parentInitKey:"width",parentInitValue:d,boxCss:"display:-webkit-box;display:box;-webkit-box-align: start;-webkit-box-pack: center;width:100%;",boxItemCSS:"-webkit-box-flex:1;box-flex:1;width:"+m+"px;height:"+y+"px;"},y:{parentInitKey:"height",parentInitValue:f,box:"display:-webkit-box;display:box;-webkit-box-align: start;-webkit-box-pack: center;width:100%;-webkit-box-orient: vertical;box-orient: vertical;",boxItemCSS:"-webkit-box-flex:1;box-flex:1;width:"+m+"px;height:"+y+"px;"}})[U].parentInitKey](P[U].parentInitValue);var n,a=c.length;for(n=0;n<a;n++){var s=c[n].getAttribute("data-scroll"),u=null==s?T.scroll:"false"!=s;P[U].boxItemCSS=P[U].boxItemCSS+(u?"overflow:auto;":"overflow:hidden;"),c[n].style.cssText=P[U].boxItemCSS}try{r[0]&&(r[0].style.cssText=P[U].boxCss)}catch(e){console.log("请检查下children参数是否正确.","bui.slide id:"+T.id)}var h="y"==U&&T.visibleNum>1?x/T.visibleNum:x,g=T.zoom?w/100+"rem":w+"px",v=T.zoom?h/100+"rem":h+"px";if(T.zoom,T.fullscreen?(e.$("main").css({position:"static"}),i.addClass("bui-slide-fullscreen").css({position:"absolute",top:0,left:0,right:0,bottom:0,"z-index":10,overflow:"hidden",width:p,height:O}),c.addClass(T.alignClassName||"bui-box-center").css("height",O)):(i.css({position:"relative",overflow:"hidden",width:p,height:g}),c.addClass(T.alignClassName).height(v)),T.autoheight&&i.addClass("bui-slide-autoheight"),T.autopage){var b=function(e,t){var n,i="",a=(t=t||1,e);for(i+='<div class="bui-slide-head bui-align-'.concat(T.alignPage,'">'),i+="<ul >",n=1;n<Number(a)+1;n++)i+="<li "+(n==t?'class="active"':"")+">"+n+"</li>";return i+="</ul >",i+="</div >"}(X(),r.find(".active").index()+1);i.children(".bui-slide-head").remove(),i.append(b),o=i.find(T.menu).eq(0).children()}}function X(){var e=S,t=parseInt(e/T.visibleNum),n=parseInt(e/T.scrollNum),i=1==T.visibleNum?t:t+1,a=1==T.scrollNum?n:n+1,o=1==T.scrollNum||T.scrollNum==e?i:a;return o=T.loop?o+2:o}function Y(t){H=!0;var n=t.touches?t.touches[0]:t;if(j.x1=n.clientX,j.y1=n.clientY,j.direction="",!1===(T.onBeforeTouchstart&&T.onBeforeTouchstart.call(C,t,j)))return!1;T.stopHandle&&e.unit.checkTargetInclude(t.target,T.stopHandle)?H=!1:(z=-N*I,B=-N*I,t.touches&&t.touches.length>1||t.scale&&1!==t.scale?ee("x"==U?z:B):(L&&(oe(),L=!0),Le.call(C,"touchstart",t,j),T.onStart&&T.onStart.call(C,t,j,C),H=!0,e.platform.isPC()&&t.stopPropagation(),e.platform.isPC()&&"IMG"===t.target.tagName&&t.preventDefault()))}function Z(n){if(H){var i=n.touches?n.touches[0]:n;if(n.touches&&n.touches.length>1||n.scale&&1!==n.scale)ee("x"==U?z:B);else{if(q=!0,j.x2=i.clientX,j.y2=i.clientY,j.direction||(j.direction=e.swipeDirection(j.x1,j.x2,j.y1,j.y2)),!1===(T.onBeforeTouchmove&&T.onBeforeTouchmove.call(C,n,j)))return!1;"swipeleft"!==j.direction&&"swiperight"!==j.direction||(n.preventDefault(),n.stopPropagation()),Le.call(C,"touchmove",n,j);try{if(!e.platform.isPC()&&"y"==U&&T.scroll){var a=t(n.target).closest(".active"),o=a[0].scrollTop||0,r=a[0].scrollHeight||0,l=a[0].offsetHeight||0;if("swipedown"===j.direction&&o>1)return void(q=!1);if("swipeup"===j.direction&&r-o-l>=2)return void(q=!1)}}catch(n){}g=j.x2-j.x1,v=j.y2-j.y1,F.x.move=z+g,F.x.absDelta=Math.abs(g),F.y.move=B+v,F.y.absDelta=Math.abs(v);var c=X();j.direction!==F[U].swipeDir&&j.direction!==F[U].swipeDir2||(T.delay&&F[U].absDelta>T.distance&&ee(F[U].move,"none"),T.delay||((T.bufferEffect||0==N&&c>1&&("swipeleft"==j.direction||"swipeup"==j.direction)||N==c-1&&c>1&&("swiperight"==j.direction||"swipedown"==j.direction)||N>0&&N<c-1&&c>1)&&ee(F[U].move,"none"),n.preventDefault()),T.onMove&&T.onMove.call(C,n,j,C))}}}function G(t){switch(H=!1,Le.call(C,"touchend",t,j),j.direction){case"swiperight":case"swipedown":t.currentIndex=N-1;break;case"swipeleft":case"swipeup":t.currentIndex=N+1}if(t.prevIndex=N,!1===(T.onBeforeTouchend&&T.onBeforeTouchend.call(C,t,j)))return!1;if(q){if(g=j.x2-j.x1,v=j.y2-j.y1,Math.abs(g)<5&&(q=!1),F.x.delta=z,F.x.absDelta=Math.abs(g),F.y.delta=B,F.y.absDelta=Math.abs(v),"x"!=T.direction||"swipeleft"!=j.direction&&"swiperight"!=j.direction){if("y"==T.direction&&("swipeup"==j.direction||"swipedown"==j.direction))n=T.onBeforeTo&&T.onBeforeTo.call(C,t)}else var n=T.onBeforeTo&&T.onBeforeTo.call(C,t);if(!1===n)return ee(F[U].delta),"swipeleft"!=j.direction&&"swiperight"!=j.direction||t.stopPropagation(),V+=j.y2-j.y1,M+=j.x2-j.x1,j.lastX=M,j.lastY=V,j={x1:0,x2:0,y1:0,y2:0,direction:""},H=!1,!e.platform.isPC()&&(q=!1),ne(),!1;re(),F[U].absDelta>T.distance?(Q.call(this,t,j,F),T.onEnd&&T.onEnd.call(C,t,j,C)):F[U].absDelta<T.distance&&ee(F[U].delta),le(),L&&ae(),"swipeleft"!=j.direction&&"swiperight"!=j.direction||t.stopPropagation(),V+=j.y2-j.y1,M+=j.x2-j.x1,j.lastX=M,j.lastY=V,j={x1:0,x2:0,y1:0,y2:0,direction:""},H=!1,!e.platform.isPC()&&(q=!1),ne()}}function Q(e,t,i){var a;if(de(),N=r.children(".active").index(),t.direction==i[U].swipeDir){var o=c.length,l=o-T.visibleNum,s=o%T.scrollNum!=0?l+1:l/T.scrollNum+1;if(N>=s-1)a=N,i[U].delta=-a*i[U].width,ee(i[U].delta),N=a,fe(a),Le.call(C,"last",a);else if(a=N+1,i[U].delta=-a*i[U].width,ee(i[U].delta),N=a,fe(a),n.autoload)ge(N);else{if(c.eq(N),n.loop&&N>S)return;Le.call(C,"to",a)}Le.call(C,"next",a)}else if(t.direction==i[U].swipeDir2)if(N>0){if(a=N-1,i[U].delta=-a*i[U].width,ee(i[U].delta),N=a,fe(a),n.autoload)ge(N);else{if(c.eq(N),n.loop&&0==N)return;Le.call(C,"to",a)}Le.call(C,"prev",a)}else a=N,i[U].delta=-a*i[U].width,ee(i[U].delta),N=a,fe(a),Le.call(C,"first",a)}function ee(e,t){var n=T.transition;t=t||"all "+n+"ms",e=e||0;switch(U){case"x":te(e+"px",0,t,l);break;case"y":te(0,e+"px",t,l)}return this}function te(e,t,n,a){var o=t||0;"y"==U&&T.zoom&&String(t).indexOf("%")<=-1&&(o=parseInt(t)/100+"rem");a=a||i;var r=e=e||0,l=String(e).indexOf("%")>-1?String(e):r,c=String(t).indexOf("%")>-1?String(t):o;n="number"==typeof n?"all "+n+"ms":n||"all 300ms";try{a.css({"-webkit-transition":n,transition:n,"-webkit-transform":"translate("+l+","+c+")",transform:"translate("+l+","+c+")"})}catch(e){console.log(e.message)}}function ne(e){l.one("webkitTransitionEnd",(function(){l.css({"-webkit-transition":"none",transition:"none"}),q=!1,e&&e.call(C,N),Le.call(C,"afterto",N)}))}function ie(e,i,a){var r,l={index:0,name:"",param:null,transition:"",callback:"function"==typeof i?i:null,needTrigger:0!=a},s=l;if("object"===_typeof(e)){s=t.extend(!0,l,e);e=s.name||s.index||0,r=i||s.transition,a=s.needTrigger,"function"==typeof i||s.callback}else e=void 0!==e?e:s.name,r="string"==typeof i?i:s.transition,a=0!=a,"object"===_typeof(i)?s.param=i:s.transition=i||s.transition,s.name=e,s.needTrigger=a,s.callback="function"==typeof i?i:l.callback;de();var u=0;a=0!=a;if("string"==typeof e&&e.indexOf(".html")>-1){var d=[];o.each((function(n,i){var a=t(i).attr("href")||void 0;d[n]=a,a==e&&(u=n)}))}else u=parseInt(e);var f={x:{transform:-u*parseFloat(I)},y:{transform:-u*parseFloat(I)}},p=X();if(re(),u>=p||u<0)return!1;if(ee(f[U].transform,r),N=u,fe(u),le(),L&&ae(),n.autoload)ge(N);else{if(c.eq(N),!a)return;Le.call(C,"to",u,s.param)}return ne(s.callback),this}function ae(e){e=e||T.interval;oe(),L=!0;var t=N;u=setInterval((function(){var e=X();t>=0&&t<e-1?t+=1:t=0,ie(t)}),e),Le.call(C,"play")}function oe(e){if(u)try{window.clearInterval(u),L=!1,Le.call(C,"stop")}catch(e){}return this}function re(){e.$(".bui-slide-video video").each((function(e,t){this.pause()}))}function le(){var t=ce(),n=T.loop?t+1:t,i=e.$(".bui-slide-video video").eq(n);(!T.data||!T.data[t]||0!=T.data[t].autoplay)&&i.length&&i[0].play()}function ce(){return T.loop?N-1:N}function se(e){var n=t.extend(!0,{beforeLoad:null,loaded:null},e);if(!1===(n.beforeLoad&&n.beforeLoad.call(C)))return this;var i=N-1;return T.loop&&i<1&&(i=parseInt(S/T.scrollNum)),n.loaded?ie(i,n.loaded):ie(i),Le.call(C,"prev",i),this}function ue(e){var n=t.extend(!0,{beforeLoad:null,loaded:null},e);if(!1===(n.beforeLoad&&n.beforeLoad.call(C)))return this;var i=N+1;return T.loop&&i>parseInt(S/T.scrollNum)+1&&(i=1),n.loaded?ie(i,n.loaded):ie(i),Le.call(C,"next",i),this}function de(t){a=0==(t=T).menu.indexOf("#")?e.obj(t.menu):i.find(t.menu).eq(0),o=a.children(),r=i.find(t.children).eq(0),l=r.parent(),c=r.children()}function fe(e){e=e||0,c.removeClass("active"),c.eq(e).addClass("active"),o.removeClass("active"),o.eq(e).addClass("active")}function pe(){var e=he();return i.off(e.touchstart,T.children,Y).off(e.touchmove,T.children,Z).off(e.touchend,T.children,G).off(e.touchcancel),Le.call(C,"lock"),this}function he(){var t={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};return e.platform.isPC()&&(t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseleave"}),t}function me(e){var t=he();return i.on(t.touchstart,T.children,Y).on(t.touchmove,T.children,Z).on(t.touchend,T.children,G).on(t.touchcancel,(function(){H=!1,q=!1,ie(T.loop?ce()+1:ce())})),Le.call(C,"unlock"),this}function ge(t){var n=c.eq(t),i=o.eq(t).attr("href")||"";if(e.array.compare($,t))return Le.call(C,"to",t,"200"),!1;if(T.autoload)if(i)if((i=e.unit.resolvePath(i))in R){var a=R[i],r=e.history.getLast().id;a=a.replace(/#module\.id/g,"#"+r),n.html(a),$.push(t),!D&&Le.call(C,"load",t,status),!D&&Le.call(C,"to",t,status),D=!1}else R[i]="",_&&_.show(),loader&&loader.import(i,(function(a){a=e.unit.handleContent(a),R[i]=a;var o=e.history.getLast().id;a=a.replace(/#module\.id/g,"#"+o),n.html(a),$.push(t),Le.call(C,"load",t,status),!D&&Le.call(C,"to",t,status),D=!1,_&&_.hide()}),(function(e,n){Le.call(C,"loadfail",t,n),_&&_.hide()}));else!D&&Le.call(C,"to",t),D=!1}function ve(n){var i=t.extend(!0,{},{id:"",icon:"",title:"",name:"",menuTemplate:null,template:null,index:-1,param:{},animate:!0,preload:!1,needRemove:!1,command:"after",width:0,height:0,loaded:null,beforeLoad:null},n);c=r.children();var a=i.url||i.name||"",l=i.index>-1?i.index:"before"==i.command?0:c.length-1,s=a&&a.indexOf(".html")||0,u=s>-1?a.substr(0,s):a;i.name=u,i.index=l;var d=function(n){var i={id:"",name:"",index:0,menuTemplate:null,template:null,command:"after",width:0,height:0},a=t.extend(!0,i,n),r=c.eq(a.index),l=o.eq(a.index),s=a.id&&(a.id.indexOf("#")>-1||a.id.indexOf(".")>-1)?a.id.substr(1):a.id||e.guid(),u='<component id="'.concat(s,'" class="delay-item" name="').concat(a.name,'" delay="true"></component>'),d='<li style="-webkit-box-flex:1;box-flex:1;width:'.concat(a.width||m,"px;height:").concat(a.height||y,'px;">\n            ').concat(a.name?u:a.template?a.template.call(C):"","\n            </li>"),f=a.command,p="function"==typeof a.menuTemplate?a.menuTemplate.call(C):a.menuTemplate||"";"html"===f?(r.after(d),r.remove(),p&&l.after(p),p&&l.remove()):(r[f](d),p&&l[f](p));return{id:s}}(i);ke();var f=0;switch(i.command){case"html":case"append":case"prepend":f=l;break;case"before":f=l-1<0?0:l-1;break;default:f=l+1}if(Le.call(C,"add",{index:f,prevIndex:N}),a){if(i.id=d.id||"",loader.delay(i),i.preload)return this;i.animate?ie(f):ie(f,"none")}return this}function ye(e){var n=t.extend(!0,{index:-1,beforeLoad:null,loaded:null},e);if(!1===(n.beforeLoad&&n.beforeLoad.call(C)))return this;var i=parseInt(n.index),a=i-1;if(i<0)return this;var r=c.eq(i),l=o.eq(i);return r.remove(),l.remove(),ke(),N===i?a>-1&&ie(a,"none"):ie(N>i?N-1:N,"none"),n.loaded&&n.loaded.call(this,n),Le.call(C,"remove",{index:N,prevIndex:i}),this}function be(e){return A[e="number"==typeof e?e:N].param||{}}function we(e){var t=void 0===e?N:e;return c.eq(t)[0]}function xe(e){var n="";return(e=e||[]).length&&e.forEach((function(e,i){var a=e.title?'<div class="bui-slide-title">'.concat(e.title,"</div>"):"",o=e.background||"background"==e.type?'<div class="bui-slide-img" style="background-image:url('.concat(e.background||e.image||e.src,')"></div>'):'<div class="bui-slide-img"><img src="'.concat(e.image||e.src,'" alt="').concat(e.title||"",'"/></div>'),r="";if("video"==e.type||e.video){var l=t.extend(!0,{},T.video,e,e.video);r='<div class="bui-slide-video">\n                        <video class="bui-video" src="'.concat(l.src,'" width="').concat(l.width,'" height="').concat(l.height,'" poster="').concat(l.poster,'" ').concat(l.preload?"preload":""," ").concat(l.muted?"muted":""," ").concat(l.controls?"controls":""," ").concat(l.loop?"loop":""," ").concat(l.fullscreen?"fullscreen":"","></video>\n                        </div>")}n+='<li data-id="'.concat(e.id||"",'" href="').concat(e.url||"",'" data-reload="').concat(e.reload||!1,'" data-iframe="').concat(e.iframe||!1,'" data-page="').concat(e.page||!1,'" data-close="').concat(e.page||!0,'" data-synchistory="').concat(e.synchistory||!1,'" data-target="').concat(e.target,'" >\n                  ').concat(r||o,"\n                  ").concat(a,"\n                  </li>")})),n}function ke(e){var i=t.extend(!0,{},n,e);return W(i),J(i),ie(N,"none"),this}function Oe(t,n){return e.on.apply(C,arguments),this}function Ie(t,n){return e.off.apply(C,arguments),this}function Le(t){C.self=this==window||this==C?null:this,e.trigger.apply(C,arguments)}return C}}(window.bui||{},window.libs),t((function(e){!function(t,n){t.tab=function(i){var a=e.config=n.extend(!0,{},{id:"",uid:"",menu:".bui-tab-head > ul",children:".bui-tab-main > ul",header:"header",footer:"footer",main:".bui-tab-main",item:"li",prev:".bui-tab-prev",next:".bui-tab-next",data:null,showNav:!0,navscroll:!1,loadall:!1,position:"top",iconBadge:!0,iconPosition:"left",loaded:null,compiled:null,sideWidth:0,align:"center",alignClassName:"",stopHandle:"",width:0,height:0,relative:!1,zoom:!1,swipe:!0,animate:!0,bufferEffect:!1,visibleNum:1,scrollNum:1,distance:40,direction:"x",autoplay:!1,autoheight:!1,scroll:!0,index:0,fullscreen:!1,autopage:!1,autoload:!1,autoinit:!0,template:null,templateMenuItem:null,async:!0,callback:null,onBeforeInit:null,onInited:null,onStart:null,onMove:null,onEnd:null},t.config.slide,i),o=null,r=null,l=t.guid();(o=function(e){r=n.extend(!0,e.data),e.data&&(e.menu=e.menu.indexOf("#")>-1?e.menu:".".concat(l,"-menu"),e.children=".".concat(l,"-main"),i=r,o=(a.template||p)(i),t.$(a.id).html(o),e.data=null);var i,o;var c=t.$(".bui-tab-sidenav");if(r&&"left"==e.position){e.sideWidth&&c.width(e.sideWidth);var s=e.sideWidth||c.width();e.width=e.width||n(window).width()-s,t.$(e.id).addClass("bui-tab-left"),t.$(e.id).css({"margin-left":s}),c.css("left",-s)}else if(r&&"right"==e.position){e.sideWidth&&c.width(e.sideWidth);s=e.sideWidth||c.width();e.width=e.width||n(window).width()-s,t.$(e.id).addClass("bui-tab-right"),c.css({left:"100%"})}var u=t.slide(e);"left"!=e.position&&"right"!=e.position||t.$(e.id).css({overflow:"visible"});r&&u.on("to",(function(e,t){var i=this.index(),o=r&&r[i]||{},l=a.loadall?".delay-item":"#".concat(o.id);o.name&&loader.delay({id:l,param:n.extend({},o.param,t),everytime:o.everytime,loaded:a.loaded,compiled:a.compiled})})).to(e.index);return e.uid&&t.history.setUI&&t.history.setUI({uid:e.uid,ui:u}),u}(a)).name="tab",o.templateNav=d,o.renderNav=function(e,n){var i=templatesNav(n||r);t.$(e).html(i)},o.addBadge=function(e,n){if(e&&!/[0-9]/.test(e))return this;var i=t.$(a.id).find(a.menu).children().eq(e),o=void 0!==n?n:"",r=i.find(".bui-badges"),l=i.find("i");r.size()?r.text(n):l.size()&&a.iconBadge?l.append('<span class="bui-badges">'.concat(o,"</span>")):i.append('<span class="bui-badges">'.concat(o,"</span>"));return this},o.removeBadge=function(e){var n=t.$(a.id).find(a.menu).children();void 0!==e?n.eq(e).find(".bui-badges").remove():n.find(".bui-badges").remove();return this};var c=o.add,s=o.remove,u=!1;function d(e){var t="left"==a.position||"right"==a.position?" bui-tab-sidenav":"",n=a.navscroll?'<div class="bui-navbar">':"",i="".concat(n,'<ul class="bui-nav ').concat(l,"-menu ").concat(t,'">'),o=a.templateMenuItem?a.templateMenuItem:f;return e&&e.forEach((function(e,t){i+=o(e,t)})),i+="</ul>\n                ".concat(a.navscroll?"</div>":"")}function f(e,t){var n="",i=function(e,t){return e.icon?e.icon.indexOf("&#")>-1?'<i class="icon">'.concat(e.icon,"</i>"):'<i class="'.concat(e.icon,'"></i>'):""}(e)||function(e,t){return e.image?'<i class="icon"><img src="'.concat(e.image,'" /></i>'):""}(e),o=e.needRemove?'<i class="icon-close"></i>':"",r=e.className?"".concat(e.className):"";switch(a.iconPosition){case"left":n+='<li class="bui-btn bui-align-'.concat(a.align," ").concat(r,'"><span class="bui-text-wrap">').concat(i).concat(e.title||"").concat(o,"</span></li>");break;case"right":n+='<li class="bui-btn bui-align-'.concat(a.align," bui-box ").concat(r,'"><div class="span1">').concat(e.title||"","</div>").concat(i).concat(o,"</li>");break;case"bottom":n+='<li class="bui-btn bui-align-'.concat(a.align," ").concat(i?"bui-box-vertical":"bui-box"," ").concat(r,'"><div class="span1">').concat(e.title||"","</div>").concat(i).concat(o,"</li>");break;default:n+='<li class="bui-btn bui-align-'.concat(a.align," ").concat(i?"bui-box-vertical":"bui-box"," ").concat(r,'">').concat(i,'<div class="span1">').concat(e.title||"").concat(o,"</div></li>")}return n}function p(e){var t="",n=a.showNav?function(e){var t="bottom"==a.position?"bui-tab-foot":"",n='<div class="bui-tab-head '.concat(t,'">');return n+=d(e),n+"</div>"}(e):"",i=function(e){var t="left"==a.position||"right"==a.position?'<div class="span1">':"",n="".concat(t,'<div class="bui-tab-main"><ul class="').concat(l,'-main">');return e&&e.forEach((function(e,t){n+=e.content?'<li class="bui-tab-main-item">'.concat(e.content,"</li>"):'<li class="bui-tab-main-item">\n                            <component id="'.concat(e.id,'" class="bui-tab-item-component delay-item" name="').concat(e.name&&0===e.name.indexOf("/")?e.name.substr(1):e.name,'" delay="true"></component>\n                        </li>')})),n+="</ul></div>",n+="left"==a.position||"right"==a.position?"</div>":""}(e);switch(a.position){case"top":t=n+i;break;case"bottom":t=i+n;break;default:t=n+i}return t}return o.add=function(e){var i=n.extend(!0,{title:"",needRemove:!1,templateMenuItem:null},e);if(i.menuTemplate=e.templateMenuItem||a.templateMenuItem&&a.templateMenuItem(i,r.length)||i.title&&f(i,r.length)||"",r.push(i),i.needRemove&&!u){var l=t.obj(this.config.id),s=this.config;(s.menu.indexOf("#")>-1?t.obj(s.menu):l.find(s.menu).eq(0)).off("click.bui",".icon-close").on("click.bui",".icon-close",(function(e){var t=n(this).parents(".bui-btn").index();o.remove({index:t})})),u=!0}return c(i)},o.remove=function(e){var i=n.extend(!0,{index:-1,keyname:"id",target:"",callback:null},e),a=i.index,o=i.keyname,l=i.target.indexOf("#")>-1?i.target.substr(1):i.target||"";return"array"===t.typeof(r)&&l&&(a=t.array.index(r,l,o))>-1&&t.array.deleteIndex(r,a),i.index=a,s(i)},o.getData=function(e){return r},o.getItem=function(e){if("string"==typeof e)return t.array.get(r,e,"id");var n="number"==typeof e?e:index();return r[n]},o.setItem=function(e,i){if("string"==typeof e&&r){var a=t.array.get(r,e,"id");return a=n.extend(a,i)}e="number"==typeof e?e:nowIndex;return r[e]&&(r[e]=n.extend(r[e],i)),r[e]},o.getItemParam=function(e){if("string"==typeof e)return t.array.get(r,e,"id").param;e="number"==typeof e?e:nowIndex;return r[e].param||{}},o.setItemParam=function(e,i){if("string"==typeof e&&r){var a=t.array.get(r,e,"id");return a.param=n.extend(a.param,i),a.param}e="number"==typeof e?e:nowIndex;var o=r[e];return o&&(o=n.extend(o,i)),o.param},o}}(window.bui||{},window.libs)})),function(e,t){e.init=function(n){var i,a={id:".bui-page",height:0,header:"header",main:"main",footer:"footer",reduceRem:0};if("object"==e.typeof(n))i=t.extend({},a,e.config.init,n);else{var o={};o.height=n,i=t.extend({},a,o)}var r=i.height||document.documentElement.clientHeight||t("body").height()||t("#bui-router").height()||t(".bui-page").height();if(!(e.obj(i.main).length<1)){try{var l=e.obj(i.id),c=i.header.indexOf("#")>-1?e.obj(i.header)[0]:l.children(i.header)[0],s=i.footer.indexOf("#")>-1?e.obj(i.footer)[0]:l.children(i.footer)[0],u=i.main.indexOf("#")>-1?e.obj(i.main):l.children(i.main),d=c?c.offsetHeight:0,f=s?s.offsetHeight:0,p=i.reduceRem>0?e.unit.remToPx(i.reduceRem):0,h=r-d-f-p;if(parseInt(h)>0)u.height(h);else{var m=d+f+p+"px";e.unit.calcHeight(u,m)}}catch(t){e.showLog(t,"bui.init")}return h}},window.addEventListener?window.addEventListener("load",(function(t){e.trigger.call(e,"onload")}),!1):window.attachEvent("onload",(function(t){e.trigger.call(e,"onload")})),t(document).ready((function(){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp,e.trigger.call(e,"pagebefore"),"function"==typeof FastClick&&FastClick.attach(document.body),e.trigger.call(e,"pageinit")}));try{var n="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"",i=n.replace(/hidden/i,"visibilitychange");document.addEventListener(i,(function(t){document[n]?e.trigger.call(e,"pagehide",t):e.trigger.call(e,"pageshow",t)}))}catch(e){}try{navigator.control.gesture(!1),navigator.control.longpressMenu(!1)}catch(e){}}(window.bui||{},window.libs)}));
