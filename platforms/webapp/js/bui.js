function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",r=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,a){var o=t&&t.prototype instanceof f?t:f,r=Object.create(o.prototype),l=new O(a||[]);return i(r,"_invoke",{value:x(e,n,l)}),r}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var d={};function f(){}function p(){}function h(){}var g={};c(g,o,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(C([])));v&&v!==t&&n.call(v,o)&&(g=v);var b=h.prototype=f.prototype=Object.create(g);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(i,o,r,l){var c=u(e[i],e,o);if("throw"!==c.type){var s=c.arg,d=s.value;return d&&"object"==_typeof(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,r,l)}),(function(e){a("throw",e,r,l)})):t.resolve(d).then((function(e){s.value=e,r(s)}),(function(e){return a("throw",e,r,l)}))}l(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){a(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function x(e,t,n){var i="suspendedStart";return function(a,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw o;return S()}for(n.method=a,n.arg=o;;){var r=n.delegate;if(r){var l=k(r,n);if(l){if(l===d)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var c=u(e,t,n);if("normal"===c.type){if(i=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i="completed",n.method="throw",n.arg=c.arg)}}}function k(e,t){var n=t.method,i=e.iterator[n];if(void 0===i)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=u(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,d;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=h,i(b,"constructor",{value:h,configurable:!0}),i(h,"constructor",{value:p,configurable:!0}),p.displayName=c(h,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,c(e,l,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(w.prototype),c(w.prototype,r,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,i,a,o){void 0===o&&(o=Promise);var r=new w(s(t,n,i,a),o);return e.isGeneratorFunction(n)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},y(b),c(b,l,"Generator"),c(b,o,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=C,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return r.type="throw",r.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],r=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=e,r.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var a=i.arg;T(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function asyncGeneratorStep(e,t,n,i,a,o,r){try{var l=e[o](r),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(i,a)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function r(e){asyncGeneratorStep(o,i,a,r,l,"next",e)}function l(e){asyncGeneratorStep(o,i,a,r,l,"throw",e)}r(void 0)}))}}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)
/* @preserve 
 * @name: BUI v1.8.2  
 * @detail: BUI 是一个移动UI开发框架，专注Webapp快速开发，完美嵌入各平台或打包，媲美APP体验。 
 * @site: http://www.easybui.com/ 
 * Copyright © 2018-2023 BUI. All Rights Reserved. 
 */}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).bui=t()}(this,(function(){"use strict";var e;function t(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}window.libs=window.Zepto||window.jQuery||{},window.bui={},window.router={},(e=window.bui).debug=!0,e.hasRouter=!1,e.nativeRouter=!1,e.isWebapp,e.currentPlatform="",e.log=!0,e.trace=!1,e.native={},e.config={},e.config.namespace="bui",e.config.classNamePrefix=e.config.namespace+"-",e.config.version="1.8.2",e.config.versionCode=20230602,e.version=e.config.version,e.versionCode=e.config.versionCode,e.config.icon={close:"icon-close",minus:"icon-minus",plus:"icon-plus",search:"icon-search",remove:"icon-removefill"},e.config.viewport={},e.config.init={auto:!0},e.config.ready={},e.config.ajax={},e.config.get={},e.config.put={},e.config.delete={},e.config.post={},e.config.back={},e.config.load={},e.config.getPageParams={},e.config.refresh={},e.config.run={},e.config.checkVersion={},e.config.component={auto:!0},e.config.page={},e.config.dialog={},e.config.confirm={},e.config.alert={},e.config.hint={},e.config.prompt={},e.config.loading={},e.config.mask={},e.config.list={},e.config.listview={},e.config.scroll={},e.config.pullrefresh={},e.config.select={},e.config.sidebar={},e.config.slide={},e.config.actionsheet={},e.config.dropdown={},e.config.accordion={},e.config.stepbar={},e.config.rating={},e.config.number={},e.config.file={},e.config.fileselect={},e.config.upload={},e.config.download={},e.config.swipe={},e.config.router={},e.config.loader={},e.config.loader.define={},e.config.loader.load={},e.config.loader.component={},e.config.store={},e.config.floor={},e.config.animate={},function(e,t){e.prefix=function(t){return e.config.classNamePrefix+t},e.showLog=function(t,n){n=n||"";var i="";"object"==_typeof(t)&&"message"in t&&"name"in t?i=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(i=t),e.log&&console.error(n+" "+i),e.trace&&console.trace&&console.trace(),e.trigger("catcherror",t,n)},e.guid=function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(e=void 0===e?"bui":e||"")+t().substr(e.length)+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e.swipeDirection=function(e,t,n,i){var a=t-e,o=i-n,r=Math.abs(a),l=Math.abs(o);return!(r<9&&l<9)&&(r/l>3?a>0?"swiperight":"swipeleft":o>0?"swipedown":"swipeup")},e.obj=function(n,i){var a=null;i=i||null;var o=e.hasRouter&&router.currentPage()||"html";o=i||o;var r=/^(body|head|link|meta)/gi.test(n)?t("html"):t(o),l="string"==typeof n;if("object"===_typeof(n)||l&&"#"+e.history.getLast().id===n)return a=t(n);if(l&&/^(\d)/.test(n))return a=r.find("[id='"+n+"']");if(l&&/^[a-zA-z]/.test(n)){var c=/^(html|head|body|link|meta|header|main|footer|ul|li|section|dt|dd|div|span|img|article|i|strong|input|textarea|select|h1|h2|h3|h4|h5|h6|p|view|component|components|iframe)$/gi.test(n)||/^\[.+\]$/.test(n)||n.indexOf("[")>-1?n:"#"+n;return a=r.find(c)}return/^#\d/.test(n)?a=r.find("[id='"+n.substr(1)+"']"):/^\.\d/.test(n)?a=r.find("[class='"+n.substr(1)+"']"):n&&(a=r.find(n)),a=a&&a.length?a:t(n)},e.$=e.obj,e.objId=function(t){return e.obj(t,"html")},e.selector=function(e){return void 0===e?this:t(e,this)},e.widget=function(e){return e&&e in this?this[e]:this},e.option=function(n,i){if("object"!==e.typeof(n)&&void 0===i)return"string"==typeof n?this.config[n]:this.config;if("id"==n)return e.showLog("不允许修改控件的ID参数"),this;if(n&&"object"===e.typeof(n)){var a=t.extend(this.config,n);return this.init(a)}if(this.config.hasOwnProperty(n)){var o={};o[n]=i;a=t.extend(this.config,o);return this.init(a)}return this}}(window.bui||{},window.libs),function(e,t){e.emitter=function(){function t(){this.handle={}}return t.prototype.on=function(t,n,i){return"function"==typeof n?(i=n,n=this):n=n||this,n.handle=n.handle||{},e.unit.stringToArray(t).forEach((function(e,t){void 0===n.handle[e]&&(n.handle[e]=[]),n.handle[e].push(i)})),n},t.prototype.off=function(t,n,i){"function"==typeof n?(i=n,n=this):n="function"==typeof i&&n||this;var a=e.typeof(t);if(void 0===t)n.handle=Object.create(null);else if("string"===a&&"function"==typeof i){var o=n.handle[t]||[];e.array.remove(o,i)}else if("string"===a||"array"===a){"object"!==_typeof(n.handle)&&(n.handle={}),e.unit.stringToArray(t).forEach((function(e,t){n.handle[e]=[]}))}return n},t.prototype.one=function(e,t){var n=this;return this.on(e,(function i(){t&&t.apply(n,arguments),n.off(e,i)})),this},t.prototype.has=function(e){return this.handle.hasOwnProperty(e)},t.prototype.wait=function(t,n){var i=this,a=e.unit.stringToArray(t),o=[],r=!0;return a.forEach((function(t,l){i.on(t,(function(t){o[l]=t,o.length===a.length&&r&&(a.forEach((function(t,n){o[n]=e.history.getLast().component[t]||{}})),n&&n.apply(i,o),r=!1)}))})),this},t.prototype.waited=function(t,n){var i=this,a=e.unit.stringToArray(t),o=[],r=!0;return a.forEach((function(t,l){i.on(t,(function(t){o[l]=t.exports||t,o.length===a.length&&r&&(a.forEach((function(t,n){var i=e.history.getLast().component[t];o[n]=i?i.exports:{}})),n&&n.apply(i,o),r=!1)}))})),this},t.prototype.trigger=function(t){try{var n=this.handle[arguments[0]];if("array"===e.typeof(n)){var i=[].slice.apply(arguments);i.shift();for(var a=0,o=n.length;a<o;a++)n[a]&&n[a].apply(this.self||this,i)}}catch(e){}return this},t.prototype.notify=function(){try{for(var t in this.handle){var n=this.handle[t];if("array"===e.typeof(n))for(var i=0,a=n.length;i<a;i++)n[i]&&n[i].apply(this.self||this)}}catch(e){}return this},function(e){return new t}}();var n=e.emitter();e.on=n.on,e.off=n.off,e.trigger=n.trigger,e.one=n.one}(window.bui||{}),function(e,t){e.store=function(n){var i={el:null,uid:"",scope:"",data:null,extends:null,mixins:[],beforeMounts:[],beforeCompiles:[],compileds:[],beforeUpdates:[],mounteds:[],updateds:[],beforeDestroys:[],destroyeds:[],computed:null,methods:null,watch:null,templates:null,beforeMount:null,mounted:null,beforeCompile:null,compiled:null,beforeUpdate:null,updated:null,beforeDestroy:null,destroyed:null,isPublic:!1,modelEvent:"input",scopeSplit:".",paramSplit:"｜",delayInput:200,needStatic:!1,needView:!0,needComponent:!1,needCompile:!0,needNative:!1,deep:!0,log:!1,autoinit:!0},a=null,o=!1,r=!1;function l(n){var a=null,o=n&&n.extends?[n.extends]:[];e.array.merge(i.mixins,o,n.mixins||[],[n]);var r=t.extend(!0,{},i,e.config.store);return function e(n){var o=0;for(o=0;o<n.length;o++){var l=n[o];l.beforeMount&&i.beforeMounts.push(l.beforeMount),l.beforeCompile&&i.beforeCompiles.push(l.beforeCompile),l.beforeUpdate&&i.beforeUpdates.push(l.beforeUpdate),l.updated&&i.updateds.push(l.updated),l.compiled&&i.compileds.push(l.compiled),l.mounted&&i.mounteds.push(l.mounted),l.beforeDestroy&&i.beforeDestroys.push(l.beforeDestroy),l.destroyed&&i.destroyeds.push(l.destroyed),a=t.extend(!0,r,l),l.mixins&&l.mixins.length&&o<n.length-1&&e(l.mixins)}}(i.mixins),a=t.extend(!0,i,a)}var c,s="function"==typeof(a=l(n)).data?a.data.call(U):a.data||{},u=a.scope||e.guid(),d=a.computed,f=a.scopeSplit,p=a.methods,h=a.templates,g=a.watch||i.watch,m=a.delayInput,v=a.isPublic,b=a.modelEvent,y=a.needStatic,w="",x=!1,k=!0,I={},T={},O={},C=!1,S={},P=e.emitter(),L={target:null};s=function n(i){for(var a in i){var o=i[a];o&&"array"===e.typeof(o)?i[a]=e.array.copy(o):o&&"object"===e.typeof(o)&&(i[a]=t.extend(!0,{},o),n(i[a]))}return i}(s),a.el?a.el=a.el:a.el=v||!e.hasRouter?"body":".bui-page",c=a.el,w=0==c.indexOf(".")||0==c.indexOf("#")?c.substr(1):c;var j=null,E=null,N=null,B=null,R=[],D=!0,_=s,F=void 0===a.log?i.log:a.log,A=/b-text|b-html|b-value|b-show|b-hide|b-checked|b-src|b-href|b-bind|b-style|b-class|b-model-lazy|b-model|b-id|b-data|b-placeholder|b-title|b-visible|b-props|b-prop|b-type|b-name|b-disabled|b-readonly|b-min|b-max|b-step/gim,$={"b-text":function(t){var n="b-text",i=se.call(this,t,n),a=ce.call(this,n),o="",r=e.typeof(t.value),l=i.attr(n),c=ge.call(this,n);c[0]&&c[0].keyname;var s=c[0]&&c[0].param||{};switch(r){case"array":o=ue(t,l);break;case"function":o=t.value.apply(U,s);break;default:o=t.value}o=a?!o:o,this.innerText=o,this.removeAttribute("b-cloak"),R=[]},"b-html":function(t){var n="b-html",i=se.call(this,t,n),a=ce.call(this,n),o="",r=e.typeof(t.value),l=i.attr(n),c=ge.call(this,n);c[0]&&c[0].keyname;var s=c[0]&&c[0].param||{};switch(r){case"array":o=ue(t,l);break;case"function":o=t.value.apply(U,s);break;default:o=t.value}o=a?!o:o,i.html(o),R=[],this.removeAttribute("b-cloak")},"b-value":function(e){var t=se.call(this,e,"b-value");v?t.each((function(t,n){de.call(this,e)})):de.call(t[0],e);R=[]},"b-show":function(e){var t=se.call(this,e,"b-show");e.value&&e.value.length||"object"!==_typeof(e.value)&&1==Boolean(e.value)?this.removeAttribute("style"):(""===e.value||e.value&&!e.value.length||0==Boolean(e.value))&&t.css("display","none");R=[]},"b-visible":function(e){var t=se.call(this,e,"b-visible");e.value&&e.value.length&&"object"!==_typeof(e.value)&&1==Boolean(e.value)?this.removeAttribute("style"):(""===e.value||e.value&&!e.value.length||0==Boolean(e.value))&&t.css("visibility","hidden");R=[]},"b-hide":function(n){var i="!"+u+f+n.keyname,a=v?t('[b-show="'.concat(i,'"]')):j(this);"array"===e.typeof(n.value)&&n.value.length||"object"!==_typeof(n.value)&&1==Boolean(n.value)?a.css("display","none"):(""===n.value||n.value&&!n.value.length||0==Boolean(n.value))&&a.removeAttr("style")},"b-checked":function(e){this.checked=!!e.value,R=[]},"b-bind":function(e){var t=se.call(this,e,"b-bind"),n=this,i=e.keyname,a=e.value;if("object"===_typeof(a)){var o=function(o){Oe(i+"."+o,(function(t){pe(se.call(n,e,"b-bind"),o,t.value)})),pe(t,o,a[o])};for(var r in a)o(r)}else{var l="string"==typeof i&&i.split("."),c=l[l.length-1];pe(t,c,a)}},"b-src":function(e){se.call(this,e,"b-src").attr("src",e.value),R=[]},"b-placeholder":function(e){se.call(this,e,"b-placeholder").attr("placeholder",e.value),R=[]},"b-title":function(e){se.call(this,e,"b-title").attr("title",e.value),R=[]},"b-data":function(e){se.call(this,e,"b-data").attr("data",e.value),R=[]},"b-id":function(e){se.call(this,e,"b-id").attr("id",e.value),R=[]},"b-href":function(e){se.call(this,e,"b-href").attr("href",e.value),R=[]},"b-class":function(n){var i=se.call(this,n,"b-class"),a=this;this.classList;var o=n.keyname||"";if("object"===_typeof(n.value))if("array"===e.typeof(n.value)){n.value.length||i.attr("class",""),n.value.forEach((function(e,t){!i.hasClass(e)&&i.addClass(e)}));var r=o.indexOf(".$index");r>-1?Oe(o.substr(0,r)+"."+t(i).index(),(function(e){var t=se.call(a,n,"b-class");he(t,e.value[t.index()],e.value)})):Oe(o,(function(e){var t=se.call(a,n,"b-class");he(t,e.value[t.index()],e.value)}))}else{var l=function(e){var t=n.value[e],r=n.preValue&&n.preValue[e]||"";Oe(o+"."+e,(function(t){he(se.call(a,n,"b-class"),e,t.value)})),he(i,e,t,r)};for(var c in n.value)l(c)}else if("function"==typeof n.value){var s=ge.call(this,"b-class"),u=s[0]&&s[0].keyname||"",d=s[0]&&s[0].param||{},f=n.value.apply(U,d);he(i,u,f,n.preValue)}else{var p="string"==typeof n.keyname&&n.keyname.split("."),h=p[p.length-1];he(i,h,n.value,n.preValue)}R=[]},"b-model":function(e){var t=se.call(this,e,"b-model");v||t.length>1?t.each((function(t,n){fe.call(this,e)})):fe.call(t[0],e)},"b-model-lazy":function(e){var t=se.call(this,e,"b-model-lazy");v?t.each((function(t,n){fe.call(this,e)})):fe.call(t[0],e)},"b-style":function(e){var t=se.call(this,e,"b-style"),n=this;if("object"===_typeof(e.value)){var i=function(i){Oe(e.keyname+"."+i,(function(t){se.call(n,e,"b-style").css(i,t.value)})),t.css(e.value)};for(var a in e.value)i(a)}else t.css(e.keyname,e.value);R=[]},"b-type":function(e){se.call(this,e,"b-type").attr("type",e.value),R=[]},"b-name":function(e){se.call(this,e,"b-name").attr("name",e.value),R=[]},"b-prop":function(t){se.call(this,t,"b-prop");var n="";if("object"===e.typeof(t.value))n=t.value;else{var i={};i[t.keyname.indexOf(".")>-1?t.keyname.split(".").pop():t.keyname]=t.value,n=i}var a=this.id?this.id:e.guid();!this.id&&(this.id=a);var o="false"!==this.getAttribute("everytime");e.$("#".concat(this.id)).attr(n),loader.delay({id:"#".concat(this.id),everytime:o,param:n}),R=[]},"b-props":function(n){se.call(this,n,"b-props");var i="";if("object"===e.typeof(n.value))i=n.value;else{var a={};a[n.keyname.indexOf(".")>-1?n.keyname.split(".").pop():n.keyname]=n.value,i=a}var o=e.history.getLast().component[this.id],r=o&&o.param,l=t.extend(!0,{},r,i),c=this.id?this.id:e.guid();!this.id&&(this.id=c);var s="false"!==this.getAttribute("everytime");e.$("#".concat(this.id)).attr(l),loader.delay({id:"#".concat(this.id),everytime:s,param:l}),R=[]},"b-disabled":function(e){var t=se.call(this,e,"b-disabled");e.value?t.attr("disabled",e.value):t.removeAttr("disabled"),R=[]},"b-readonly":function(e){var t=se.call(this,e,"b-readonly");e.value?t.attr("readonly",e.value):t.removeAttr("readonly"),R=[]},"b-min":function(e){se.call(this,e,"b-min").attr("min",e.value),R=[]},"b-max":function(e){se.call(this,e,"b-max").attr("max",e.value),R=[]},"b-step":function(e){se.call(this,e,"b-step").attr("step",e.value),R=[]}},z={"b-text":[],"b-html":[],"b-value":[],"b-show":[],"b-hide":[],"b-checked":[],"b-bind":[],"b-src":[],"b-title":[],"b-data":[],"b-id":[],"b-href":[],"b-class":[],"b-model":[],"b-model-lazy":[],"b-style":[],"b-prop":[],"b-props":[]},M={},H=t.extend(!0,{},s,p,g,d,h),U={$methods:p,$refs:S,handle:{},mixin:l,$options:a,$templates:h,config:a,watch:Y,nextTick:function(t){return Oe("nexttick",(function(n){try{t&&t.call(U,n)}catch(n){e.showLog(n)}})),this},oneTick:function(t,n){var i="nexttick-"+t;if(O.hasOwnProperty(i))return this;return O[i]=n,Oe("nexttick",(function(n){if(n.keyname===t)try{T[t]&&T[t].pop(),0==T[t].length&&O[i]&&O[i].call(U,n)}catch(n){e.showLog(n)}})),this},get:function(t){if(void 0===t)return _;if("string"==typeof t){var n=e.unit.getKeyValue(t,_);return R=[],n}return _},set:ke,setState:function(n,i){var r="string"==typeof n,l="array"===e.typeof(i),c=i,d="",p=null,h=/\.\d$/.test(n);n.match(/\d+/g),R=[];var g=e.unit.getKeyValue(n,_);if(o=!0,!r||"$data"===n&&"$root"===n||void 0===i)"$data"!==n&&"$root"!==n||"object"!==e.typeof(i)||(_=t.extend(!0,{},_,i),Te(i),R=[]);else{if(F&&console.log("set ".concat(n," ")),C=!0,!l&&Pe.call(U,"beforeupdate",{target:null,value:c,preValue:g,action:"setState",keyname:n,origin:_}),!l&&a.beforeUpdates.forEach((function(e,t){e.call(U,{target:null,value:c,preValue:g,action:"setState",keyname:n,origin:_})})),c="object"===e.typeof(i)?t.extend(!0,{},g,i):"array"===e.typeof(i)?e.array.copy(i):i,h&&(d=n.replace(/\.\d$/,""),p=e.unit.getKeyValue(d,_)),e.unit.setKeyValue(n,c,s),e.unit.setKeyValue(n,c,_),"array"!==e.typeof(g)&&Pe.call(U,n,{target:null,value:c,preValue:g,action:"setState",keyname:n,origin:_}),h){var m=n.replace(/\.\d$/,""),v=e.unit.getKeyValue(m,_);ye(m)&&Pe.call(U,m,{target:null,value:v,preValue:p,action:"setState",keyname:m,origin:_})}i&&e.typeof(i);var b=h?E.find('[b-template*="'.concat(u,".").concat(d,'"]')):E.find('[b-template*="'.concat(u,".").concat(n,'"]'));b.length&&b.each((function(e,n){t(n).length&&Z({el:t(n),action:"setState"})})),"array"!==e.typeof(g)&&(Pe.call(U,"updated",{target:null,value:c,preValue:g,action:"setState",keyname:n,origin:_}),a.updateds.forEach((function(e,t){e.call(U,{target:null,value:c,preValue:g,action:"setState",keyname:n,origin:_})}))),"object"===_typeof(i)&&("array"===e.typeof(i)?be(s,n.split(f)):be(i)),R=[]}return this},delete:Ie,del:Ie,observer:be,compile:K,$mount:K,compileHtml:J,clearKey:function(){return R=[],x=!1,k=!0,C=!1,this},destroy:function(){return R=[],a.beforeDestroys.forEach((function(e,t){e.call(U)})),x=!1,k=!0,C=!1,Se(),a.beforeMounts=[],a.beforeCompiles=[],a.compileds=[],a.mounteds=[],a.beforeUpdates=[],a.updateds=[],a.destroyeds.forEach((function(e,t){e.call(U)})),this},init:V,connect:function(t,n,i){if("object"!==_typeof(t)||!t.hasOwnProperty("$refs"))return U;var a=this;if("string"==typeof n){xe(t,n);var o=e.unit.getKeyValue(n,a.$data);"object"===e.typeof(o)?d(n,o,i||n):u(i||n,o,n)}else for(var r=Object.keys(_),l=0;l<r.length;l++){var c=r[l];if(e.array.compare(we,c,"field"))break;if(xe(t,c),t.$data.hasOwnProperty(c)){t.$data[c];var s=a.$data[c];"object"===e.typeof(s)?d(c,s):u(c,s)}}function u(n,i,a){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i);var o=null;a&&(o=Y(a,(function(i){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i)}))),n&&(o=Y(n,(function(i){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i)})));var r=e.array.index(we,n,"field");(r<0||we[r]&&t.$options.el!==we[r].el)&&we.push({field:a||n,el:t.$options.el,disconnect:o})}function d(n,o,r){for(var l,c=Object.keys(o),s=function(){var o=c[u],r=n+"."+o,l=void 0===i,s=l||""==i?o:i+"."+o;xe(t,r);var f=e.unit.getKeyValue(r,a.$data);l?t.set(r,f):t.set(s,f);var p=Y(r,(function(e){void 0!==i?t.set(s,e):t.set(r,e)}));((d=e.array.index(we,r,"field"))<0||we[d]&&t.$options.el!==we[d].el)&&we.push({field:r,el:t.$options.el,disconnect:p})},u=0;u<c.length;u++){var d;s()}t.trigger.call(t,r||n,(_defineProperty(l={action:"set",target:null,value:_[n],preValue:null},"action","set"),_defineProperty(l,"keyname",n),_defineProperty(l,"origin",_),l))}return U},disconnect:function(t){if("string"==typeof t){var n=e.array.get(we,t,"field");n&&n.disconnect()}else we.forEach((function(e,t){e.disconnect()}));return U},on:Oe,off:Se,one:Ce,trigger:Pe,emitter:P,triggerkey:function(t,n){var i=n||[],o=[];t.indexOf(a.paramSplit)>-1?o=t.split(a.paramSplit):o.push(t);return o.forEach((function(t){var n=e.unit.getKeyValue(t,_),a=e.unit.getKeyValue(t,U);if("function"==typeof a)return C=!1,void a.apply(U,i);Pe(t,{target:null,value:a,preValue:n,action:"set",keyname:t,param:{},origin:_})})),this}};try{a.autoinit&&V()}catch(t){e.showLog(t)}function V(){var n,i=(j=e.hasRouter?router.$:t)(a.el);for(var o in E="object"===_typeof(a.el)?t(a.el):i.length?i:t(a.el),N=E&&E.parent(),B=E&&E.children(),U.$el=E,U.$parent=N,U.$children=B,U.$data=s,p)p[o]=p[o].bind(U);return U.$methods=p,p&&function(){try{Object.keys(p).forEach((function(t){s.hasOwnProperty(t)?e.showLog("不能跟data的键值相同:"+t):Object.defineProperty(U,t,{get:function(){return p[t].bind(this)},set:function(){}})}))}catch(t){e.showLog(t)}}(),h&&function(){try{Object.keys(h).forEach((function(t){s.hasOwnProperty(t)?e.showLog("不能跟data的键值相同:"+t):Object.defineProperty(U,t,{get:function(){return h[t].bind(this)},set:function(){}})}))}catch(t){e.showLog(t)}}(),Pe.call(U,"beforemount"),a.beforeMounts.forEach(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.call(U);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),be(s),function(){var e=function(e){Object.defineProperty(U,e,{configurable:!0,get:function(){this===U||!x&&k?(x=!0,k=!1,R=[],C=!1):(x=!1,k=!1);var t=s[e];return Array.isArray(t)&&L.target&&(Array.isArray(I[e])||(I[e]=[]),I[e].push(L.target)),t},set:function(t){F&&console.log("2. data setting ".concat(e),t),R=[],C=!1,s[e]=t,_[e]=t}})};for(var t in s)e(t)}(),g&&function(t){try{q(t)}catch(t){e.showLog(t)}}(g),d&&function(){try{Object.keys(d).forEach((function(t){if(s.hasOwnProperty(t))e.showLog("不能跟data的键值相同:"+t);else{var n=d[t];Object.defineProperty(U,t,{get:function(){var e,i="function"==typeof n?n.bind(this):n.get.bind(this);return L.target&&(I[t]=[],I[t].push(L.target)),L.target=function(){var e=i();I[t]&&I[t].forEach((function(e){return e()})),Pe(t,{target:null,value:e,action:"set",keyname:t,param:[],origin:_}),L.target=null,R=[]},e=i(),L.target=null,R=[],e},set:n&&"object"===e.typeof(n)&&n.set||function(){}})}}))}catch(t){e.showLog(t)}}(),v?a.needCompile&&router&&router.on("complete",(function(e){a.needCompile&&K(),D&&a.mounteds.forEach((function(t,n){t.call(U,e)})),_=t.extend(!0,{},s),x=!1,k=!0,Pe.call(U,"mounted",e),D=!1,R=[],E.removeAttr("b-cloak"),E.find(["b-cloak"]).removeAttr("b-cloak")})):(D||Se(),y&&(n=J(n=E.html()),E.html(n)),a.needView?function(e){loader.views({id:e.id,loaded:function(e){K(e.el)},compiled:e.compiled})}({id:E,compiled:function(){a.needCompile&&K(),a.mounteds.forEach((function(e,t){e.call(U)})),E.removeAttr("b-cloak")}}):(a.needCompile&&K(),a.mounteds.forEach((function(e,t){e.call(U)})),E.removeAttr("b-cloak")),_=t.extend(!0,{},s),x=!1,k=!0,R=[],Pe.call(U,"mounted"),D=!1),a.uid&&e.history.setUI&&e.history.setUI({uid:a.uid,ui:U}),this}function q(t,n,i){t=t||g;try{var a=Object.keys(t),o=[];a.forEach((function(a,r){var l=i||("object"===_typeof(t[a])?t[a].handler:t[a]);o.push(a),n&&o.unshift(n);var c=o.join("."),u=t[a];if("object"===e.typeof(u)){var d=u.deep?Object.keys(s[a]):Object.keys(t[a]),f=e.unit.getKeyValue(a,s);d.forEach((function(t,n){var i=c+"."+t,a=f[t];"object"===e.typeof(a)&&q(a,i,l),Y(i,l),o=[]})),u.immediate&&u.handler&&u.handler.call(U,s[a],_[a])}Y(c,l),o=[]}))}catch(t){e.showLog(t)}}function Y(t,n){var i=function(t){try{var i=[t.value,t.preValue||"",t];if("init"!==t.action){var a=n;switch(e.typeof(a)){case"function":default:a.apply(U,i);break;case"array":a.forEach((function(e,t){e.apply(U,i)}));break;case"string":new Function(a+"(".concat(t.value,",").concat(t.preValue||"",")"))()}}}catch(t){e.showLog(t)}};return Oe(t,i),Se.bind(this,t,i)}function K(n){try{var i=null,o=null;void 0===n?(i=E,o=a):"string"==typeof n?(i=j(n),o=a):n&&"object"===_typeof(n)&&(i=j(n)||t(n),o=t.extend(!0,{},a,n));var r=!0;if(o.beforeCompiles.forEach((function(e,t){if(!1===(r=e.call(U,o)))return!1})),!1===r)return R=[],!1;if(Z({el:i,action:"first"}),re(i),function(t){var n=t,i=n.find("[b-watch*=".concat(u,"]")),a=n.find("[b-one*=".concat(u,"]"));if(i.length)try{le(i,"b-watch",Oe)}catch(t){e.showLog(t)}if(a.length)try{le(a,"b-one",Ce)}catch(t){e.showLog(t)}}(i),o.needComponent)return loader.components({id:i,compiled:function(){ae(i),ie(i),ne(i),te(i),!0,X(),R=[],o.compileds.forEach((function(e,t){e.call(U,o)}))}}),this;ae(i),ie(i),ne(i),te(i),!0,X(),R=[],o.compileds.forEach((function(e,t){e.call(U,o)}))}catch(t){e.showLog(t)}return this}function W(t){("string"==typeof t?e.$(t).find("component"):t.find("component")).each((function(e,t){loader.component({id:t})}))}function X(){return E.find("[ref]").each((function(){var t=this.getAttribute("ref"),n=S.hasOwnProperty(t),i=null;n&&"htmldivelement"===e.typeof(S[t])?((i=[S[t]]).push(this),S[t]=i):n&&"array"===e.typeof(S[t])?S[t].push(this):S[t]=this})),this}function J(n){try{var i=this,a="string"==typeof n?n:"",o=new RegExp("{{[\\s]?"+u+f+"(.*?)}}","mg");return a=a.replace(o,(function(n,a){var o=a.split(u+f);""===t.trim(o[0])&&o.shift();var r=o.length>0&&e.unit.getKeyValue(o.join("."),_)||"";return"function"==typeof r?r.call(i):r}))}catch(t){e.showLog(t)}}function G(t,n){var i;return M&&M.hasOwnProperty(t)?i=M[t]:(void 0===(i=e.unit.getKeyValue(t,n))&&F&&console.warn("请检查 ".concat(t," 在bui.store scope:").concat(u," 中有没有声明定义")),M[t]=i),i}function Z(n){var i=1==n.replace;try{var a="object"===e.typeof(n)?n.el:n,o=[],r=(a.prop("outerHTML")||a.html()||"").match(A)||[],l=e.array.uniq(r).reverse();l.length&&l.forEach((function(r,l){var c=a.find("[".concat(r,"*=").concat(u,"]"));c.length<1&&(c=a.closest("[".concat(r,"*=").concat(u,"]"))),c.length&&c.each((function(l,c){var s=this,d="",p=ge.call(this,"".concat(r)),h=p[0]&&p[0].keyname||"",g=h.indexOf(".length"),m=g>-1?h.substr(0,g):h,b=p[0]&&p[0].param;G(m,U);var y=ge.call(this,"b-linked");if(y.length&&y.forEach((function(t,n){Oe(t.keyname,(function(t){Pe(h,{target:null,value:e.unit.getKeyValue(h,U),action:"set",keyname:h,param:b,origin:_})}))})),"b-show"===r)if("!"===(p[0]&&p[0].rule))d="b-hide";else d="b-show";else d=r;if(v){var w=e.array.compare(z[d],m);!w&&z[d].push(m),!w&&Oe(m,$[d].bind(s))}else{var I=function(i){var o=arguments;try{if(O.indexOf("$index")>-1){var l=m.match(/([0-9]+)/g),c=l[l.length-1],p=a.find("[".concat(r,'="').concat(T,'"]')),h=p.attr("b-target");p.each((function(e,n){h=t(n).attr("b-target")}));var g=h?a.find(h).eq(c):null,v=arguments;return void(h&&g&&g.length?(g.find("[".concat(r,'="').concat(T,'"]')).each((function(e,t){var n=t||s;$[d].apply(n,v)})),g.closest("[".concat(r,'="').concat(T,'"]')).each((function(e,t){var n=t||s;$[d].apply(n,v)}))):(p.each((function(e,t){var i=t||s;e!=c||"first"!==n.action?"first"!==n.action&&$[d].apply(i,v):$[d].apply(i,v)})),a.closest("[".concat(r,'="').concat(T,'"]')).each((function(e,t){var n=t||s;$[d].apply(n,v)}))))}if(O.indexOf("$key")>-1){var b=function(e){var n=t(e).closest("[b-template]"),i=n.length?n.children()[0]:null,a=i&&i.classList[0]?"."+i.classList[0]:i&&i.nodeName||"";return a&&t(e).closest(a)}(s),y=b&&b.index(),w=y||0;O.indexOf("$key1")>-1?w=y+1:O.indexOf("$key01")>-1&&(w=y<10?"0"+(y+1):y+1),i.value=w}if(O.includes("$itemIndex")){var x=i.keyname.match(/[\d]+/g),k=+x[x.length-1],I=null;if(O.includes("$parentItemIndex")){var C=u+f+O.replace(/\.\$parentItemIndex.+/,""),S=u+f+O.replace(/\.\$itemIndex.+/,"").replace(/\$parentItemIndex/,"$itemIndex");E.find('[b-template$="'.concat(C,')"]')).each((function(e,n){var i=t(n).children().eq(x[0]);I=i.find('[b-template*="'.concat(S,'"]')).children().eq(k).find("[".concat(d,'*="').concat(O,'"]'))}))}else{var P=E.find("[".concat(d,'*="').concat(O,'"]')).closest("[b-template]");I=P.children().eq(k).find("[".concat(d,'*="').concat(O,'"]'))}I.each((function(e,t){$[d].apply(t,o)}))}else $[d].apply(s,arguments)}catch(t){e.showLog(t)}};!D&&0===l&&Se(m,I),i&&Se(m,I);var T=this.getAttribute(r)||"",O=T.replace(u+f,"");Oe(m,(function(){I.apply(s,arguments)}))}e.array.compare(o,m)||o.push(m),R=[],x=!1,k=!0}))})),ee(o,n)}catch(t){e.showLog(t)}}function Q(){var t=ge.call(this,"b-trigger"),n=t&&t[0]&&t[0].keyname||"",i=t&&t[0]&&t[0].param||[],o=[];n.indexOf(a.paramSplit)>-1?o=n.split(a.paramSplit):o.push(n);for(var r=0;r<o.length;r++){var l=o[r];if(l){var c=e.unit.getKeyValue(l,_),s=e.unit.getKeyValue(l,U);if("function"==typeof s)return C=!1,void s.apply(U,i);l&&Pe(l,{target:null,value:s,preValue:c,action:"set",keyname:l,param:{},origin:_})}}return this}function ee(t,n){t.forEach((function(t,i){var a=e.unit.getKeyValue(t,U);Pe(t,{target:null,action:"object"===e.typeof(n)&&n.action||"init",value:a,param:null,keyname:t,origin:_}),R=[]}))}function te(t){var n=t,i='[type="text"][b-model-lazy*='.concat(u,'],\n                                 [type="search"][b-model-lazy*=').concat(u,'],\n                                 [type="password"][b-model-lazy*=').concat(u,'],\n                                 [type="url"][b-model-lazy*=').concat(u,'],\n                                 [type="number"][b-model-lazy*=').concat(u,'],\n                                 [type="email"][b-model-lazy*=').concat(u,'],\n                                 [type="range"][b-model-lazy*=').concat(u,'],\n                                 [type="tel"][b-model-lazy*=').concat(u,"],\n                                 textarea[b-model-lazy*=").concat(u,"]");if("input"===a.modelEvent){var o=!1,l=!1,c=["checkbox","radio","select","select-multiple"];n.off("input compositionstart compositionend",i).on(b,i,e.unit.debounce((function(e){o||(l=!0,(!r||"insertText"===e.inputType)&&s.call(e.target,e),r=!1)}),m)).on("compositionstart",i,(function(e){o=!0,e.stopPropagation()})).on("compositionend",i,e.unit.debounce((function(e){o=!1,l=!0,s.call(e.target,e),e.stopPropagation()}),m)).on("change",(function(e){!c.includes(e.target.type)&&e.target.getAttribute("b-model-lazy")&&((!l||r||e.hasOwnProperty("data"))&&s.call(e.target,e),l=!1,r=!1,e.stopPropagation())}))}function s(t){var n=t.target.value,i=ge.call(this,"b-model-lazy"),a=i[0]&&i[0].keyname||"";if(""===a)return e.showLog("b-model-lazy的值不能为空"),!1;ke(a,n),Q.call(this),R=[],t.stopPropagation()}}function ne(n){var i=n,o='[type="text"][b-model*='.concat(u,'],\n                                 [type="search"][b-model*=').concat(u,'],\n                                 [type="password"][b-model*=').concat(u,'],\n                                 [type="url"][b-model*=').concat(u,'],\n                                 [type="number"][b-model*=').concat(u,'],\n                                 [type="email"][b-model*=').concat(u,'],\n                                 [type="range"][b-model*=').concat(u,'],\n                                 [type="tel"][b-model*=').concat(u,"],\n                                 textarea[b-model*=").concat(u,"]");if("input"===a.modelEvent){var l=!1,c=!1,s=["checkbox","radio","select","select-multiple"];i.off("input compositionstart compositionend change",o).on(b,o,(function(e){l||(c=!0,(!r||"insertText"===e.inputType)&&d.call(e.target,e),r=!1)})).on("compositionstart",o,(function(e){l=!0,e.stopPropagation()})).on("compositionend",o,(function(e){l=!1,c=!0,d.call(e.target,e),e.stopPropagation()})).on("change",(function(e){!s.includes(e.target.type)&&e.target.getAttribute("b-model")&&((!c||r||e.hasOwnProperty("data"))&&d.call(e.target,e),c=!1,r=!1,e.stopPropagation())}))}else i.off(b,o).on(b,o,d);function d(t){var n=t.target.value,i=ge.call(this,"b-model"),a=i[0]&&i[0].keyname||"";if(""===a)return e.showLog("b-model不能为空"),!1;ke(a,n),Q.call(this),R=[],t.stopPropagation()}var f='[type="checkbox"][b-model*='.concat(u,'],\n                                 [type="radio"][b-model*=').concat(u,"]");i.off("change",f).on("change",f,(function(t){try{var n=this,a=this.getAttribute("value")||this.checked,o=this.getAttribute("type"),r=ge.call(this,"b-model")[0].keyname,l=null,c=this.getAttribute("check-value"),s=this.getAttribute("uncheck-value"),d=this.getAttribute("check"),f=this.getAttribute("uncheck");(d||f||c||s)&&(a=this.checked?c||this.value||d:s||f||"");var p=_typeof(l=G(r,U)),h=/\{.+\}$/g.test(a),g=h?null:i.find('[type="checkbox"][b-model="'.concat(u+"."+r,'"][value="').concat(a,'"],\n                 [type="radio"][b-model="').concat(u+"."+r,'"][value="').concat(a,'"]'));if("checkbox"===o){var m=h?JSON.parse(a):a,v=[];"string"==typeof m&&m.indexOf(",")>-1?v=m.split(","):v.push(m),this.checked&&(l&&"array"===e.typeof(l)?v.forEach((function(t,n){!e.array.compare(l,t)&&l.push(t)})):ke(r,m),this.checked=!0),this.checked||(l&&"array"===e.typeof(l)?v.forEach((function(t,n){e.array.remove(e.unit.getKeyValue(r,U),t)})):ke(r,m),this.checked=!1),g&&g.each((function(e,t){this.checked=n.checked})),Q.call(this)}else{var b=e.unit.getKeyValue(r,U);"boolean"===p&&(a="false"!==a&&("true"===a||a)),l&&"array"===e.typeof(l)?b.splice(0,1,a):ke(r,a),Q.call(this)}R=[],t.stopPropagation()}catch(t){e.showLog(t)}}));var p="select[b-model*=".concat(u,"]");i.off("change",p).on("change",p,(function(n){try{var i=t(this).val(),a=(this.selectedIndex,this.multiple),o=ge.call(this,"b-model")[0].keyname,r=null;if(r=G(o,U),!0===a)"array"!==e.typeof(r)&&e.showLog("".concat(o,"的类型必须为数组")),i.splice(0,0,0,i.length+1),r.splice.apply(r,i);else ke(o,i);Q.call(this),R=[],n.stopPropagation()}catch(n){e.showLog(n)}}))}function ie(e){e.off("change","[b-checked*=".concat(u,"]")).on("change","[b-checked*=".concat(u,"]"),(function(e){var t=this.checked;ke(ge.call(this,"b-checked")[0].keyname,t),Q.call(this),R=[],e.stopPropagation()}))}function ae(t){var n=t;["b-click","b-submit","b-change","b-scroll-lazy","b-scroll","b-keydown","b-keyup","b-keypress","b-focus","b-input-lazy","b-input","b-blur","b-mousedown","b-mouseover","b-mousemove","b-mouseup","b-mouseleave","b-touchstart","b-touchmove","b-touchend","b-touchcancel"].forEach((function(t,i){var o=t.substr(2),r=function(e){a.onBeforeEvent&&a.onBeforeEvent.call(this,e,t);var n=oe.call(this,e,t);if(!1===n)return!1;void 0===n&&e.stopPropagation()};if("scroll-lazy"===o||"scroll"===o){var l=n.find("[".concat(t,"*=").concat(u,"]")),c=l.attr("lazy")?parseInt(l.attr("lazy")):300;r="scroll-lazy"===o?e.unit.debounce(r,c):r,l.off("scroll").on("scroll",r)}else if("input-lazy"===o||"input"===o){var s=n.find("[".concat(t,"*=").concat(u,"]")),d=s.attr("lazy")?parseInt(s.attr("lazy")):300;r="input-lazy"===o?e.unit.debounce(r,d):r,s.off("input").on("input",r)}else if("touchstart"===o||"touchmove"===o||"touchend"===o||"touchcancel"===o){var f={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};e.platform.isPC()&&(f={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseleave"}),n.off(f[o],"[".concat(t,"*=").concat(u,"]")).on(f[o],"[".concat(t,"*=").concat(u,"]"),r)}else n.off(o,"[".concat(t,"*=").concat(u,"]")).on(o,"[".concat(t,"*=").concat(u,"]"),r)}))}function oe(t,n){var i=ge.call(this,n),a=i[0].keyname,o=i[0].param,r=null;o.push(t);try{var l="function"==typeof(r=G(a,U))&&r.apply(U,o);return R=[],Pe(a,{target:this,value:r,action:"set",keyname:a,param:o,origin:_}),l}catch(t){e.showLog(t)}}function re(t){var n=t&&t.find("[b-template*=".concat(u,"]"))||[],i=[];if(n.length)try{n.each((function(t,n){var a=j(this),o=ge.call(this,"b-template"),r=this.getAttribute("b-template"),l=o[0].keyname,c=o[0].param,s=u+f;c[0]||console.error('b-template 没有找到数据源, 格式为: b-template="page.template(page.sources)"');var d="string"==typeof c[0]&&c[0].replace(new RegExp(s),"")||"",p=a.attr("b-command")||"html",g=a.attr("b-children")||a.children()[0]&&a.children()[0].tagName;G(d,U);v&&Se(d),T.hasOwnProperty(d)?T[d].push(d):T[d]=[d],Oe(d,(function(t){try{if(r.includes("$itemIndex")){t.keyname.replace(/\d+/,"$itemIndex");var n=t.keyname.match(/\d+/);a=E.find('[b-template*="'.concat(r,'"]')).eq(n[0])}var i,o=t.param;switch(t.action){case"push":case"unshift":i=o;break;case"splice":i=o.slice(2)||"";break;case"setState":p="html",i=t.value;break;default:i=t.value}if(h&&h.hasOwnProperty(l)){c=c.map((function(e,t){return"string"==typeof e&&0==e.indexOf(u+f)&&t>0?G(e.replace(new RegExp(s),""),_):e})),c[0]=i,c[c.length]=t;var m=void 0!==i&&"undefined"!==i&&h[l]&&h[l].apply(U,c);void 0===m&&(m="",e.showLog("".concat(l,"模板方法需要返回内容，例如：return html;"))),v&&(a=j('[b-template*="'.concat(s+d,'"]')));var b=t.preValue||[];0==b.length&&"html"==p&&a.empty();var y=g?a.children(g):a.children(),w=y,x=o&&o.length||0,k=null;switch(D=!0,t.action){case"push":if(a.append(m),y=a.children(g),x&&x==y.length)Z({el:y,action:"push"}),re(k);else if(x>1)for(var I=w.length,T=I;T<y.length;T++)Z({el:k=y.eq(I+T-1),action:"push"}),W(k),re(k);else Z({el:k=y.last(),action:"push"}),W(k),re(k);break;case"unshift":if(a.prepend(m),y=a.children(g),x&&x==y.length)Z({el:y,action:"unshift"});else if(x>1)for(T=0;T<x;T++)Z({el:k=y.eq(T),action:"unshift"}),W(k),re(k);else Z({el:k=y.first(),action:"unshift"}),W(k),re(k);break;case"pop":y.last().remove(),Z({el:k=(y=a.children(g)).last(),action:"pop"}),W(k),re(k);break;case"shift":y.first().remove(),Z({el:k=(y=a.children(g)).first(),action:"shift"}),W(k),re(k);break;case"length":break;case"splice":var O=parseInt(o[0]),C=parseInt(o[1]);C>=b.length&&"html"==p&&(a.empty(),y=a.children(g));var S=y.length,P=S>0,L=!1;if(0==C)if(P&&S-1>=O){y.eq(O).before(m),y=a.children(g);for(T=0;T<i.length;T++)Z({el:k=y.eq(O+T),action:"splice"}),W(k),re(k)}else{a.append(m),y=a.children(g);for(T=0;T<i.length;T++)Z({el:k=y.eq(S+T),action:"splice"}),W(k),re(k)}else if(C>0){var N=e.unit.getKeyValue(t.keyname,t.origin);if(o[1]-o[0]>=(N&&N.length)&&(L=!0),void 0!==o[2])if(P&&S-1>=O){y.eq(O).before(m),y=a.children(g);for(T=0;T<i.length;T++)Z({el:k=y.eq(O+T),action:"splice",replace:L}),W(k),re(k)}else{a.append(m),y=a.children(g);for(T=0;T<i.length;T++)Z({el:k=y.eq(S+T),action:"splice",replace:L}),W(k),re(k)}var B=0;if("append"===p)B=y.length-t.preValue.length||0;else B=0;for(T=0;T<C;T++)y.eq(O+i.length+T+B).remove();m&&!t.value.length&&a.html(m)}break;case"reverse":case"sort":a.html(m),Z({el:a,action:t.action}),W(a),re(a);break;default:a[p](m),Z({el:a,action:t.action}),W(a),re(a)}Pe.call(U,"nexttick",t)}else e.showLog("找不到对应的模板,请检查下 scope:".concat(u," 的templates是否存在").concat(l),"bui.store")}catch(t){e.showLog(t)}})),e.array.compare(i,d)||i.push(d),R=[]})),ee(i)}catch(t){e.showLog(t)}}function le(e,t,n){e.each((function(e,i){j(this);var a=ge.call(this,t);a[0].keyname;var o=a[0].param,r=u+f;o[0]||console.error("".concat(t," 没有找到数据源, 格式为: ").concat(t,'="page.doit(page.sources)"')),G("string"==typeof o[0]&&o[0].replace(new RegExp(r),"")||"",U);var l=this;function c(e){var n=ge.call(l,t),i=n[0].keyname,a=n[0].param;a.push(e),H[i].apply(U,a)}a[0].paramKeyname.forEach((function(e,t){n(e,c)}))}))}function ce(e){return 0==this.getAttribute(e).indexOf("!")}function se(e,n){var i=u+f+e.keyname;return v?t("[".concat(n,'="').concat(i,'"]')):j(this)}function ue(t,n){if(n.indexOf(".length")>-1)return t.value.length||0;if("object"!==e.typeof(t.value))return"array"===e.typeof(t.value)?(t.value=t.value.map((function(e,t){if("object"!==_typeof(e))return e;try{return JSON.stringify(e)}catch(t){return e}})),t.value.join(",")):t.value;try{return JSON.stringify(t.value)}catch(t){return t.value}}function de(t){var n=this.getAttribute("type"),i=this.value,a=this,o=this.getAttribute("b-value");switch(n){case"radio":i==t.value?this.checked=!0:this.checked=!1;break;case"checkbox":"array"===e.typeof(t.value)&&t.value.forEach((function(e,t){i==e&&(a.checked=!0)}));break;default:this.value=ue(t,o)}}function fe(n){var i=this,a=i.getAttribute("type"),o=i.value;if(n.param,"SELECT"===i.nodeName&&i.multiple)n.value.length>1?n.value.forEach((function(e,n){"string"==typeof e?t(i).find("option[value=".concat(e,"]")).attr("selected",!0):t(i).find("option[value=".concat(e.value,"]")).attr("selected",!0)})):i.value=n.value[0];else if("COMPONENT"!==i.nodeName){switch(a){case"radio":o==n.value||String(o)==String(n.value)?i.checked=!0:i.checked=!1;break;case"checkbox":if(o&&"array"===e.typeof(n.value))switch(n.action){case"push":case"unshift":var l=n.param?n.param[0]:[],c="string"==typeof l&&l.indexOf(",")>-1?l.split(","):n.param;c&&c.filter((function(e,t){o!==e||(i.checked=!0)}));break;case"pop":case"shift":n.param&&n.param.filter((function(e,t){o===e&&(i.checked=!1)}));break;case"splice":var s=n.param,u=s&&s[1]&&parseInt(s[1]),d=s&&s.slice(2);0==u?d.forEach((function(e,t){o===e&&(i.checked=!0)})):u>0&&(n.preValue.forEach((function(e,t){t<=n.param[1]&&(i.checked=!1)})),n.value.forEach((function(e,t){o===e&&(i.checked=!0)})));break;case"length":break;default:n.value.filter((function(e,t){o==e&&(i.checked=!0)}))}else n.value===o||1==n.value?i.checked=!0:i.checked=!1;break;default:if(event&&event.target&&"INPUT"===event.target.nodeName&&event.target===i&&i.value===n.value)break;"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName||(r=!0,t(i).trigger("input",n)),i.value=n.value}R=[]}else{var f=i.id?i.id:e.guid();!i.id&&(i.id=f);var p="true"===i.getAttribute("everytime");loader.delay({id:"#".concat(i.id),everytime:p,param:{value:n.value,keyname:n.keyname}})}}function pe(e,t,n){switch(t){case"disabled":n?e.attr(t,n):e.removeAttr(t);break;case"checked":e.prop(t,n);break;default:var i="object"===_typeof(n)?JSON.stringify(n):n;e.attr(t,i)}R=[]}function he(e,t,n,i){"boolean"==typeof n?(n&&e.addClass(t),!n&&e.removeClass(t)):"string"==typeof n?(v&&e.removeClass(n),i&&e.removeClass(i),n&&!e.hasClass(n)&&e.addClass(n),void 0!==i&&""===n&&e.removeClass(i)):(Boolean(n)&&e.addClass(t),!Boolean(n)&&e.removeClass(t))}function ge(t){var n=[],i=this,o=this.getAttribute(t)||"",r=o.indexOf(a.paramSplit)>-1?o.split(a.paramSplit):o&&[o]||[];try{r.forEach((function(e,a){var o={},r=me.call(i,e,t);o.scope=u,o.rule=r.rule,o.keyname=r.name,o.param=r.param,o.paramKeyname=r.paramKeyname,o.eventType=r.eventType,o.eventProperty=r.eventProperty,n.push(o)}))}catch(t){e.showLog("参数处理出错")}return n}function me(n,i){try{var a=n?n.match(/([^\(|\)]+)/g):[],o=[],r="",l="",c=null,s=[],d=null,p=this,h="",g=(S=t(p).attr("b-target"))&&t(p).parents(S)[0]||p,m=null,v="",b="";if(h=(h=(c=(a=a.map((function(e,n){var i=e;if(p.getAttribute("b-template")&&i.indexOf("$itemIndex")>-1){var a=t(p).parents("[b-template]").children()[0],o=a.classList[0]?"."+a.classList[0]:a.nodeName,r=t(p).closest(o).index();i=i.replace(/\$itemIndex/g,r)}return i})))[0]&&a[0].indexOf(u+f)>-1?a[0].split(u+f):[u,a[0]])[0].split(u))[0]||h[1]||"",r=u,(l=c[1]||"").indexOf("$index")>-1){var y=t(g).index();l=l.replace("$index",y)}else if(l.indexOf("$id")>-1){var w=g.id;l=l.replace("$id",w)}else if(l.indexOf("$parentIndex")>-1){var x=t(g).parent().index();l=l.replace("$parentIndex",x)}var k=null,I="";if(!p.getAttribute("b-template")&&(n.indexOf("$itemIndex")>-1||n.indexOf("$itemId")>-1||n.indexOf("$item")>-1)){var T=(k=t(p).closest("[b-template]")||t(p).closest(".bui-template")||t(p).closest(".bui-list")||t(p).closest("ul")).children()[0];I=k?k.attr("b-children")||(T.classList[0]?"."+T.classList[0]:null)||T.nodeName:"";var O=(m=t(p).closest(I)).index();l=l.replace("$itemIndex",O)}if(l.includes("$parentItemIndex")){var C=ve(p);l=l.replace(/\$parentItemIndex/g,C)}if(void 0!==a[1]){var S,P=(S=t(g).attr("b-target"))&&t(g).closest(S)[0]||g,L=a[1].replace(/\$index/g,t(P).index())||"";try{var j=/\{.+\}$/g,E=/\[.+\]$/g,N=L?L.match(/(\'(.*?)\'.*?)|(\"(.*?)\".*?)|(\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14})|(^((https|http|ftp|rtsp|mms)?:\/\/)[^\,]+)|([a-zA-Z0-9][-a-zA-Z0-9\._]{0,62})|(\{.+\})|(\[.+])|([$\w\.]+)|([\d\.]+)|([\u4e00-\u9fa5|\w|\d]+)/g):[];a[1].split(",").forEach((function(e,n){e.indexOf(u+f)>-1&&o.push(e.replace(u+f,"").replace(/\$index/g,t(P).index()))})),s=N.map((function(n,a){var o=n.replace(/^\"|^\'|\"$|\'$/g,"");switch(n){case"$this":o=P;break;case"$index":o=t(P).index();break;case"$parentItemIndex":o=ve(p);break;case"$itemIndex":o=m.index();break;case"$itemId":o=m.attr("id");break;case"$itemText":o=m.text();break;case"$itemHtml":o=m.html();break;case"$item":o=m[0];break;case"$parentIndex":o=t(P).parent().index();break;case"$parent":o=P.parentNode;break;case"$children":o=t(P).children();break;case"$prev":o=t(P).prev();break;case"$next":o=t(P).next();break;case"$id":o=P.id;break;case"$text":o=P.textContent;break;case"$value":o=P.value;break;case"$html":o=P.innerHTML}if("b-template"!==i){var r=u+f;if(e.unit.startWithStr(o,r)){var l=e.unit.getKeyValue(o.split(r)[1],U);o=void 0===l?o:l}}return o=/^\d+$/.test(o)&&o.length<17?parseFloat(o):o,j.test(n)||E.test(n)?JSON.parse(n):o}))}catch(t){e.showLog(t,"getArguments"),s=[]}}void 0!==a[2]&&(v=(d=a[2].indexOf(".")>-1?a[2].split("."):[a[2]])[0],b=d[1]||"")}catch(t){e.showLog("参数格式错误:"+n)}return{scope:r,rule:h,name:l,param:s,paramKeyname:o,eventType:v,eventProperty:b}}function ve(e){var n=t(e).parents("[b-template]"),i=(n[1]||n[0]).children[0],a=i.classList[0]?"."+i.classList[0]:i.nodeName;return t(e).closest(a).index()}function be(n,i){if(!n||!n.hasOwnProperty("widget")||"function"!=typeof n.widget)return function(n,i){if(i&&"array"===e.typeof(i)){if(i.length>1){var r=i.pop();l(e.unit.getKeyValue(i.join("."),n),r)}else l(n,i[0]);return}function l(n,i){var r=n&&n[i];if(n&&function(n,i){var r=n[i],l="function"==typeof r?r.call(U):r,c=[];Object.defineProperty(n,i,{enumerable:!0,configurable:!0,get:function(){return P.target=this,(x||!x&&k)&&R.push(i),L.target&&c.push(L.target),l},set:function(n){if(n===l)return R=[],C=!1,o=!1,x=!1,k=!0,!0;P.target===this&&(R=[]),P.target=this;var r="array"===e.typeof(l)&&"array"===e.typeof(n);(!k||!x&&k)&&R.push(i);var d=R.join("."),f=e.array.copy(R);!r&&!C&&Pe.call(U,"beforeupdate",{action:"set",value:n,preValue:l,keyname:d,origin:_}),!r&&!C&&a.beforeUpdates.forEach((function(e,t){e.call(U,{action:"set",value:n,preValue:l,keyname:d,origin:_})})),F&&console.log("4. data setting ".concat(d),n);var p=e.unit.getKeyValue(d,_);if(r){var h,g=t.extend(!0,[],n);(h=l).splice.apply(h,[0,l.length].concat(_toConsumableArray(g)))}else l="object"===e.typeof(n)?t.extend(!0,{},n):n,!C&&Pe(d,{action:"set",value:l,preValue:p,keyname:d,origin:_}),C=!1;c.forEach((function(e){return e()})),e.unit.setKeyValue(d,l,_),"array"===e.typeof(l)?be(s,f):"object"===e.typeof(l)&&(a.deep&&be(l),l&&Object.keys(l).forEach((function(e,t){var n=d+"."+e;R=[],ye(n)&&Pe(n,{target:null,value:l[e],preValue:p&&p[e],action:"set",keyname:n,origin:_})}))),!r&&!C&&Pe.call(U,"updated",{action:"set",value:l,preValue:p,keyname:d,origin:_}),!r&&!C&&a.updateds.forEach((function(e,t){e.call(U,{action:"set",value:l,preValue:p,keyname:d,origin:_})}));var m=E.find('[b-template*="'.concat(u,".").concat(d,'"]'));return m.length&&!o&&m.each((function(e,n){Z({el:t(n),action:"set"})})),R=[],C=!1,o=!1,x=!1,k=!0,!0}})}(n,i),"array"===e.typeof(r)&&function(t,n){var i=[],o=Array.prototype,r=Object.create(o);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var l=o[t];Object.defineProperty(r,t,{enumerable:!0,configurable:!0,value:function(o){var r=Array.prototype.slice.call(arguments);Pe.call(U,"beforeupdate",{target:null,action:t,param:r,value:this,prevValue:[],keyname:n,origin:_});var c=i.join(".")||n;!s.hasOwnProperty(n)&&R.length?(i.unshift(R.join(".")),c=i.join(".")||n):(i.push(n),c=i.join(".")),R.length>1&&R[0]!==n&&(c=R.join("."));var d=this.slice(0),f=l.apply(this,r);switch(F&&console.log("5. ".concat(c," action ").concat(t,", param:").concat(r," ")),t){case"pop":case"shift":r=[f]}e.unit.setKeyValue(c,this,_);var p=E.find('[b-template*="'.concat(u,".").concat(c,'"]'));if("splice"===t&&r[1]>=0)if(void 0!==r[2]){var h=_toConsumableArray(r);h.splice(0,2);for(var g=0,m=r[0]+r[1],v=r[0];v<m;v++){var b=c+"."+v,y=e.unit.getKeyValue(b,_),w=h[g];void 0!==w&&Pe(b,{target:p,action:t,param:r,value:w,preValue:y,keyname:b,origin:_}),g++}}else for(var T=r[0]+r[1],O=r[0];O<T;O++){var C=c+"."+O,S=e.unit.getKeyValue(C,_);Pe(C,{target:p,action:t,param:r,value:"",preValue:S,keyname:C,origin:_})}Pe(c,{target:p,action:t,param:r,value:this,preValue:d,keyname:c,origin:_});var P=i[0]||n;return I[P]&&"array"===e.typeof(I[P])&&I[P].forEach((function(e){return e()})),ye(c+".$key")&&Pe.call(U,c+".$key",{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:_}),ye(c+".$key1")&&Pe.call(U,c+".$key1",{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:_}),ye(c+".$key01")&&Pe.call(U,c+".$key01",{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:_}),Pe.call(U,"updated",{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:_}),a.updateds.forEach((function(e,i){e.call(U,{target:p,action:t,param:r,value:this,preValue:d,keyname:n,origin:_})})),i=[],R=[],x=!1,k=!0,f}})})),r.$index=function(t,n){return e.array.index(this,t,n)},r.$include=function(t,n){return e.array.compare(this,t,n)},r.$filter=function(t,n){return e.array.filter(this,t,n)},r.$empty=function(){return e.array.empty(this)},r.$replace=function(t){return e.array.replace(this,t)},r.$merge=function(){var t;return(t=e.array).merge.apply(t,[this].concat(Array.prototype.slice.call(arguments)))},r.$get=function(t,n){return e.array.get(this,t,n)},r.$set=function(t,n,i){return e.array.set(this,t,n,i)},r.$delete=function(t,n){return e.array.delete(this,t,n)},r.$deleteIndex=function(t){return e.array.deleteIndex(this,t)},t.__proto__=r}(r,i),r&&"object"===e.typeof(r))return be(r)}n&&Object.keys(n).forEach((function(e){l(n,e)}))}(n,i)}function ye(e){var t=u+f,n=e.includes(u+t)?w+"_"+e:w+"_"+t+e;return P.has.call(U,n)}var we=[];function xe(t,n){var i=e.array.index(we,n,"field");return!!(i>-1&&we[i]&&t.$options.el===we[i].el)&&(we[i].disconnect&&we[i].disconnect(),!0)}function ke(n,i){var o="string"==typeof n,r=i;R=[];var l=e.unit.getKeyValue(n,_);if(o&&void 0!==i){var c,u;if(F&&console.log("set ".concat(n," ")),C=!0,Pe.call(U,"beforeupdate",(_defineProperty(c={action:"set",target:null,value:r,preValue:l},"action","set"),_defineProperty(c,"keyname",n),_defineProperty(c,"origin",_),c)),a.beforeUpdates.forEach((function(e,t){var i;e.call(U,(_defineProperty(i={action:"set",target:null,value:r,preValue:l},"action","set"),_defineProperty(i,"keyname",n),_defineProperty(i,"origin",_),i))})),i&&"object"===e.typeof(i)?(r=t.extend(!0,{},l,i),Object.keys(i).forEach((function(e,t){var a=n+"."+e;Pe.call(U,a,{target:null,value:i[e],preValue:l,action:"set",keyname:a,origin:_})}))):r=i,"array"===e.typeof(r)){var d=e.unit.getKeyValue(n,U);d.splice.apply(d,[0,d.length].concat(_toConsumableArray(r)))}else e.unit.setKeyValue(n,r,s),e.unit.setKeyValue(n,r,_);Pe.call(U,n,{target:null,value:r,preValue:l,action:"set",keyname:n,origin:_}),Pe.call(U,"updated",(_defineProperty(u={action:"set",target:null,value:r,preValue:l},"action","set"),_defineProperty(u,"keyname",n),_defineProperty(u,"origin",_),u)),a.updateds.forEach((function(e,t){var i;e.call(U,(_defineProperty(i={action:"set",target:null,value:r,preValue:l},"action","set"),_defineProperty(i,"keyname",n),_defineProperty(i,"origin",_),i))})),"object"===_typeof(i)&&("array"===e.typeof(i)?be(s,n.split(f)):be(i)),R=[]}else n&&"object"===e.typeof(n)&&(_=t.extend(!0,{},_,n),Te(n));return _}function Ie(t,n){return function(t,n){"string"==typeof t&&(e.unit.delKey(t,_),n&&n.call(U,t))}(t,(function(e){Pe(t)})),_}function Te(t,n){for(var i in t){var a=void 0===n?i:n+i,o=t[i];Pe(a,{target:null,value:o,preValue:_[i]||"undefined",action:"set",param:null,keyname:a,origin:_}),o&&"object"===e.typeof(o)&&Te(o,i+".")}}function Oe(t,n){var i="";return i=t&&"array"===e.typeof(t)?t.map((function(e,t){return w+"_"+u+f+e})):w+"_"+u+f+t,P.on.call(U,i,n),this}function Ce(e,t){return O.hasOwnProperty(e)||(Oe(e,t),O[e]=t),this}function Se(e,t){if(e){var n=w+"_"+u+f+e;P.off.call(U,n,t)}else U.handle={};return this}function Pe(e){var t=w+"_"+u+f+e;arguments[0]=t;var n=arguments[1]&&arguments[1].value||arguments[1];return F&&console.warn(t,n,"trigger"),P.trigger.apply(U,arguments),x=!1,k=!0,this}return U}}(window.bui||{},window.libs),function(e,t){e.viewport=function(n,i){e.trigger.call(e,"viewportbefore");var a,o=t.extend(!0,{uid:"",width:"device-width",initScale:1,maxScale:1,minScale:1,fit:"cover",scalable:"no",zoom:!0,hd:!0,base:750,size:0,create:!1},e.config.viewport),r="object"==_typeof(n)?t.extend(!0,o,n):o,l=window.parent===window?window:window.top,c=document.querySelector("meta[name=viewport]"),s='"width='.concat(r.width,", initial-scale=").concat(r.initScale,", maximum-scale=").concat(r.maxScale,", minimum-scale=").concat(r.minScale,", user-scalable=").concat(r.scalable,",viewport-fit=").concat(r.fit,'"'),u=window.devicePixelRatio,d=l.document.documentElement.clientWidth||l.innerWidth,f=l.document.documentElement.clientHeight||l.innerHeight,p=parseInt(d)*parseInt(u),h=parseInt(f)*parseInt(u),g=d,m=f;if(d=d>f&&f>1?f+24:d,r.size="number"==typeof n?n:r.size||(d/r.base*100).toFixed(2),c)r.create&&(c.content=s);else{var v=document.createElement("meta");v.name="viewport",v.content=s,document.head.appendChild(v),v=null}var b=e.array.index([240,320,360,375,384,393,412,414,435,480,512,540,768,1024,1080,1536,2048,2732,534,854,750],l.document.documentElement.clientWidth);b>-1&&void 0===n?a=[32,42.67,48,50,51.2,52.4,54.93,55.2,58,64,68.27,60,60,60,60,60,60,60,60,60,60][b]:w(r);var y={width:function(e){return g||t("#bui-router").width()||t("body").width()||t(".bui-page").width()},height:function(e){return m||t("#bui-router").height()||t("body").height()||t(".bui-page").height()},fontSize:a,screenWidth:function(e){return p},screenHeight:function(e){return h},ratio:function(e){return u},init:w};function w(t){var n=document.head.parentNode,i="object"===_typeof(t)?t.size||50:t;return a=i||50,r.zoom&&(n.style.fontSize=a+"px"),r.uid&&e.history.setUI&&e.history.setUI({uid:r.uid,ui:y}),e.trigger.call(e,"viewportinit"),this}return y}}(window.bui||{},window.libs),function(e,t){e.loader=function(n){var i,o=t.extend({},{cache:!0,log:!1,baseUrl:"",relativePath:"pages",needNative:!1,deepView:!1,viewTag:"view",componentTag:"component",deepComponent:!0,scriptSuffix:".js"},e.config.loader,n),r=e.emitter(),l=[],c=[],s={},u={baseUrl:"",modules:{},globals:{}},d={},f=null,p={init:function(e){return e=e||{},o=t.extend({},o,e),p.config=o,this},config:o,define:function(n,i,a){var r={moduleName:"",template:"",script:"",path:"",props:null,isComponent:!1,params:null,data:null,depend:[],beforeCreate:null,created:null,beforeLoad:null,loaded:null,hide:null,exports:null,show:null,beforeDestroy:null,destroyed:null},l={},c="";try{var s=y().name?y():function(e){var t=window.location.pathname,n=t.indexOf(".html"),i="",a="";a=n>-1?(i=t.substr(1,n))+".js":(i=t.substr(1))+".js";return{name:i,src:a}}(),f=s.name}catch(e){}var p=[];if(void 0===n)return e.showLog("define第1个参数不能为空"),this;"function"==typeof n?(a=n,c=f,i=[]):"object"===e.typeof(n)?(c=f,i=n.depend||[],a=n.loaded,l=t.extend(!0,{},r,n)):"array"===e.typeof(n)?(a=i,i=n,c=f):"function"==typeof i?(c=n,a=i,i=[]):c=n;var g=d.hasOwnProperty(c)&&d[c].script||s.src,m=window.location.href.substr(0,window.location.href.indexOf("#")).replace("index.html","");g=g.replace(m,""),o.log&&console.log("define "+c),i.length&&(p=b(i,g));if("string"==typeof c&&"function"==typeof a){(l=n&&"object"===e.typeof(n)?t.extend(!0,{},r,d[c],e.config.loader.define,n):t.extend(!0,{},r,d[c],e.config.loader.define)).moduleName=c,l.depend=p,l.style=[],l.script=g,l.path=g.substr(0,g.lastIndexOf("/")+1),l.loaded=function(){var e=[w,d[f]&&d[f].exports,d[f],u.globals],t=[];p.length&&p.forEach((function(e,n){d[e]&&t.push(d[e].exports)}));var n=t.concat(e);return a&&a.apply(this,n)},l.isDefined=!0,h(l)}else e.showLog("define "+c+"模块的参数格式不对");return l},global:function(e){var n=h().globals;if("object"===_typeof(e)){h({globals:t.extend(!0,n,e)})}else{if("function"!=typeof e)return"string"==typeof e?h().globals[e]:h().globals;var i=e.call(p,u.globals);h({globals:t.extend(!0,n,i)})}return p},require:w,destroy:function(n){o.log&&console.log("destroy "+n);var i="string"==typeof n?d[n]:null;if(i){i.beforeDestroy&&i.beforeDestroy.call(i);var a=t('script[name="'+n+'"]').attr("src");l=e.array.remove(l,a),t('script[name="'+n+'"]').remove(),delete u.modules[n],d=u.modules,i.destroyed&&i.destroyed.call(i)}},map:h,import:L,importCss:function(t,n){return new Promise((function(i,a){if("string"==typeof t){var r=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),l=document.createElement("link")||{};l.href=r+(o.cache?"":"?t="+(new Date).getTime()),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),n&&l.setAttribute("id",n),document.head&&document.head.appendChild(l),l=null,i(t,n)}else e.showLog(t+"的格式不正确")}))},importSync:j,importHtml:E,load:k,syncImport:j,syncLoad:function(n){return new Promise((function(i,a){_asyncToGenerator(_regeneratorRuntime().mark((function a(){var o,r,l,c,s,u,d,f,p,h;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(""!=(o=t.extend(!0,{id:"",url:"",param:null,command:"html",beforeLoad:null,loaded:null},n)).id){a.next=4;break}return e.showLog("id不能为空"),a.abrupt("return");case 4:if(""!=o.url){a.next=7;break}return e.showLog("url不能为空"),a.abrupt("return");case 7:r=o.id.indexOf("#")>-1||o.id.indexOf(".")>-1?e.$(o.id):e.$("#"+o.id),l=[],c=0;case 10:if(!(c<r.length)){a.next=27;break}return s=r[c],u=e.unit.getAttributes(s),d=e.$(s).parents("component"),f=d[0]&&d[0].id||"",(p=f&&e.history.getComponent(f,"name"))?(u.parentId=f,u.parentName=p):(h=e.history.getLast(),u.parentId=h.id,u.parentName=h.name),o.url=o.url||u.url||u.name+".html",o.param=t.extend(!0,{},u,o.param),u.id||(s.id=u.id=e.guid()),o.id=u.id,a.next=23,k(o);case 23:l[c]=a.sent;case 24:c++,a.next=10;break;case 27:n.id.indexOf(".")>-1?i(l):i(l[0]);case 28:case"end":return a.stop()}}),a)})))()}))},checkLoad:function(t){var n=!0,i=[];if(d=u.modules,"string"==typeof t){t.indexOf(",")>-1?i=t.split(","):i.push(t)}else t&&"array"===e.typeof(t)&&(i=t||[]);if(i.length)i.forEach((function(e,t){d.hasOwnProperty(e)||(n=!1),d[e]&&!1===d[e].isLoaded&&(n=!1)}));else for(var a in d)d[a]&&!1===d[a].isLoaded&&(n=!1);return n},components:T,component:I,delay:function(n){var i=t.extend(!0,{id:"",deepView:o.deepView,deepComponent:o.deepComponent,delay:!1,everytime:!1,param:null,beforeLoad:null,loaded:null,compiled:null},n);if(!i.id)return void e.showLog("id 不能为空");for(var a=e.$(i.id),r=0;r<a.length;r++){var l=a[r],c=l&&l.getAttribute("delay"),s=l&&l.tagName.toLowerCase();("true"===c||i.everytime)&&("true"===c&&s===o.componentTag||i.everytime?(i.isSelf=!0,i.id=l,i.everytime?l.removeAttribute("delay"):l.setAttribute("delay","false"),I(i)):"true"===c&&s===o.viewTag||i.everytime?(i.isSelf=!0,i.id=l,l.removeAttribute("delay"),P(i)):(i.isSelf=!1,s=t(l).find('[delay="true"]')[0]&&t(l).find('[delay="true"]')[0].tagName.toLowerCase(),t(l).find('[delay="true"]').removeAttr("delay"),s===o.componentTag&&I(i),s===o.viewTag&&P(i)))}return this},views:S,view:P,get:function(e){if("string"==typeof e)return u.modules[e]||null},set:g,one:function(e,t){return r.one.apply(p,arguments),this},wait:function(e,t){return r.wait.apply(p,arguments),this},waited:function(e,t){return r.waited.apply(p,arguments),this},on:function(t,n){var i=e.history.getLast("id"),a=arguments;return e.unit.stringToArray(t).forEach((function(e,t){a[0]=i+"-"+e,r.on.apply(p,a)})),this},off:function(t,n){var i=e.history.getLast("id"),a=arguments;return e.unit.stringToArray(t).forEach((function(e,t){a[0]=i+"-"+e,r.off.apply(p,a)})),this},trigger:D};function h(e){if(void 0===e)return u;if("object"===_typeof(e)&&(e.hasOwnProperty("modules")||e.hasOwnProperty("baseUrl")||e.hasOwnProperty("globals"))){var n=e.modules||{},i=Object.keys(n);i.length&&i.forEach((function(e,t){n[e]=v(n[e])})),u=t.extend(u,e,n),d=u.modules}else if("object"===_typeof(e)&&e.hasOwnProperty("moduleName")){var a=v(e);d[e.moduleName]=a||{}}return u}function g(t,n){if(n&&"object"===e.typeof(n)){if(n.moduleName=t,n.hasOwnProperty("loaded")&&"function"==typeof n.loaded){var i=n.loaded;n.loaded=function(){d=u.modules;var e=n.moduleName,t=d[e].depend,a=[w,d[e]&&d[e].exports,d[e],u.globals],o=[];t.length&&t.forEach((function(e,t){d[e]&&o.push(d[e].exports)}));var r=o.concat(a);return i&&i.apply(this,r)},n.script=n.moduleName+".js",n.path=n.script.substr(0,n.script.lastIndexOf("/")+1)}n.depend&&n.depend.length&&(n.depend=b(n.depend,n.script)),h(n)}return this}function m(e,t){var n=e,i=t.lastIndexOf("/"),a=t.substr(0,i);return e.indexOf("../")>-1?(e=e.replace(/\..\//g,(function(e){var t=a.lastIndexOf("/");return a=a.substr(0,t),""})),n=a?a+"/"+e:e):e.indexOf("./")>-1?n=a+"/"+e.replace(/\.\//g,""):0===e.indexOf("/")&&(n=e.substr(1)),n}function v(n){var i={id:"",moduleName:"",template:"",data:null,props:null,isComponent:!1,params:null,depend:[],script:"",style:[],isDefined:!1,isLoaded:!1,beforeCreate:null,created:null,beforeLoad:null,loaded:null,show:null,hide:null,beforeDestroy:null,destroyed:null,path:"",exports:{},dependExports:[]},a=(d=u.modules)[n.moduleName]||i,o=d[n.moduleName]||i,r=t.extend(a,o,n);return n.props&&(r.props=n.props),r.params=e.history.getParams("url"),r}function b(e,t){for(var n=[],i=0;i<e.length;i++){var a=e[i],o=a.indexOf("./")>-1||0===a.indexOf("/")?m(a,t):a;if(o.indexOf(".css")>-1)o.indexOf("css!")>-1?styles.push(o.substr(4)):styles.push(o);else{var r=o.indexOf(".js");r>-1&&(o=o.substr(0,r)),n.push(o),d.hasOwnProperty(o)||h({moduleName:o})}}return n}function y(){var e,n=window.location.href,r=[],l=document.currentScript;if(n.indexOf("#")>-1?r=n.split("#"):r.push(n),i=r[0].replace("/index.html","")+"/",l)return e=l.src.replace(i,""),{name:l.getAttribute("name")||e.substr("0",e.indexOf(o.scriptSuffix)),src:e};try{a()}catch(e){var c=(c=(e.stack||e.sourceURL||e.stacktrace||"").split(/[@ ]/g).pop().replace(/(:\d+)?:\d+$/i,"")).replace(new RegExp(i,"g"),"");return{name:(l=t('script[src="'+c+'"]')[0])?l.getAttribute("name"):c.replace(o.scriptSuffix,""),src:c}}}function w(t,n,i){if(o.log&&console.log("require "+t),i=1==i,"boolean"==typeof n&&(i=n,n=function(){}),t&&"string"==typeof t){if(t.indexOf(".css")>-1)return L(t,n);if(t.indexOf(".html")>-1)return L(t,n);t=0===t.indexOf("/")?[t.substr(1)]:[t]}if(n&&"function"!=typeof n&&"boolean"!=typeof n)return e.showLog("require第2个参数格式为函数或布尔值","bui.loader.require"),this;try{return function(t,n,i){var a=[];function r(t,n){t=t||[],d=u.modules;var i=e.array.uniq(t);i.length>1&&i.forEach((function(e,t){var n=d[e];n&&(1==n.isLoaded||n.loaded)&&i.splice(t,1)})),i.forEach((function(t,l){var c=d[t];if(d[t]&&d[t].style&&d[t]&&d[t].style.length&&B(d[t].style),e.array.compare(a,t)||a.unshift(t),c&&c.isLoaded){if(!1===(c&&c.beforeLoad&&c.beforeLoad.call(c,c.depend)))return!1;l==i.length-1&&(n&&n.apply(c),a=[])}else if(c&&c.loaded){if(s(t,l),!1===(d[t].beforeCreate&&d[t].beforeCreate.call(d[t])))return!1;d[t].created&&d[t].created.call(d[t])}else N(t,(function(){var e=d[t];if(!1===(e&&e.beforeCreate&&e.beforeCreate.call(d[t])))return!1;e&&e.style&&e.style.length&&B(e.style),e&&e.created&&e.created.call(d[t]),s(t,l)}),(function(){l==i.length-1&&(n&&n.apply(null),a=[])}));function s(e,t){var a=d[e];return a&&(a.isDefined=!0),a.id=c?c.id:"",a.props=c?c.props:{},!1!==(a&&a.beforeLoad&&a.beforeLoad.call(a,a.depend))&&(a&&a.depend&&a.depend.length?(o.log&&console.warn(a.moduleName+" depend:"),o.log&&console.log(a.depend),void r(a.depend,n)):void(t==i.length-1&&n&&n.apply(a)))}}))}return new Promise((function(e,l){r(t,(function(){if(function(e){var t=!0,n=e||[];if(d=u.modules,n.length)for(var i=0;i<n.length;i++){var a=n[i],r=d[a];if(r&&!1===r.isDefined)return t=!1,o.log&&console.warn("check defined false:"+r.moduleName),o.log&&console.warn("wait modules:"),o.log&&console.warn(n),t}else for(var l in d)if(d[l]&&!1===d[l].isDefined)return t=!1,o.log&&console.warn("check defined false:"+r.moduleName),t;return t}(a)){var r=[];t.forEach((function(a,o){x(a,i),r.push(d[a]&&d[a].exports),o===t.length-1&&(n&&n.apply(p,r||[]),e.apply(p,r||[]))}))}}))}))}(t=t.map((function(t,n){return e.unit.resolvePath(t)})),n,i)}catch(t){e.showLog(t,"bui.loader.require")}return this}function x(t,n){d=u.modules;var i="string"==typeof t?d[t]||{}:t,a=i.depend||[],r=null,l=[];i.dependExports=[];try{if(a.length)for(var c=0;c<a.length;c++){var s=a[c],f=d[s];f.isLoaded?l[c]=f.exports:l[c]=x(f)||f.exports,f.exports=l[c],i.dependExports.push(l[c]),f.isLoaded=!0}r=i.isLoaded&&!i.isComponent||i.isLoaded&&!n?i.exports:i.loaded&&i.loaded.apply(i,l),i.exports=r||d[i.moduleName]&&d[i.moduleName].exports,i.isLoaded=!0,D(i.moduleName,i,i.exports),o.log&&console.log("execute "+i.moduleName)}catch(t){e.showLog(t,"bui.loader.execute")}return r}function k(n){return new Promise((function(i,a){var o=t.extend(!0,{id:"",cacheHtml:!1,cache:!1,url:"",script:"",param:null,command:"html",template:null,beforeLoad:null,reload:!0,loaded:null},e.config.loader.load,n);if(""!=o.id)if(""!=o.url){if(!1===("function"==typeof o.beforeLoad?o.beforeLoad.call(p):o.beforeLoad))return this;var r=function(e){var t=d,n={},i=e&&e.indexOf(".html");i>-1?(n.url=e,n.module=e.replace(/\.html?.+/g,"")):(n.url=t[e]&&t[e].template||e+".html",n.module=e);return n}(o.url);if(o.script){var l=o.script.indexOf(".js");r.module=o.script.substr(0,l)}var c=null;"object"===_typeof(o.id)||"string"==typeof o.id&&(o.id.indexOf("#")>-1||o.id.indexOf(".")>-1)?c=e.$(o.id):"string"==typeof o.id&&(c=e.$("#"+o.id));for(var s=0;s<c.length;s++){var u=c[s];u.id||(u.id=e.guid())}o.id=c[0].id,o.name=r.module,o.url=r.url,o.param=e.unit.changeParamBoolean(o.param),h({id:o.id,moduleName:r.module,props:o.param}),e.history.getLast().currentComponent=o.id,e.history.setComponent({id:o.id,name:o.name,url:o.url,param:o.param||null});var f=h().modules[o.name];if(f&&"function"==typeof f.template){var m=f.template.call(f)||"";return m=(m=(m=e.unit.handleContent(m)).replace(/#module\.id/g,"#"+o.id)).replace(/#module\.path\//g,f.path),!o.cacheHtml&&e.obj(o.id)[o.command](m),y(o),this}if(o.cacheHtml)return y(o),this;if("function"==typeof r.url){var v=r.url(o)||"";v=(v=e.unit.handleContent(v)).replace(/#module\.id/g,"#"+o.id);var b=r.url.substr(0,r.url.lastIndexOf("/")+1);return v=v.replace(/#module\.path\//g,b),!o.cacheHtml&&e.obj(o.id)[o.command](v),y(o),this}L(r.url,(function(t){t=(t=e.unit.handleContent(t)).replace(/#module\.id/g,"#"+o.id);var n=r.url.substr(0,r.url.lastIndexOf("/")+1);t=t.replace(/#module\.path\//g,n),!o.cacheHtml&&e.obj(o.id)[o.command](t),y(o)}),(function(e){o.onFail&&o.onFail.call(this,r),a(r)}))}else e.showLog("url不能为空");else e.showLog("id不能为空");function y(n){var a=h().modules[n.name];if(!1===(a.beforeLoad&&a.beforeLoad.call(a,a.depend)))return!1;if(g(n.name,{id:n.id,props:n.param||null,isComponent:!0,$:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return t("#"+n.id).find(e)}))}),a.isLoaded&&"function"==typeof a.loaded&&!n.cache){a.id=n.id,a.exports=a.loaded&&a.loaded.call(a,a.exports)||a.exports;var o={id:n.id,name:n.name,url:n.url,param:n.param||null,exports:a.exports||{}};return e.history.setComponent(o),window.store&&window.store.$mount&&window.store.$mount(n.id),n.loaded&&n.loaded.call(a,a.exports),i(a.exports),D(n.id,o),p}e.checkLoad(n.name),w(n.name,(function(t){var o={id:n.id,name:n.name,url:n.url,param:n.param||null,exports:t||{}};e.history.setComponent(o),window.store&&window.store.$mount&&window.store.$mount(n.id),n.loaded&&n.loaded.call(a,t),i(t),D(n.id,o)}),n.reload)}}))}function I(n){var i=t.extend(!0,{id:"",isSelf:!0,deepComponent:o.deepComponent,cache:!1,cacheHtml:!1,command:"html",delay:!0,param:null,beforeLoad:null,loaded:null,compiled:null},e.config.loader.component,n),a=null;a=""===i.id?e.$(o.componentTag):i.isSelf?e.$(i.id):e.$(i.id).find(o.componentTag);for(var r=[],l=[],c=[],s=[],u=h().modules,d=0;d<a.length;d++){var f=a[d],p=e.guid();if(f.getAttribute("name")){!f.id&&f.setAttribute("id",p);var g=e.unit.getAttributes(f),m=g.parentId=i&&i.id||e.history.getLast().id||"bui-page",v=e.$(m).parents("component"),b=i.isSelf?v[0]&&v[0].id:i.id;"array"===e.typeof(m)?b=i.isSelf?v&&v[0].id:m[0].id:"object"==_typeof(g.parentId)&&e.typeof(g.parentId).indexOf("element")>-1&&(b=i.isSelf?v[0]&&v[0].id:m.id);var y=b&&e.history.getComponent(b,"name");if(y)g.parentId=b,g.parentName=y;else{var w=e.history.getLast();g.parentId=w.id,g.parentName=w.name}var x=g.name||f.getAttribute("name");x=x.replace(/\.html?.+/g,""),g.command||f.getAttribute("command")||i.command;var I="true"===g.rendered||i.cacheHtml;if(x&&(!g.delay||!i.delay)){var T=/\{.+\}$/g,C=/\[.+\]$/g;for(var S in g){var P=g[S],L=_typeof(P);try{"string"===L&&(T.test(P)||C.test(P))&&(g[S]=new Function("return "+P)()),"string"===L&&P.indexOf("(function")>-1&&(g[S]=new Function("return "+P))}catch(t){e.showLog(t)}}g=t.extend(!0,{},g,i.param);var E=u[x],N=f.innerHTML,B=E&&"string"==typeof E.template?E.template:x+".html",R=E&&E.script?E.script:x+".js";B=B||x+".html",E&&"function"==typeof E.template?r.push({id:f.id,el:f,name:x,command:i.command,cacheHtml:I,cache:i.cache,deepComponent:i.deepComponent,template:E.template||"",url:B,srcript:R,slot:N,param:g}):(c.push(B),s.push(R),l.push({id:f.id,el:f,name:x,cacheHtml:I,cache:i.cache,deepComponent:i.deepComponent,url:B,srcript:R,slot:N,param:g}))}}}return r.length&&(r.forEach((function(e,t){k({id:e.id,url:e.url,command:e.command||"html",param:e.param||null,template:e.template,cacheHtml:e.cacheHtml,cache:e.cache,beforeLoad:i.beforeLoad})})),i.data=r,O(i)),l.length?(j(e.array.merge(c,s),(function(e){!function t(n){var a=l[n];return n==l.length?(i.data=l,O(i),this):a?(a.template=e[n],void k({id:a.id,url:a.url,param:a.param||null,cacheHtml:a.cacheHtml,cache:a.cache,beforeLoad:i.beforeLoad,loaded:function(e){t(n+1)},onFail:function(){t(n+1)}})):this}(0)})),this):(i.compiled&&i.compiled(i.data),D("componentcompiled",i.data),!1)}function T(e){return I(t.extend(!0,{id:"",isSelf:!1,deepComponent:o.deepComponent,cache:!1,cacheHtml:!1,beforeLoad:null,loaded:null,compiled:null},e)),this}function O(t){for(var n=0;n<t.data.length;n++){var i=t.data[n];new RegExp("<".concat(o.viewTag,".+name="),"gi").test(i.template)&&S({id:i.id});var a=new RegExp("<".concat(o.componentTag,".+name="),"gi");new RegExp("<".concat(o.componentTag,'.+name="').concat(i.name,'"'),"gi").test(i.template)?e.showLog("请检查代码, <".concat(o.componentTag,' name="').concat(i.name,'"></').concat(o.componentTag,">的模板里面存在循环嵌套")):(t.deepComponent&&a.test(i.template)&&T({id:i.id}),t.loaded&&t.loaded(i),D("componentloaded",i))}t.compiled&&t.compiled(t.data),D("componentcompiled",t.data)}function C(n){for(var i=0;i<n.data.length;i++){var a=n.data[i];if(!a.cacheHtml){a.el.innerHTML=a.template;var r=new RegExp("<".concat(o.componentTag,".+name"),"gi");new RegExp("<".concat(o.componentTag,'.+name="').concat(a.name,'"'),"gi"),r.test(a.template)&&T({id:a.id});var l=new RegExp("<".concat(o.viewTag,'.+name="').concat(a.name,'"'),"gi"),c=new RegExp("<".concat(o.viewTag,'.+name="').concat(a.name,'"'),"gi");if(c.test(a.template)){e.showLog("请检查代码, <".concat(o.viewTag,' name="').concat(a.name,'"></').concat(o.viewTag,">的模板里面存在循环嵌套"));continue}n.deepView&&l.test(a.template)&&!c.test(a.template)&&S({id:t(a.el)})}n.loaded&&n.loaded(a),D("viewloaded",a)}n.compiled&&n.compiled(n.data),D("viewcompiled",n.data)}function S(e){return P(t.extend(!0,{id:"",isSelf:!1,deepView:o.deepView,loaded:null,compiled:null},e)),this}function P(n){var i=t.extend(!0,{id:"",isSelf:!0,deepView:o.deepView,loaded:null,compiled:null},n),a=null;a=""===i.id?e.$(o.viewTag):i.isSelf?e.$(i.id):e.$(i.id).find(o.viewTag);for(var r=[],l=[],c=loader.map().modules,s=0;s<a.length;s++){var u=a[s],d=u.getAttribute("name"),f=u.getAttribute("delay"),p=c[d],h="true"===u.getAttribute("rendered"),g=e.guid();if(u.getAttribute("name")&&(!u.id&&u.setAttribute("id",g),"true"!==f)){var m=u.innerHTML,v=p&&p.template?p.template:d+".html";p&&"function"==typeof p.template?l.push({id:u.id,el:u,name:d,cacheHtml:h,template:p.template.call(p)||"",url:v,slot:m}):r.push({id:u.id,el:u,name:d,cacheHtml:h,url:v,slot:m})}}return l.length&&(l.forEach((function(e,t){e.el.innerHTML=e.template,window.store&&window.store.$mount&&window.store.$mount(i.id)})),i.data=l,C(i)),function e(t){if(t==r.length)return i.data=r,void C(i);r[t]&&E(r[t].url,(function(n){r[t].template=n,e(t+1)}),(function(n){r[t].template="",e(t+1)}))}(0),this}function L(n,i,a){return new Promise((function(o,r){if("string"==typeof n)(n=e.hasRouter?e.unit.resolvePath(n):n.indexOf("./")>-1?e.unit.relativePath(n):n).indexOf(".css")>-1?(i&&i(n),R(n).then((function(e){o(n)}))):n.indexOf(".html")>-1||n.indexOf(".htm")>-1?E(n).then((function(e){if("function"!=typeof i)return t(i).html(e),a&&a(e),void o(e);i&&i(e),o(e)}),(function(e){a&&a(e),r(e)})):("function"==typeof window.define&&(f=t.extend(!0,{},f,window.define.amd),window.define.amd=null),N(n).then((function(e){i&&i(e),o(e),"function"==typeof window.define&&(window.define.amd=t.extend(!0,{},f))}),(function(e){a&&a(e),r(e)})));else if(n&&"array"===e.typeof(n)){var l=n.map((function(t,n){return(t=e.unit.resolvePath(t)).indexOf(".css")>-1?R(t):t.indexOf(".html")>-1||t.indexOf(".htm")>-1?E(t):N(t)}));Promise.all(l).then((function(e){i&&i(e),o(e)}),(function(e){a&&a(e),r(e)}))}}))}function j(n,i,a){return"string"==typeof n?L(n,i,a):n&&"array"===e.typeof(n)?("function"==typeof window.define&&(f=t.extend(!0,{},f,window.define.amd),window.define.amd=null),new Promise((function(a,o){var r=[];!function o(l){if(l==n.length)return i&&i(r),a(r),void("function"==typeof window.define&&(window.define.amd=t.extend(!0,{},f)));var c=e.unit.resolvePath(n[l]);return c.indexOf(".css")>-1?R(c).then((function(e){r.push(e),o(l+1)})):c.indexOf(".html")>-1||c.indexOf(".htm")>-1?E(c,(function(e){r.push(e),o(l+1)}),(function(e){o(l+1)})):N(c,(function(e){r.push(e),o(l+1)}),(function(e){o(l+1)}))}(0)}))):void 0}function E(t,n,i){return new Promise((function(a,r){var l="function"==typeof n;if(t=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),s.hasOwnProperty(t))return l?n&&n.call(p,s[t],200):"string"==typeof n&&e.$(n).html(s[t]),a(s[t],200),this;"string"==typeof t&&bui.ajax({baseUrl:o.baseUrl,url:t,dataType:"html",contentType:"text/html;charset=UTF-8",mimeType:"html",processData:!1,needNative:o.needNative,cache:o.cache,data:null,success:function(o,r,c){s[t]=o,l?n&&n.call(p,o,r,c):"string"==typeof n&&(e.$(n).html(o),i&&i.call(p,o,r,c)),a(o,r)},error:function(e,t,n){i&&i.call(p,e,t,n),r(e,t,n)}})}))}function N(n,i,a){return new Promise((function(r,c){var s;if(d=u.modules,void 0===n||""==n)return a&&a.call(this,n),c(n),this;if(n in d)s=n,n=d[n].script||s+o.scriptSuffix;else{var f=n.indexOf(o.scriptSuffix);f>-1?s=n.substr(0,f):(s=n,n+=o.scriptSuffix)}n=e.hasRouter?n:e.unit.relativePath(n,o.relativePath);var p=document.createElement("script")||{},h=o.cache?"":"?t="+(new Date).getTime(),g=n.indexOf("://")>-1;p.type="text/javascript",p.async=!1,p.src=g?n+h:u.baseUrl+n+h,p.setAttribute("name",s);var m=null;p.onload=function(){o.log&&console.log("create "+n),m&&clearTimeout(m),m=setTimeout((function(){i&&i(n),r(n)}),10)},p.onerror=function(e){o.log&&console.log("createError "+n),a&&a(n),c(n)};var v=e.array.index(l,n);return d[s]&&d[s].isDefined?(i&&i(n),r(n)):(v>-1&&d.hasOwnProperty(s)&&t('script[name="'+s+'"]').remove(),v>-1&&!d.hasOwnProperty(s)&&t('script[name="'+s+'"]').remove(),document.body&&document.body.appendChild(p),o.cache&&l.push(n)),p=null,this}))}function B(t){return new Promise((function(n,i){if(t.length,"array"===e.typeof(t)){var a=t.map((function(e){return R(e)}));return Promise.all(a)}return R(t)}))}function R(t,n){return new Promise((function(i,a){if("string"==typeof t){if(e.array.index(c,t)<0){var r=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),l=document.createElement("link")||{};l.href=r+(o.cache?"":"?t="+(new Date).getTime()),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),document.head&&document.head.appendChild(l),l=null,c.push(t)}i(t,n)}else e.showLog(t+"的格式不正确")}))}function D(t){p.self=this==window||this==p?null:this;var n=e.history.getLast("id");arguments[0]=n+"-"+t,r.trigger.apply(p,arguments)}return p},window.loader=e.loader(),e.define=loader.define,e.require=loader.require,e.map=loader.map,e.import=loader.import,e.checkLoad=loader.checkLoad,e.checkDefine=loader.checkDefine,e.checkImport=loader.checkImport}(window.bui||{},window.libs),function(e,t){e.toggle=function(n){if("string"==typeof n){var i=n||"";(n={}).id=i}var a,o,r={show:function(t,n){if(s)return;if(d=e.objId(l.id),!f&&!p)return!1;f=!1,"function"==typeof t||null==t?n=n||o||"":(n=t||o||"",t=null);d[0]&&"none"==d[0].style.display&&d.css("display",c);if(d.addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n)l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),h=!0,f=!0;else{var i=e.platform.isIE()?"animationend":"webkitAnimationEnd";d.one(i,(function(){try{!h&&d.css("display",c),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),h=!0,f=!0}catch(t){e.showLog(t,"toggle show method")}}))}return this},hide:function(t,n){if(s)return;if(d=e.objId(l.id),!f&&!p)return;p=!1,"function"==typeof t?n=n||a||"":(n=t||a||"",t=null);if(d.css("display",c).addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n)d.css("display","none"),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),h=!1,p=!0;else{var i=e.platform.isIE()?"animationEnd":"webkitAnimationEnd";d.one(i,(function(){try{d.css("display","none"),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),h=!1,p=!0}catch(t){e.showLog(t,"toggle hide method")}}))}return this},remove:function(){return d.remove(),this},isShow:function(){return h},destroy:function(e){e=1==e;d&&(d.off(),e&&d.remove());s=!0},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(r,t,n)},config:l,init:g},l=r.config=t.extend(!0,{},{id:"",uid:"",effect:"fadeIn",useBox:!1,revert:!0,inOrder:!1},n),c=l.useBox?"-webkit-box":"block",s=!1,u={show:["fadeIn","fadeInLeft","fadeInRight","fadeInDown","fadeInUp","fadeInLeftBig","fadeInRightBig","fadeInUpBig","fadeInDownBig","zoomIn","bounceIn","rotateIn","rollIn","flipInX","flipInY","lightSpeedIn","showIn","slideInRight","slideInLeft","coverInLeft","coverInRight","zoomSlideInLeft","zoomSlideInRight","pushInLeft","pushInRight"],hide:["fadeOut","fadeOutLeft","fadeOutRight","fadeOutUp","fadeOutDown","fadeOutLeftBig","fadeOutRightBig","fadeOutDownBig","fadeOutUpBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutRight","slideOutLeft","coverOutLeft","coverOutRight","zoomSlideOutLeft","zoomSlideOutRight","pushOutLeft","pushOutRight"],hideInOrder:["fadeOut","fadeOutRight","fadeOutLeft","fadeOutDown","fadeOutUp","fadeOutRightBig","fadeOutLeftBig","fadeOutUpBig","fadeOutDownBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutLeft","slideOutRight","coverOutRight","coverOutLeft","zoomSlideOutRight","zoomSlideOutLeft","pushOutRight","pushOutLeft"]},d=null,f=!0,p=!0,h=!1;function g(t){if(s=!1,(t=t||l).id){d=e.objId(t.id),l=r.config=t,d.attr("class");var n=t.effect,i=t.inOrder?e.array.index(u.hideInOrder,n):e.array.index(u.hide,n),c=n&&(e.array.index(u.show,n)>-1?e.array.index(u.show,n):i);return h=!(d[0]&&"none"==d[0].style.display||"none"==d.css("display")),c<0?(o=u.show[0],a=t.inOrder?u.hideInOrder[0]:u.hide[0]):(o=u.show[c],a=t.inOrder?u.hideInOrder[c]:u.hide[c]),t.uid&&e.history.setUI&&e.history.setUI({uid:t.uid,ui:r}),this}e.showLog("toggle id不能为空","bui.toggle")}return l.id&&g(l),r}}(window.bui||{},window.libs),function(e,t){e.unit={},e.unit.remToPx=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100;return e=(parseFloat(e)*t).toFixed(2)},e.unit.pxToRem=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100;return e=(parseFloat(e)/t).toFixed(2)},e.unit.pxToRemZoom=function(e){return e=(parseFloat(e)/100).toFixed(2)},e.unit.debounce=function(e,t,n){var i;return function(){var a=n||this,o=arguments;clearTimeout(i),i||(i=setTimeout((function(){i=null,e.apply(a,o)}),t))}},e.unit.throttle=function(e,t,n){var i,a;return t||(t=250),function(){var o=n||this,r=+new Date,l=arguments;i&&r<i+t?(clearTimeout(a),a=setTimeout((function(){i=r,e.apply(o,l)}),t)):(i=r,e.apply(o,l))}},e.unit.startWithCss=function(e){var t=new RegExp("^\\.|^#");return"string"==typeof e&&t.test(e)},e.unit.startWithStr=function(e,t){var n=new RegExp("^"+t);return"string"==typeof e&&n.test(e)},e.unit.startWithId=function(e){var t=new RegExp("^#");return"string"==typeof e&&t.test(e)},e.unit.startWithClass=function(e){var t=new RegExp("^\\.");return"string"==typeof e&&t.test(e)},e.unit.endWithImage=function(e){var t=new RegExp("(.png|.jpg|.gif)$");return"string"==typeof e&&t.test(e)},e.unit.tel=function(t){var n,i="tel:";return 0==(t=String(t)).indexOf("+")&&(i="wtai://wp/mc;"),n=t,window.location.href=i+n,e},e.unit.sms=function(t,n){var i=navigator.userAgent,a=/(iPhone|iPad|iOS)/i.test(i)?"&":"?";return window.location.href="sms:"+t+a+"body="+n,e},e.unit.mailto=function(t){return"string"==typeof(t="email"in t?t:{}).email&&t.email.indexOf("@")>0?window.location.href="mailto:"+t.email+"?subject="+(t.subject||"")+"&body="+(t.body||"")+"&cc="+(t.cc||""):e.showLog(email+"格式不正确"),e},e.unit.openExtral=function(t){var n=[],i="";if((t=String(t)).indexOf("mailto:")>=0)if((i=(n=t.split("mailto:"))[1]).indexOf("?")>-1){var a=i.split("?"),o=e.unit.keyStringToObject(a[1]);o.email=a[0],e.unit.mailto(o)}else e.unit.mailto({email:i});if(t.indexOf("tel:")>=0&&(n=t.split("tel:"),i=parseInt(n[1]),e.unit.tel(i)),t.indexOf("sms:")>=0)if(i=(n=t.split("sms:"))[1],t.indexOf("=")>=0){var r=t.split("=")[1];e.unit.sms(i,r)}else e.unit.sms(i);return e},e.unit.objectToKeyString=function(e,t){var n="";for(var i in e){var a=e[i],o="";if("function"==typeof a)n+=o+="&"+i+"=function",delete e[i];else n+="&"+i+"="+(t?encodeURIComponent(a):a)}return n.substr(1)},e.unit.keyStringToObject=function(t,n){var i,a={},o=[];try{for(o=t.split("&"),i=0;i<o.length;i++){var r=n?decodeURIComponent(o[i].split("=")[1]):o[i].split("=")[1];a[o[i].split("=")[0]]=r}}catch(t){e.showLog(t)}return a},e.unit.checkTargetInclude=function(e,n){var i=n,a=[];if(i.indexOf(",")>-1){var o,r=(a=i.split(",")).length;for(o=0;o<r;o++){var l=a[o];l.indexOf(".")>-1&&(a[o]=l.substr(1))}}else i.indexOf(".")>-1?a[0]=i.substr(1):a[0]=i;var c,s=a.length;for(c=0;c<s;c++)if(t(e).hasClass(a[c])||t(e).closest("."+a[c]).length)return!0;return!1},e.unit.jsonToString=function(t){var n;return n="object"===_typeof(t)?function(t){var n;if("object"===e.typeof(t)){for(var i in t)t[i]=a(t,i);n=JSON.stringify(t)}else"array"===e.typeof(t)?(t.forEach((function(e,n){t[n]=a(t,n)})),n=JSON.stringify(t)):n=t;function a(t,n){var i=t[n];return i&&"object"===e.typeof(i)?t[n]=function(t){if(t&&"object"===e.typeof(t)){for(var n in t){var i=t[n];"object"===_typeof(i)&&(t[n]=JSON.stringify(i))}return t}}(i):i&&"array"===e.typeof(i)?t[n]=function(t){if(t&&"array"===e.typeof(t))return t.forEach((function(e,n){"object"===_typeof(e)&&(t[n]=JSON.stringify(e))})),t}(i):t[n]=i,t[n]}return n}(t):t,n},e.unit.stringToJson=function(t){var n;return n=t&&function t(n){var i,a;try{if(i="object"===_typeof(n)?n:JSON.parse(n),"array"===e.typeof(i))i.forEach((function(e,n){i[n]=t(e)}));else if("object"===e.typeof(i))for(var o in i){var r=i[o];i[o]=t(r)}a=i}catch(e){a=n}return a}(t),n},e.unit.stringToArray=function(t){var n=e.typeof(t);return"array"===n?t:"string"===n&&t.indexOf(",")>-1?t.split(","):[t]},e.unit.setKeyValue=function(e,t,n){var i=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(n,a){if(i.length)return a[n]=a.hasOwnProperty(n)?a[n]:{},e(i.shift(),a[n]);a[n]=t}(i.shift(),n)},e.unit.getKeyValue=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(t,i){var a=i[t];if(a&&"string"==typeof a&&a.indexOf("{")>-1&&a.indexOf("}")>-1)try{i[t]=JSON.parse(a)}catch(e){i[t]=a}return a&&void 0!==a&&n.length?e(n.shift(),a):a}(n.shift(),t)},e.unit.getKeyObj=function(t,n){var i=t&&t.indexOf(".")>-1?t.split("."):[t];return function t(n,a){var o=a[n];return"array"!==e.typeof(o)&&"object"===e.typeof(o)?t(i.shift(),o):o}(i.shift(),n)},e.unit.getKeyName=function(t){var n=field&&field.indexOf(".")>-1?field.split("."):[field];return function t(i,a){var o=a[i];return"array"!==e.typeof(o)&&"object"===e.typeof(o)?t(n.shift(),o):o}(n.shift(),t)},e.unit.delKey=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(i,a){return n.length?e(n.shift(),a[i]):(delete a[i],t)}(n.shift(),t)},e.unit.calcHeight=function(e,n){var i=t(e);i[0]&&(i[0].style.height="calc(100% - "+n+")")},e.unit.resolvePath=function(t){if(!e.hasRouter)return t;var n=t=t||"",i=(router&&router.history&&router.history.getLast()||{url:n}).url||"";if("function"==typeof i)return n;var a=i.lastIndexOf("/"),o=i.substr(0,a);return t.indexOf("../")>-1?(t=t.replace(/\..\//g,(function(e){var t=o.lastIndexOf("/");return o=o.substr(0,t),""})),n=o?o+"/"+t:t):t.indexOf("./")>-1?n=o+"/"+t.replace(/\.\//g,""):0===t.indexOf("/")&&(n=t.substr(1)),n},e.unit.filterField=function(t,n){var i={};if("object"===_typeof(n)){var a="object"===e.typeof(t),o="object"===e.typeof(n),r="array"===e.typeof(t),l="array"===e.typeof(n);if(a){if(o)for(var c in n)i[c]=n[c]?s(t,n[c]):t[c];else l&&n.forEach((function(e,n){i[e]=s(t,e)}));return i}return r?(i=[],l?t.forEach((function(e,t){var a={};n.forEach((function(t,n){a[t]=s(e,t)})),i.push(a)})):o&&t.forEach((function(e,t){var a={};for(var o in n)a[o]=n[o]?s(e,n[o]):e[o];i.push(a)})),i):void 0}function s(t,n){return n.indexOf(".")>-1?e.unit.getKeyValue(n,t):t[n]}},e.unit.fixZero=function(e){return e<10?"0"+e:e},e.unit.getAttributes=function(t){if("object"!==_typeof(t))return null;var n={},i=/\{.+\}$/g,a=/\[.+\]$/g;return t.attributes&&Object.keys(t.attributes).forEach((function(o,r){var l=t.attributes[o],c=l.value;if(i.test(c)||a.test(c))try{c=JSON.parse(c)}catch(t){e.showLog(t)}n[l.name]=c})),n},e.unit.resolvePathname=function(e,t){t=t||0;var n=e.lastIndexOf("/"),i=e.substring(t,n);return i.indexOf("/")>-1?i.split("/"):[i]},e.unit.relativeUrl=function(e,t){var n=[];return t.length>=e.length?t.forEach((function(t,i){var a=e[i];a&&t===a||(a&&t!==a?(n.unshift(".."),n.push(t)):n.push(t))})):e.forEach((function(e,i){var a=t[i];a&&e===a||(a&&e!==a?(n.unshift(".."),n.push(a)):n.unshift(".."))})),n},e.unit.relativePath=function(t,n){n=n||"pages";var i=window.self.location.href;if(i.indexOf("source.html?url=")>-1&&i.indexOf("code=")>-1)return t;if(0===t.indexOf("http://")||0===t.indexOf("https://")||0===t.indexOf("./"))return t;var a=window.location.href,o=a.indexOf(n),r=t&&t.indexOf("/")>-1?t.split("/"):[t],l=[];if(o<0){var c=window.location.pathname.toLocaleLowerCase(),s=c.indexOf("www"),u=c.indexOf("src"),d=c.indexOf("dist");if(s>-1){var f=e.unit.resolvePathname(c,s+4);l=e.unit.relativeUrl(f,r)}else if(d>-1){var p=e.unit.resolvePathname(c,d+5);l=e.unit.relativeUrl(p,r)}else{if(!(u>-1))return 0==t.indexOf("/")?t.replace("/",""):t;var h=e.unit.resolvePathname(c,u+4);l=e.unit.relativeUrl(h,r)}}else{var g=e.unit.resolvePathname(a,o);l=e.unit.relativeUrl(g,r)}return l.join("/")},e.unit.between=function(t,n,i){var a=!0,o=new Date;if(n=n||0,i=i||e.date.convert(o.getFullYear+"/12/31").getTime(),"number"==typeof t)(t<n||t>i)&&(a=!1);else{n||e.showLog("bui.unit.between 第2个参数为最小日期");try{n=e.date.convert(n).getTime(),i=e.date.convert(i).getTime(),((t=e.date.convert(t).getTime())<n||t>i)&&(a=!1)}catch(t){e.showLog("bui.unit.between 用来检测数字或者日期,请检查参数格式是否正确")}}return a},e.unit.numberunit=function(e){var t=+e,n=t;return t>1e4&&(n=parseFloat(t/1e4).toFixed(1)+"万"),n},e.unit.handleStyleScope=function(e){var t=/@\-*[\s\S]*\{[\s\S]+[from|\d|%]+[\s]*\{[\s\S]+?\}[\s\S]+?\}/gm,n=e.match(t)||[],i=(e=e.replace(t,"")).match(/(?=[#|\.|\w]).*[,|\{][\s\S]*?\}/gm)||[];return i=i.map((function(e){var t=e.indexOf(","),n=e.indexOf("{");return t>-1&&t<n&&e.indexOf(",#module.id")<0&&(e=e.replace(/,/g,",#module.id ")),0==e.indexOf("#module.id")||/@[\-|\w]*keyfreames/.test(e)||/[\d]+%[\s]*\{/.test(e)?e:"#module.id "+e})).join(""),i=n.join("")+i},e.unit.getStyleStr=function(e){return e.match(/<style[\s\S]*?<\/style>/g).join("")},e.unit.getStyleContent=function(t){var n=e.unit.getStyleStr(t);return(n=n.replace(/<\/style>/g,"")).replace(/<style[\s\S]*?>/g,"")},e.unit.changeParamBoolean=function(e){for(var t in e)"false"===e[t]?e[t]=!1:"true"===e[t]&&(e[t]=!0);return e},e.unit.handleContent=function(t){var n=/<style[\s\S]*?<\/style>/g,i="string"==typeof t?t:"",a=i&&i.match(n);if(!a)return i;var o=i&&i.match(/@import url.+\)[;]?/g),r=o?o.join(""):"",l=a.join(""),c=i.replace(n,""),s=e.unit.getStyleContent(l);return"<style>".concat(r).concat(e.unit.handleStyleScope(s),"</style>")+c+""}}(window.bui||{},window.libs),function(e,t){e.history=function(){var n=[],i={get:function(t,i){if(void 0===t)return n;var a=i||"name";return e.array.get(n,t,a)},getLast:function(e){var t=n.length-1,i=n[t]||{};return e?i[e]:i},getPrev:function(e){var t=n.length-2,i=n[t]||{};return e?i[e]:i},getParams:function(e){var t=this.getLast(),n={};switch(e){case"page":n=this.getPageParam()||n;break;case"part":case"component":n=this.getComponentParam()||n;break;case"url":n=t.param||bui.getUrlParams();break;default:n=this.getComponentParam(e)||this.getPageParam(e)||t.param||bui.getUrlParams()}return n},setComponent:function(t){var n=this.getLast();return(t.param?Object.keys(t.param):[]).length&&(t.param=e.unit.changeParamBoolean(t.param)),n.component[t.id]=t,t},setUI:function(e){var t=this.getLast(),n=e.uid;return t.ui[n]=e.ui,i},getUI:function(t){return t?this.getLast().ui[t]||null:e.showLog("uid不能为空，指ui自定义唯一的名字")},getComponentParam:function(e){var t=this.getLast(),n=e||t.currentComponent;return n&&t.component[n]&&t.component[n].param||null},getComponent:function(t,n){if(void 0!==t){n=n||"exports";var i=this.getLast();return i.component[t]&&i.component[t][n]||null}e.showLog("必须传component id 才能获取实例")},getComponents:function(t,n){if(void 0!==t){for(var i=this.getLast().component,a=Object.keys(i),o=[],r=0;r<a.length;r++){var l=i[a[r]];l.name===t&&o.push(l)}return o}e.showLog("必须传component name 才能获取实例")},getParentComponent:function(){var e=this.getComponentParam();return e&&e.parentId&&this.getComponent(e.parentId)||this.getLast("exports")},getParentParams:function(){var e=this.getComponentParam();return this.getParams(e.parentId)||this.getLast("param")||null},getPage:function(t,n){if(void 0!==t){n=n||"exports";var i=this.getLast(),a=null,o=i.page;if(o.hasOwnProperty(t))a=o[t]&&o[t][n]||{};else if(t)for(var r=Object.keys(o),l=0;l<r.length;l++){var c=o[r[l]]||{};if(c.name===t)return c[n]}else{var s=i.currentPage;a=o[s]&&o[s][n]||{}}return a}e.showLog("必须传page id 或者 模块名才能获取实例")},getPageDialog:function(t){if(void 0!==t){var n=this.getLast();return n.page[t]&&n.page[t].dialog||null}e.showLog("必须传page id才能获取对话框信息")},setPage:function(n){var i=this.getLast();if("object"!==_typeof(n))return n;if(i.page||(i.page={}),n&&n.hasOwnProperty("id")){var a,o=t.extend({},i.page[n.id],n);for(a in o.param)o.param[a]&&"array"==e.typeof(o.param[a])&&(o.param[a]=n.param[a]||[]);return o.param=e.unit.changeParamBoolean(o.param),i.page[n.id]=o,n}},getPageParam:function(e){var t=this.getLast(),n=e||t.currentPage;return n&&t.page[n]&&t.page[n].param||null},add:function(i){var a=t.extend(!0,{id:"",name:"",url:"",replace:!1,syncHistory:!0,component:{},param:{},ui:{},part:{},page:{},toggle:null,effect:"push"},i),o=n;if(i.toggle){var r=t.extend(!0,{},a,i);a.toggle=null,o.push(r)}else o.push(a);var l=window.location.origin+window.location.pathname+"#"+a.name,c=e.setUrlParams(l,a.param);return a.syncHistory&&"pushState"in window.history&&window.history.pushState(a,null,c),o},replace:function(i){i=t.extend(!0,{id:"",name:"",url:"",replace:!1,syncHistory:!0,param:{},part:{},ui:{},page:{},toggle:null,effect:"push"},opts);var a=n,o=a.length-1,r=window.location.origin+window.location.pathname+"#"+i.name,l=e.setUrlParams(r,i.param);if(o>-1){if(opts.toggle){var c=t.extend(!0,{},i,opts);i.toggle=null,a.splice(o,1,c)}else a.splice(o,1,i);i.syncHistory&&"replaceState"in window.history&&window.history.replaceState(i,null,l)}return a},refresh:function(){if(e.hasRouter){var n=i.getLast(),a=loader.get(n.name);loader.import(n.url,(function(i){i=(i=(i=e.unit.handleContent(i)).replace(/#module\.id/g,"#"+n.id)).replace(/#module\.path\//g,a.path),t("#"+n.id).html(i),e.config.init.auto&&e.init(),router.config.needView&&loader.views(),a.loaded(),router.config.needComponent&&loader.components()}))}else window.location.reload(!0)},removeNext:function(t){var i=n,a=t.index;if(parseInt(a)<0)return e.showLog("index 必须大于或者等于0"),i;var o=i.length-a;i.splice(a,o);var r=this.getLast(),l=window.location.origin+window.location.pathname+"#"+r.name,c=e.setUrlParams(l,r.param);return t.syncHistory&&"replaceState"in window.history&&window.history.replaceState(r.param,null,c),i},removeLast:function(e){var t=n.length-1;return this.removeNext({index:t,syncHistory:!1!==e})},check:function(t){var i=n;return e.array.compare(i,t,"name")||e.array.compare(i,t,"url")||e.array.compare(i,t,"id")},checkComponent:function(t){var n=this.getLast(),i=Object.keys(n.component);return e.array.compare(i,t)},checkPage:function(e,t){for(var n=this.getLast(),i=Object.keys(n.page),a=0;a<i.length;a++){var o=i[a],r=n.page[o];if(r.name===e||r.id===e)return!0}return!1},getHash:function(e){var t=window.location.hash||window.location.search,n=window.location.search,i=n&&n.indexOf("?"),a=0!=e,o=t&&t.indexOf("?"),r=o>-1?t&&t.substr(1,o-1):window.location.hash.substr(1);r&&r.indexOf(".html");var l=r.replace(/\.js|\.html/gi,""),c=loader.get(l)||{},s=c.template?c.template:l+".html",u={};function d(e,t){var n=e&&e.substr(t+1);if(n.indexOf("?")>-1){var i=n.split("?");o(i[0]),o(i[1])}else o(n);function o(e){for(var t=e&&e.split("&"),n=0;n<t.length;n++){var i=t[n],o=a?decodeURIComponent(i.split("=")[1]):i.split("=")[1];"false"===o?o=!1:"true"===o&&(o=!0),u[i.split("=")[0]]=o}}}return o>-1&&(d(n,i),d(t,o)),{pid:l,url:s,param:u}},getCurrent:function(){var e=this.getHash();return this.get(e.pid)},getIndex:function(){var t=this.getHash();return e.array.index(n,t.pid,"pid")},getCurrentPrev:function(t,i){var a=this.getHash(),o=e.array.index(n,a.pid,"pid");return o>0?n[o-1]:n[0]},remove:function(t){var i=String(t),a=/\d+/.test(i)?parseInt(t):e.array.index(n,t,"pid"),o=null;return a>-1&&(o=n.splice(a,1)[0]||null),o}};i.empty=i.epmty=function(e){return n=[]};var a,o;return a=function(t){var n=(t=t&&t.replace(window.location.origin,"")||window.location.pathname).indexOf(".html"),i=t.indexOf("?"),a="",o="",r="",l=null,c=loader.map().modules;if(i>-1){var s=t.substr(i+1);l=e.unit.keyStringToObject(s,!0)}return n>-1?(o=(a=0==t.indexOf("/")?t.substr(1,n-1):t.substr(0,n-1))+".html",r=a+".js"):(o=c[a=t]&&c[a].template||"",r=c[a]&&c[a].script||""),{pid:a,name:a,url:o,src:r,param:l}}(window.location.href),o=e.guid(),t(document).ready((function(){document.body.setAttribute("id",o)})),n.push({id:e.guid(),pid:a.pid,name:a.pid,url:a.url,src:a.src,param:a.param,page:{},ui:{},component:{}}),i}()}(window.bui||{},window.libs),function(e,t){e.router=function(n){var i,a,o,r=t.extend({},{id:"",uid:"",progress:!1,syncHistory:!0,autoInit:!0,firstAnimate:!1,path:"",indexModule:{moduleName:"main",template:"pages/main/main.html",script:"pages/main/main.js"},repairPath:!0,parseurl:!0,errorPage:"",hash:!1,cache:!0,reloadCache:!1,reload:!1,swipe:!1,swipeBack:!1,distance:100,startDistance:5,swipeDistance:50,onSwipeRight:null,onSwipeLeft:null,onSwipeUp:null,onSwipeDown:null,onBeforeSwipeRight:null,onSwipeCancel:null,pageMove:!0,needNative:!1,needView:!1,needComponent:!0,useScroll:"main,.bui-tab-main>ul>li,.bui-dialog-main,.bui-scroll,.bui-scroll-x",beforeBack:null,beforeLoad:null,beforeShow:null,showed:null,beforeHide:null,hided:null,loaded:null,store:null,width:0,height:0,async:!0,effect:"push",backEffect:"",hashPrefix:"#",scriptSuffix:".js",pageSuffix:".html",beforeInit:null,inited:null,loading:{display:"block",className:"bui-router-loading",width:30,height:30,opacity:0}},e.config.router,n),l=null,c=this,s=null,u=null,d=null,f="",p="",h=!0,g=!0,m=!1,v=!1,b=!0,y={none:{inRight:"showIn",inLeft:"showIn",outRight:"showOut",outLeft:"showOut"},fadein:{inRight:"fadeIn",inLeft:"fadeIn",outRight:"fadeOut",outLeft:"fadeOut"},fadeinslide:{inRight:"fadeInRight",inLeft:"fadeInLeft",outRight:"fadeOutRight",outLeft:"fadeOutLeft"},slide:{inRight:"slideInRight",inLeft:"slideInLeft",outRight:"slideOutRight",outLeft:"slideOutLeft"},push:{inRight:"pushInRight",inLeft:"pushInLeft",outRight:"pushOutRight",outLeft:"pushOutLeft"},zoom:{inRight:"zoomIn",inLeft:"zoomIn",outRight:"zoomOut",outLeft:"zoomOut"},cover:{inRight:"coverInRight",inLeft:"coverInLeft",outRight:"coverOutRight",outLeft:"coverOutLeft"},zoomslide:{inRight:"zoomSlideInRight",inLeft:"zoomSlideInLeft",outRight:"zoomSlideOutRight",outLeft:"zoomSlideOutLeft"},fadeinslideback:{inRight:"fadeInLeft",inLeft:"fadeInRight"},slideback:{inRight:"slideInLeft",inLeft:"slideInRight"},pushback:{inRight:"pushInLeft",inLeft:"pushInRight"},coverback:{inRight:"coverInLeft",inLeft:"coverInRight"},zoomslideback:{inRight:"zoomSlideInLeft",inLeft:"zoomSlideInRight"}},w={},x={},k={},I={},T=!1,O={},C={},S=loader.map(r.indexModule),P=e.history.empty(),L=S.modules,j={},E=e.storage({local:!1});function N(n){var i={id:"",url:"",param:{},effect:"",command:"html",path:r.path,repairPath:r.repairPath,firstAnimate:r.firstAnimate,progress:r.progress,reload:r.reload,autoInit:r.autoInit,needView:r.needView,needComponent:r.needComponent,syncHistory:r.syncHistory,replace:!1,iframe:!1,decode:!1,part:!1,cache:r.cache,callback:null,beforeShow:null,showed:null,beforeHide:null,hided:null,beforeLoad:null,loaded:null},c=t.extend(!0,{},i,n),f=t.Deferred();c.beforeLoad=function(e){var t=r.beforeLoad&&r.beforeLoad.call(this,e),i=n.beforeLoad&&n.beforeLoad.call(this,e);return t&&i},c.loaded=function(e){r.loaded&&r.loaded.call(this,e),n.loaded&&n.loaded.call(this,e)},c.beforeHide=function(e){var t=r.beforeHide&&r.beforeHide.call(this,e),i=n.beforeHide&&n.beforeHide.call(this,e);return t&&i},c.hided=function(e){r.hided&&r.hided.call(this,e),n.hided&&n.hided.call(this,e)},c.beforeShow=function(e){var t=r.beforeShow&&r.beforeShow.call(this,e),i=n.beforeShow&&n.beforeShow.call(this,e);return t&&i},c.showed=function(e){r.showed&&r.showed.call(this,e),n.showed&&n.showed.call(this,e)};var g=s.attr("data-main"),v=x.getLast()||null;P[P.length-2],c.url.indexOf("./")>-1&&(c.url=function(e,t){var n=e,i=t.url.lastIndexOf("/"),a=t.url.substr(0,i);e.indexOf("../")>-1?(e=e.replace(/\..\//g,(function(e){var t=a.lastIndexOf("/");return a=a.substr(0,t),""})),n=a?a+"/"+e:e):e.indexOf("./")>-1?n=a+"/"+e.replace(/\.\//g,""):0===e.indexOf("/")&&(n=e.substr(1));return n}(c.url,v)),c.repairPath&&0===c.url.indexOf("/")&&(c.url=c.url.substr(1)),c.path&&(c.path="/"==c.path[c.path.length-1]?c.path:c.path+"/"),c.url=c.url in L||c.iframe||c.url.indexOf("http:")>-1?c.url:c.path+c.url,document.activeElement.blur();var y=null,I={};c.id=(c.id&&c.id.indexOf("#")>-1?c.id.substr(1):c.id)||"";var S=c.replace||c.part?v.id:c.id||e.guid(),E=e.objId(S);if(!c.url)return e.showLog("url 不能为空","bui.router.load"),f.promise();if(c.url=c.decode?decodeURIComponent(c.url):c.url,c.url.indexOf("tel:")>=0||c.url.indexOf("mailto:")>=0||c.url.indexOf("sms:")>=0)return e.unit.openExtral(c.url),f.promise();if(c.url&&c.url.indexOf("?")>-1){var R=c.url.split("?");I=e.unit.keyStringToObject(R[1]),c.url=R[0]}y=t.extend(!0,{},I,c.param),y=e.unit.changeParamBoolean(y),"wechat_redirect"==c.url?c.url="main":"undefined"==c.url&&(c.url=r.errorPage||"main"),c.iframe==y.iframe&&y.iframe.toString();var D=B(c.url),M=D.pid||params.errorPage||"main",U=c.iframe?c.url:D.url,q="string"==typeof U?U:loader.get(M).script||c.url,Y=q.substr(0,q.lastIndexOf("/")+1),K={id:S,pid:M,name:M,url:"function"==typeof U?c.url:U,path:Y,replace:c.replace,param:y,component:{},page:{},part:{},ui:{},toggle:null,exports:{},effect:n.effect||r.effect,syncHistory:c.syncHistory};if(!h&&!1===(c.beforeHide&&c.beforeHide.call(V,{type:"load",target:v})))return!1;if(!1===(j[M]&&j[M].beforeLoad&&j[M].beforeLoad({prevTarget:v,target:K})))return h=!1,this;var W="function"==typeof c.beforeLoad?c.beforeLoad.call(V,{prevTarget:v,target:K}):c.beforeLoad;if(H.call(V,"loadbefore",{prevTarget:v,target:K}),H.call(V,"beforeload",{prevTarget:v,target:K}),!1===W)return h=!1,this;if(c.part,o&&o.show(),c.progress&&a&&a.show(),loader.map({moduleName:M,path:Y,id:S}),loader.get(K.pid),P.length&&c.effect){var X=P.length-1;P[X].effect=c.effect}!m&&!c.part&&!c.replace&&x.add(K),c.replace&&x.replace(K);var J=K;if(c.part&&(e.history.setComponent({id:S,pid:M,url:U,param:y}),J.currentComponent=S,P.splice(P.length-1,1,J)),c.part||K,k[M])!function(e){var t=O.get(e.pid,"template");ne(t),e.part?ie(e):(ee(),!m&&te((function(){e.firstAnimate&&(ie(e),e.loaded&&e.loaded({prevTarget:v,target:K}),e.callback&&e.callback({prevTarget:v,target:K})),e.progress&&a&&a.hide()})),!e.firstAnimate&&ie(e))}({pid:M,progress:c.progress,part:c.part,firstAnimate:c.firstAnimate}),r.needComponent&&loader.components(),c.firstAnimate||(c.loaded&&c.loaded({prevTarget:v,target:K}),c.callback&&c.callback({prevTarget:v,target:K}),j[M]&&j[M].loaded&&j[M].loaded({prevTarget:v,target:K})),H.call(V,"complete",{prevTarget:v,target:K}),l.removeClass("bui-router-placeholder");else{if(c.iframe)return function(t){var n=function(t){var n=t.url.indexOf(".html")>-1||0==t.url.indexOf("http")?t.url:t.url+".html",i=t.param?e.setUrlParams(n,t.param):n,a="",o=e.platform.isIos()?'scrolling="no"':"";return a+='<div id="'+t.id+'" class="bui-router-item bui-router-fixiframe" data-page="'+t.pid+'">',a+='<iframe class="bui-router-iframe" src="'+i+'" '+o+' name="'+t.pid+'"></iframe>',a+="</div>"}({id:t.id,pid:t.pid,url:t.url,param:t.param});s&&s.attr("data-main",t.id).append(n),te((function(){c.progress&&a&&a.hide()}))}({id:S,pid:M,url:c.url,param:y}),f.promise();if(c.part)return _(U,(function(t,n,i){e.objId(S)[c.command](t),Z(ae),c.cache&&O.add(M,{id:S,pid:M,template:t}),o&&o.hide(),c.progress&&a&&a.hide()}),(function(e,t,n){G(U,e),H.call(V,"loadfail",e,t,n)})),f.promise();_(U,(function(e,t,n){return"object"===_typeof(e)?(G(U,e),!1):(ne(e),c.cache&&O.add(M,{id:S,pid:M,template:e}),ee(),!1!==(c.beforeShow&&c.beforeShow.call(V,{type:"load",target:K}))&&void(c.firstAnimate?te((function(){Z(ae),c.progress&&a&&a.hide(),C.add(M,{id:S,pid:M,param:y})})):(te((function(){c.progress&&a&&a.hide()})),Z(ae),C.add(M,{id:S,pid:M,param:y}))))}),(function(e,t,n){G(U,e),H.call(V,"loadfail",e,t,n)}))}function G(t,n,i,l){if(o&&o.hide(),c.progress&&a&&a.hide(),x.removeLast(),f.reject(t),"object"===_typeof(n)){switch(e.showLog("找不到页面"+t,"bui.router.load"),window.location.protocol){case"file:":e.hasRouter&&e.showLog("PC调试预览单页时，需要开启跨域的Chrome，或使用部署站点才能访问，具体请查看官网调试章节");break;case"http:":case"https:":e.showLog("请检查下网络是否正常")}return r.errorPage&&function(e){!function(e){var t,n=window.location.href,i=(t=(t=n.indexOf(r.hashPrefix))>-1?t:0)>-1?n.substr(0,t):n;N({url:r.errorPage||i,param:{error:e}}),H.call(V,"error",{target:e,status:404})}(e)}(t),!1}}function Z(n){loader.set(M,{props:y,$:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return t("#"+S).find(e)}))}),c.showed&&c.showed.call(V,{type:"load",target:K}),m||w[M]?(J.exports=w[M],ie({pid:M}),T&&te(),n&&n(),r.needComponent&&loader.components(),Q(),l.removeClass("bui-router-placeholder")):(loader.checkLoad(M)?(ie({pid:M}),r.needComponent&&loader.components(),n&&n(),Q(),l.removeClass("bui-router-placeholder")):(r.needComponent&&loader.components(),loader.require(M,(function(t){try{if(c.firstAnimate&&c.progress&&a&&a.hide(),w[M]=t||null,K.exports=t,f.resolve(t),h||c.firstAnimate||c.replace){var i=loader.get(M);i&&i.show&&i.show({type:"firstload",target:K})}n&&n(),c.loaded&&c.loaded({prevTarget:v,target:K}),c.callback&&c.callback({prevTarget:v,target:K}),Q(),j[M]&&j[M].loaded&&j[M].loaded({prevTarget:v,target:K}),!b&&c.firstAnimate&&H.call(V,"pageshow",{type:"load",target:K}),l.removeClass("bui-router-placeholder")}catch(t){e.showLog(t,"bui.router.load"),f.reject()}}))),H.call(V,"complete",{prevTarget:v,target:K}))}function Q(e){if(b){var t=x.getLast(),n="pageshow-"+t.pid;!c.firstAnimate&&H.call(V,"pageshow",{type:"load",target:t}),H.call(V,n,{type:"load",target:t}),b=!1}}function ee(){var t=(l=e.objId(J.id))&&l.find(".bui-page");t&&t.length&&c.autoInit&&e.init({id:t,height:p})}function te(t){l=e.objId(S),!c.replace&&document.getElementById(g)&&(document.getElementById(g).style.display="none"),F(),A();try{h||m||c.replace||c.part?(t&&t(),!c.firstAnimate&&c.progress&&a&&a.hide(),o&&o.hide(),l&&l.css("zIndex",5)):(u&&u.hide(),d&&d.show((function(){t&&t(),!c.firstAnimate&&c.progress&&a&&a.hide(),l&&l.css("zIndex",5),o&&o.hide();var e=P[P.length-2]||{},n=x.getLast(),i=loader.get(n.pid),r=e&&e.pid&&loader.get(e.pid)||null,s="pageshow-"+n.pid,u="pagehide-"+e.pid;r&&r.hide&&r.hide({type:"load",target:e}),i&&i.show&&i.show({type:"load",target:x.getLast()}),!h&&c.hided&&c.hided.call(V,{type:"load",target:e}),H.call(V,u,{type:"load",target:e}),H.call(V,s,{type:"load",target:x.getLast()}),H.call(V,"pagehide",{type:"load",target:e}),c.firstAnimate?loader.checkLoad(P[P.length-1].pid)&&H.call(V,"pageshow",{type:"load",target:n}):H.call(V,"pageshow",{type:"load",target:n})})))}catch(t){e.showLog(t,"bui.router.doAnimate")}}function ne(t){var n="";V.store&&(t=V.store.compileHtml(t));var i=e.history.getLast();if(t=(t=(t=e.unit.handleContent(t)).replace(/#module\.id/g,"#"+i.id)).replace(/#module\.path\//g,i.path),c.part)n=z({content:t}),c.id?E.html(n):e.showLog("id 不能为空","router.loadPart");else if(c.replace){var a=x.getLast();E=P.length?e.objId(a.id):s,a.pid=M,a.url=U,a.param=y,e.array.index(P,M,"pid"),n=M in k?O.get(M,"template"):z({content:t});i=e.history.getLast();n=(n=n.replace(/#module\.id/g,"#"+i.id)).replace(/#module\.path\//g,i.path),E.html(n).attr("data-page",M)}else m||(n=$({id:S,content:t,pid:M}),s&&s.attr("data-main",S).append(n));return r.needView&&loader.views({compiled:function(){V.store&&!V.store.config.isPublic&&V.store.config.needCompile&&V.store.compile("#"+S)}}),!V.store||r.needView||V.store.config.isPublic||V.store.config.needCompile&&V.store.compile("#"+S),n}function ie(e){var n=x.getLast(),i=L[e.pid]&&L[e.pid]||{},a=i.loaded;loader.set(e.pid,{props:n.param,$:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return t("#"+n.id).find(e)}))});var r=a&&a.apply(i,i.dependExports)||i.exports;w[e.pid]=r||null,i.exports=r,n.exports=r,m&&H.call(V,"refresh",{prevTarget:v,target:n}),o&&o.hide(),f.resolve(r),m=!1,h=!1}function ae(){var e=P[P.length-2]||null,t=x.getLast();h&&!c.part&&(H.call(V,"firstload",{prevTarget:e,target:t}),h=!1),c.part?H.call(V,"loadpart",{prevTarget:e,target:t}):H.call(V,"load",{prevTarget:e,target:t})}return f.promise()}function B(e){var t="",n=e;S=loader.map(),L=S.modules;var i=n.indexOf(r.pageSuffix);return i>-1?(n=(t=n).substr(0,i),L.hasOwnProperty(n)&&(t=L[n]&&L[n].template||t||"")):t=L[n]&&L[n].template||n+r.pageSuffix||"",{pid:n,url:t}}function R(n){var i=this,a={};"function"==typeof n?a.callback=n:a=n||{};var o=t.extend(!0,{index:-1,name:"",beforeBack:null,callback:null,effect:r.backEffect||r.effect,beforeHide:null,beforeShow:null,showed:null,hided:null,loaded:null},a);o.beforeBack=function(e){r.beforeBack&&r.beforeBack.call(this,e),a.beforeBack&&a.beforeBack.call(this,e)},o.loaded=function(e){r.loaded&&r.loaded.call(this,e),a.loaded&&a.loaded.call(this,e)},o.beforeHide=function(e){r.beforeHide&&r.beforeHide.call(this,e),a.beforeHide&&a.beforeHide.call(this,e)},o.hided=function(e){r.hided&&r.hided.call(this,e),a.hided&&a.hided.call(this,e)},o.beforeShow=function(e){r.beforeShow&&r.beforeShow.call(this,e),a.beforeShow&&a.beforeShow.call(this,e)},o.showed=function(e){r.showed&&r.showed.call(this,e),a.showed&&a.showed.call(this,e)};var l=parseInt(o.index),c=P.length;if(S=loader.map(),L=S.modules,!(l>0)){var f=x.getLast(),p=c-1,h=f.toggle;if(h)return h.hide(),void F();var m=o.beforeBack&&o.beforeBack.call(V,{prevTarget:null,target:f});H.call(V,"beforeback",{prevTarget:null,target:f});var v=loader.get(f.pid);if(v&&v.beforeDestroy&&v.beforeDestroy(),!1===m)return this;var b=bui.history.getPrev();if(!1===(o.beforeHide&&o.beforeHide.call(V,{type:"back",target:f})))return this;if(!1===(o.beforeShow&&o.beforeShow.call(V,{type:"back",target:b})))return this;if(o.name&&(l=D(o.name)),Math.abs(l)>p&&(l=-p),c>1&&g){l<-1&&A(l),g=!1;var k=y[o.effect]&&y[o.effect].inLeft,I=y[o.effect]&&y[o.effect].outRight;u&&u.show(null,k),d&&d.hide((function(){var n=c+l;!function(e){s.children().each((function(n,i){n>=e&&t(i).remove()}))}(n),x.removeNext(n),A();var a=F(),r=a.pid;e.objId(a.id).css("zIndex",5),function(){var e;e=w[r]||{};var t=loader.get(a.pid);o.callback&&o.callback.call(i,e,a),o.backed&&o.backed.call(V,{prevTarget:f,target:a}),H.call(V,"back",{prevTarget:f,target:a}),a;var n="pageshow-"+a.pid,l="pagehide-"+f.pid;v&&v.hide&&v.hide({type:"back",target:f}),t&&t.show&&t.show({type:"back",target:a}),H.call(V,l,{type:"back",target:f}),H.call(V,n,{type:"back",target:a}),o.showed&&o.showed.call(V,{type:"back",target:a}),o.hided&&o.hided.call(V,{type:"back",target:f}),H.call(V,"pageshow",{type:"back",target:a}),H.call(V,"pagehide",{type:"back",target:f}),v&&v.destroyed&&v.destroyed(),g=!0}()}),I)}return this}e.showLog("index 参数只能是负数","bui.router.back")}function D(t){var n,i=e.array.indexs(P,t,"pid"),a=i.length;if(a){var o=-(P.length-i[a-1]-1);n=0==o?-1:o}else n=-1;return n}function _(t,n,i){if("string"==typeof t){loader.importHtml(t,(function(e,t,i){e=function(e){var t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,n=/<body[^>]*>([\s\S]*)<\/body>/.exec(e);if(n&&2===n.length)return n[1].replace(t,"");return e}(e),n&&n(e,t,i),H.call(V,"success",e,t,i)}),(function(e,t,n){i&&i(e,t,n),H.call(V,"fail",e,t,n)}))}else if("function"==typeof t){var a=t&&t();n&&n(a,200,{}),H.call(V,"success",a,200,{})}else e.showLog("url 不能为空","bui.router.requestUrl")}function F(){var t=x.getLast(),n=t.id||"",i=t.effect||r.effect;return n&&(H.call(V,"beforepageshow",{target:t}),d=null,d=e.toggle({id:document.getElementById(n),effect:y[i]&&y[i].inRight||""}),s&&s.attr("data-main",n)),t}function A(t){t=t||-1;var n=P.length+t-1,i=P[n],a=i&&i.id||"",o=i&&i.effect||r.effect;return a&&(H.call(V,"beforepagehide",{target:i}),u=null,u=e.toggle({id:document.getElementById(a),effect:y[o]&&y[o].inLeft||""})),i}function $(e){var t="";return t+='<div id="'+e.id+'" class="bui-router-item bui-router-placeholder" data-page="'+e.pid+'">',t+=e.content||"",t+="</div>"}function z(e){var t="";return t+=e.content}function M(t,n){return e.on.apply(V,arguments),this}function H(t){V.self=this==window||this==V?null:this,e.trigger.apply(V,arguments)}e.hasRouter=!0,x.get=function(){return P},x.add=function(n){if((n=n||{}).toggle){var i=t.extend(!0,{},n);n.toggle=null,P.push(i)}else P.push(n);var a=window.location.origin+window.location.pathname+"#"+n.pid,o=e.setUrlParams(a,n.param);if(!h)return n.syncHistory&&"pushState"in window.history&&window.history.pushState(n,null,o),P;n.syncHistory&&"replaceState"in window.history&&window.history.replaceState(n,null,o)},x.prepend=function(t){t=t||{};var n=window.location.origin+window.location.pathname+"#"+t.pid;return e.setUrlParams(n,t.param),P.unshift(t),P},x.replace=function(t){t=t||{};var n=P.length-1,i=window.location.origin+window.location.pathname+"#"+t.pid,a=e.setUrlParams(i,t.param);return n>-1&&(P.splice(n,1,t),t.syncHistory&&"replaceState"in window.history&&window.history.replaceState(t,null,a)),P},x.getLast=function(e){var t=P.length-1,n=P[t]||{};return e?n[e]:n},x.removeNext=function(t){var n=P.length-t;P.splice(t,n);var i=x.getLast(),a=window.location.origin+window.location.pathname+"#"+i.pid,o=e.setUrlParams(a,i.param);r.syncHistory&&"replaceState"in window.history&&window.history.replaceState(i.param,null,o)},x.removeLast=function(){var e=P.length-1;x.removeNext(e)},x.checkLoad=function(t){return e.array.compare(P,t,"pid")||e.array.compare(P,t,"url")||e.array.compare(P,t,"id")},O.add=function(e,t){return k[e]=t||{},k[e]},O.del=function(e){delete k[e]},O.get=function(e,t){return t?(k[e]||{})[t]:k[e]},O.save=function(){if(P.length>1){var e=i.html();E.set("cacheHtml",e),E.set("cacheHistory",P),E.set("hasCache","true")}},O.load=function(){var t=E.get("cacheHtml",0),n=E.get("cacheHistory",0),a=[];if(n.length>1){i.html(t),s=i.children(".bui-router-main"),R({name:e.history.getHash().pid});try{n.forEach((function(e,t){var n="string"==typeof e?JSON.parse(e):e;a.push(n)}));var o=a[a.length-1];o,loader.require(o.pid,(function(e){w[o.pid]=e||null})),M("back",(function(e){loader.require(e.target.pid,(function(t){w[e.target.pid]=t||null}))}))}catch(t){e.showLog(t)}P=a,F(),A(),h=!1,T=!0,O.clear()}},O.clear=function(){E.remove("cacheHistory"),E.remove("cacheHtml"),E.remove("hasCache")},C.add=function(e,t){return I[e]=t||{},I[e]},C.get=function(e,t){return t?(I[e]||{})[t]:I[e]};function U(n){var i=_typeof(n),a=null,o=s.attr("data-main");if("number"===i){var r=e.array.index(P,o,"id"),l=n<0?r+n:n;a={url:P[l]&&P[l].pid||""}}else"string"===i?a={url:n}:"object"===i&&(a=n);var c=t.extend(!0,{url:"",effect:"none",refresh:!1,syncHistory:!1,beforeLoad:null,loaded:null,callback:null,param:{}},a);if(!c.url)return console.error("没有找到该条记录"),!1;var u=e.array.get(P,o,"id"),d=u?u.pid:"",f=c.url;c.param;var p=null;if(c.url&&c.url.indexOf("?")>-1){var h=c.url.split("?");f=h[0],p=e.unit.keyStringToObject(h[1])}c.param=t.extend(!0,c.param,p);var g=e.history.get(d),m=e.history.get(f);if(m){var v=document.getElementById(g.id),b=document.getElementById(m.id);if(v&&(v.style.display="none"),b&&(b.style.display="block"),m.id&&s.attr("data-main",m.id),c.syncHistory){var y=window.location.origin+window.location.pathname+"#"+m.pid,w=e.setUrlParams(y,c.param);window.history.replaceState(null,null,w)}c.refresh&&loader.load({id:m.id,url:m.url,param:c.param,beforeLoad:c.beforeLoad,loaded:c.loaded,callback:c.callback})}else e.load(c);return this}var V={init:function(n){V.store=n.store||null,delete n.store,n=t.extend(!0,{},r,e.config.router,n),r=V.config=n;var l,u=e.history.getParams("url");if(u.module&&n.parseurl){var d=u.module;delete u.module;var h=e.setUrlParams(d,u);return window.location.href=window.location.origin+window.location.pathname+"#"+h,this}if(S=loader.map(n.indexModule),v&&"effect"in n&&P.forEach((function(e,t){e.effect=n.effect})),!n.id)return e.showLog("id 不能为空","bui.router.init"),!1;if(i=e.objId(n.id),!1===(n.beforeInit&&n.beforeInit.call(V,{target:i[0]})))return!1;if(o=bui.mask({appendTo:i,opacity:0,autoClose:!1}),a=e.loading(n.loading),s=i.children(".bui-router-main"),f=n.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",p=n.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",!s.length){var g=(l="",String(f).indexOf("%"),String(p).indexOf("%"),l+='<div class="bui-router-main">',l+="</div>");i.html(g),s=i.children(".bui-router-main")}return(n.width>0||String(n.width).indexOf("%")>-1)&&s.width(n.width),(n.height>0||String(n.height).indexOf("%")>-1)&&s.height(n.height),function(n){if(function(t){var n=E.get("hasCache",0);Boolean(n)&&r.reloadCache?O.load():function(t){try{var n=e.history.getHash();if(n.pid){if(n.pid.indexOf("http://")>-1||n.pid.indexOf("https://")>-1)return n.param.iframe=!0,void N({url:n.pid,param:n.param,iframe:!0});N({url:n.pid,param:n.param})}else N({url:r.indexModule.moduleName,param:n.param||{}})}catch(t){e.showLog(t,"bui.router.loadUrl")}}()}(),n.swipe&&function(n){var a=/hp-tablet/gi.test(navigator.appVersion),o="ontouchstart"in window&&!a,l=0,c=0,s=!1,u=null,d=null,f={x1:0,x2:0,y1:0,y2:0,direction:""};i.on("touchstart",(function(i){var a=i.originalEvent&&i.originalEvent.targetTouches||i.targetTouches,l=o?a[0]:i;f.x1=l.pageX,f.y1=l.pageY,s=t(i.target).closest(r.useScroll).length,P.length>1&&f.x1>0&&f.x1<n.distance&&(u=t("#".concat(x.getLast().id)),d=e.history.getPrev().id?t("#".concat(e.history.getPrev().id)):null)})),i.on("touchmove",(function(i){var a=i.originalEvent&&i.originalEvent.targetTouches||i.targetTouches,p=o?a[0]:i;f.x2=p.pageX,f.y2=p.pageY,a.length>1||i.scale&&1!==i.scale||(s=t(i.target).closest(r.useScroll).length,f.x2-f.x1>0&&!s&&i.preventDefault(),f.direction||(f.direction=e.swipeDirection(f.x1,f.x2,f.y1,f.y2)),"swipeleft"!==f.direction&&"swiperight"!==f.direction||(i.preventDefault(),i.stopPropagation()),l=Math.abs(f.x2-f.x1),c=Math.abs(f.y2-f.y1),"swiperight"===f.direction&&l>n.startDistance&&n.swipeBack&&(d&&d.css("display","block"),n.pageMove&&u&&u.css("transform","translateX(".concat(l,"px)")),i.preventDefault()))})),i.on("touchend",(function(i){(s=t(i.target).closest(r.useScroll).length,"swiperight"===f.direction&&f.x1>n.distance&&n.swipeBack&&(l=0),"swiperight"===f.direction&&l>n.swipeDistance)&&(!1!==(n.onBeforeSwipeRight&&n.onBeforeSwipeRight())&&n.swipeBack&&e.back({effect:r.backEffect||"none"}),n.onSwipeRight&&n.onSwipeRight(i),H.call(V,"swiperight"));"swipeleft"===f.direction&&l>n.swipeDistance&&(n.onSwipeLeft&&n.onSwipeLeft(i),H.call(V,"swipeleft")),"swipeup"===f.direction&&c>n.swipeDistance&&!s&&(n.onSwipeUp&&n.onSwipeUp(i),H.call(V,"swipeup")),"swipedown"===f.direction&&c>n.swipeDistance&&!s&&(n.onSwipeDown&&n.onSwipeDown(i),H.call(V,"swipedown")),l<n.swipeDistance&&(d&&d.css("display","none"),u&&u.css("transform","translateX(0)")),l=0,s=!1,f={x1:0,x2:0,y1:0,y2:0,direction:""},u=null,d=null,i.stopPropagation()}))}(n),window.addEventListener("beforeunload",(function(e){r.reloadCache&&O.save(),H.call(c,"beforeunload",{target:P[P.length-1]})})),n.hash)return window.addEventListener("hashchange",(function(t){var n=e.history.getHash(),i=""==n.pid||"undefined"==n.pid?n.errorPage||"main":n.pid,a=e.array.indexs(P,i,"pid"),o=a[a.length-1];i="wechat_redirect"==n.pid?"main":i;var r=sessionStorage.getItem("backEffect")||"";o>-1?(R({index:-(P.length-o-1||1),backEffect:r}),H.call(c,"popstate",{type:"back",prevTarget:P[o-1],target:P[o]})):(N({url:i,param:n.param,iframe:"true"==n.param.iframe,replace:!0}),H.call(c,"popstate",{type:"load",prevTarget:P[P.length-2],target:P[P.length-1]}))})),this;n.syncHistory&&"pushState"in window.history&&window.addEventListener("popstate",(function(t){var n=e.history.getHash(),i=""==n.pid?r.indexModule.moduleName:n.pid,a=D(i);if(e.array.index(P,i,"pid")>-1){var o=sessionStorage.getItem("backEffect");R(o?{index:a,param:n.param,effect:o}:{index:a,param:n.param}),sessionStorage.removeItem("backEffect"),H.call(c,"popstate",{type:"back",prevTarget:P[a-1],target:P[a]})}else N({url:i,param:n.param,iframe:"true"==n.param.iframe}),H.call(c,"popstate",{type:"load",prevTarget:P[P.length-2],target:P[P.length-1]})}))}(n),n.uid&&e.history.setUI&&e.history.setUI({uid:n.uid,ui:V}),H.call(this,"init",{target:i[0]}),n.inited&&n.inited.call(V,{target:i[0]}),V},option:function(t,n){return v=!0,e.option.call(V,t,n)},go:U,remove:function(t,n){var i=String(t),a=/\d+/.test(i)?parseInt(t):e.array.index(P,t,"pid"),o=a-1;a>-1&&s.children().eq(a).remove(),a>-1&&e.history.remove(a);var r=P[o>-1?o:a+1]||{};return s.attr("data-main",r.id),r.pid&&U(r.pid),this},get:function(e,t){return"object"===_typeof(t)?j[e]=t:"function"==typeof t&&(j[e]={beforeLoad:t}),this},config:r,data:{},on:M,off:function(t,n){return e.off.apply(V,arguments),this},trigger:H,load:N,resize:function(t){return(t=t||{}).width=t.width||r.width,t.height=t.height||r.height,window.viewport=e.viewport(),f=t.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",p=t.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",s.css({width:f,height:p}),H.call(this,"resize",{target:P[P.length-1]}),this},destroy:function(t){return"string"==typeof t&&"main"!==t?(loader.destroy(t),O.del(t),t in w&&delete w[t]):e.showLog("参数只能是字符串"),this},loadPart:function(e){var n=t.Deferred(),i=t.extend(!0,{},{id:"",url:"",param:{},loaded:null},e);return i.loaded=function(t){e.loaded&&e.loaded.call(V,t),n.resolve(t),H.call(V,"loadpart",t)},loader.load(i),n.promise()},replace:function(e){return N({url:(e=e||{}).url||"",param:e.param||{},replace:!0}),this},refresh:function(){var t=P.length-1,n=P[t],i=P.length>1?P[P.length-2]:null;return e.history.refresh(),H.call(V,"refresh",{prevTarget:i,target:n}),this},back:R,isLoad:function(e){var t;return e&&(t=e in w),t},$:function(t){var n=x.getLast(),i=document.getElementById(n.id)||document;return e.obj(t,i)},currentId:function(e){return x.getLast().id},currentPage:function(){var e=x.getLast();return document.getElementById(e.id)},currentModule:function(){return x.getLast()},getPageParams:function(){return x.getLast().param},getPartParams:function(t){return e.history.getComponentParam(t)},getHistory:x.get,preload:function(n){var i=t.Deferred(),a=function(t,a){return _(t.url,(function(i){var o=e.guid(),r=B(t.url).pid;$({id:o,content:i,pid:r});var l=[];O.add(r,{id:o,pid:r,template:i}),l.push(r),t.style&&"array"===e.typeof(t.style)?t.style.forEach((function(e,t){l.push(e)})):t.style&&"string"===e.typeof(t.style)&&l.push(t.style),t.script&&"array"===e.typeof(t.script)?t.script.forEach((function(e,t){l.push(e)})):t.script&&"string"===e.typeof(t.script)&&l.push(t.script),loader.import(l,(function(){H.call(V,"preloadafter",{prevTarget:null,target:null}),a&&a(n)}),(function(){H.call(V,"preloadafter",{prevTarget:null,target:null}),a&&a(n)}))}),(function(n){e.showLog(t.url+"请求失败"),i.reject(t.url)})),i.promise()};return n&&"object"===e.typeof(n)?"url"in n&&a(n,(function(){i.resolve(n)})):n&&"array"===e.typeof(n)&&n.forEach((function(e,t){t==n.length-1?"url"in e&&a(e,(function(){i.resolve(n)})):"url"in e&&a(e)})),i},initScroll:function(n){var i=x.getLast(),a=e.objId(i.id),o="object"===_typeof(n)?t(n):a.find(".bui-page");return o.length&&e.init({id:o,height:p}),this},history:{get:x.get,check:x.checkLoad,getLast:x.getLast,add:x.add,removeLast:x.removeLast,replace:x.replace}};return V}}(window.bui||{},window.libs),function(e,t){var n=function(){function n(i){_classCallCheck(this,n),this._default={log:!1,hasLife:!0,onBeforeInit:null,onInited:null},this._plugin=i||{name:"",depend:null,config:null,param:null,callback:null};var a=e.config.hasOwnProperty(this._plugin.name)?e.config[this._plugin.name]:null;this.config=t.extend(!1,{},this._default,this._plugin.config,a,this._plugin.param),this.handle={},this.initStatus=!1,this.reinitStatus=!1,this.widgets=Object.create(null),this.init()}return _createClass(n,[{key:"widget",value:function(e){return e&&e in this.widgets?this.widgets[e]:this.widgets}},{key:"init",value:function(n){var i=this,a=n||null;i.config=t.extend(!0,this.config,a);var o=i.config,r=o.hasLife&&o.onBeforeInit&&o.onBeforeInit.call(i,o);return o.log&&console.log("".concat(i._plugin.name," before init")),!1===r||(i._plugin.callback&&i._plugin.callback.call(i,o),o.log&&console.log("".concat(i._plugin.name," init")),o.hasLife&&o.onInited&&o.onInited.call(i,o),o.log&&console.log("".concat(i._plugin.name," after inited")),this.initStatus=!0,i.config.uid&&e.history.setUI&&e.history.setUI({uid:i.config.uid,ui:i})),i}},{key:"reinit",value:function(){return this.destroy(),this.init(),this.config.log&&console.log("".concat(this._plugin.name," reinit")),this}},{key:"destroy",value:function(t){this.beforeDestroy&&this.beforeDestroy(),this.beforeDestroy=null,this.widgets={},this.off(),this.initStatus=!1,t&&t.call(this);var n=this.config.uid;n&&(e.history.getLast().ui[n]=null);return this.config.log&&console.log("".concat(this._plugin.name," destroyed")),this}},{key:"prefix",value:function(t){return e.config.classNamePrefix+t}},{key:"showLog",value:function(t,n){n=n||"";var i="";return"object"==_typeof(t)&&"message"in t&&"name"in t?i=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(i=t),e.log&&console.error(n+" "+i),e.trace&&console.trace&&console.trace(),this}},{key:"option",value:function(n,i){if("object"!==e.typeof(n)&&void 0===i)return"string"==typeof n?this.config[n]:this.config;if("id"==n)return e.showLog("不允许修改控件的ID参数"),this;if(n&&"object"===e.typeof(n)){var a=t.extend(this.config,n);return this&&this.init(a)}if(this.config.hasOwnProperty(n)){var o={};o[n]=i;var r=t.extend(this.config,o);return instance&&instance.init(r)}return this}},{key:"emitter",get:function(){return e.emitter()}},{key:"on",get:function(){return this.emitter.on}},{key:"off",get:function(){return this.emitter.off}},{key:"trigger",get:function(){return this.emitter.trigger}}]),n}();e.extend=function(t){new(function(){function i(e){_classCallCheck(this,i),this.init(e)}return _createClass(i,[{key:"init",value:function(i){var a=i.name;return this.checkName(a)?(e[a]=function(e){return t.param=e,new n(t)},this):e[a]}},{key:"checkName",value:function(t){return t?!e.hasOwnProperty(t)&&(this.name=t,!0):(console.warn("插件名字不能为空"),!1)}}]),i}())(t)}}(window.bui||{},window.libs),t((function(e){!function(t,n){t.extend({name:"page",config:{uid:"",dialogid:"",url:"",param:null,script:"",appendTo:"",className:"bui-dialog-page",pageSuffix:".html",height:0,width:0,iframe:!1,openFirst:!0,closeFirst:!1,autoClose:!1,needRemove:!1,useBox:!1,syncHistory:!1,resize:!0,dragable:!1,dragback:!1,touch:{dragup:!0,swipeDistance:60,dragdown:!0,dragleft:!0,dragright:!0,moveType:"transform",direction:"xy"},title:"",buttons:null,mask:!1,life:!0,scroll:!1,needView:!1,needComponent:!0,navbarPosition:"bottomright",navbarDirection:"y",cache:!0,showToolbar:!0,mini:!1,max:!1,close:!1,autoload:!0,fullscreen:!0,effect:"pushInRight",onError:null,beforeClose:null,closed:null,beforeOpen:null,opened:null,beforeLoad:null,loaded:null},callback:function(i){var a=this,o=a.config,r="body"==a.appendTo?n:t.obj,l="",c=!1,s=(loader.map().modules,m(i.url)),u=a.widgets.dialog=t.dialog({autoinit:!1,navbarPosition:i.navbarPosition,navbarDirection:i.navbarDirection,showToolbar:i.showToolbar,onBeforeClose:i.beforeClose,mask:i.mask,onClose:i.closed,needRemove:i.needRemove}),d=!1,f=null;function p(e,n){var i="",a=n.showToolbar?function(e){var n="";n+='<div class="bui-dialog-toolbar">';var i=t.config.icon.mini?'<i class="'.concat(t.config.icon.mini,'"></i>'):'<i class="icon-mini">&#xe620;</i>',a=t.config.icon.max?'<i class="'.concat(t.config.icon.max,'"></i>'):'<i class="icon-max">&#xe617;</i>';return e.mini&&(n+='<span class="bui-dialog-miniicon">'.concat(i,"</span>")),e.max&&(n+='<span class="bui-dialog-maxicon">'.concat(a,"</span>")),e.close&&(n+='   <span class="bui-dialog-close"><i class="'+t.config.icon.close+'"></i></span>'),n+"</div>"}(n):"",o=n.title?'<div class="bui-dialog-head">'.concat(n.title,"</div>"):"";return i+="".concat(o,'<div class="bui-dialog-main">').concat(e,"</div>").concat(a)}function h(e){var n=loader.map().modules[s.module]||{};if(n.hide&&o.life){var i=t.hasRouter?t.history.getLast():{};n.hide({type:"page",target:i})}"function"==typeof e&&e.call(a,n.exports),o.closed&&o.closed.call(a,n)}function g(i,r){var l=t.history.getLast(),s=(loader.map().modules||{})[i];if(o.cache&&c&&!d)return!o.openFirst&&u.open(),"function"==typeof r&&r.call(a,s.exports),a;if(t.history.setPage({id:u.config.id,name:i,url:o.url,dialog:a,param:o.param}),loader.set(i,{props:o.param,$:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return n("#"+u.config.id).find(e)}))}),d=!1,s&&"function"==typeof s.loaded){var f=s.loaded&&s.loaded.call(e,s.exports)||s.exports;t.history.setPage({id:u.config.id,name:i,url:o.url,dialog:u,exports:f,param:o.param});var p=loader.map().modules[i]||{};return p.show&&o.life&&p.show({type:"page",target:l}),"function"==typeof r&&r.call(a,f),a.compile({id:u.config.id}),o.opened&&o.opened.call(a,f),!o.openFirst&&u.open(),c=!0,this}loader.require(i,(function(e){var n=loader.map().modules[i]||{};t.history.setPage({id:u.config.id,name:i,url:o.url,dialog:u,exports:e,param:o.param}),n.show&&o.life&&n.show({type:"page",target:l}),"function"==typeof r&&r.call(a,e),a.compile({id:u.config.id}),o.opened&&o.opened.call(a,e),c=!0}))}function m(e){var t=loader.map().modules,n={},i=e.indexOf(o.pageSuffix);return i>-1?(n.url=e,n.module=e.substr(0,i)):(n.url=t[e]&&t[e].template?t[e].template:e+o.pageSuffix,n.module=e),n}return a.init=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(i){var o,r,c,d,g,v,b,y,w;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=n.extend(!0,{},a.config,i)).onClose=function(){t.hasRouter&&o.syncHistory&&bui.back(),h()},s=m(o.url),r=o.dialogid||t.guid(),!o.iframe){e.next=14;break}return c=t.platform.isIos()||!o.scroll?'scrolling="no"':"",o.content='<iframe class="bui-router-iframe" src="'.concat(o.url,'" ').concat(c," ></iframe>"),delete(d=n.extend(!0,{},o)).uid,u.create(d),o.autoload&&u.open(),f=u.$("iframe"),o.loaded&&o.loaded.call(a,s),e.abrupt("return",a);case 14:if(o.script&&(g=o.script.indexOf(".js"),s.module=o.script.substr(0,g)),!1!==(o.beforeLoad&&o.beforeLoad.call(a,s))){e.next=18;break}return e.abrupt("return",this);case 18:if(o.id?(delete n.extend(!0,{},o).uid,u.init(o)):(o.dialogid=r,o.content="",delete(v=n.extend(!0,{},o)).uid,u=u.create(v)),b="","function"!=typeof s.url){e.next=24;break}b=s.url(),e.next=28;break;case 24:if("string"!=typeof s.url){e.next=28;break}return e.next=27,loader.importSync(s.url);case 27:b=e.sent;case 28:if("object"!==_typeof(b)){e.next=31;break}return o.onError&&o.onError.call(a,b),e.abrupt("return");case 31:return b=(b=t.unit.handleContent(b)||"").replace(/#module\.id/g,"#"+(o.id||r)),y="string"==typeof s.url?s.url:loader.get("pages/apps/service/trip/mapSearch").path,b=b.replace(/#module\.path\//g,y),l=p(b,o),w=o.id||r,u.render({id:w,content:l}),o.scroll?u.scroll(!0):u.scroll(!1),o.autoload&&a.open(),o.loaded&&o.loaded.call(a,s),e.abrupt("return",a);case 42:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a.compile=function(e){var t=n.extend(!0,{id:u.config.id,cacheHtml:!1,cache:!1,needComponent:o.needComponent,needView:o.needView},e);t.needView&&loader.views(t),t.needComponent&&loader.components(t)},a.show=function(e){return u&&u.show(e),this},a.hide=function(e){return u&&u.hide(e),this},a.reload=function(e){e=e||{};var i=o=n.extend(!1,a.config,o,e);if(i.param=e.param||{},i.iframe)return f&&f.attr("src",i.url),this;if(d=!0,s=m(i.url),i.script){var c=i.script.indexOf(".js");s.module=i.script.substr(0,c)}if(!1===(i.beforeLoad&&i.beforeLoad.call(a,s)))return this;"function"==typeof s.url?(res=s.url(),h(res)):"string"==typeof s.url&&loader.import(s.url,(function(e){"object"!==_typeof(e)?h(e):i.onError&&i.onError.call(a,e)}));var h=function(e){e=(e=t.unit.handleContent(e)||"").replace(/#module\.id/g,"#"+(u.config.id||i.dialogid));var n=s.url.substr(0,s.url.lastIndexOf("/")+1);e=e.replace(/#module\.path\//g,n),l=p(e,i),r("#"+(u.config.id||i.dialogid)).html(l),i.resize&&u.resize(i),i.scroll?u.scroll(!0):u.scroll(!1),g(s.module),i.loaded&&i.loaded.call(a,s)}},a.replace=function(e){return a.reload(e),a},a.toggle=function(e,t){return a.isOpen()?a.close(t):a.open(e),a},a.isOpen=u.isOpen,a.close=function(e){return!1===(i.beforeClose&&o.beforeClose.call(a))?this:(t.hasRouter&&o.syncHistory&&t.history.removeLast(o.syncHistory),o.closeFirst?(u.close((function(){a.trigger("close"),h(e)})),a):(h(e),u.close(),a.trigger("close"),a))},a.remove=function(e){return u.remove(e),a.trigger("remove"),a},a.open=function(e){if(!1===(o.beforeOpen&&o.beforeOpen.call(a)))return this;if(o.iframe)return u.open(e),a;var n={hide:a.close,show:a.open};return t.hasRouter&&o.syncHistory&&t.history.add({id:u.config.id,name:s.module,url:o.url,replace:!1,param:o.param||{},part:{},page:{},effect:"push",toggle:n,syncHistory:o.syncHistory}),loader.map({moduleName:s.module,id:u.config.id}),t.history.getLast().currentPage=u.config.id,o.openFirst?(u.open((function(){a.trigger("open"),g(s.module,e)})),a):(g(s.module,e),u.open(),a.trigger("open"),a)},a.setParam=function(e){var i=n.extend(!1,{},o.param,e);t.history.setPage({id:u.config.id,param:i})},a.minimize=u.minimize,a.maxmize=u.maxmize,a.revert=u.revert,a.resize=u.resize,a.top=u.top,a.fullscreen=u.fullscreen,a.isFullscreen=u.isFullscreen,a.scroll=u.scroll,a.init(o),a}})}(window.bui||{},window.libs)})),function(e,t){e.setUrlParams=function(t,n,i){i=0!=i,n="object"==_typeof(n)?n:{};var a=e.unit.objectToKeyString(n,i);return""==a?t:t.indexOf("?")>-1?t+"&"+a:t+"?"+a},e.getUrlParams=function(n){n=0!=n;var i=window.location.href,a=i.indexOf("?"),o={};if(a>-1){var r=i.substr(a+1);if(r.indexOf("?")>-1){var l=r.split("?"),c=l[0],s=l[1],u=e.unit.keyStringToObject(c,n),d=e.unit.keyStringToObject(s,n);o=t.extend(!0,u,d)}else o=e.unit.keyStringToObject(r,n)}return o},e.getUrlParam=function(e){var t=window.location.href,n=new RegExp("(^|&|.)"+e+"=([^&]*)(&|$)","i"),i=t.substr(1).match(n);return null!=i?decodeURIComponent(i[2]):null},e.typeof=function(e){var t=Object.prototype.toString.call(e).slice(8,-1);return t=t.toLowerCase()},e.setting=function(t,n){return"string"==typeof t&&"object"===_typeof(n)?e.config[t]=n:"string"==typeof t&&void 0===n?e.config[t]:e.config},e.cmd=function(t){var n=t.split(":")||[],i=e.history.getUI(n[0]);if(n.length>1){var a=[].slice.apply(arguments);a.shift();var o=i[n[1]];return o?o.apply(i,a):void e.showLog("找不到该实例的".concat(n[1],"方法"))}return i}}(window.bui||{},window.libs),function(e,t){e.array={},e.array.index=e.inArray=function(t,n,i){var a,o;"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t);for(var r=0;r<a.length;r++){var l=a[r];if((l&&l[i]||l)===o)return parseInt(r)}return-1},e.array.compare=e.compareArray=function(t,n,i){var a,o;"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t);for(var r=0;r<a.length;r++){var l=a[r],c=l&&l[i]||l;if("object"===_typeof(c)&&"object"===_typeof(o))try{if(JSON.stringify(c)===JSON.stringify(o))return!0}catch(e){if(c===o)return!0}else if(c===o)return!0}return!1},e.array.remove=e.removeArray=function(t,n,i){var a,o;return"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t||[]),e.array.delete(a,o,i),a},e.array.filter=e.filterArray=function(t,n,i){var a,o;t&&"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t);var r=[];for(var l in a)try{var c=a[l],s=c&&c[i]||c;new RegExp(o).test(s)&&r.push(c)}catch(t){e.showLog(t)}return r},e.array.indexs=e.indexArray=function(t,n,i){var a,o;"array"===e.typeof(t)?(a=t||[],o=n):(a=n||[],o=t);var r=[];for(var l in a){(a[l]&&a[l][i]||a[l])===o&&r.push(+l)}return r},e.array.excess=e.excessArray=function(t,n,i){var a;a="array"===e.typeof(t)?t||[]:n||[];var o={},r=[];for(var l in a)try{var c=a[l]&&a[l][i]||a[l];o[c]!==c&&(o[c]=c,r.push(a[l]))}catch(e){}return r},e.array.uniq=function(t,n){for(var i=[],a=0;a<t.length;a++){var o=void 0===n,r=t[a],l=o?r:r[n]||r;e.array.index(i,l,n)<0&&i.push(r)}return i},e.array.copy=e.copyArray=function(t,n,i){var a=[];if(n=n||0,i=i||t&&t.length,!t||"array"===e.typeof(t))return a=t.slice(),void 0!==n?a.splice(n,i):a},e.array.empty=function(t){if(!t||"array"===e.typeof(t))return t.splice(0,t.length)},e.array.replace=function(t,n){if(!(t&&"array"!==e.typeof(t)||n&&"array"!==e.typeof(n))){var i=[0,t.length].concat(n);return t.splice.apply(t,i)}},e.array.merge=function(t){var n;if(!t||"array"===e.typeof(t)){var i=arguments,a=i.length-1,o=i[a];if("string"==typeof o&&i.length>1){for(var r,l=a,c=[],s=function(){var n=Array.prototype.slice.call(i[u],0);t.forEach((function(t,i){var a=t[o]||t;"array"===e.typeof(n)&&n.forEach((function(e,i){var r=e[o]||e;if(a===r){for(var l in e)t[l]=e[l];n.splice(i,1)}}))})),c.push(n)},u=0;u<l;u++)s();return(r=e.array).merge.apply(r,[t].concat(c))}var d=(n=[t.length,0]).concat.apply(n,_toConsumableArray(Array.prototype.slice.call(arguments,1)));return t.splice.apply(t,d),t}},e.array.get=function(t,n,i){if(!t||"array"===e.typeof(t)){for(var a,o=i||"id",r=null,l=0;l<t.length;l++){((r=t[l])&&r[o]||r)===n&&(a=r)}return a}},e.array.getAll=function(t,n,i){t=t||[];var a=[],o=null;for(var r in t)try{var l=(o=t[r])&&o[i]||o;n&&"array"===e.typeof(n)?n.forEach((function(e,t){l===e&&a.push(o)})):l===n&&a.push(o)}catch(e){}return a},e.array.set=function(t,n,i,a){if(a=a||!0,!t||"array"===e.typeof(t)){var o=/\d/.test(n)&&"number"==typeof n;if(o&&void 0!==i){var r=t[n]||{};if(!0===a)return t.splice(n,1,i),t;if("object"===e.typeof(i))for(var l in i)r[l]=i[l];else"object"!==e.typeof(i)&&"string"==typeof a&&(r[a]=i);return t.splice(n,1,r),t}for(var c=0;c<t.length;c++){var s=t[c],u=void 0===a?s:s[a]||s;if(o?c===n:u===n){if("string"==typeof a){if(i&&"object"===e.typeof(i))for(var d in i)s[d]=i[d];else s[a]=i;t.splice(c,1,s)}else t.splice(c,1,i);return t}}return t}},e.array.setAll=function(t,n,i,a){if(!t||"array"===e.typeof(t))return t.filter((function(o,r){var l=void 0===a?o:o[a]||o;if(r==n||l===n)if(a){if(i&&"object"===e.typeof(i))for(var c in i)o[c]=i[c];else o[a]=i;t.splice(r,1,o)}else t.splice(r,1,i)})),t},e.array.delete=function(t,n,i){if(!t||"array"===e.typeof(t)){var a=[],o=e.array.copy(t);return n&&"array"===e.typeof(n)?n.forEach((function(e,t){r(void 0!==i&&e[i]||e)})):r(n),a}function r(e){for(var r=0,l=0;l<o.length;l++){var c=l-r,s=t.length!==o.length,u=s?t[c]||{}:t[l]||{},d=void 0!==i?u[i]:u,f="function"==typeof d?d.name.replace("bound ",""):d,p="function"==typeof e?e.name:e;if("object"===_typeof(d)&&"object"===_typeof(n))try{JSON.stringify(d)===JSON.stringify(n)&&(s?t.splice(c,1):t.splice(l,1),a.push(l),++r)}catch(e){}else d!==e&&f!==p||(s?t.splice(c,1):t.splice(l,1),a.push(l),++r)}}},e.array.deleteIndex=function(t,n){if(!t||"array"===e.typeof(t)){var i=[];return n&&"array"===e.typeof(n)?n.forEach((function(n,a){i.push(t[n]),e.array.remove(t,t[n])})):(i.push(t[n]),e.array.remove(t,t[n])),i}}}(window.bui||{}),function(e,t){e.storage=function(n){var i=1,a="",o="",r=null,l=null,c={size:i,reverse:!0,deep:!1,local:!0,uid:"",prefix:""},s={init:u,get:d,getAll:function(e){for(var t={},n=parseInt(e)||0,i=0;i<localStorage.length;i++){var a=localStorage.key(i);if(a.substr(o.length),o&&0===a.indexOf(o))try{var r=JSON.parse(l.getItem(a));t[a]=void 0!==e?r[n]:r}catch(e){t[a]=l.getItem(a)}if(""===o)try{t[a]=JSON.parse(l.getItem(a))}catch(e){t[a]=l.getItem(a)}}return t},set:function(t,n,r){t=o+t;var c=1==i?null:l.getItem(t),s=[],u="",d=r?n[r]:n;if(null===c){s.push(n),u=JSON.stringify(s);try{l.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{var f=JSON.parse(c);if(e.array.compare(f,d,r)){e.array.remove(f,d,r),f[a](n);try{u=JSON.stringify(f),l.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{f[a](n),f.length>i&&0!=i&&("unshift"==a?f.pop():f.shift());try{u=JSON.stringify(f),l.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}}return this},remove:function(t,n,i){if("string"!=typeof(t=o+t))return void e.showLog("要删除的字段名只能是字符串","bui.storage.remove");var a=d(t)||[];if("number"==typeof n){var r="number"==typeof i?i:1;a.splice(n,r);try{var c=JSON.stringify(a)||"";l.setItem(t,c)}catch(t){e.showLog(t.name+": "+t.message,"bui.storage.remove")}}else if("string"==typeof n){var s=e.array.remove(a,n,i);try{c=JSON.stringify(s)||"";l.setItem(t,c)}catch(t){e.showLog(t.name+": "+t.message,"bui.storage.remove")}}else l.removeItem(t);return this},clear:function(){if(o)for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);0===t.indexOf(o)&&l.removeItem(t)}else l.clear();return this}};function u(n){var u;return"number"!=typeof n&&"string"!=typeof n||(n={size:n}),u=r=t.extend(!0,c,n),i=+u.size,o=u.prefix||"",a=u.reverse?"push":"unshift",l=u.local?localStorage:sessionStorage,u.uid&&e.history.setUI&&e.history.setUI({uid:u.uid,ui:s}),this}function d(t,n,i){t=o+t;var a,c=l.getItem(t)||"";try{a=r.deep?c&&e.unit.stringToJson(c):c&&JSON.parse(c)}catch(t){a=c,e.showLog(t.name+": "+t.message,"bui.storage.get")}if("number"==typeof n&&i)a=a&&a[n]&&a[n][i]||void 0;else if("string"==typeof n){var s=e.array.index(a,n,i);a=a&&a[s]}else"number"==typeof n&&(a=a&&a[n]||void 0);return a}return u(n),s}}(window.bui||{},window.libs),function(e,t){e.platform=function(){var e=navigator.userAgent;function t(){return n()||i()||a()}function n(t){return/(Android|Linux)/i.test(e)}function i(t){return/(iPhone)/i.test(e)}function a(t){return/(iPad)/i.test(e)}return{isAndroid:n,isIphone:i,isIpad:a,isIos:function(t){return/(iPhone|iPad|iOS)/i.test(e)},isWeiXin:function(t){return/(micromessenger)/i.test(e)},isPC:function(){return!t()},isMobile:t,isWeiXinMini:function(e){return"miniprogram"===window.__wxjs_environment},isBingotouch:function(t){return/(crosswalk)/i.test(e)},isMac:function(){return/macintosh;.+mac os x/i.test(e)},isIE:function(t){return/(trident)/i.test(e)},isIphoneX:function(e){var t=!1,n=375==window.screen.width&&812==window.screen.height,i=414==window.screen.width&&896==window.screen.height,a=390==window.screen.width&&844==window.screen.height,o=393==window.screen.width&&852==window.screen.height,r=428==window.screen.width&&926==window.screen.height,l=430==window.screen.width&&932==window.screen.height;return(n||i||a||o||r||l)&&(t=!0),t},isIphoneFull:function(e){var t=!1,n=window.screen.width>=375&&window.screen.width<=430,i=window.screen.height>=812&&window.screen.height<=926;return n&&i&&(t=!0),t},isWindow:function(t){return/Windows NT/i.test(e)}}}()}(window.bui||{}),function(e,t){e.date={},e.date.format=function(e,t){if(null==e)return"";var n=this.convert(e);t=t||"yyyy-MM-dd";var i={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[a]:("00"+i[a]).substr((""+i[a]).length)));return t},e.date.convert=function(e,t){if(e&&e.constructor==Date)return e;if("number"==typeof e&&13===String(e).length)return new Date(e);e=String(e);var n=new Date,i=n.getFullYear(),a=n.getMonth()+1,o=n.getDate();if((e=e.replace(/[-|年|月]/gim,"/").replace(/[时|分|秒|小时|分钟]/gim,":").replace(/^(\d{4}\/\d+?)($|\s)/,(function(e,t){return t+"/1"})).replace(/[日|号]/gim,"").replace(/^(\d{1,2}\/\d{1,2}?)($|\s)/,(function(e,t){return n.getFullYear()+"/"+t}))).indexOf("T")>-1&&-1==e.indexOf("GMT")){var r=(e=e.replace("T"," ")).indexOf(".")>-1?e.split("."):[e];return new Date(r[0])}if(e.indexOf("GMT")>-1){var l=(r=e.split(" "))[3]+"/"+{Jan:"1",Feb:"2",Mar:"3",Apr:"4",May:"5",Jun:"6",Jul:"7",Aug:"8",Sep:"9",Oct:"10",Nov:"11",Dec:"12"}[r[1]]+"/"+r[2]+" "+r[4];return new Date(l)}return e.indexOf("/")<0&&e.indexOf(":")>-1&&(e=i+"/"+a+"/"+o+" "+e),4===e.length?e+="/1/1 00:00:00":"MM"===t||"M"===t?e=i+"/"+e+"/1 00:00:00":"dd"!==t&&"d"!==t||(e=i+"/"+a+"/"+e+" 00:00:00"),new Date(e)},e.date.after=function(e,t,n){t=0===t?0:t||1;var i=this.convert(e).getTime()+1e3*parseInt(t)*3600*24;return this.format(i,n||"yyyy-MM-dd")},e.date.afterTime=function(e,t,n){var i=0===t?0:t||30,a=this.format(new Date,"yyyy/MM/dd")+" "+e,o=new Date(a).getTime()+1e3*i*60;return this.format(o,n||"hh:mm")},e.date.count=function(t,n,i){var a,o;switch(i){case"number":a=t,o=n;break;case"hour":var r=this.format(new Date,"yyyy/MM/dd"),l=r+" "+t,c=this.convert(l),s=r+" "+n,u=this.convert(s);a=c.getTime(),o=u.getTime();break;default:a=this.convert(t).getTime(),o=this.convert(n).getTime()}var d=a-o;d=Math.abs(d);var f=parseInt(d/1e3/3600/24,10),p=parseInt(d/1e3/3600%24,10),h=parseInt(d/1e3/60%60,10),g=parseInt(d/1e3%60,10);return{value:d,day:f,hour:p,minute:h,second:g,tip:"".concat(f,"天 ").concat(e.unit.fixZero(p),":").concat(e.unit.fixZero(h),":").concat(e.unit.fixZero(g))}},e.date.countMonth=function(e){var t=this.convert(e),n=t.getMonth()+1;return t.setMonth(n),t.setDate(0),t.getDate()},e.date.toWeek=function(e,t){var n=null;if(1===t)n=["周日","周一","周二","周三","周四","周五","周六"];else n=t||["星期天","星期一","星期二","星期三","星期四","星期五","星期六"];return n[this.convert(e).getDay()]},e.date.today=function(e){return e=e||"M-d",this.format(new Date,e)},e.date.fromnow=function(e){var t=+new Date,n=this.convert(e).getTime(),i="",a=this.count(t,n,"date"),o=t>n?"前":"后";return a.day?i=a.day+"天"+o:a.hour?i=a.hour+"小时"+o:a.minute?i=a.minute+"分钟"+o:a.second&&(i=a.second+"秒"+o),i}}(window.bui||{}),function(e,t){e.touch=function(n){var i=t.extend(!0,{},{id:"",uid:"",children:"",handle:"",stopHandle:"",scrollEl:".bui-page main,.bui-dialog-main,.bui-scroll,.bui-tab-main>ul>li",moveEl:"current",moveType:"position",direction:"xy",stopPropagation:!1,preventDefault:!1,useScroll:!0,swipeDistance:60,zIndex:10,dragable:!1,dragup:!0,dragdown:!0,dragleft:!0,dragright:!0,reset:!1,swipeup:!0,swipedown:!0,swipeleft:!0,swiperight:!0,onLongtap:null,longtapTime:1.5,onSwipe:null,onSwipeup:null,onSwipedown:null,onSwipeleft:null,onSwiperight:null,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeTouchcancel:null,onTouchstart:null,onTouchmove:null,onTouchend:null,onTouchcancel:null},n),a=null,o=null,r=null,l=null,c=!1,s=[],u=null,d=0,f=0,p={x1:0,x2:0,y1:0,y2:0,distanceX:0,distanceY:0,lastX:0,lastY:0,offsetLeft:0,offsetTop:0,parentOffsetLeft:0,parentOffsetTop:0,direction:""},h=null,g=!1,m=null,v={},b={init:y,touchstart:j,touchmove:N,touchend:B,touchcancel:_,swipe:I,swipeleft:T,swiperight:O,swipeup:C,swipedown:S,getxy:w,move:A,reset:R,isScale:E,dragable:F,longtap:k,off:function(e,t){if("click"===(t=t||i.children,e))o.off(e,t);else o.off(a.touchstart,t).off(a.touchmove,t).off(a.touchend,t).off(a.touchcancel,t);return this}};function y(n){a=function(){var t={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};e.platform.isPC()&&(t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseleave"});return t}();var c=i=t.extend(!0,{},i,n);if(o=e.$(c.id),u=o.find(c.scrollEl),r=c.children?o.find(c.children):null,l=o.parent(),(m=r||o).length){if(m.css("z-index",c.zIndex),w(m),l.css("position"),"transform"===c.moveType){var s=P(l);l.css({transform:"translate(".concat(s.x,"px,").concat(s.y,"px)")})}return!c.dragable&&c.onSwipe&&I(c.children,c.onSwipe),!c.dragable&&c.onSwipeleft&&T(c.children,c.onSwipeleft),!c.dragable&&c.onSwiperight&&O(c.children,c.onSwiperight),!c.dragable&&c.onSwipeup&&C(c.children,c.onSwipeup),!c.dragable&&c.onSwipedown&&S(c.children,c.onSwipedown),c.onLongtap&&k(c.onLongtap),F(c),c.uid&&e.history.setUI&&e.history.setUI({uid:c.uid,ui:b}),this}console.warn("请检查下选择器",c.id,c.children)}function w(t){var n=t?e.$(t):r||o;return"position"==i.moveType?{x:parseFloat(n.css("left")),y:parseFloat(n.css("top"))}:P(n)}function x(e,t,n){return"function"==typeof t?(n=t,t=e):t=t||e,v[e]||(v[e]=v[e]||[]),v[e].push(n),this}function k(e,t){return x("longtap",e,t),this}function I(e,t){return x("swipe",e,t),this}function T(e,t){return x("swipeleft",e,t),this}function O(e,t){return x("swiperight",e,t),this}function C(e,t){return x("swipeup",e,t),this}function S(e,t){return x("swipedown",e,t),this}function P(e){var t={},n=(e||o).css("transform")||"",i=n.indexOf("translateY"),a=n.match(/(\-?[0-9]\d*\.?\d*)|(0\.\d*[0-9])/g);return t.x=-1===i&&a&&a[0]||0,t.y=0===i?a&&a[0]||0:a&&a.length>1?a[1]:0,t.x=parseFloat(t.x),t.y=parseFloat(t.y),t}function L(t,n,i){if(t&&"array"===e.typeof(t)&&t.length)for(var a in t){t[a].call(b,n,i)}return this}function j(n,l){return n=n||i.children,o.off(a.touchstart,n).on(a.touchstart,n,(function(n){c=!0;var a=n.touches?n.touches[0]:n,s=t(this).parent();p.x1=a.clientX,p.y1=a.clientY,p.direction="",p.offsetLeft=this.offsetLeft,p.offsetTop=this.offsetTop,p.parentOffsetLeft=s[0].offsetLeft,p.parentOffsetTop=s[0].offsetTop;var u=w("current"==i.moveEl&&r?r:o);if(d=u.x,f=u.y,p.lastX=d,p.lastY=f,h&&(clearTimeout(h),g=!1),h=setTimeout((function(){g=!0,c=!1,i.onLongtap&&i.onLongtap.call(b,n,p),L(v.longtap,n,p)}),500*i.longtapTime),E(n))return c=!1,!1;if(i.stopPropagation&&n.stopPropagation(),!1===(i.onBeforeTouchstart&&i.onBeforeTouchstart.call(b,n,p)))return c=!1,!1;if(i.stopHandle&&e.unit.checkTargetInclude(n.target,i.stopHandle))c=!1;else{if(!i.handle||e.unit.checkTargetInclude(n.target,i.handle))return!1===(l&&l.call(b,n,p))?(c=!1,!1):void 0;c=!1}})),this}function E(e){return!!(e.touches&&e.touches.length>1||e.scale&&1!==e.scale)}function N(t,n){return t=t||i.children,o.off(a.touchmove,t).on(a.touchmove,t,(function(t){if(c){var a=t.touches?t.touches[0]:t;if(p.x2=a.clientX,p.y2=a.clientY,p.distanceX=p.x2-p.x1,p.distanceY=p.y2-p.y1,p.lastX=p.offsetLeft+("position"==i.moveType?0:d)+p.distanceX,p.lastY=p.offsetTop+("position"==i.moveType?0:f)+p.distanceY,(h&&Math.abs(p.distanceX)>1||Math.abs(p.distanceY)>1)&&(clearTimeout(h),h=null,g=!1),p.direction||(p.direction=e.swipeDirection(p.x1,p.x2,p.y1,p.y2)),i.stopPropagation&&t.stopPropagation(),!1===(i.onBeforeTouchmove&&i.onBeforeTouchmove.call(b,t,p)))return!1;if(!1===(n&&n.call(b,t,p)))return!1}})),this}function B(e,t){return e=e||i.children,o.off(a.touchend,e).on(a.touchend,e,(function(e){if(!1===(i.onBeforeTouchend&&i.onBeforeTouchend.call(b,e,p)))return!1;if(g)return!1;h&&(clearTimeout(h),h=null,g=!1);var n=Math.abs(p.distanceX)>i.swipeDistance,a=Math.abs(p.distanceY)>i.swipeDistance;switch(p.direction){case"swipeleft":!i.dragable&&n&&i.swipeleft&&L(v.swipeleft,e,p);break;case"swiperight":!i.dragable&&n&&i.swiperight&&L(v.swiperight,e,p);break;case"swipeup":!i.dragable&&a&&i.swipeup&&L(v.swipeup,e,p);break;case"swipedown":!i.dragable&&a&&i.swipedown&&L(v.swipedown,e,p)}!i.dragable&&(n||a)&&L(v.swipe,e,p),(!n||!a)&&i.reset&&R(),s.push(p),i.stopPropagation&&e.stopPropagation(),t&&t.call(b,e,p),D()})),this}function R(e){return t.extend(!0,{x:d,y:f,animate:!0,callback:null},e),A({x:(p={x1:0,x2:0,y1:0,y2:0,distanceX:0,distanceY:0,lastX:d=0,lastY:f=0,offsetLeft:0,offsetTop:0,parentOffsetLeft:0,parentOffsetTop:0,direction:""}).lastX,y:p.lastY,animate:!0,callback:function(){"position"==i.moveType?m.css({left:p.lastX+"px",top:p.lastY+"px"}):m.css("transform","translate(".concat(p.lastX,",").concat(p.lastY,")"))}}),s=[],c=!1,this}function D(){return d=parseFloat(p.lastX),f=parseFloat(p.lastY),p={x1:0,x2:0,y1:0,y2:0,distanceX:0,distanceY:0,lastX:d,lastY:f,offsetLeft:0,offsetTop:0,parentOffsetLeft:0,parentOffsetTop:0,direction:""},c=!1,this}function _(e,t){return e=e||i.children,o.off(a.touchcancel,e).on(a.touchcancel,e,(function(e){i.onTouchcancel&&i.onTouchcancel.call(b,e,p),c&&(D(),t&&t.call(b,e,p))})),this}function F(e){var n=t.extend(!0,{},i,{dragable:!0},e),a=u&&u[0]||null;return j(n.children,(function(e,i){if(0==(n.onBeforeDragstart&&n.onBeforeDragstart.call(b,e,i)))return c=!1,!1;var o=a&&a.scrollHeight>a.offsetHeight&&t(e.target).parents(n.scrollEl).length,r=a&&a.scrollWidth>a.offsetWidth&&t(e.target).parents(n.scrollEl).length;n.useScroll&&o&&(c=!1),n.useScroll&&r&&(c=!1),n.dragable&&n.onDragstart&&n.onDragstart.call(b,e,i)})),N(n.children,(function(e,t){return 0==(n.onBeforeDragmove&&n.onBeforeDragmove.call(b,e,t))?(c=!1,!1):(n.dragup||"swipeup"!==t.direction)&&(n.dragdown||"swipedown"!==t.direction)&&(n.dragleft||"swipeleft"!==t.direction)&&(n.dragright||"swiperight"!==t.direction)?(n.x=d+t.x2-t.x1,n.y=f+t.y2-t.y1,n.animate=!1,n.dragable&&(n.dragup||n.dragdown||n.dragleft||n.dragright)&&A(n),void(n.dragable&&n.onDragmove&&n.onDragmove.call(b,e,t))):(c=!1,!1)})),B(n.children,(function(e,t){if(0==(n.onBeforeDragend&&n.onBeforeDragend.call(b,e,t)))return!1;n.dragable&&n.onDragend&&n.onDragend.call(b,e,t)})),_(n.children,(function(e,t){n.dragable&&n.onDragcancel&&n.onDragcancel.call(b,e,t)})),this}function A(n){var a=t.extend(!0,i,{animate:!0},n),l="current"==a.moveEl&&r?r:o;l=n.el?e.$(n.el):l;var c="";switch(c=a.animate?a.transition||"all 300ms ease":"none 0ms",a.direction){case"x":"position"==a.moveType?l.css({"-webkit-transition":c,transition:c,position:"absolute",left:a.x+"px"}):l.css({"-webkit-transition":c,transition:c,"-webkit-transform":"translateX(".concat(a.x,"px)"),transform:"translateX(".concat(a.x,"px)")});break;case"y":"position"==a.moveType?l.css({"-webkit-transition":c,transition:c,position:"absolute",top:a.y+"px"}):l.css({"-webkit-transition":c,transition:c,"-webkit-transform":"translateY(".concat(a.y,"px)"),transform:"translateY(".concat(a.y,"px)")});break;default:"position"==a.moveType?l.css({"-webkit-transition":c,transition:c,position:"absolute",left:a.x+"px",top:a.y+"px"}):l.css({"-webkit-transition":c,transition:c,"-webkit-transform":"translate(".concat(a.x,"px,").concat(a.y,"px)"),transform:"translate(".concat(a.x,"px,").concat(a.y,"px)")})}a.animate?l.one("webkitTransitionEnd",(function(){l.css({"-webkit-transition":"none",transition:"none"}),a.callback&&a.callback.call(b,a)})):a.callback&&a.callback.call(b,a)}return y(i),b}}(window.bui||{},window.libs),function(e,t){e.animate=function(n){if("object"===_typeof(n)&&n.id)n=n||{};else{var i=n||"";(n={}).id=i}var a,o,r,l,c={origin:function(e){var n=String(e);return a.each((function(i,a){var o=t(a),r=void 0===e?o.attr("anim-origin"):n;o.css({"-webkit-transform-origin":r,"transform-origin":r})})),this},transition:m,property:function(e,n){return new Promise((function(i,o){var r={};"object"===_typeof(e)?(r=e,n=""):"string"==typeof e&&(r[e]=n||""),a.each((function(e,n){var o=t(n);o.css(r),"none"!=f&&o.one("webkitTransitionEnd",(function(){e==h&&i.call(c,a)}))}))}))},open3D:function(e){return new Promise((function(t,n){e=parseFloat(e)||100,o=!0,a.parent().css({perspective:e+"px"})}))},transform:function(e,n){return new Promise((function(i,o){"string"==typeof e?a.each((function(o,r){var l=t(r);l.css({"-webkit-transform":e,transform:e}),"none"!=f&&l.one("webkitTransitionEnd",(function(){o==h&&(n&&n.call(c,a),i.call(c,a))}))})):o.call(c,a)}))},start:O,restart:k,stop:function(e){return new Promise((function(n,i){a.each((function(i,o){var r=t(o);r.css({"-webkit-transform":"",transform:""}),"none"!=f?r.one("webkitTransitionEnd",(function(){i==h&&(f="",e&&e.call(c,a),n.call(c,a))})):i==h&&(e&&e.call(c,a),n.call(c,a))})),b()}))},looping:w,loop:w,delay:x,none:v,clear:b,left:function(e){var t=Math.abs(parseFloat(e));e="string"==typeof e&&e.indexOf("%")>-1?"-"+e:r?-t/100+"rem":-t+"px";var n="translateX("+e+")";return l.push(n),u.push(n),this},right:function(e){var t=Math.abs(parseFloat(e));"string"==typeof e&&e.indexOf("%")>-1||(e=r?t/100+"rem":t+"px");var n="translateX("+e+")";return l.push(n),u.push(n),this},up:function(e){var t=Math.abs(parseFloat(e));e="string"==typeof e&&e.indexOf("%")>-1?"-"+e:r?-t/100+"rem":-t+"px";var n="translateY("+e+")";return l.push(n),u.push(n),this},down:function(e){var t=Math.abs(parseFloat(e));"string"==typeof e&&e.indexOf("%")>-1||(e=r?t/100+"rem":t+"px");var n="translateY("+e+")";return l.push(n),u.push(n),this},scale:function(e){var t=String(e),n="scale("+(e=t.indexOf(",")>-1?t:e+",1")+")";return l.push(n),u.push(n),this},scaleX:function(e){var t="scaleX("+(e=String(e))+")";return l.push(t),u.push(t),this},scaleY:function(e){var t="scaleY("+(e=String(e))+")";return l.push(t),u.push(t),this},rotate:function(e){var t=String(e),n="rotate("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},rotateX:function(e){var t=String(e),n="rotateX("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},rotateY:function(e){var t=String(e),n="rotateY("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},skew:function(e){var n=String(e),i=[];n.indexOf(",")>-1?(i=n.split(","),e="",t.each(i,(function(t,n){t<2&&(e+=n.indexOf("deg")>-1?","+n:","+n+"deg")})),e=e.substr(1)):e=n.indexOf("deg")>-1?n:n+"deg,0";var a="skew("+e+")";return l.push(a),u.push(a),this},skewX:function(e){var t=String(e),n="skewX("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},skewY:function(e){var t=String(e),n="skewY("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},reversestart:C,reverse:S,revert:y,widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:g},s=c.config=t.extend(!0,{},e.config.animate,{id:"",uid:"",zoom:!0,open3D:!1,times:99999,transition:"all 300ms ease-out",clear:!1,animates:[]},n),u=[],d=[];e.guid();var f=s.transition,p=[],h=0;function g(n){var i=t.extend(!0,s,n);if(i.id)return a=e.obj(i.id),m(),a.each((function(e,n){var i=t(n);p[e]={},p[e].width=i.css("width"),p[e].height=i.css("height"),p[e].padding=i.css("padding"),p[e].margin=i.css("margin"),p[e].border=i.css("border"),p[e].opacity=i.css("opacity"),p[e].color=i.css("color"),p[e].background=i.css("background"),p[e]["box-shadow"]=i.css("box-shadow"),p[e].transform=i.css("transform")})),o=i.open3D,r=i.zoom,l=i.animates||[],s=c.config=i,i.uid&&e.history.setUI&&e.history.setUI({uid:i.uid,ui:c}),this;e.showLog("animate id不能为空","bui.animate")}function m(e,n){return new Promise((function(i,o){f="number"==typeof e?"all "+e+"ms "+(n||"ease"):0==e||"none"==e?"none":1==e?s.transition:e||s.transition;var r=[];a.length&&a.each((function(n,i){var a=t(i),o=i.getAttribute("anim-delay")||"0ms",l=o&&/\d+$/.test(o)?o+"ms":o,c=i.getAttribute("anim-transition")||0,s=c&&/\d+$/.test(c)?c+"ms":c,u=void 0===e&&s||f,d=u.match(/\d+/g)[0]||300;r.push({index:n,time:parseInt(d)});var p=u.split(" ").length>3?u:u+" "+l;a.css({"-webkit-transition":p,transition:p})})),h="object"===_typeof(h=r.reduce((function(e,t){return e.time>t.time?e.index:t.index})))?h.index:h,i.call(c,a)}))}function v(){return new Promise((function(e,n){a.each((function(n,i){t(i).css({"-webkit-transition":"none",transition:"none"}),n==h&&e.call(c,a)}))}))}function b(){return l=[],u=[],d=[],I=0,this}function y(e){return new Promise((function(n,i){b(),a.each((function(i,o){t(o).css({"-webkit-transform":"",transform:""}),i==h&&(e&&e.call(c,a),n.call(c,a))}))}))}function w(e,n){var i={times:s.times||99999,type:"normal",delay:10,frames:[]};return new Promise((function(o,r){var l="number"==typeof e?t.extend(!0,i,{times:e}):t.extend(!0,i,e),s=l.times,u=l.type,d="object"===_typeof(n)&&n||l.frames;function f(e){return p.apply(this,arguments)}function p(){return(p=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return e.next=4,S();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return g.apply(this,arguments)}function g(){return(g=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return e.next=4,O();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t)){e.next=7;break}return e.next=4,n(i);case 4:i++,e.next=1;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e,t){w.apply(this,arguments)}(s,function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,r,p;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=0;n<d.length;n++)i=d[n],t==i.loop-1&&i.before&&i.before.call(c,a,t);e.t0=u,e.next="reverse"===e.t0?4:"restart"===e.t0?7:"reversestart"===e.t0?10:(e.t0,13);break;case 4:return e.next=6,h();case 6:case 9:case 12:case 15:return e.abrupt("break",16);case 7:return e.next=9,m();case 10:return e.next=12,b();case 13:return e.next=15,f();case 16:for(r=0;r<d.length;r++)p=d[r],t==p.loop-1&&p.after&&p.after.call(c,a,t);if(t==s-1&&o.call(c,a),!l.delay){e.next=21;break}return e.next=21,x(l.delay);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}function x(e){return new Promise((function(t,n){var i="number"==typeof(e=e||500)?e:parseInt(e);setTimeout((function(){t.call(c,a)}),i)}))}function k(e){return new Promise((function(e,t){v(),y(),setTimeout(_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m();case 2:return t.next=4,O();case 4:e.call(c,a);case 5:case"end":return t.stop()}}),t)}))),100)}))}g(s);var I=0;function T(){var e={},n=this,i=t(n);["left","right","up","down","scale","scale-x","scale-y","rotate","rotate-x","rotate-y","skew","skew-x","skew-y","origin"].forEach((function(e,t){var i=n.getAttribute("anim-".concat(e)),a=e.replace("-x","X").replace("-y","Y");i&&c[a]&&c[a](i)})),["width","height","border","padding","margin","opacity","color","background","box-shadow"].forEach((function(t,i){var a=n.getAttribute("anim-".concat(t));if(a){switch(t){case"width":case"height":case"padding":case"margin":a=/(.+(?=[rem,px,em,%]$))/.test(a)?a:r?a/100+"rem":a+"px"}e[t]=a}}));var a=o?l.join("")+"translateZ(0)":l.join(""),s={"-webkit-transform":a,transform:a},u=t.extend(!0,{},s,e);i.css(u)}function O(e){return new Promise((function(n,i){var o=null,r=null,u=null;"object"===_typeof(e)?(r=e.beforeAnimate||null,u=e.onAnimate||null,o=e.callback||null):"function"==typeof e&&(o=e),r&&r.call(c,a),a.each((function(e,i){var r=t(i),f=t(i).css("transition");T.call(i);try{d[I]=[],d[I].push(l.join("")),s.clear&&(l=[]),I++}catch(e){}f.indexOf("none")<0?(u&&u.call(c,a),r.one("webkitTransitionEnd",(function(){e==h&&(o&&o.call(c,a),n.call(c,a))}))):e==h&&(u&&u.call(c,a),o&&o.call(c,a),n.call(c,a))}))}))}function C(){return new Promise((function(e,t){v(),O(),setTimeout(_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m();case 2:return t.next=4,S();case 4:e.call(c,a);case 5:case"end":return t.stop()}}),t)}))),100)}))}function S(e){return new Promise((function(e,n){var i=0,o=d.reverse();m(),function n(r){r[i];var l=r[i+1]||[];a.each((function(r,s){var u=t(s);u.css(p[r]),u.one("webkitTransitionEnd",(function(){l&&l.length?n(o):r==h&&(e.call(c,a),i=0,d=[])}))})),i++}(o)}))}return c}}(window.bui||{},window.libs),function(e,t){e.btn=function(n){var i,a,o,r,l={},c={load:function(n){var s=0;i.off("click.bui",r).on("click.bui",r,(function(i){var r=t(this),u=l.beforeCallback||l.beforeLoad;if(!1===(u&&u.call(c,i)))return i.preventDefault(),i.stopPropagation(),!1;var d=n||r.attr("href"),f=r.attr("target"),p="true"==r.attr("iframe"),h="true"==r.attr("firstAnimate"),g=r.attr("disabled"),m=r.hasClass("disabled")||""==g||"true"==g||"disabled"==g;if(d&&!m&&!(d&&d.indexOf("javascript:")>-1)){var v=r.attr("param")||"",b=v&&v.indexOf("{")>-1&&v.indexOf("}")>-1?JSON.parse(r.attr("param")):{};(r.attr("progress")?"false"!=r.attr("progress"):a)&&e.loading({autoTrigger:!0,display:"block",opacity:0,timeout:l.timeout});var y=+new Date;if(y-s<350)return!1;s=y;var w={url:d,param:b,replace:o,firstAnimate:h,iframe:p};return"_blank"==f?e.run({id:d,data:b}):e.load(w),i.preventDefault(),i.stopPropagation(),!1}}))},submit:function(n,a){a=a||{};var o=null;l.id&&l.handle?i.off("click.bui",r).on("click.bui",r,c):i.click(c);function c(i){if(!1===(l.beforeCallback&&l.beforeCallback.call(this,i)))return i.preventDefault(),i.stopPropagation(),!1;var r=this,c=t(r).css("background-color");if(!t(this).hasClass("disabled")&&"true"!=t(this).attr("disabled")){var s="none"==c?"#fff":c;if(a.appendTo=r,a.background=a.background||s,a.display=a.display||"inline",a.width=a.width||15,a.height=a.height||15,a.text=a.text||"加载中",a.autoClose=1==a.autoClose,a.autoTrigger=0!=a.autoTrigger,o){if(o.isLoading())return;o.show()}else o=e.loading(a);return n&&n.call(r,o,i)}}},click:function(e){var n=0;l.id&&l.handle?i.off("click.bui",r).on("click.bui",r,a):i.click(a);function a(i){if(!1===(l.beforeCallback&&l.beforeCallback.call(this,i)))return i.preventDefault(),i.stopPropagation(),!1;if(!t(this).hasClass("disabled")&&"true"!=t(this).attr("disabled")){var a=+new Date;return!(a-n<350)&&(n=a,e&&e.call(this,i))}}},off:function(){return i.off("click.bui",r),this}};return function(n){n&&"object"===e.typeof(n)?(l.id=n.id||"",l.handle=n.handle||"",l.progress="progress"in n&&n.progress,l.replace="replace"in n&&n.replace,l.timeout=n.timeout||3e3,l.beforeCallback=n.beforeCallback||null,i=t(l.id)):"string"==typeof n&&(l.id=n||"",l.handle="",l.progress=!1,l.replace=!1,l.timeout=3e3,l.beforeCallback=null,i=e.obj(l.id));r=l.handle,a=l.progress,o=l.replace}(n),c}}(window.bui||{},window.libs),function(e,t){e.mask=function(n){var i={id:"",uid:"",appendTo:"",className:"",opacity:.3,background:"",zIndex:100,autoTrigger:!1,autoClose:!1,onBeforeInit:null,onInited:null,callback:null},a={name:"mask",handle:{},on:function(t,n){return e.on.apply(a,arguments),this},off:y,hide:b,show:function(t){if(h)return;(d=e.objId(l))&&d.length?(d.css("display","block"),!p&&u.css("position","relative"),s=!0):m(o);return w.call(a,"show"),this},isShow:function(){return s},remove:v,destroy:function(e){v(),u&&u.off("click.mask");y("show"),y("hide"),h=!0},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(a,t,n)},config:o,init:g},o=a.config=t.extend(!0,{},i,e.config.mask,n),r=e.guid(),l=o.id?o.id.indexOf("#")>-1?o.id.substring(1):o.id:r;t("body");var c,s,u=e.objId(o.appendTo),d=null,f=!1,p=!1,h=!1;function g(n){h=!1;var r=t.extend(!0,i,o,n);return r.onBeforeInit&&r.onBeforeInit.call(a,r),r.appendTo=r.appendTo||"body",u=e.objId(r.appendTo),p=u[0]&&"COMPONENT"===u[0].tagName,o=a.config=r,c=u.css("position"),r.autoTrigger&&m(r),d=e.objId(r.id),r.uid&&e.history.setUI&&e.history.setUI({uid:r.uid,ui:a}),r.onInited&&r.onInited.call(a,r),this}function m(n){if(!h){var r=t.extend(!0,{},i,o,n),c=function(t){var n=t.background?t.background:"rgba(0,0,0,"+t.opacity+")",i="";return i+'<div id="'+l+'" class="'+e.prefix("mask")+" "+t.className+'" style="background:'+n+";z-index:"+t.zIndex+'"></div>'}(r);return(d=e.objId(l))&&d.length?d.css("display","block"):(u.append(c),!p&&u.css("position","relative"),d=e.objId(l)),s=!0,w.call(a,"show"),f||function(e){d.off("click.bui").on("click.bui",(function(t){e.callback&&e.callback.call(a,t),e.autoClose&&b(),t.stopPropagation()})),f=!0}(r),this}}function v(){if(!h)return d&&d.remove(),d=null,u.css("position",c||"static"),s=!1,f=!1,w.call(a,"hide"),this}function b(){if(!h)return d&&d.css("display","none"),!p&&u.css("position","relative"),s=!1,w.call(a,"hide"),this}function y(t,n){return e.off.apply(a,arguments),this}function w(t){a.self=this==window||this==a?null:this,e.trigger.apply(a,arguments)}return g(o),a}}(window.bui||{},window.libs),function(e,t){e.loading=function(n){var i={name:"loading",handle:{},$el:function(){return s=e.objId(l)},on:function(t,n){return e.on.apply(i,arguments),this},off:k,start:b,stop:w,isLoading:function(){return f},pause:function(){if(d)return;return s&&s.addClass("bui-loading-pause"),I.call(this,"pause"),this},text:y,showRing:function(){if(d)return;return s=e.objId(l),s.children(".bui-loading-cell").css("display","inline-block"),s.removeClass("bui-loading-pause"),this},hideRing:function(){if(d)return;return s=e.objId(l),s.children(".bui-loading-cell").css("display","none"),s.addClass("bui-loading-pause"),this},show:function(n){var i=n||{};if(d)return;var o=t.extend(!0,a,i);s=e.objId(o.id),s&&s.length?(y(o.text),s[0].style.display="-webkit-box",m&&m.show(),o.callback&&r.off("click.bui","#"+l).on("click.bui","#"+l,o.callback),I.call(this,"show")):b(o);a.timeout&&(p&&clearTimeout(p),p=setTimeout((function(e){x()}),a.timeout));return f=!0,this},hide:x,destroy:function(e){e=1==e;w(),r&&r.off("click.bui");k("show"),k("hide"),k("start"),k("stop"),k("pause"),k("remove"),m&&m.destroy(e),d=!0},widget:function(t){var n={mask:m||{}};return e.widget.call(n,t)},option:function(t,n){return e.option.call(i,t,n)},config:a,init:v},a=i.config=t.extend(!0,{},{uid:"",appendTo:"",width:30,height:30,text:"",onlyText:!1,mask:!0,zIndex:"",className:"",autoTrigger:!1,autoClose:!0,timeout:0,opacity:0,display:"block",template:null,onBeforeInit:null,onInited:null,callback:null},e.config.loading,n);t("body");var o,r=null,l=e.guid(),c=l+"-mask",s=e.objId(l),u=!1,d=!1,f=!1,p=null;a.id=l;var h=a.callback;a.callback=function(e){a.autoClose&&w(),h&&h.call(i,e)};var g=t.extend(!0,{},a,{id:c}),m=a.mask?e.mask(g):null;function v(o){d=!1;var c=t.extend(!0,{},a,o);return c.onBeforeInit&&c.onBeforeInit.call(i,n),c.appendTo=c.appendTo||"body",r=t(c.appendTo),a=i.config=c,c.autoTrigger&&s.length<1&&b(c),s=e.objId(l),c.uid&&e.history.setUI&&e.history.setUI({uid:c.uid,ui:i}),c.onInited&&c.onInited.call(i,c),this}function b(n){if(!d){var o=t.extend(!0,{},a,n);if(s=e.objId(l),s.children(".bui-loading-cell"),s.hasClass("bui-loading-pause"))s.removeClass("bui-loading-pause"),I.call(this,"start");else{s.length&&s.remove();var c=function(t){var n=(t=t||{}).text,a=r.width()||document.documentElement.clientWidth,o=n&&"block"==t.display?parseInt(t.height)+30:parseInt(t.height),c=-a/2,s=-o/2,u="block"==t.display?e.prefix("loading-block"):e.prefix("loading-inline"),d="";return d+='<div id="'+l+'" class="'+e.prefix("loading")+" "+u+" "+t.className+'" style="width:'+a+"px;height:"+o+"px;line-height:"+o+"px;margin-left:"+c+"px;margin-top:"+s+"px;"+(t.zIndex?"z-index:"+t.zIndex:"")+'" >',t.onlyText||(d+='<div class="'+e.prefix("loading-cell")+'" style="width:'+parseFloat(t.width)+"px;height:"+parseFloat(t.height)+'px;"></div>'),d+='<div class="'+e.prefix("loading-text")+'">'+t.text+"</div>",d+="</div>",t&&t.template?t.template.call(i,t):d}(o);r.append(c),m&&m.show(),I.call(this,"show")}return o.timeout&&(p&&clearTimeout(p),p=setTimeout((function(){w()}),o.timeout)),u||function(e){var t=e||a;r.off("click.bui","#"+l).on("click.bui","#"+l,(function(e){t.callback&&t.callback.call(i,e),e.stopPropagation()})),u=!0}(o),f=!0,this}}function y(t){if(!d)return s=e.objId(l),o=s.children(".bui-loading-text"),void 0===t?o&&o.text():(o&&o.html(t),this)}function w(){if(!d)return(s=e.objId(l))&&s.remove(),s=null,m&&m.remove(),u=!1,f=!1,I.call(this,"remove"),I.call(this,"hide"),this}function x(){if(!d)return s=e.objId(l),(a.appendTo||s&&s.length)&&(s.css("display","none"),m&&m.hide()),f=!1,I.call(this,"hide"),this}function k(t,n){return e.off.apply(i,arguments),this}function I(t){i.self=this==window||this==i?null:this,e.trigger.apply(i,arguments)}return v(a),i}}(window.bui||{},window.libs),function(e,t){e.dialog=function(n){var i,a,o,r,l,c={id:"",dialogid:"",title:"",effect:"zoomIn",content:"",className:"",appendTo:"",position:"center",style:null,fullscreen:!1,useBox:!1,width:0,height:0,mask:!0,opacity:.3,render:!1,needRemove:"",navbarPosition:"bottomright",navbarDirection:"y",showToolbar:!0,autoClose:!0,close:!0,mini:!1,max:!1,scroll:!0,closeText:"",zoom:!1,zIndex:101,buttons:[],onBeforeClose:null,onBeforeOpen:null,onOpen:null,onBeforeInit:null,autoinit:!0,onInited:null,onMask:null,onClose:null,callback:null,dragable:!1,dragback:!1,touch:{dragup:!0,swipeDistance:60,dragdown:!0,dragleft:!0,dragright:!0,moveType:"transform",direction:"xy",onSwipeleft:function(e,t){var n=this;d.dragback&&D((function(){n.reset()})),e.stopPropagation()},onSwiperight:function(e,t){var n=this;d.dragback&&D((function(){n.reset()})),e.stopPropagation()}}},s={width:0,height:0},u={name:"dialog",selector:$,$el:$,$:$,handle:{},on:function(t,n){return e.on.apply(u,arguments),this},off:M,show:function(e){var t=d.useBox?"-webkit-box":"block";i&&i.css("display",t),e&&e.call(this)},hide:function(e){i.css("display","none"),e&&e.call(this)},open:C,scroll:function(e,t){var n=0!=e,a=i.children(".bui-dialog-main");n?a.css({overflow:"auto"}):a.css({overflow:"hidden"});return t&&t.call(this),this},resize:S,revert:N,modify:z,minimize:j,maxmize:E,removebar:B,fullscreen:R,isFullscreen:function(){return I},close:D,isOpen:function(e){return m},disableOpen:function(){return h=!0,this},enableOpen:function(){return h=!1,this},disableClose:function(){return g=!0,this},enableClose:function(){return g=!1,this},top:function(t){return t=t||d.zIndex+e.$(".bui-dialog").length,e.$(".bui-dialog").css("z-index",d.zIndex),e.$(".bui-mask").css("z-index",d.zIndex-1),i.css("z-index",t),l&&e.$("#"+l.config.id).css("z-index",t-1),u.config.zIndex=t,d.zIndex=t,this},template:O,render:function(a){var o=a.id||n.id,r=o.indexOf("#")>-1||o.indexOf(".")>-1?o:"#"+o,l=e.$(r);l="body"===d.appendTo?t(r):l,i=l,l.length?void 0!==a.content&&l.html(a.content):console.log("找不到ID",o);return this},toggle:function(e,t){u.isOpen()?u.close(t):u.open(e);return this},create:function(e){var n=e||{};c.title=d.title||"提示",c.content=d.content||"",c.close=!1,c.render=!0,c.autoClose=d.autoClose,c.mask=d.mask,c.buttons=d.buttons&&d.buttons.length?d.buttons:["确定"],c.callback=d.callback||null;var i=t.extend(!0,c,n);return _.call(u,"create"),T(i)},remove:F,destroy:function(){var e=1==e;i&&(i.off("click.bui"),i.remove(),i=null,h=!1);M("open"),M("close"),l&&l.destroy(e),o&&o.destroy(e),k=!0},widget:function(t){var n={toggle:o,mask:l};return e.widget.call(n,t)},option:function(t,n){"object"===_typeof(t)&&(t.width||t.height)?z(t):"width"==t?z({width:n}):"height"==t&&z({height:n});return e.option.call(u,t,n)},config:d,init:T},d=u.config=t.extend(!0,c,e.config.dialog,n),f="",p="fadeInDown",h=!1,g=!1,m=!1,v=!1,b=""!==d.needRemove?d.needRemove:!!d.render,y={},w=document.documentElement.clientWidth,x=document.documentElement.clientHeight,k=!1,I=!1;function T(n){var a=d=t.extend(!0,d,n);switch(a.onBeforeInit&&a.onBeforeInit.call(u,a),a.appendTo=a.appendTo||e.hasRouter&&router.currentPage()||"body",k=!1,r=a.effect,b=""!==a.needRemove?a.needRemove:!!a.render,w=document.documentElement.clientWidth,x=document.documentElement.clientHeight,a.position){case"top":f="bui-dialog-top",r=a.effect||"fadeInDown";break;case"bottom":f="bui-dialog-bottom",r=a.effect||"fadeInUp";break;case"left":f="bui-dialog-left",r=a.effect||"fadeInLeft";break;case"right":f="bui-dialog-right",r=a.effect||"fadeInRight";break;case"center":f="bui-dialog-center",r=a.effect||p;break;case"custom":f="bui-dialog-custom",r=a.effect||p}if(a.fullscreen&&(f="bui-dialog-fullscreen",r=a.effect||p,I=!0),a.render){a.id=a.dialogid||e.guid(),function(n){var i=O(n),a=e.$("#"+n.id);a.length&&a.remove();t(n.appendTo).append(i)}(a);var c=/\#|\./.test(a.id)?a.id:"#"+a.id;i=t(c)}else(i=e.obj(a.id,a.appendTo)).addClass(f).css("z-index",a.zIndex),a.useBox&&i.addClass("bui-box-vertical");a.style&&i.css(a.style),i.width()>w||i.width(),i.height()>x||i.height(),i.css("display","none"),o||(o=e.toggle({id:a.id,effect:r,useBox:a.useBox})),d=u.config=a;try{var s="object"===_typeof(a.id)?t(a.id).attr("id")+"-mask":a.id+"-mask";n.mask&&!l&&(l=e.mask({id:s,opacity:n.opacity,appendTo:i.parent(),autoTrigger:!1,onlyOne:!0,autoClose:!1,zIndex:parseInt(n.zIndex,10)-1,callback:function(e){if(!1===(n.onMask&&n.onMask.call(u,e)))return!1;d.autoClose&&(b?D(F):D())}}))}catch(t){e.showLog(t)}if((!v||d.render)&&(A(),a.dragable)){var h=t.extend(!0,{},a.touch);if(h.id=i,h.dragable=a.dragable,h.zIndex=a.zIndex,a.dragback)switch(a.position){case"right":h.direction="x",h.dragleft=!1,h.onDragend=function(e,t){var n=this;"swiperight"===t.direction&&D((function(){n.reset()}))};break;case"left":h.direction="x",h.dragright=!1,h.onDragend=function(e,t){var n=this;"swipeleft"===t.direction&&D((function(){n.reset()}))};break;case"top":h.direction="y",h.dragdown=!1,h.onDragend=function(e,t){var n=this;"swipeup"===t.direction&&D((function(){n.reset()}))};break;case"bottom":h.direction="y",h.dragup=!1,h.onDragend=function(e,t){var n=this;"swipedown"===t.direction&&D((function(){n.reset()}))}}e.touch(h)}return a.uid&&e.history.setUI&&e.history.setUI({uid:a.uid,ui:u}),a.onInited&&a.onInited.call(u,a),u}function O(t){var n="",i=t.useBox?"bui-box-vertical ":"";return n+='<div id="'+t.id+'" class="bui-dialog '+i+f+" "+t.className+'" style="display:block;z-index:'+t.zIndex+'">',t.title&&(n+='\t<div class="bui-dialog-head">'+t.title+"</div>"),n+='\t<div class="bui-dialog-main">',t.content&&(n+=t.content),n+="\t</div>",t.buttons&&t.buttons.length&&(n+='\t<div class="bui-dialog-foot"><div class="bui-box">',t.buttons.forEach((function(e,t){n+='\t\t<div class="bui-btn span1 '+(e.className||"")+'" value="'+(e.value||"")+'">'+(e.name||e)+"</div>"})),n+="\t</div></div>"),n+=t.showToolbar?function(t){var n="";n+='<div class="bui-dialog-toolbar">';var i=e.config.icon.mini?'<i class="'.concat(e.config.icon.mini,'"></i>'):'<i class="icon-mini">&#xe620;</i>',a=e.config.icon.max?'<i class="'.concat(e.config.icon.max,'"></i>'):'<i class="icon-max">&#xe617;</i>';return t.mini&&(n+='<span class="bui-dialog-miniicon">'.concat(i,"</span>")),t.max&&(n+='<span class="bui-dialog-maxicon">'.concat(a,"</span>")),t.close&&(n+='<span class="bui-dialog-close">'+(t.closeText?t.closeText:'<i class="'+e.config.icon.close+'"></i>')+"</span>"),n+"</div>"}(t):"",n+="</div>"}function C(n){if(m||k||h)return m=!0,this;var a={width:d.width,height:d.height,zoom:d.zoom,fullscreen:d.fullscreen,position:d.position,scroll:d.scroll,onBeforeOpen:d.onBeforeOpen,useBox:d.useBox,effect:"",callback:null},r=a;if("function"==typeof n?r.callback=n:"string"==typeof n?r.effect=n:n&&"object"===e.typeof(n)&&(r=t.extend(!0,{},a,n)),!i)return console.error("找不到 Dialog ID"),this;var c=r.onBeforeOpen&&r.onBeforeOpen.call(u,{toggle:o});if(_.call(u,"beforeopen",{toggle:o}),!1===c)return this;var s=d.useBox?"-webkit-box":"block";return i&&i.css("display",s),0==(i&&i.attr("status")||0)&&(S(r),i&&i.attr("status","1")),l&&l.show(),o.show((function(e){m=!0,d.width=i.width(),d.height=i.height(),r.callback&&r.callback.call(u,{toggle:o,target:i[0]}),d.onOpen&&d.onOpen.call(u,{toggle:o,target:i[0]}),_.call(u,"openafter",{toggle:o}),_.call(u,"afteropen",{toggle:o})}),r.effect),v||A(),_.call(u,"open",{toggle:o}),this}function S(n){var a=t.extend(!0,{},d,n),o=String(a.width),r=String(a.height),l=function(t){var n=t.width?String(t.width):String(i.width()||w),a="",o=0,r="";return n.indexOf("%")>-1?(o=w*parseFloat(n)/100,r=e.unit.pxToRemZoom(o)+"rem",a=o+"px"):n.indexOf("px")>-1?(o=parseFloat(n),r=e.unit.pxToRemZoom(o)+"rem",a=n):n.indexOf("rem")>-1?(r=n,a=(o=e.unit.remToPx(parseFloat(n)))+"px"):(o=parseFloat(n),r=e.unit.pxToRemZoom(o)+"rem",a=o+"px"),{width:parseFloat(o),widthPx:a,widthRem:r}}(a),c=function(t){var n=t.height?String(t.height):String(i.height()||x),a="",o=0,r="";return n.indexOf("%")>-1?(o=x*parseFloat(n)/100,r=e.unit.pxToRemZoom(o)+"rem",a=o+"px"):n.indexOf("px")>-1?(o=parseFloat(n),r=e.unit.pxToRemZoom(o)+"rem",a=n):n.indexOf("rem")>-1?(r=n,a=(o=e.unit.remToPx(parseFloat(n)))+"px"):(o=parseFloat(n),r=e.unit.pxToRemZoom(o)+"rem",a=o+"px"),{height:parseFloat(o),heightPx:a,heightRem:r}}(a);y=l.height;var s=/\d+$/.test(o)&&a.zoom,u=/\d+$/.test(r)&&a.zoom,f=s?l.widthRem:l.widthPx,p=u?c.heightRem:c.heightPx,h=s?"-"+parseFloat(l.widthRem)/2+"rem":"-"+parseFloat(l.widthPx)/2+"px",g=u?"-"+parseFloat(c.heightRem)/2+"rem":"-"+parseFloat(c.heightPx)/2+"px";i.css({width:o.indexOf("%")>-1?o:f,height:r.indexOf("%")>-1?r:p,transition:"all 0.3s"}),"center"!=a.position||a.fullscreen||i.css({top:"50%","margin-top":g,left:"50%","margin-left":h,right:"auto"}),a.fullscreen&&i.addClass("bui-dialog-fullscreen");var m=i.children(".bui-dialog-head"),v=i.children(".bui-dialog-foot"),b=i.children(".bui-dialog-main");if(!a.useBox){var y=a.fullscreen&&!a.height?i.parent().height()||document.documentElement.clientHeight:a.zoom?i.height()||bui.unit.remToPx(P(a.height)/100):P(a.height)||i.height(),k=y-(m.length?m[0].clientHeight:0)-(v.length?v[0].clientHeight:0);b.css({height:k})}return this}function P(e){return"string"==typeof e&&e.indexOf("%")>-1?document.documentElement.clientHeight*parseFloat(e)/100:"string"==typeof e?parseFloat(e):"number"==typeof e?e:void 0}d.id&&d.autoinit&&T(d);var L=null;function j(n){D();var o="".concat(i.attr("id"),"-mini"),r=e.$(".bui-dialog-navbar");a=e.$("#".concat(o));var l=(null==n?void 0:n.title)||d.title||i.children(".bui-dialog-head").text()||"",c=function(e){var t=e.needRemove?'<i class="icon-remove"></i>':"";return'<div id="'.concat(e.id,'" class="bui-dialog-mini span1"><span>').concat(e.title,"</span>").concat(t,"</div>")}({id:o,title:l,needRemove:0!=(null==n?void 0:n.needRemove)});if(r.length&&!a.length)r.append(c);else if(!r.length){var s="";switch(d.navbarPosition){case"topleft":s="topleft";break;case"topright":s="topright";break;case"bottomleft":s="bottomleft";break;default:s="bottomright"}var f="y"==d.navbarDirection?"bui-box-vertical":"bui-box";t(router.currentPage()).append('<div class="bui-dialog-navbar '.concat(s," ").concat(f,'">').concat(c,"</div>"))}return a=e.$("#".concat(o)),(null==n?void 0:n.title)&&a.find("span").html("".concat(l)),L?(L.show(),this):((L=e.toggle({id:"#".concat(o),effect:"fadeInUp"})).show(),a.click((function(e){"I"!==e.target.tagName?(C(),L&&L.hide()):B()})),_.call(u,"minimize"),this)}function E(e){return s.width=i.width()||d.width,s.height=i.height()||d.height,C(),L&&L.hide(),i.removeClass("bui-dialog-minimize").addClass("bui-dialog-maxmize"),S({height:i.parent().height(),fullscreen:!0}),_.call(u,"maxmize"),I=!0,this}function N(e){return C(),L&&L.hide(),i.hasClass("bui-dialog-maxmize")&&(S({width:s.width,height:s.height,zoom:!1}),i.removeClass("bui-dialog-maxmize bui-dialog-fullscreen")),_.call(u,"revert"),I=!1,this}function B(e){return d.render?F():D(),L&&L.hide((function(){a.remove(),L=null})),this}function R(e,t){return 0!=e?E():N(),t&&t.call(this),this}function D(t){if(m&&!k&&!g){var n={};"function"==typeof t?n.callback=t:"string"==typeof t?(n.effect=t,n.callback=d.onClose):t&&"object"===e.typeof(t)&&(n=t),n.onBeforeClose=d.onBeforeClose;var i=n.onBeforeClose&&n.onBeforeClose.call(u,{toggle:o});if(_.call(u,"beforeclose",{toggle:o}),!1===i)return this;try{o.hide((function(e){m=!1,n.callback&&n.callback.call(u,{toggle:o})}),n.effect),l&&l.hide(),_.call(this,"close",{toggle:o})}catch(t){e.showLog(t,"bui.dialog.close")}return this}}function _(t,n){var i=y[t];if("array"===e.typeof(i))for(var a=0,o=i.length;a<o;a++)i[a](n)}function F(){try{i.remove(),l&&l.remove(),_.call(this,"remove")}catch(t){e.showLog(t,"bui.dialog.remove")}return this}function A(){return i.off("click.bui",".bui-dialog-close").on("click.bui",".bui-dialog-close",(function(e){D(b?F:d.onClose),e.stopPropagation()})),i.off("click.bui",".bui-dialog-miniicon").on("click.bui",".bui-dialog-miniicon",(function(e){j()})),i.off("click.bui",".bui-dialog-maxicon").on("click.bui",".bui-dialog-maxicon",(function(e){i.hasClass("bui-dialog-maxmize")?R(!1):R()})),d.callback&&i.on("click.bui",".bui-dialog-foot .bui-btn",(function(e){return e.target=this,!!m&&(!1!==(d.callback&&d.callback.call(u,e,u))&&(d.autoClose&&(b?D(F):D()),void e.stopPropagation()))})),v=!0,this}function $(t){return e.selector.call(i,t)}function z(e){if((e=e||{}).width||e.height){e.width&&i.css({width:e.width}),e.height&&i.css({height:e.height});var t=parseFloat(e.height)-$dialogHead.height()-$dialogFoot.height();$dialogMain.css({height:t}),"center"==d.position&&(e.height&&i.css({"margin-top":-e.height/2}),e.width&&i.css({"margin-left":-e.width/2}))}else e.title?$dialogHead.html(e.title):e.content&&$dialogMain.html(e.content)}function M(t,n){return e.off.apply(u,arguments),this}function _(t){u.self=this==window||this==u?null:this,e.trigger.apply(u,arguments)}return u}}(bui||{},libs),function(e,t){e.alert=function(n,i,a){var o=e.dialog(),r={className:"bui-alert",title:"",width:580,height:360,scroll:!0,zIndex:121,position:"center",autoClose:!0,showToolbar:!1,zoom:!0,useBox:!1,buttons:[{name:"确定",className:"primary-reverse"}]};r.callback=i||function(){};var l=t.extend(r,e.config.alert,a),c="";try{c="string"==typeof n&&n.indexOf("<")>-1&&n.indexOf(">")>-1?"<xmp>"+n+"</xmp>":!n||"object"!==e.typeof(n)&&"array"!==e.typeof(n)?n&&"function"===e.typeof(n)?n.toString():n:JSON.stringify(n),l.content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+c+"</div>"}catch(t){e.showLog(t,"bui.alert")}return o.create(l).open(),o}}(window.bui||{},window.libs),function(e,t){e.confirm=function(n,i,a){var o=e.dialog(),r={className:"bui-confirm",title:"",width:580,height:360,scroll:!0,zIndex:121,autoClose:!0,showToolbar:!1,zoom:!0,useBox:!1,position:"center",buttons:[{name:"取消",className:""},{name:"确定",className:"primary-reverse"}]};r.callback=i||function(){};var l={};return"object"===_typeof(n)?(n.content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+n.content+"</div>",l=t.extend(r,e.config.confirm,n)):((l=t.extend(r,e.config.confirm,a)).content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+n+"</div>",l.callback=i||function(){}),o.create(l).open(),o}}(window.bui||{},window.libs),t((function(e){!function(t,n){t.prompt=function(i,a,o){var r=t.dialog(),l={className:"bui-prompt",title:"",width:580,height:400,scroll:!0,autoClose:!1,showToolbar:!1,needRemove:!1,zoom:!0,zIndex:121,position:"center",buttons:[{name:"取消",className:""},{name:"确定",className:"primary-reverse"}]};l.callback=a||function(){},l.placeholder="",l.row=1,l.type="textarea",l.value="",l.onChange=null;var c={},s="",u="";if("object"===_typeof(i)?s=(c=n.extend(l,t.config.prompt,i)).content||"":((c=n.extend(l,t.config.prompt,o)).callback=a||function(){},s=i||""),"textarea"===c.type)c.content='<div class="bui-prompt-main bui-box-vertical"> <div class="bui-prompt-label">'+s+'</div> <div class="span1"> <textarea class="bui-prompt-text" placeholder="'+c.placeholder+'" rows="'+c.row+'" >'+c.value+"</textarea> </div> </div>";else c.content='<div class="bui-prompt-main bui-box-vertical"> <div class="bui-prompt-label">'+s+'</div> <div class="span1"> <input class="bui-prompt-text" placeholder="'+c.placeholder+'" type="'+c.type+'" value="'+c.value+'"/> </div> </div>';return r.create(c).open(),n("#"+r.config.id).on("change",".bui-prompt-text",(function(t){u=this.value,c.onChange&&c.onChange.call(e,t)})),r.value=function(e){return void 0===e?u:(n("#"+r.config.id).find(".bui-prompt-text").val(e),u=e)},r.focus=function(e){n("#"+r.config.id).find(".bui-prompt-text").focus()},r}}(window.bui||{},window.libs)})),function(e,t){e.hint=function(n,i){if("number"==typeof n||"string"==typeof n){var a=n||"";(n={}).content=a,n.onClose=i||null}else _typeof(n);var o,r,l={name:"hint",handle:{},on:function(t,n){return e.on.apply(l,arguments),this},off:b,remove:m,hide:function(e,t){var n=this;"function"==typeof e?t=t||c.effect||"":(t=e||c.effect||"",e=null);u&&u.hide((function(){p=!1,e&&e.call(l,{toggle:u}),c.onHided&&c.onHided.call(l,{toggle:u}),y.call(n,"hide",{toggle:u})}),t);return l},show:v,text:function(e){return d.find(".bui-hint-inner").length&&d.find(".bui-hint-inner").html(e),this},isShow:function(){return p},destroy:function(e){e=1==e;return d.off("click.bui"),u&&u.destroy(e),b("show"),b("hide"),l},widget:function(t){var n={toggle:u};return e.widget.call(n,t)},option:function(t,n){return e.option.call(l,t,n)},config:c,init:g},c=l.config=t.extend(!0,{},{appendTo:"",content:"",uid:"",target:"",timeout:2e3,autoClose:!0,showClose:!1,autoTrigger:!0,useBox:!0,opacity:1,background:"",effect:"fadeInUp",skin:"",position:"bottom",width:0,height:0,zIndex:130,style:null,onBeforeInit:null,onInited:null,onClose:null,onHided:null},e.config.hint,n),s=0,u=null,d=null,f="",p=!1,h=!1;function g(n){var i=t.extend(!0,c,n);if(i.appendTo=i.appendTo||e.hasRouter&&router.currentPage()||"body",i.onBeforeInit&&i.onBeforeInit.call(l,i),o=e.guid(),f="top"===i.position?"fadeInDown":"bottom"===i.position?"fadeInUp":i.effect,c=l.config=i,function(n,i,a,o){var r,l=+c.zIndex+a,s="body"==o||"object"==_typeof(o)?t("body"):e.obj(o);switch(c.position){case"top":r="bui-hint-top";break;case"bottom":r="bui-hint-bottom";break;case"center":r="bui-hint-center";break;case"right":r="bui-hint-right";break;case"rb":case"rightbottom":r="bui-hint-right-bottom";break;case"left":r="bui-hint-left";break;case"lb":case"leftbottom":r="bui-hint-left-bottom";break;default:r="bui-hint-".concat(r||"")}var u=c.height;c.width=String(c.width).indexOf("%")>-1?750*parseFloat(c.width)/100:parseFloat(c.width),c.height=parseFloat(c.height)||0;var d=c.background?"background:"+c.background:"",f=c.width>0?"width:"+c.width/100+"rem;margin-left:-"+c.width/100/2+"rem;":"",p=c.height>0?"height:"+c.height/100+"rem;":"",h="auto"==u?"height:auto;":p,g="center"===c.position&&c.width>0?"margin-top:-"+c.height/100/2+"rem;":"",m=d+";display:none;z-index:"+l+";opacity:"+c.opacity+";"+f+h+g;if(c.style&&"object"===e.typeof(c.style))for(var v in c.style){var b=m[v];m+="".concat(v,":").concat(b)}var y='<div id="'+n+'" class="bui-hint '+r+" "+c.skin+'" style="'+m+'"><span class="bui-hint-inner">'+i+"</span>"+(c.showClose?'<div class="bui-hint-close"><i class="'+e.config.icon.close+'"></i></div>':"")+"</div>",w=document.querySelector("#"+n);w||s.append(y);o&&s.css("position","relative")}(o,i.content,s,i.appendTo),++s,d=e.objId(o),u||(u=e.toggle({id:d,effect:f,useBox:i.useBox})),i.target){var a=e.obj(i.target);a.width(),a.height(),a[0].offsetTop,a[0].offsetLeft,a.attr("dir")||a.attr("direction")||i.direction}return i.autoTrigger&&(p=!0,v()),h||function(e){e.showClose&&d.off("click.bui",".bui-hint-close").on("click.bui",".bui-hint-close",(function(t){e.autoTrigger?(p=!1,u&&u.hide(m)):(p=!1,u&&u.hide(e.onHided)),e.onClose&&e.onClose.call(l,t)})),h=!0}(i),i.uid&&e.history.setUI&&e.history.setUI({uid:i.uid,ui:l}),i.onInited&&i.onInited.call(l,i),l}function m(e){return u&&(p=!1,u.remove(),"function"==typeof e&&e.call(l),y.call(this,"remove",{toggle:u}),u=null),l}function v(e,t){var n=this;return"function"==typeof e?t=t||c.effect||"":(t=e||c.effect||"",e=null),d.css("display","-webkit-box"),u&&(p=!0,u.show((function(t){y.call(n,"show",{toggle:u}),e&&e.call(l,{toggle:u})}),t)),c.autoClose&&(r&&clearTimeout(r),r=setTimeout((function(){c.autoTrigger?u&&u.hide((function(){p=!1,m()})):u&&u.hide((function(){p=!1})),c.onClose&&c.onClose.call(l)}),c.timeout)),l}function b(t,n){return e.off.apply(l,arguments),this}function y(t){l.self=this==window||this==l?null:this,e.trigger.apply(l,arguments)}return g(c),l}}(window.bui||{},window.libs),function(e,t){e.slide=function(n){var i,a,o,r,l,c,s,u,d,f,p,h,g,m,v,b,y,w,x,k,I,T,O,C,S,P={name:"slide",handle:{},on:Ie,off:Te,trigger:Oe,to:ie,load:function(e){var n={id:"",icon:"",title:"",url:"",name:"",index:E,menuTemplate:null,template:null,param:{},animate:!0,preload:!1,needRemove:!1,command:"after",width:0,height:0,loaded:null,beforeLoad:null},i=t.extend(!0,{},n,e);if(!1===(i.beforeLoad&&i.beforeLoad.call(P)))return this;return i.beforeLoad=null,i.menuTemplate=i.menuTemplate||(i.title?'<li class="bui-btn">'.concat(i.title,"</li>"):""),ve(i),this},back:function(e){var n={id:"",url:"",name:"",index:E,loaded:null,beforeLoad:null},i=t.extend(!0,{},n,e);return i.name=i.url||i.name,i.loaded=function(){i.beforeLoad=null,i.loaded=null,be(i)},se(i),this},add:ve,remove:be,replace:function(e){var n={id:"",name:"",index:E,param:{},animate:!1,preload:!1,command:"html",width:0,height:0,loaded:null,beforeLoad:null};return ve(t.extend(!0,{},n,e))},resize:ke,getPageParams:ye,getItemParam:ye,setItemParam:function(e,n){e="number"==typeof e?e:E;return _[e]&&(_[e]=t.extend(_[e],n)),_[e].param},getPages:X,getData:function(){return L.data},getItem:function(t){if("string"==typeof t)return e.array.get(L.data,t,"id");var n="number"==typeof t?t:ce();return L.data[n]},$active:we,currentMain:we,currentMenu:function(e){var t=void 0===e?E:e;return o.eq(t)[0]},prev:se,next:ue,stop:oe,start:function(e){ae(e)},lock:pe,index:ce,unlock:ge,destroy:function(e){e=1==e;oe(),a&&(a.off("click.bui"),e&&a.remove());i&&(i.off(),e&&i.remove());Te("stop"),Te("play"),Te("first"),Te("last"),Te("to")},widget:function(t){var n={loading:R};return e.widget.call(n,t)},option:function(t,n){return e.option.call(P,t,n)},config:L,init:Y},L=P.config=t.extend(!0,{},{id:"",uid:"",menu:".bui-slide-head > ul",children:".bui-slide-main > ul",main:".bui-slide-main",header:"header",footer:"footer",item:"li",prev:".bui-slide-prev",next:".bui-slide-next",alignClassName:"",alignPage:"center",stopHandle:"",stopPropagation:!0,width:0,height:0,data:null,zoom:!0,transition:200,interval:5e3,relative:!1,swipe:!0,animate:!0,delay:!1,bufferEffect:!0,visibleNum:1,scrollNum:1,distance:40,direction:"x",autoplay:!1,sideWidth:0,loop:!1,cross:!1,autoheight:!1,autoinit:!0,scroll:!1,index:0,fullscreen:!1,autopage:!1,autoload:!1,needLoading:!1,async:!0,video:{preload:!0,autoplay:!0,fullscreen:!1,muted:!1,loop:!0,controls:!0,playsinline:!0,width:"100%",height:"100%",poster:""},template:null,callback:null,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeTo:null,onTo:null,onClickNav:null,onBeforeInit:null,onInited:null,onStart:null,onMove:null,onEnd:null},e.config.slide,n),j={},E=0,N=!1,B={},R=null,D=[],_=L.data,F=!1,A={x:{},y:{}};/hp-tablet/gi.test(navigator.appVersion);var $,z,M="",H=0,U=0,V=!1,q=!1;j={x1:0,x2:0,y1:0,y2:0,direction:""};try{L.autoinit&&Y(L)}catch(t){e.showLog(t)}function Y(n){var s=t.extend(!1,L,n);if(!1===(s.onBeforeInit&&s.onBeforeInit.call(P,s)))return this;if(s.id){if(i=e.obj(s.id),P.$el=i,s.relative){var u=i.parent().width()||k;s.width=s.sideWidth>0?u-s.sideWidth:u}if(L=P.config=s,M=s.direction,"function"==typeof s.template)i.html(s.template.call(P,s.data||[])||"");else if(s.data&&!s.template){if(i.find(s.main).length<=0){var d=function(e){var t='<div class="'.concat(e.main.substr(1),'">\n              <ul class="bui-slide-main-ul">\n              </ul>\n            </div>');return t}(s);i.html(d)}var f=i.find(s.children),p=xe.call(P,s.data);f.html(p)}if(s.needLoading&&(R=bui.loading({appendTo:i})),a=0==s.menu.indexOf("#")?e.obj(s.menu):i.find(s.menu).eq(0),o=a.children(),r=i.find(s.children).eq(0),l=r.parent(),c=r.children(),C=c.length,s.loop&&c.length){var h=c.eq(c.length-1).clone(!0),g=c.eq(0).clone(!0);r.prepend(h).append(g);var m=(c=r.children()).length-1;Te("afterto"),Ie("afterto",(function(e){0==e&&ie(m-1,"none"),e==m&&ie(1,"none")})),ie(1,"none"),!i.hasClass(".bui-slide-loop")&&i.addClass("bui-slide-loop")}if(s.cross&&c.length){var v=function(e){var t=c.eq(e);t.removeClass("bui-cross-prev").removeClass("bui-cross-next"),t.prev().removeClass("bui-cross-next").addClass("bui-cross-prev"),t.next().removeClass("bui-cross-prev").addClass("bui-cross-next")};!i.hasClass(".bui-slide-cross")&&i.addClass("bui-slide-cross"),Te("to",v),Ie("to",v),s.loop?ie(1):ie(0)}return K(s),W(s),(O=s.autoplay)&&ae(),N||(!function(){ge(),L.swipe||pe();var n=function(e){var n=t(this).hasClass("active"),i=t(this).index(),a=t(this).attr("disabled"),o=t(this).hasClass("disabled")||""==a||"true"==a||"disabled"==a;if(e.currentIndex=i,e.prevIndex=E,!1===(L.onBeforeTo&&L.onBeforeTo.call(P,e)))return!1;Oe.call(P,"beforeto",e),n||o||(L.animate?ie(i):ie(i,"none"),O&&ae(),L.onClickNav&&L.onClickNav.call(P,i)),L.stopPropagation&&e.stopPropagation()};0==L.menu.indexOf("#")?a.off("click.bui","li").on("click.bui","li",n):i.off("click.bui",L.menu+" li").on("click.bui",L.menu+" li",n);i.off("click.bui",L.prev).on("click.bui",L.prev,se),i.off("click.bui",L.next).on("click.bui",L.next,ue);var o=L.children+">"+L.item;L.data&&i.off("click.bui",o).on("click.bui",o,(function(n){if(q)return!1;var i=t(n.currentTarget),a=i.attr("href"),o=i.attr("data-target")||"",r="true"==i.attr("data-reload"),l="true"==i.attr("data-iframe"),c="true"==i.attr("data-page"),s="true"==i.attr("data-close"),u="true"==i.attr("data-synchistory");a&&c?e.page({url:a,iframe:l,close:s,syncHistory:u}):a&&e.load({url:a,reload:r,target:o,iframe:l}),Oe.call(P,"click",n);var d=L.data[ce()]||{};d.callback&&d.callback.call(P,n),L.callback&&L.callback.call(P,n,P),L.stopPropagation&&n.stopPropagation()})),N=!0}(),F=!0),E=r.children(".active").length?r.children(".active").index():E||s.index,parseInt(s.index)>0?ie(s.index,"none"):ie(E,"none"),s.uid&&e.history.setUI&&e.history.setUI({uid:s.uid,ui:P}),s.onInited&&s.onInited.call(P,s),this}e.showLog("slide id不能为空","bui.slide.init")}function K(e){k=document.documentElement.clientWidth,I=document.documentElement.clientHeight,e.height=String(e.height).indexOf("%")>-1?parseFloat(e.height)/100*I:parseFloat(e.height),e.width=String(e.width).indexOf("%")>-1?parseFloat(e.width)/100*k:parseFloat(e.width),c=r.children();var t=i.parents(".bui-page");i.parents("main");var n=i[0]&&i[0].offsetTop||0,o=t.children(e.header);o[0]&&o[0].offsetHeight;var l=t.children(e.footer),u=l[0]&&l[0].offsetHeight||0;y=I-(u||0)-n,y=i.parent("main").length?i.parent("main").height():y,w=0==e.height?y:e.height;var m="static"==a.parent().css("position")?a.css("position"):a.parent().css("position");x=i.find(e.menu).length?"absolute"==m||"fixed"==m?w:w-(a[0]&&a[0].offsetHeight||0):w,h=e.fullscreen?I:0==e.height?x:e.height,p=e.fullscreen?k:e.width||(e.relative?i.parent().width():k),s=c.length,g="x"==M?p/L.visibleNum:p,b="y"==M?h/L.visibleNum:h,T="y"==L.direction?b*L.scrollNum:g*L.scrollNum,d=p*s/L.visibleNum,f=h*s/L.visibleNum}function W(t){c=r.children(),C=t.loop?c.length-2:c.length,A={x:{swipeDir:"swipeleft",swipeDir2:"swiperight",width:T},y:{swipeDir:"swipeup",swipeDir2:"swipedown",width:T}},l[(S={x:{parentInitKey:"width",parentInitValue:d,boxCss:"display:-webkit-box;display:box;-webkit-box-align: start;-webkit-box-pack: center;width:100%;",boxItemCSS:"-webkit-box-flex:1;box-flex:1;width:"+g+"px;height:"+b+"px;"},y:{parentInitKey:"height",parentInitValue:f,box:"display:-webkit-box;display:box;-webkit-box-align: start;-webkit-box-pack: center;width:100%;-webkit-box-orient: vertical;box-orient: vertical;",boxItemCSS:"-webkit-box-flex:1;box-flex:1;width:"+g+"px;height:"+b+"px;"}})[M].parentInitKey](S[M].parentInitValue);var n,a=c.length;for(n=0;n<a;n++){var s=c[n].getAttribute("data-scroll"),u=null==s?L.scroll:"false"!=s;S[M].boxItemCSS=S[M].boxItemCSS+(u?"overflow:auto;":"overflow:hidden;"),c[n].style.cssText=S[M].boxItemCSS}try{r[0]&&(r[0].style.cssText=S[M].boxCss)}catch(e){console.log("请检查下children参数是否正确.","bui.slide id:"+L.id)}var h="y"==M&&L.visibleNum>1?x/L.visibleNum:x,m=L.zoom?w/100+"rem":w+"px",v=L.zoom?h/100+"rem":h+"px";if(L.zoom,L.fullscreen?(e.$("main").css({position:"static"}),i.addClass("bui-slide-fullscreen").css({position:"absolute",top:0,left:0,right:0,bottom:0,"z-index":10,overflow:"hidden",width:p,height:I}),c.addClass(L.alignClassName||"bui-box-center").css("height",I)):(i.css({position:"relative",overflow:"hidden",width:p,height:m}),c.addClass(L.alignClassName).height(v)),L.autoheight&&i.addClass("bui-slide-autoheight"),L.autopage){var y=function(e,t){var n,i="",a=(t=t||1,e);for(i+='<div class="bui-slide-head bui-align-'.concat(L.alignPage,'">'),i+="<ul >",n=1;n<Number(a)+1;n++)i+="<li "+(n==t?'class="active"':"")+">"+n+"</li>";return i+="</ul >",i+="</div >"}(X(),r.find(".active").index()+1);i.children(".bui-slide-head").remove(),i.append(y),o=i.find(L.menu).eq(0).children()}}function X(){var e=C,t=parseInt(e/L.visibleNum),n=parseInt(e/L.scrollNum),i=1==L.visibleNum?t:t+1,a=1==L.scrollNum?n:n+1,o=1==L.scrollNum||L.scrollNum==e?i:a;return o=L.loop?o+2:o}function J(t){V=!0;var n=t.touches?t.touches[0]:t;if(j.x1=n.clientX,j.y1=n.clientY,j.direction="",!1===(L.onBeforeTouchstart&&L.onBeforeTouchstart.call(P,t,j)))return!1;L.stopHandle&&e.unit.checkTargetInclude(t.target,L.stopHandle)?V=!1:($=-E*T,z=-E*T,t.touches&&t.touches.length>1||t.scale&&1!==t.scale?ee("x"==M?$:z):(O&&(oe(),O=!0),Oe.call(P,"touchstart",t,j),L.onStart&&L.onStart.call(P,t,j,P),V=!0,e.platform.isPC()&&t.stopPropagation(),e.platform.isPC()&&"IMG"===t.target.tagName&&t.preventDefault()))}function G(n){if(V){var i=n.touches?n.touches[0]:n;if(n.touches&&n.touches.length>1||n.scale&&1!==n.scale)ee("x"==M?$:z);else{if(q=!0,j.x2=i.clientX,j.y2=i.clientY,j.direction||(j.direction=e.swipeDirection(j.x1,j.x2,j.y1,j.y2)),!1===(L.onBeforeTouchmove&&L.onBeforeTouchmove.call(P,n,j)))return!1;"swipeleft"!==j.direction&&"swiperight"!==j.direction||(n.preventDefault(),n.stopPropagation()),Oe.call(P,"touchmove",n,j);try{if(!e.platform.isPC()&&"y"==M&&L.scroll){var a=t(n.target).closest(".active"),o=a[0].scrollTop||0,r=a[0].scrollHeight||0,l=a[0].offsetHeight||0;if("swipedown"===j.direction&&o>1)return void(q=!1);if("swipeup"===j.direction&&r-o-l>=2)return void(q=!1)}}catch(n){}m=j.x2-j.x1,v=j.y2-j.y1,A.x.move=$+m,A.x.absDelta=Math.abs(m),A.y.move=z+v,A.y.absDelta=Math.abs(v);var c=X();j.direction!==A[M].swipeDir&&j.direction!==A[M].swipeDir2||(L.delay&&A[M].absDelta>L.distance&&ee(A[M].move,"none"),L.delay||((L.bufferEffect||0==E&&c>1&&("swipeleft"==j.direction||"swipeup"==j.direction)||E==c-1&&c>1&&("swiperight"==j.direction||"swipedown"==j.direction)||E>0&&E<c-1&&c>1)&&ee(A[M].move,"none"),n.preventDefault()),L.onMove&&L.onMove.call(P,n,j,P))}}}function Z(t){switch(V=!1,Oe.call(P,"touchend",t,j),j.direction){case"swiperight":case"swipedown":t.currentIndex=E-1;break;case"swipeleft":case"swipeup":t.currentIndex=E+1}if(t.prevIndex=E,!1===(L.onBeforeTouchend&&L.onBeforeTouchend.call(P,t,j)))return!1;if(q){if(m=j.x2-j.x1,v=j.y2-j.y1,Math.abs(m)<5&&(q=!1),A.x.delta=$,A.x.absDelta=Math.abs(m),A.y.delta=z,A.y.absDelta=Math.abs(v),"x"!=L.direction||"swipeleft"!=j.direction&&"swiperight"!=j.direction){if("y"==L.direction&&("swipeup"==j.direction||"swipedown"==j.direction))n=L.onBeforeTo&&L.onBeforeTo.call(P,t)}else var n=L.onBeforeTo&&L.onBeforeTo.call(P,t);if(!1===n)return ee(A[M].delta),"swipeleft"!=j.direction&&"swiperight"!=j.direction||t.stopPropagation(),H+=j.y2-j.y1,U+=j.x2-j.x1,j.lastX=U,j.lastY=H,j={x1:0,x2:0,y1:0,y2:0,direction:""},V=!1,!e.platform.isPC()&&(q=!1),ne(),!1;re(),A[M].absDelta>L.distance?(Q.call(this,t,j,A),L.onEnd&&L.onEnd.call(P,t,j,P)):A[M].absDelta<L.distance&&ee(A[M].delta),le(),O&&ae(),"swipeleft"!=j.direction&&"swiperight"!=j.direction||t.stopPropagation(),H+=j.y2-j.y1,U+=j.x2-j.x1,j.lastX=U,j.lastY=H,j={x1:0,x2:0,y1:0,y2:0,direction:""},V=!1,!e.platform.isPC()&&(q=!1),ne()}}function Q(e,t,i){var a;if(de(),E=r.children(".active").index(),t.direction==i[M].swipeDir){var o=c.length,l=o-L.visibleNum,s=o%L.scrollNum!=0?l+1:l/L.scrollNum+1;if(E>=s-1)a=E,i[M].delta=-a*i[M].width,ee(i[M].delta),E=a,fe(a),Oe.call(P,"last",a);else if(a=E+1,i[M].delta=-a*i[M].width,ee(i[M].delta),E=a,fe(a),n.autoload)me(E);else{if(c.eq(E),n.loop&&E>C)return;Oe.call(P,"to",a)}Oe.call(P,"next",a)}else if(t.direction==i[M].swipeDir2)if(E>0){if(a=E-1,i[M].delta=-a*i[M].width,ee(i[M].delta),E=a,fe(a),n.autoload)me(E);else{if(c.eq(E),n.loop&&0==E)return;Oe.call(P,"to",a)}Oe.call(P,"prev",a)}else a=E,i[M].delta=-a*i[M].width,ee(i[M].delta),E=a,fe(a),Oe.call(P,"first",a)}function ee(e,t){var n=L.transition;t=t||"all "+n+"ms",e=e||0;switch(M){case"x":te(e+"px",0,t,l);break;case"y":te(0,e+"px",t,l)}return this}function te(e,t,n,a){var o=t||0;"y"==M&&L.zoom&&String(t).indexOf("%")<=-1&&(o=parseInt(t)/100+"rem");a=a||i;var r=e=e||0,l=String(e).indexOf("%")>-1?String(e):r,c=String(t).indexOf("%")>-1?String(t):o;n="number"==typeof n?"all "+n+"ms":n||"all 300ms";try{a.css({"-webkit-transition":n,transition:n,"-webkit-transform":"translate("+l+","+c+")",transform:"translate("+l+","+c+")"})}catch(e){console.log(e.message)}}function ne(e){l.one("webkitTransitionEnd",(function(){l.css({"-webkit-transition":"none",transition:"none"}),q=!1,e&&e.call(P,E),Oe.call(P,"afterto",E)}))}function ie(e,i,a){var r,l={index:0,name:"",param:null,transition:"",callback:"function"==typeof i?i:L.onTo,needTrigger:0!=a},s=l;if("object"===_typeof(e)){s=t.extend(!0,l,e);e=s.name||s.index||0,r=i||s.transition,a=s.needTrigger,"function"==typeof i||s.callback}else e=void 0!==e?e:s.name,r="string"==typeof i?i:s.transition,a=0!=a,"object"===_typeof(i)?s.param=i:s.transition=i||s.transition,s.name=e,s.needTrigger=a,s.callback="function"==typeof i?i:l.callback;de();var u=0;a=0!=a;if("string"==typeof e&&e.indexOf(".html")>-1){var d=[];o.each((function(n,i){var a=t(i).attr("href")||void 0;d[n]=a,a==e&&(u=n)}))}else u=parseInt(e);var f={x:{transform:-u*parseFloat(T)},y:{transform:-u*parseFloat(T)}},p=X();if(re(),1==L.visibleNum&&u>=p||u<0)return!1;if(ee(f[M].transform,r),E=u,fe(u),le(),O&&ae(),n.autoload)me(E);else{if(c.eq(E),!a)return;Oe.call(P,"to",u,s.param),s.callback&&s.callback.call(P,u,s.param)}return ne(s.callback),this}function ae(e){e=e||L.interval;oe(),O=!0;var t=E;u=setInterval((function(){var e=X();t>=0&&t<e-1?t+=1:t=0,ie(t)}),e),Oe.call(P,"play")}function oe(e){if(u)try{window.clearInterval(u),O=!1,Oe.call(P,"stop")}catch(e){}return this}function re(){e.$(".bui-slide-video video").each((function(e,t){this.pause()}))}function le(){var t=ce(),n=L.loop?t+1:t,i=e.$(".bui-slide-video video").eq(n);(!L.data||!L.data[t]||0!=L.data[t].autoplay)&&i.length&&i[0].play()}function ce(){return L.loop?E-1:E}function se(e){var n=t.extend(!0,{beforeLoad:null,loaded:null},e);if(!1===(n.beforeLoad&&n.beforeLoad.call(P)))return this;var i=E-1;return L.loop&&i<1&&(i=parseInt(C/L.scrollNum)),n.loaded?ie(i,n.loaded):ie(i),Oe.call(P,"prev",i),this}function ue(e){var n=t.extend(!0,{beforeLoad:null,loaded:null},e);if(!1===(n.beforeLoad&&n.beforeLoad.call(P)))return this;var i=E+1;return L.loop&&i>parseInt(C/L.scrollNum)+1&&(i=1),n.loaded?ie(i,n.loaded):ie(i),Oe.call(P,"next",i),this}function de(t){a=0==(t=L).menu.indexOf("#")?e.obj(t.menu):i.find(t.menu).eq(0),o=a.children(),r=i.find(t.children).eq(0),l=r.parent(),c=r.children()}function fe(e){e=e||0,c.removeClass("active"),c.eq(e).addClass("active"),o.removeClass("active"),o.eq(e).addClass("active")}function pe(){var e=he();return i.off(e.touchstart,L.children,J).off(e.touchmove,L.children,G).off(e.touchend,L.children,Z).off(e.touchcancel),Oe.call(P,"lock"),this}function he(){var t={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};return e.platform.isPC()&&(t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseleave"}),t}function ge(e){var t=he();return i.on(t.touchstart,L.children,J).on(t.touchmove,L.children,G).on(t.touchend,L.children,Z).on(t.touchcancel,(function(){V=!1,q=!1,ie(L.loop?ce()+1:ce())})),Oe.call(P,"unlock"),this}function me(t){var n=c.eq(t),i=o.eq(t).attr("href")||"";if(e.array.compare(D,t))return Oe.call(P,"to",t,"200"),!1;if(L.autoload)if(i)if((i=e.unit.resolvePath(i))in B){var a=B[i],r=e.history.getLast().id;a=a.replace(/#module\.id/g,"#"+r),n.html(a),D.push(t),!F&&Oe.call(P,"load",t,status),!F&&Oe.call(P,"to",t,status),F=!1}else B[i]="",R&&R.show(),loader&&loader.import(i,(function(a){a=e.unit.handleContent(a),B[i]=a;var o=e.history.getLast().id;a=a.replace(/#module\.id/g,"#"+o),n.html(a),D.push(t),Oe.call(P,"load",t,status),!F&&Oe.call(P,"to",t,status),F=!1,R&&R.hide()}),(function(e,n){Oe.call(P,"loadfail",t,n),R&&R.hide()}));else!F&&Oe.call(P,"to",t),F=!1}function ve(n){var i=t.extend(!0,{},{id:"",icon:"",title:"",name:"",menuTemplate:null,template:null,index:-1,param:{},animate:!1,preload:!1,needRemove:!1,command:"after",width:0,height:0,loaded:null,beforeLoad:null},n);c=r.children();var a=i.url||i.name||"",l=i.index>-1?i.index:"before"==i.command?0:c.length-1,s=a&&a.indexOf(".html")||0,u=s>-1?a.substr(0,s):a;i.name=u,i.index=l;var d=function(n){var i={id:"",name:"",index:0,menuTemplate:null,template:null,command:"after",width:0,height:0},a=t.extend(!0,i,n),r=c.eq(a.index),l=o.eq(a.index),s=a.id&&(a.id.indexOf("#")>-1||a.id.indexOf(".")>-1)?a.id.substr(1):a.id||e.guid(),u='<component id="'.concat(s,'" class="delay-item" name="').concat(a.name,'" delay="true"></component>'),d='<li style="-webkit-box-flex:1;box-flex:1;width:'.concat(a.width||g,"px;height:").concat(a.height||b,'px;">\n            ').concat(a.name?u:a.template?a.template.call(P):"","\n            </li>"),f=a.command,p="function"==typeof a.menuTemplate?a.menuTemplate.call(P):a.menuTemplate||"";"html"===f?(r.after(d),r.remove(),p&&l.after(p),p&&l.remove()):(r[f](d),p&&l[f](p));return{id:s}}(i);ke();var f=0;switch(i.command){case"html":case"append":case"prepend":f=l;break;case"before":f=l-1<0?0:l-1;break;default:f=l+1}if(Oe.call(P,"add",{index:f,prevIndex:E}),a){if(i.id=d.id||"",loader.delay(i),i.preload)return this;i.animate?ie(f):ie(f,"none")}return this}function be(e){var n=t.extend(!0,{index:-1,beforeLoad:null,loaded:null},e);if(!1===(n.beforeLoad&&n.beforeLoad.call(P)))return this;var i=parseInt(n.index),a=i-1;if(i<0)return this;var r=c.eq(i),l=o.eq(i);return r.remove(),l.remove(),ke(),E===i?a>-1&&ie(a,"none"):ie(E>i?E-1:E,"none"),n.loaded&&n.loaded.call(this,n),Oe.call(P,"remove",{index:E,prevIndex:i}),this}function ye(e){return _[e="number"==typeof e?e:E].param||{}}function we(e){var t=void 0===e?E:e;return c.eq(t)[0]}function xe(e){var n="";return(e=e||[]).length&&e.forEach((function(e,i){var a=e.title?'<div class="bui-slide-title">'.concat(e.title,"</div>"):"",o=e.background||"background"==e.type?'<div class="bui-slide-img" style="background-image:url('.concat(e.background||e.image||e.src,')">&nbsp;</div>'):'<div class="bui-slide-img"><img src="'.concat(e.image||e.src,'" alt="').concat(e.title||"",'"/></div>'),r="";if("video"==e.type||e.video){var l=t.extend(!0,{},L.video,e,e.video);r='<div class="bui-slide-video">\n                        <video class="bui-video" src="'.concat(l.src,'" width="').concat(l.width,'" height="').concat(l.height,'" poster="').concat(l.poster,'" ').concat(l.preload?"preload":""," ").concat(l.muted?"muted":""," ").concat(l.playsinline?"playsinline":""," ").concat(l.controls?"controls":""," ").concat(l.loop?"loop":""," ").concat(l.fullscreen?"fullscreen":"",' data-wf-ignore="true" data-object-fit="cover" ></video>\n                        </div>')}n+='<li data-id="'.concat(e.id||"",'" href="').concat(e.url||"",'" data-reload="').concat(e.reload||!1,'" data-iframe="').concat(e.iframe||!1,'" data-page="').concat(e.page||!1,'" data-close="').concat(e.page||!0,'" data-synchistory="').concat(e.synchistory||!1,'" data-target="').concat(e.target,'" >\n                  ').concat(r||o,"\n                  ").concat(a,"\n                  </li>")})),n}function ke(e){var i=t.extend(!0,{},n,e);return K(i),W(i),ie(E,"none"),this}function Ie(t,n){return e.on.apply(P,arguments),this}function Te(t,n){return e.off.apply(P,arguments),this}function Oe(t){P.self=this==window||this==P?null:this,e.trigger.apply(P,arguments)}return P}}(window.bui||{},window.libs),t((function(e){!function(t,n){t.tab=function(i){var a=e.config=n.extend(!0,{},{id:"",uid:"",menu:".bui-tab-head > ul",children:".bui-tab-main > ul",header:"header",footer:"footer",main:".bui-tab-main",item:"li",prev:".bui-tab-prev",next:".bui-tab-next",data:null,showNav:!0,navscroll:!1,loadall:!1,position:"top",iconBadge:!0,iconPosition:"left",loaded:null,compiled:null,sideWidth:0,align:"center",alignClassName:"",stopHandle:"",width:0,height:0,relative:!1,zoom:!1,swipe:!0,animate:!0,bufferEffect:!1,visibleNum:1,scrollNum:1,distance:40,direction:"x",autoplay:!1,autoheight:!1,scroll:!0,index:0,fullscreen:!1,autopage:!1,autoload:!1,autoinit:!0,template:null,templateMenuItem:null,async:!0,callback:null,onRemove:null,onBeforeInit:null,onClickNav:null,onInited:null,onStart:null,onMove:null,onEnd:null},t.config.tab,i),o=null,r=null,l=t.guid(),c=null;(o=function(e){r=n.extend(!0,[],e.data),e.data&&(e.menu=e.menu.indexOf("#")>-1?e.menu:".".concat(l,"-menu"),e.children=".".concat(l,"-main"),i=r,o=(a.template||h)(i),t.$(a.id).html(o),e.data=null);var i,o;var c=t.$(".bui-tab-sidenav");if(r&&"left"==e.position){e.sideWidth&&c.width(e.sideWidth);var s=e.sideWidth||c.width();e.width=e.width||n(window).width()-s,t.$(e.id).addClass("bui-tab-left"),t.$(e.id).css({"margin-left":s}),c.css("left",-s)}else if(r&&"right"==e.position){e.sideWidth&&c.width(e.sideWidth);s=e.sideWidth||c.width();e.width=e.width||n(window).width()-s,t.$(e.id).addClass("bui-tab-right"),c.css({left:"100%"})}var u=t.slide(e);"left"!=e.position&&"right"!=e.position||t.$(e.id).css({overflow:"visible"});if(r){u.on("to",(function(e,t){var i=this.index(),o=r&&r[i]||{},l=a.loadall?".delay-item":"#".concat(o.id);o.name&&loader.delay({id:l,param:n.extend({},o.param,t),everytime:o.everytime,loaded:a.loaded,compiled:a.compiled})}));var d=a.animate?"":"none";u.to(e.index,d)}return e.uid&&t.history.setUI&&t.history.setUI({uid:e.uid,ui:u}),u}(a)).name="tab",o.templateNav=f,o.renderNav=function(e,n){var i=templatesNav(n||r);t.$(e).html(i)},o.addBadge=function(e,n){if(e&&!/[0-9]/.test(e))return this;var i=t.$(a.id).find(a.menu).children().eq(e),o=void 0!==n?n:"",r=i.find(".bui-badges"),l=i.find("i");r.size()?r.text(n):l.size()&&a.iconBadge?l.append('<span class="bui-badges">'.concat(o,"</span>")):i.append('<span class="bui-badges">'.concat(o,"</span>"));return this},o.removeBadge=function(e){var n=t.$(a.id).find(a.menu).children();void 0!==e?n.eq(e).find(".bui-badges").remove():n.find(".bui-badges").remove();return this};var s=o.add,u=o.remove,d=!1;function f(e){var t="left"==a.position||"right"==a.position?" bui-tab-sidenav":"",n=a.navscroll?'<div class="bui-navbar">':"",i="".concat(n,'<ul class="bui-nav ').concat(l,"-menu ").concat(t,'">'),o=a.templateMenuItem?a.templateMenuItem:p;return e&&e.forEach((function(e,t){i+=o(e,t)})),i+="</ul>\n                ".concat(a.navscroll?"</div>":"")}function p(e,t){var n="",i=function(e,t){var n=e.icon?e.icon.indexOf("&#")>-1?'<i class="icon">'.concat(e.icon,"</i>"):'<i class="'.concat(e.icon,'"></i>'):"";return n}(e)||function(e,t){var n=e.image?'<i class="icon"><img src="'.concat(e.image,'" /></i>'):"";return n}(e),o=e.needRemove?function(e,t){var n='<i class="icon-close"></i>';return n}():"",r=e.className?"".concat(e.className):"";switch(a.iconPosition){case"left":n+='<li class="bui-btn bui-align-'.concat(a.align," ").concat(r,'"><span class="bui-text-wrap">').concat(i).concat(e.title||"").concat(o,"</span></li>");break;case"right":n+='<li class="bui-btn bui-align-'.concat(a.align," bui-box ").concat(r,'"><div class="span1">').concat(e.title||"","</div>").concat(i).concat(o,"</li>");break;case"bottom":n+='<li class="bui-btn bui-align-'.concat(a.align," ").concat(i?"bui-box-vertical":"bui-box"," ").concat(r,'"><div class="span1">').concat(e.title||"","</div>").concat(i).concat(o,"</li>");break;default:n+='<li class="bui-btn bui-align-'.concat(a.align," ").concat(i?"bui-box-vertical":"bui-box"," ").concat(r,'">').concat(i,'<div class="span1">').concat(e.title||"").concat(o,"</div></li>")}return n}function h(e){var t="",n=a.showNav?function(e){var t="bottom"==a.position?"bui-tab-foot":"",n='<div class="bui-tab-head '.concat(t,'">');return n+=f(e),n+"</div>"}(e):"",i=function(e){var t="left"==a.position||"right"==a.position?'<div class="span1">':"",n="".concat(t,'<div class="bui-tab-main"><ul class="').concat(l,'-main">');return e&&e.forEach((function(e,t){n+=e.content?'<li class="bui-tab-main-item">'.concat(e.content,"</li>"):'<li class="bui-tab-main-item">\n                            <component id="'.concat(e.id,'" class="bui-tab-item-component delay-item" name="').concat(e.name&&0===e.name.indexOf("/")?e.name.substr(1):e.name,'" delay="true"></component>\n                        </li>')})),n+="</ul></div>",n+="left"==a.position||"right"==a.position?"</div>":""}(e);switch(a.position){case"top":default:t=n+i;break;case"bottom":t=i+n}return t}return o.add=function(e){var i=n.extend(!0,{title:"",needRemove:!1,templateMenuItem:null},e);i.menuTemplate=e.templateMenuItem||a.templateMenuItem&&a.templateMenuItem(i,r.length)||i.title&&p(i,r.length)||"";var l=i.onBeforeRemove||a.onBeforeRemove||null,c=i.onRemove||a.onRemove||null;if(r.push(i),i.needRemove&&!d){var u=t.obj(this.config.id),f=this.config;(f.menu.indexOf("#")>-1?t.obj(f.menu):u.find(f.menu).eq(0)).off("click.bui",".icon-close").on("click.bui",".icon-close",(function(e){var t=n(this).parents(".bui-btn").index();e.index=t,!1!==(l&&l.call(o,{index:t},e))&&(o.remove({index:t},e),c&&c.call(o,{index:t},e))})),d=!0}return s(i)},o.remove=function(e){var i=n.extend(!0,{index:-1,keyname:"id",target:"",callback:null},e),a=i.index,o=i.keyname,l=i.target.indexOf("#")>-1?i.target.substr(1):i.target||"";return"array"===t.typeof(r)&&l?(a=t.array.index(r,l,o))>-1&&t.array.deleteIndex(r,a):"array"===t.typeof(r)&&i.index>-1&&t.array.deleteIndex(r,a),i.index=a,u(i)},o.getData=function(e){return r},o.getItem=function(e){if("string"==typeof e)return t.array.get(r,e,"id");var n="number"==typeof e?e:o.index();return r[n]},o.setItem=function(e,i){if("string"==typeof e&&r){var a=t.array.get(r,e,"id");return a=n.extend(a,i)}e="number"==typeof e?e:nowIndex;return r[e]&&(r[e]=n.extend(r[e],i)),r[e]},o.getItemParam=function(e){if("string"==typeof e)return t.array.get(r,e,"id").param;e="number"==typeof e?e:nowIndex;return r[e].param||{}},o.setItemParam=function(e,i){if("string"==typeof e&&r){var a=t.array.get(r,e,"id");return a.param=n.extend(a.param,i),a.param}e="number"==typeof e?e:nowIndex;var o=r[e];return o&&(o=n.extend(o,i)),o.param},o.hideContent=function(e){var n=t.$(a.id),i=o.index();return c={index:i,parentWidth:n.css("width"),parentHeight:n.css("height")},n.find(a.menu).children().removeClass("active"),n.children(".bui-tab-main").css("display","none"),n.css("height","auto"),e&&e.call(this,c),this},o.showContent=function(e){var n=t.$(a.id);n.children(".bui-tab-main").css("display","");var i=n.find(a.menu+" .active");return c&&!i.length&&n.find(a.menu).children().eq(c.index).addClass("active"),c&&n.css("height",c.parentHeight),e&&e.call(this,c),this},o.toggleContent=function(e,n){var i=!0;return"none"==t.$(a.id).children(".bui-tab-main").css("display")?(this.showContent(e),i=!0):(this.hideContent(n),i=!1),i},o.isShow=function(){var e=!0;return"none"==t.$(a.id).children(".bui-tab-main").css("display")&&(e=!1),e},o.refresh=function(e){var i="object"===_typeof(e)?e.index:e,a="number"==typeof i?i:o.index();if("array"===t.typeof(r)){var l=r[a];l.url=l.name+".html",l.param=n.extend(!1,{},l.param,e&&e.param||{}),loader.load(l)}else console.warn("刷新方法仅在data是数组的方式使用");return this},o}}(window.bui||{},window.libs)})),function(e,t){var n,i;e.swipe=(n=null,i=null,function(a){var o,r,l,c,s,u,d,f,p,h,g,m,v={name:"swipe",handle:{},targetEl:null,active:function(){return n},isActive:function(){return _},on:function(t,n){return e.on.apply(v,arguments),this},off:fe,close:function(){if(!D)return re(),this},open:function(e){if(!D){var t=e||{};t.transition=t.transition||b.transition,t.index=t.index||0;var n,i=t.target;switch(z=i,i){case"swiperight":t.target=p.eq(t.index),n=t.target.parent().index(),t.handle=x?o.children().eq(n).children(b.handle):r,R=t.handle,t.target,c=p.attr("data-moving")||m,I&&Q(t);break;case"swipeleft":t.target=f.eq(t.index),n=t.target.parent().index(),t.handle=x?o.children().eq(n).children(b.handle):r,R=t.handle,t.target,c=f.attr("data-moving")||m,T&&Z(t);break;case"swipedown":t.target=g.eq(t.index),n=t.target.parent().index(),t.handle=x?o.children().eq(n).children(b.handle):r,R=t.handle,t.target,c=g.attr("data-moving")||m,C&&te(t);break;case"swipeup":t.target=h.eq(t.index),n=t.target.parent().index(),t.handle=x?o.children().eq(n).children(b.handle):r,R=t.handle,t.target,c=h.attr("data-moving")||m,O&&ee(t);break;default:t.target=p.eq(t.index),n=t.target.parent().index(),t.handle=x?o.children().eq(n).children(b.handle):r,R=t.handle,t.target,I&&Q(t)}return pe.call(v,"open",i),this}},destroy:function(e){e=1==e,o&&(o.off(),e&&o.remove()),fe("open"),fe("close"),D=!0},lock:ue,unlock:de,init:U},b=v.config=t.extend(!0,{},{id:"",uid:"",handle:".handle",swiperight:".swiperight",swipeleft:".swipeleft",swipeup:".swipeup",swipedown:".swipedown",direction:"x",stopHandle:"",relative:!0,swipe:!0,hasChild:!1,handleMove:!0,targetMove:!0,alwaysTrigger:!1,stopPropagation:!1,width:0,height:0,movingDistance:280,initDistance:0,zoom:!1,autoClose:!0,distance:40,autoinit:!0,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onInited:null,transition:300},e.config.swipe,a),y={},w=b.direction,x=b.hasChild,k=!1,I=!1,T=!1,O=!1,C=!1,S=!1,P=!1,L=!1,j=!1,E=b.handleMove,N=b.targetMove,B=!1,R=null,D=!1,_=!1;/hp-tablet/gi.test(navigator.appVersion);var F=!1,A=!1,$=!1,z=(y={x1:0,x2:0,y1:0,y2:0,direction:"",deltax:0,movingleft:0,movingright:0,movingup:0,movingdown:0,scrollObj:null},""),M=b.initDistance,H=document.documentElement;function U(i){var a,d,y=t.extend(!0,b,i);if(y.onBeforeInit&&y.onBeforeInit.call(v,y),D=!1,y.id)return o=e.obj(y.id),s=y.width>0?y.width:y.relative?o.parent().width():H.clientWidth,u=y.height>0?y.height:y.relative?o.parent().height():H.clientHeight,r=o.children(y.handle),l=x?o.children():o,f=l.children(y.swipeleft),p=l.children(y.swiperight),h=l.children(y.swipeup),g=l.children(y.swipedown),a=y.movingDistance,d=_typeof(a),m="number"===d?a:a.indexOf("%")>-1?u*parseFloat(a)/100:parseFloat(a),c=m,Y(),k||(V(),k=!0),n&&n.close(),B||(ue(),function(e){e.swipe&&de(),B=!0}(y)),y.uid&&e.history.setUI&&e.history.setUI({uid:y.uid,ui:v}),y.onInited&&y.onInited.call(v,y),this;e.showLog("swipe id不能为空","bui.swipe.init")}function V(e){l.css({width:s,position:"relative",overflow:"hidden"}),!x&&l.css({height:u}),r.css({position:"relative","z-index":12});try{var t=f.attr("data-moving")||m,n=p.attr("data-moving")||m,i=h.attr("data-moving")||m,a=g.attr("data-moving")||m,o=q(t),c=q(n),d=q(i),v=q(a);T&&f.css({width:o}),I&&p.css({width:c}),C&&g.css({height:v}),O&&h.css({height:d})}catch(e){}}function q(e){return b.zoom?e/100+"rem":e+"px"}function Y(){"x"==w?(I=!!p.length,T=!!f.length):"y"==w?(C=!!g.length,O=!!h.length):"xy"==w&&(C=!!g.length,O=!!h.length,T=!!f.length,I=!!p.length)}function K(n){F=!0;var i=n.touches?n.touches[0]:n;if(n.touches&&n.touches.length>1||n.scale&&1!==n.scale)F=!1;else if(b.stopHandle&&e.unit.checkTargetInclude(n.target,b.stopHandle))F=!1;else{if(y.id=b.id,y.x1=i.clientX,y.y1=i.clientY,y.direction="",d=t(n.target).closest(b.handle),!1===(b.onBeforeTouchstart&&b.onBeforeTouchstart.call(v,n,y)))return!1;pe.call(v,"touchstart",n,y);var a=t(n.target).closest(".bui-scroll"),o=t(n.target).closest(".bui-tab-main li.active"),c=t(n.target).closest("main"),s=t(n.target).closest(".swipedown"),u=t(n.target).closest(".swipeup"),k=s.length?s:u.length?u:d;if(y.scrollObj=a.length?a:o.length?o:c.length?c:s.length?s:k,y.scrollObj.scrollTop(),x&&!_&&(l=(r=d).parent(),f=l.children(b.swipeleft),p=l.children(b.swiperight),h=l.children(b.swipeup),g=l.children(b.swipedown),Y(),l.index(),V(),(0==b.height||""==l[0].style.height)&&l.height(d[0]&&d[0].offsetHeight)),y.movingleft=parseInt(f.attr("data-moving")||m),y.movingright=parseInt(p.attr("data-moving")||m),y.movingup=parseInt(h.attr("data-moving")||m),y.movingdown=parseInt(g.attr("data-moving")||m),d.length){var S=!1;switch(w){case"x":S=!(!T&&!I);break;case"y":S=!(!O&&!C);break;case"xy":S=!!(T||I||O||C)}}F=null==S||1==S}}function W(t){if(F){A=!0;var a=t.touches?t.touches[0]:t;if(t.touches&&t.touches.length>1||t.scale&&1!==t.scale)re();else{if(y.x2=a.clientX,y.y2=a.clientY,!1===(b.onBeforeTouchmove&&b.onBeforeTouchmove.call(v,t,y)))return!1;pe.call(v,"touchmove",t,y),n&&t.stopPropagation();var l=y.scrollObj.scrollTop()<=0,s=(y.scrollObj[0]&&y.scrollObj[0].scrollHeight)-(y.scrollObj[0]&&y.scrollObj[0].offsetHeight)-y.scrollObj.scrollTop()<=2,u=y.y2-y.y1>0,m=y.y2-y.y1<0;if(L){if(u&&l)return A=!1,void t.preventDefault();if(m&&s&&t.preventDefault(),m&&!s)return void(A=!1);if(u&&!l)return void(A=!1)}if(C&&!L&&(u&&l&&t.preventDefault(),m&&s&&t.preventDefault()),!C&&u&&l&&t.preventDefault(),j){if(u&&l&&t.preventDefault(),m&&s)return t.preventDefault(),void(A=!1);if(m&&!s)return void(A=!1);if(u&&!l)return void(A=!1)}y.direction||(y.direction=e.swipeDirection(y.x1,y.x2,y.y1,y.y2)),"swipeleft"!==y.direction&&"swiperight"!==y.direction||t.preventDefault();try{if("swipeup"===y.direction||"swipedown"===y.direction){var w=o[0].scrollTop||0,x=(o[0].scrollHeight,d[0].scrollTop,d[0].scrollHeight,y.scrollObj[0]&&y.scrollObj[0].scrollTop||0),k=y.scrollObj[0]&&y.scrollObj[0].offsetHeight||0,B=y.scrollObj[0]&&y.scrollObj[0].scrollHeight||0,R=!1,D=!1;w<=0&&x<=0&&(R=!0),B-x-k<=2&&(D=!0)}}catch(t){}var $="swiperight"==y.direction||"swipeleft"==y.direction?y.x2-y.x1:y.y2-y.y1,z=0;y.deltax=_?Math.abs($):Math.abs($)+M,!I||"swiperight"!=y.direction||P||_||i?!R||!C||"swipedown"!=y.direction||L||_||i?!T||"swipeleft"!=y.direction||S||_||i?!D||!O||"swipeup"!=y.direction||j||_||i?"swipeleft"==y.direction&&P?(c=y.movingright,z=J(y,y.movingright),N&&ce(-y.deltax,0,"none",i||p),E&&ce(-z,0,"none",r),pe.call(v,"movingleft",t,y),A=!0,t.stopPropagation()):"swipeup"==y.direction&&L?(c=y.movingdown,z=J(y,y.movingdown),N&&ce(0,-y.deltax,"none",i||g),E&&ce(0,-z,"none",r),pe.call(v,"movingup",t,y),A=!0,t.preventDefault(),t.stopPropagation()):"swiperight"==y.direction&&S?(c=y.movingleft,z=J(y,y.movingleft),N&&ce(y.deltax,0,"none",i||f),E&&ce(z,0,"none",r),pe.call(v,"movingright",t,y),A=!0,t.stopPropagation()):"swipedown"==y.direction&&j&&(c=y.movingup,z=J(y,y.movingup),N&&ce(0,y.deltax,"none",i||h),E&&ce(0,z,"none",r),pe.call(v,"movingdown",t,y),A=!0,t.preventDefault(),t.stopPropagation()):(c=y.movingup,z=G(y,y.movingup),N&&ce(0,z,"none",h),E&&ce(0,-y.deltax,"none",r),pe.call(v,"movingup",t,y),A=!0,t.preventDefault(),t.stopPropagation()):(c=y.movingleft,z=G(y,y.movingleft),N&&ce(z,0,"none",f),E&&ce(-y.deltax,0,"none",r),pe.call(v,"movingleft",t,y),A=!0,t.stopPropagation()):(c=y.movingdown,z=J(y,y.movingdown),N&&ce(0,z,"none",g),E&&ce(0,y.deltax,"none",r),pe.call(v,"movingdown",t,y),A=!0,t.preventDefault(),t.stopPropagation()):(c=y.movingright,z=J(y,y.movingright),N&&ce(z,0,"none",p),E&&ce(y.deltax,0,"none",r),pe.call(v,"movingright",t,y),A=!0,t.stopPropagation())}}}function X(t){if(F=!1,$=!0,pe.call(v,"touchend",t,y),!1===(b.onBeforeTouchend&&b.onBeforeTouchend.call(v,t,y)))return!1;if(A){var n="",i=!1,a=!1,o=!1,r=!1;switch(y.direction){case"swiperight":n="swipeleft",a=!0;break;case"swipeleft":n="swiperight",i=!0;break;case"swipeup":n="swipedown",o=!0;break;case"swipedown":n="swipeup",r=!0}var l=a||i?Math.abs(y.x2-y.x1):Math.abs(y.y2-y.y1);if(I&&a&&l>b.distance&&!P&&!_)Q(),pe.call(v,y.direction,t,y),pe.call(v,"open",y.direction);else if(T&&i&&l>b.distance&&!S&&!_)Z(),pe.call(v,y.direction,t,y),pe.call(v,"open",y.direction);else if(O&&o&&l>b.distance&&!j&&!_)ee(),pe.call(v,y.direction,t,y),pe.call(v,"open",y.direction);else if(C&&r&&l>b.distance&&!L&&!_)te(),pe.call(v,y.direction,t,y),pe.call(v,"open",y.direction);else if(_&&l<b.distance)T&&S&&Z(),I&&P&&Q(),O&&j&&ee(),C&&L&&te(),pe.call(v,y.direction,t,y),b.alwaysTrigger&&pe.call(v,"open",y.direction);else if(_&&l>b.distance){var c=T&&S&&a,s=I&&P&&i,u=O&&j&&r,d=C&&L&&o;c&&ie(),s&&ne(),u&&ae(),d&&oe(),pe.call(v,y.direction,t,y),(c||s||u||d)&&pe.call(v,"close",n)}else!_&&l<b.distance&&(i&&T&&!S&&ie(),a&&I&&!P&&ne(),o&&O&&!j&&ae(),r&&C&&!L&&oe(),b.alwaysTrigger&&pe.call(v,"close",n),pe.call(v,y.direction,t,y));z=y.direction,F=!1,!e.platform.isPC()&&(A=!1),b.stopPropagation&&t.stopPropagation()}}function J(e,t){var n=-t+e.deltax;return n=n>0?0:n}function G(e,t){var n=t-e.deltax;return n=n>t?t:n}function Z(e){(e=e||{}).transition=e.transition||b.transition,e.target=e.target||f,e.handle=e.handle||r,n&&n.close(),_=!0,S=!0,x&&(v.targetEl=f[0],n=v,i=f,H.addEventListener("click",le,!0)),N&&ce(0,0,e.transition,e.target),E&&ce(-c,0,e.transition,e.handle)}function Q(e){(e=e||{}).transition=e.transition||b.transition,e.target=e.target||p,e.handle=e.handle||r,n&&n.close(),_=!0,P=!0,x&&(v.targetEl=p[0],n=v,i=p,H.addEventListener("click",le,!0)),N&&ce(0,0,e.transition,e.target),E&&ce(c,0,e.transition,e.handle)}function ee(e){(e=e||{}).transition=e.transition||b.transition,e.target=e.target||h,e.handle=e.handle||r,n&&n.close(),_=!0,j=!0,x&&(v.targetEl=h[0],n=v,i=h,H.addEventListener("click",le,!0)),N&&ce(0,0,e.transition,e.target),E&&ce(0,-c,e.transition,e.handle)}function te(e){(e=e||{}).transition=e.transition||b.transition,e.target=e.target||g,e.handle=e.handle||r,n&&n.close(),_=!0,L=!0,x&&(v.targetEl=g[0],n=v,i=g,H.addEventListener("click",le,!0)),N&&ce(0,0,e.transition,e.target),E&&ce(0,c,e.transition,e.handle)}function ne(e){(e=e||{}).transition=e.transition||b.transition,e.target=p,e.handle=R||r,_=!1,P=!1,x&&(n=null,i=null,R=null,H.removeEventListener("click",le,!0)),N&&ce(-(c+1),0,e.transition,e.target),E&&ce(M,0,e.transition,e.handle)}function ie(e){(e=e||{}).transition=e.transition||b.transition,e.target=f,e.handle=R||r,_=!1,S=!1,x&&(n=null,i=null,R=null,H.removeEventListener("click",le,!0)),N&&ce("101%",0,e.transition,e.target),E&&ce(-M,0,e.transition,e.handle)}function ae(e){(e=e||{}).transition=e.transition||b.transition,e.target=h,e.handle=R||r,_=!1,j=!1,x&&(n=null,i=null,R=null,H.removeEventListener("click",le,!0)),N&&ce(0,"100%",e.transition,e.target),E&&ce(0,-M,e.transition,e.handle)}function oe(e){(e=e||{}).transition=e.transition||b.transition,e.target=g,e.handle=R||r,_=!1,L=!1,x&&(n=null,i=null,R=null,H.removeEventListener("click",le,!0)),N&&ce(0,-c,e.transition,e.target),E&&ce(0,M,e.transition,e.handle)}function re(){P&&ne(),S&&ie(),L&&oe(),j&&ae(),pe.call(v,"close",z)}function le(e){if(!A||!$){var i=t(e.target),a=i.closest(f).length||i.closest(p).length||i.closest(h).length||i.closest(g).length||e.target.className.indexOf("bui-mask")>-1||e.target.className.indexOf("bui-click")>-1;n&&(a||(n.close(),e.stopPropagation()))}}function ce(e,t,n,i){var a=i||o,r=(e=e||0,t=t||0,b.zoom?parseFloat(e)/100+"rem":parseFloat(e)+"px"),l=b.zoom?parseFloat(t)/100+"rem":parseFloat(t)+"px",c=String(e).indexOf("%")>-1?e:r,s=String(t).indexOf("%")>-1?t:l;return n="number"==typeof n?"all "+n+"ms":n||"all 300ms",a.css({"-webkit-transition":n,transition:n,"-webkit-transform":"translate("+c+","+s+")",transform:"translate("+c+","+s+")"}).one("webkitTransitionEnd",(function(){a.css({"-webkit-transition":"none",transition:"none"}),A=!1})),this}function se(){var t={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};return e.platform.isPC()&&(t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseleave"}),t}function ue(){if(!D){var e=se();return o.off(e.touchstart,K).off(e.touchmove,W).off(e.touchend,X).off(e.touchcancel),pe.call(v,"lock"),this}}function de(){if(!D){var t=se();return o.on(t.touchstart,K).on(t.touchmove,W).on(t.touchend,X).on(t.touchcancel,(function(t){b.autoClose&&e.platform.isPC()&&($||A)&&(ne(),ie(),oe(),ae(),v.targetEl=null,pe.call(v,"close",z),t.stopPropagation()),F=!1,A=!1,$=!1})),pe.call(v,"unlock"),this}}function fe(t,n){return e.off.apply(v,arguments),this}function pe(t){v.self=this==window||this==v?null:this,e.trigger.apply(v,arguments)}return b.autoinit&&U(b),v})}(window.bui||{},window.libs),function(e,t){e.sidebar=function(n){var i,a={name:"sidebar",handle:{},on:function(t,n){return e.on.apply(a,arguments),this},off:h,active:function(){return i.active()},isActive:function(){return c},open:f,close:p,lock:function(){return i.lock(),g.call(this,"lock"),this},unlock:function(e){return i.unlock(),g.call(this,"unlock"),this},destroy:function(e){e=1==e;u&&u.off("click.bui");h("open"),h("close"),r&&r.destroy(e),i&&i.destroy(e)},widget:function(t){var n={swipe:i,mask:r};return e.widget.call(n,t)},option:function(t,n){return e.option.call(a,t,n)},config:o,init:d},o=a.config=t.extend(!0,{},{id:"",uid:"",trigger:"",handle:".bui-page",swiperight:".swiperight",swipeleft:".swipeleft",handleMove:!0,swipe:!0,stopHandle:"",zIndex:121,mask:!0,width:280,opacity:.1,height:0,zoom:!0,autoClose:!0,stopPropagation:!1,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,autoinit:!0,onBeforeInit:null,onInited:null,distance:40},e.config.sidebar,n),r=null,l=null,c=!1,s=!1,u=null;function d(n){var d=t.extend(!0,o,n);return d.onBeforeInit&&d.onBeforeInit.call(a,d),o=a.config=d,d.trigger&&(u=e.obj(d.trigger)),l=e.obj(d.handle),i||(i=e.swipe({id:d.id,handle:d.handle,movingDistance:d.width,swipe:d.swipe,swiperight:d.swiperight,swipeleft:d.swipeleft,stopHandle:d.stopHandle,autoClose:d.autoClose,stopPropagation:d.stopPropagation,direction:"x",hasChild:!1,width:0,height:0,onBeforeTouchstart:d.onBeforeTouchstart,onBeforeTouchmove:d.onBeforeTouchmove,onBeforeTouchend:d.onBeforeTouchend,handleMove:d.handleMove,zoom:d.zoom,distance:d.distance,transition:300})),o.mask&&!r&&(r=bui.mask({id:d.id+"-mask",appendTo:l,autoTrigger:!1,zIndex:d.zIndex-1,opacity:d.opacity,callback:function(){i.close()}})),s||(!function(){var e=this;i.on("open",(function(t){u&&u.addClass("active"),r&&r.show(),l.css("overflow-y","hidden"),c=!0,g.call(e,"open",t)})),i.on("close",(function(){u&&u.removeClass("active"),r&&r.hide(),l.css("overflow-y","auto"),c=!1,g.call(e,"close")})),u&&u.off("click.bui").on("click.bui",(function(e){if(!t(this).hasClass("disabled")){var n=t(this).attr("data-target")||"swiperight";c?p():f({target:n})}})),s=!0}(),d.height>0&&e.obj(d.id).height(d.height)),d.uid&&e.history.setUI&&e.history.setUI({uid:d.uid,ui:a}),d.onInited&&d.onInited.call(a,d),this}function f(e){var t=e||{};return t.target=t.target||"swiperight",t.transition=t.transition||300,i.open(t),this}function p(){return i.close(),this}function h(t,n){return e.off.apply(a,arguments),this}function g(t){a.self=this==window||this==a?null:this,e.trigger.apply(a,arguments)}return o.autoinit&&d(o),a}}(bui||{},libs),function(e,t){e.listview=function(n){var i,a,o,r={name:"listview",active:function(){return i.active()},pin:function(){if(i.targetEl){var e=t(i.targetEl).parent();i.close(),e.addClass("bui-pin").clone().prependTo(a),e.remove()}},unpin:function(e){if(i.isActive()){var n=t(i.targetEl).parent();if(i.close(),e)n.removeClass("bui-pin").clone().appendTo(a),n.remove();else{n.removeClass("bui-pin");var o=a.find(".bui-pin").last();o.length&&(o.after(n.clone()),n.remove())}}},ispin:function(){if(i.targetEl){return t(i.targetEl).parent().hasClass("bui-pin")}return!1},index:function(e){return i.isActive()?t(i.targetEl).parent().index():-1},remove:function(){if(i.targetEl){var e=t(i.targetEl).parent();i.close(),e.remove()}},lock:function(){return i.lock(),f.call(this,"lock"),this},unlock:function(e){return i.unlock(),f.call(this,"unlock"),this},open:function(e){var t=e||{};return t.target=t.target||("right"==l.position?l.swipeleft.substr(1):l.swiperight.substr(1)),t.transition=t.transition||300,t.index=t.index||0,i.open(t),this},isActive:s,close:function(){return i.close(),this},destroy:function(e){e=1==e;o&&(o.off("click.bui"),o=null);a&&(a.off("click.bui"),e&&a.remove(),a=null);d("open"),d("close"),i&&i.destroy(e),l=null,r=null},widget:function(t){var n={swipe:i};return e.widget.call(n,t)},option:function(t,n){return e.option.call(r,t,n)},config:l,init:u},l=r.config=t.extend(!0,{},{id:"",uid:"",data:[],handle:".bui-btn",stopHandle:"",swiperight:".swiperight",swipeleft:".swipeleft",position:"right",width:0,height:0,relative:!1,menuWidth:160,menuHeight:0,distance:80,swipe:!0,zoom:!1,stopPropagation:!1,autoClose:!0,autoinit:!0,template:null,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onInited:null,callback:null},e.config.listview,n),c=!1,s=!1;function u(n){var u=t.extend(!0,l,n);return u.onBeforeInit&&u.onBeforeInit.call(r,u),l=r.config=u,a=e.obj(u.id),(o=a.children()).length&&function(e){e.height>0&&a.height(e.height);e.data&&e.data.length?o.each((function(n,i){var a=t(i),o=a.attr("status"),l=e.menuHeight>0?e.menuHeight:i.offsetHeight;if(!o){var c="function"==typeof e.template?e.template.call(r,e.data):function(e){var n="",i="right"==e.position?e.swipeleft.substr(1):e.swiperight.substr(1);return n+='<div class="bui-listview-menu '+i+'">',t.each(e.data,(function(e,t){n+='    <div class="bui-btn '+t.classname+'">'+t.text+"</div>"})),n+="</div>",n}(e);a.append(c).attr("status","1")}i.style.height||t(i).height(l)})):o.each((function(n,i){var a=e.menuHeight>0?e.menuHeight:i.offsetHeight;i.style.height||t(i).height(a)}))}(u),c||function(t){var n=this,o=function(e){e.ui=r,t.callback&&t.callback.call(r,e,i)};a.off("click.bui",".bui-listview-menu .bui-btn").on("click.bui",".bui-listview-menu .bui-btn",o),i=e.swipe({id:t.id,handle:t.handle,stopHandle:t.stopHandle,stopPropagation:t.stopPropagation,movingDistance:t.menuWidth,swipe:t.swipe,swiperight:t.swiperight,swipeleft:t.swipeleft,direction:"x",autoClose:t.autoClose,hasChild:!0,width:t.width,relative:t.relative,height:0,zoom:t.zoom,distance:t.distance,onBeforeTouchstart:t.onBeforeTouchstart,onBeforeTouchmove:t.onBeforeTouchmove,onBeforeTouchend:t.onBeforeTouchend,transition:300}),i.on("open",(function(e){s=!0,f.call(n,"open",e)})),i.on("close",(function(e){s=!1,f.call(n,"close",e)})),c=!0}(u),u.uid&&e.history.setUI&&e.history.setUI({uid:u.uid,ui:r}),u.onInited&&u.onInited.call(r,u),this}function s(){return i&&i.isActive()}function d(t,n){return e.off.apply(r,arguments),this}function f(t){r.self=this==window||this==r?null:this,e.trigger.apply(r,arguments)}return l.autoinit&&u(l),r}}(window.bui||{},window.libs),function(e,t){e.pullrefresh=function(n){var i,a,o,r,l,c,s="."+e.prefix("scroll-head"),u="."+e.prefix("scroll-main"),d="."+e.prefix("scroll-foot"),f={id:"",uid:"",stopHandle:"",childrenTop:s,childrenMain:u,handleMove:"main",header:".bui-page header",footer:".bui-page footer",distance:100,backDistance:50,maxDistance:0,autoLoad:!0,lastUpdated:!1,height:0,cacheHeight:!0,refreshTips:{start:"刷新中..",release:"松开刷新",end:"下拉刷新",fail:"刷新失败,请检查下网络再试试",success:"刷新成功"},loading:null,autoinit:!0,stopPropagation:!1,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onBeforeRefresh:null,onInited:null,onRefresh:null},p={name:"pullrefresh",handle:{},on:function(t,n){return e.on.apply(p,arguments),this},off:U,reverse:function(e,t,n){w||(L("success"),x.show({text:h.refreshTips.success,onlyText:!1}),z(e,t),k.one("webkitTransitionEnd",(function(){x&&x.hide().pause(),w=!1,n&&n.call(p)})));return this},refresh:function(){z(h.backDistance,!0),L("start"),x.start({text:h.refreshTips.start,onlyText:!1}),h.onRefresh&&c()},reload:function(){h.onRefresh&&c()},setHeight:H,resize:function(e){var t=e||{height:0,width:0};this.setHeight(t),t&&t.width>0&&i.width(t.width);return this},fail:function(){w=!0,z(),L("fail"),e.hint(h.refreshTips.fail),V.call(p,"fail")},lock:function(e){m=!0;var t=A();return i.off(t.touchstart,N).off(t.touchmove,_).off(t.touchend,F).off(t.touchcancel),z(),e&&e.call(p),V.call(p,"lock"),this},status:L,unlock:$,destroy:function(e){e=1==e;i&&(i.off(),e&&i.remove());x&&x.destroy(e),U("refresh"),U("movingdown"),U("swipedown")},widget:function(t){var n={loading:x};return e.widget.call(n,t)},option:function(t,n){return e.option.call(p,t,n)},config:h,init:P},h=p.config=t.extend(!0,{},f,e.config.pullrefresh,n),g=0,m=!1,v=(new Date).getTime(),b=!1,y=!1,w=!1,x=null;/hp-tablet/gi.test(navigator.appVersion);var k=null,I=0,T=0,O=!1,C=!1,S={x1:0,x2:0,y1:0,y2:0,direction:""};function P(n){var f=t.extend(!0,h,n);if(f.onBeforeInit&&f.onBeforeInit.call(p,f),f.id){if(i=e.obj(f.id),h=p.config=f,i[0],a=i.children(s),o=i.children(u),r=i.children(d),"head"===f.handleMove?(k=a,i.attr("handlemove","head")):(k=o,i.attr("handlemove","main")),c=j,l=f.refreshTips.end,!x){L("end");var g=t.extend(!0,{appendTo:a,width:20,height:20,autoClose:!1,text:l,onlyText:!0,display:"inline",autoTrigger:!1,mask:!1},f.loading);x=e.loading(g)}return f.autoLoad&&(b=!0,L("start"),x.start({text:f.refreshTips.start,onlyText:!1}),c()),y||function(e){m||$();y=!0}(),H(f.height),f.uid&&e.history.setUI&&e.history.setUI({uid:f.uid,ui:p}),f.onInited&&f.onInited.call(p,f),this}e.hint("pullrefresh id不能为空")}function L(e){return"string"!=typeof e?i.attr("pullrefresh-status"):(i.attr("pullrefresh-status",e),this)}function j(){v=(new Date).getTime(),h.onBeforeRefresh&&h.onBeforeRefresh.call(p),h.onRefresh&&h.onRefresh.call(p),V.call(p,"refresh")}h.autoinit&&P(h);var E=0;function N(n){O=!0;var o=n.touches?n.touches[0]:n;if(S.x1=o.clientX,S.y1=o.clientY,S.direction="",E=i.scrollTop(),h.stopHandle&&e.unit.checkTargetInclude(n.target,h.stopHandle))O=!1;else if(n.touches&&n.touches>1||n.scale&&1!==n.scale)O=!1;else{var r,c,s;if(!1===(h.onBeforeTouchstart&&h.onBeforeTouchstart.call(p,n,S)))return!1;l=h.lastUpdated?(r=(new Date).getTime()-v,c=Math.floor(r/36e5),s=Math.floor(r/6e4),c<=0&&s<=0?"刚刚更新":c<=0&&s>0?s+"分钟前更新":"上次更新时间:"+(c<10?"0"+c:c)+":"+(s<10?"0"+s:s)):h.refreshTips.end,V.call(p,"touchstart",n,S),"head"===h.handleMove&&a.css("zIndex",10),t(window).scrollTop()<=0&&E<=0&&h.onRefresh&&!b?(O=!0,t(this).css("touch-action","none")):(O=!1,a.css("zIndex",0)),h.stopPropagation&&n.stopPropagation()}}var B=!1,R=!1,D=i.find(".bui-scroll-head .bui-loading-cell");function _(t){var n=t.touches?t.touches[0]:t;if(O)if(t.touches&&t.touches.length>1||t.scale&&1!==t.scale)z();else{if(S.x2=n.clientX,S.y2=n.clientY,!1===(h.onBeforeTouchmove&&h.onBeforeTouchmove.call(p,t,S)))return!1;if(S.direction||(S.direction=e.swipeDirection(S.x1,S.x2,S.y1,S.y2),L("start"),x.show({text:h.refreshTips.start,onlyText:!1}).pause()),V.call(p,"touchmove",t,S),"swipeleft"!==S.direction&&"swiperight"!==S.direction||t.preventDefault(),S.y2-S.y1>0&&E<=0&&t.preventDefault(),"swipedown"==S.direction){V.call(p,"movingdown",t,S);var a=(g=Math.abs(S.y2-S.y1))/2,o=360*parseFloat(g/h.distance).toFixed(2);D.length||(D=i.find(".bui-scroll-head .bui-loading-cell")),D.css("transform","rotate(".concat(o>360?360:o,"deg)")),z(a,!1),g>=h.distance?B||(L("release"),x.show({text:h.refreshTips.release,onlyText:!1}).pause(),B=!0,R=!1):R||(x.show({text:l,onlyText:!1}).pause(),R=!0,B=!1),C=!0,h.maxDistance>h.distance&&g>=h.maxDistance&&(L("release"),x.show({text:h.refreshTips.start,onlyText:!1}),b=!0,h.onRefresh&&c(),C=!1,B=!1,R=!1,I+=(S={}).y2-S.y1,T+=S.x2-S.x1,S.lastX=T,S.lastY=I,S={x1:0,x2:0,y1:0,y2:0,direction:""},O=!1,C=!1),t.preventDefault(),t.stopPropagation()}else"swipeup"==S.direction&&(V.call(p,"movingup",t,S),C=!0,t.stopPropagation());x&&x.pause()}else z()}function F(e){return V.call(p,"touchend",e,S),!1!==(h.onBeforeTouchend&&h.onBeforeTouchend.call(p,e,S))&&(t(this).css("touch-action","auto"),C?("swipedown"==S.direction?(V.call(p,S.direction,e,S),g>=h.distance?(z(h.backDistance),L("start"),x.show({text:h.refreshTips.start,onlyText:!1}).start(),b=!0,h.onRefresh&&c()):z(),e.stopPropagation(),B=!1,R=!1,S={}):"swipeup"==S.direction&&(V.call(p,S.direction,e,S),e.stopPropagation()),I+=S.y2-S.y1,T+=S.x2-S.x1,S.lastX=T,S.lastY=I,S={x1:0,x2:0,y1:0,y2:0,direction:""},O=!1,C=!1,void a.css("zIndex",0)):(S={x1:0,x2:0,y1:0,y2:0,direction:""},O=!1,void(C=!1)))}function A(){var t={touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",touchcancel:"touchcancel"};return e.platform.isPC()&&(t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseleave"}),t}function $(t){var n=A();return m=!1,i.on(n.touchstart,N).on(n.touchmove,_).on(n.touchend,F).on(n.touchcancel,(function(t){O=!1,C=!1,!e.platform.isPC()&&z(t)})),t&&t.call(this),V.call(p,"unlock"),this}function z(e,t){b=!1;var n=(t=0!=t)?"all 300ms ease-out":"none";return M(0,(e=e||0)+"px",n,k),r.length&&("head"===h.handleMove?r.find(".bui-loading-text").text(""):M(0,e+"px",n,r)),this}function M(e,t,n,a){a=a||i;var o=e=e||0,r=t=t||0,l=String(e).indexOf("%")>-1?String(e):o,c=String(t).indexOf("%")>-1?String(t):r;n="number"==typeof n?"all "+n+"ms":n||"all 300ms";try{a.css({"-webkit-transition":n,transition:n,"-webkit-transform":"translate("+l+","+c+")",transform:"translate("+l+","+c+")"}),a.one("webkitTransitionEnd",(function(){a.css({"-webkit-transition":"none",transition:"none"})}))}catch(e){console.log(e.message)}}function H(e){var t=e||i.parents(".bui-tab-main-item").height()||i.parents(".bui-dialog-main").height()||i.parents("main").height()||window.viewport.height()-(i[0]?i[0].offsetTop:0);i.height(t)}function U(t,n){return e.off.apply(p,arguments),this}function V(t){p.self=this==window||this==p?null:this,e.trigger.apply(p,arguments)}return p}}(window.bui||{},window.libs),function(e,t){e.scroll=function(n){var i,a,o,r,l,c,s,u,d,f="."+e.prefix("list"),p="."+e.prefix("scroll-head"),h="."+e.prefix("scroll-main"),g="."+e.prefix("scroll-foot"),m={id:"",uid:"",childrenTop:p,childrenMain:h,childrenBottom:g,children:f,stopHandle:"",header:".bui-page header",footer:".bui-page footer",handle:"li",distance:100,backDistance:50,endDistance:5,height:"100%",page:1,pageSize:10,stopPropagation:!1,handleMove:"main",lastUpdated:!0,autoRefresh:!1,autoNext:!0,autoScroll:!0,refresh:!0,cacheHeight:!0,refreshPage:!0,scroll:!0,delayTime:100,direction:"y",scrollTips:{start:"努力加载中..",end:"上拉加载更多",nodata:"没有更多内容",last:"没有更多内容",fail:"点击重新加载"},refreshTips:{start:"刷新中..",release:"松开刷新",end:"下拉刷新",fail:"点击加载",success:"刷新成功"},loading:null,scrollLoading:null,autoinit:!0,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onInited:null,onScrolling:null,onBeforeRefresh:null,onRefresh:null,onBeforeLoad:null,onLoad:null},v={name:"scroll",handle:{},on:function(t,n){return e.on.apply(v,arguments),this},off:A,reverse:function(e){return u&&u.reverse(),e&&e.call(v,u),this},updateCache:R,updatePage:R,getPage:function(){return b.page},getCache:function(e){return L},clearCache:function(e){return void(L={})},resize:function(e){var t=e||{height:0,width:0};(void 0===e||"number"==typeof t||"string"==typeof t||t&&t.height)&&this.setHeight(t.height||t);t&&t.width&&i.width(t.width);return this},fail:function(e,t){return x=!0,F("fail"),w.show({text:b.scrollTips.fail,onlyText:!0,callback:function(n){N(e,t)}}).hideRing(),u&&u.lock(),this},filter:function(t,n){var i,a,o=[];if(t&&n)for(i in L){var r=e.array.filter(L[i],t,n)||[];if(r.length)for(a in r)o.push(r[a])}return o},to:D,toBottom:function(e){i[0]&&(i[0].scrollTop=i[0].scrollHeight,e&&e.call(v));return this},scrollTop:function(e){var n=0;n="object"===_typeof(e)||"string"==typeof e&&e.indexOf("#")>-1?t(e)[0].offsetTop:parseInt(e)||0;return a.scrollTop=n,this},status:F,lock:function(){return i.off("scroll"),$.call(v,"lock"),this},unlock:function(t){return i.on("scroll",e.unit.debounce(E,b.delayTime)),$.call(v,"unlock"),this},lockrefresh:function(){return u.lock(),this},unlockrefresh:function(){return u.unlock(),this},refresh:function(){return D(1),u&&u.refresh(),this},reload:function(){return D(1),u&&u.reload(),this},load:function(e){return C=e=e||C,s&&s.call(v,C,S),this},nextPage:function(){return s&&s.call(v,++C,S),this},prevPage:function(){C-- >0&&s&&s.call(v,C--,S);return this},setHeight:_,isRefresh:function(){return O},destroy:function(e){e=1==e;i&&(i.off("scroll"),e&&i.remove());u&&u.destroy(e),w&&w.destroy(e),A("loadpage"),A("lastpage"),A("scrolltop"),A("scrollbottom"),A("scrollend")},widget:function(t){var n={pullrefresh:u,loading:w};return e.widget.call(n,t)},option:function(t,n){return e.option.call(v,t,n)},config:b,init:j},b=v.config=t.extend(!0,{},m,e.config.scroll,n),y=b.page,w=null,x=!1,k=!0,I=!0,T=!1,O=!1,C=b.page,S=b.pageSize,P=!1,L={};function j(n){var o=t.extend(!0,{},b,n);if(o.onBeforeInit&&o.onBeforeInit.call(v,o),t(window),o.id){if(i=e.obj(o.id),C=o.page,S=o.pageSize,b=v.config=o,k=!0,I=!0,T=!1,O=!1,a=i[0],i.children(p),l=i.children(h),r=i.children(g),l.css({position:"relative"}),!w){F("start");var d=t.extend(!0,{appendTo:r,width:20,height:20,autoClose:!1,text:o.scrollTips.start,zIndex:10,display:"inline",autoTrigger:!1,mask:!1},o.scrollLoading);w=e.loading(d)}c=B,s=N,u?u.init({id:o.id,onBeforeRefresh:o.onBeforeRefresh,onRefresh:c,distance:o.distance,backDistance:o.backDistance,maxDistance:o.maxDistance,lastUpdated:o.lastUpdated,height:o.height,cacheHeight:o.cacheHeight,stopPropagation:o.stopPropagation,handleMove:o.handleMove,loading:o.loading,refreshTips:o.refreshTips,autoLoad:o.autoRefresh}):o.refresh&&o.onRefresh?((u=e.pullrefresh({id:o.id,onBeforeRefresh:o.onBeforeRefresh,onRefresh:c,distance:o.distance,backDistance:o.backDistance,stopHandle:o.stopHandle,maxDistance:o.maxDistance,lastUpdated:o.lastUpdated,header:o.header,footer:o.footer,height:o.height,handleMove:o.handleMove,cacheHeight:o.cacheHeight,stopPropagation:o.stopPropagation,onBeforeTouchstart:o.onBeforeTouchstart,onBeforeTouchmove:o.onBeforeTouchmove,onBeforeTouchend:o.onBeforeTouchend,loading:o.loading,refreshTips:o.refreshTips,autoLoad:o.autoRefresh})).lock(),x=!0):"y"===o.direction&&_(o.height),"x"===o.direction&&i.addClass("bui-box-center").attr("direction","x");try{s&&s.call(v,C,S)}catch(t){e.showLog(t,"bui.scroll.init")}return P||o.scroll&&function(t){i.off("scroll").on("scroll",e.unit.debounce(E,t.delayTime)),P=!0}(o),o.uid&&e.history.setUI&&e.history.setUI({uid:o.uid,ui:v}),o.onInited&&o.onInited.call(v,o),this}e.hint("scroll id不能为空")}function E(e){var t=e.target,n=t.scrollTop||0,i=t.scrollLeft||0;"y"===b.direction?0==n?$.call(v,"scrolltop",e):t.scrollTop+t.clientHeight>=(t&&t.scrollHeight-b.endDistance)&&b.onLoad&&(b.page=v.config.page=++C,b.autoScroll&&s&&s.call(v,b.page,S),$.call(v,"scrollbottom",e)):0==i?$.call(v,"scrolltop",e):t.scrollLeft+t.clientWidth>=(t&&t.scrollWidth-b.endDistance)&&b.onLoad&&(b.page=v.config.page=++C,b.autoScroll&&s&&s.call(v,b.page,S),$.call(v,"scrollbottom",e)),$.call(v,"scrollend",e),b.onScrolling&&b.onScrolling.call(v,e,v)}function N(e,t){return O=!1,I&&!T&&(b.page=v.config.page=e,b.onBeforeLoad&&b.onBeforeLoad.call(v,e,t),b.onLoad&&w&&F("start"),b.onLoad&&w&&w.start({text:b.scrollTips.start,onlyText:!1}),b.onLoad&&b.onLoad.call(v,e,t)),x&&b.refresh&&u&&u.unlock(),this}function B(){I=!0,T=!1,k=!0,O=!0,b.refreshPage&&(C=y,S=b.pageSize,L={}),b.page=v.config.page=C,$.call(v,"refresh",C),b.onRefresh&&b.onRefresh.call(v,C,S)}function R(t,n,a){a=0!=a;if(!n||"array"!=e.typeof(n))return w&&w.stop(),e.showLog("scroll 控件的updatePage 第2个参数,必须是一个数组,如果是list控件,检测field的data映射是否准确","bui.scroll.updatePage"),void(n=[]);d&&clearTimeout(d),d=setTimeout((function(){var e=parseInt(i.height()),o=parseInt(i.find(b.childrenMain)[0]&&i.find(b.childrenMain)[0].scrollHeight);if(a)if(n&&n.length>S-1){if(I=!0,T=!1,k=!1,F("end"),w&&w.start({text:b.scrollTips.end,onlyText:!0}),o>=10&&o<e&&b.autoNext&&b.onLoad){var r=++C;s&&s.call(v,r,S)}$.call(v,"loadpage",n,C)}else{I=!1,T=!0;var l=k&&n&&n.length<1,c=l?b.scrollTips.nodata:b.scrollTips.last;F(l?"nodata":"last"),w&&w.start({text:c,onlyText:!0}),$.call(v,"loadpage",n,C),$.call(v,"lastpage",n,C)}else I=!1,T=!0,w&&w.stop();return L[t]=n}),10)}function D(e,t){e=e||0;o=i.find(b.children).children(b.handle);var n=i.height(),r=parseFloat(o.height()),l=a.scrollHeight,c=r*parseInt(e)-r;return l>n&&(a.scrollTop=c,$.call(v,"to",e),t&&t.call(v,parseInt(e))),this}function _(e){var t=e||i.parents(".bui-tab-main-item").height()||i.parents(".bui-dialog-main").height()||i.parents("main").height()||window.viewport.height()-(i[0]?i[0].offsetTop:0);i.height(t)}function F(e){return"string"!=typeof e?i.attr("scroll-status"):(i.attr("scroll-status",e),this)}function A(t,n){return e.off.apply(v,arguments),this}function $(t){v.self=this==window||this==v?null:this,e.trigger.apply(v,arguments)}return b.autoinit&&j(b),v}}(window.bui||{},window.libs),function(e,t){e.list=function(n){var i,a,o={name:"list",handle:{},on:function(t,n){return e.on.apply(o,arguments),this},off:I,empty:k,updatePage:function(){var e=p.getPage();return p.updatePage(e,f),this},getPage:function(){return p.getPage()},getData:function(){return c},getItem:function(n,i){if(/\d/.test(n)&&void 0===i){var a=(+n-1)*r.pageSize;return t.extend(!0,c).splice(a,r.pageSize)}return/\d/.test(n)&&"index"===i?t.extend(!0,c).splice(n,1)[0]:n&&"string"==typeof i?e.array.get(c,n,i):e.array.get(c,n,"id")},refresh:function(){return T.call(this,"refreshbefore"),p.refresh(),this},reload:function(){return p&&p.reload(),this},replace:function(e){return k(),v(_objectSpread({page:1},e)),this},resize:function(e){return p.resize(e),this},modify:function(e){return r=o.config=t.extend(!0,{},o.config,e),h=r.data,this},destroy:function(e){e=1==e;i&&(i.off("click.bui"),e&&i.remove(),i=null);I("refreshbefore"),I("refresh"),I("success"),I("fail"),p&&p.destroy(e)},widget:function(t){var n={scroll:p,ajax:d};return e.widget.call(n,t)},option:function(n,i){return"data"==n&&void 0!==i?function(n,i){var a;if("string"==typeof i)try{a=JSON.parse(i)}catch(t){return void e.showLog("data 参数必须为对象","bui.list.modifyData")}else a=i;return h=t.extend(!0,{},m,a)}(0,i):e.option.call(o,n,i)},config:r,init:v},r=o.config=t.extend(!0,{},{id:"",uid:"",url:"",data:{},method:"GET",dataType:"json",headers:{},contentType:"",timeout:2e4,field:{page:"page",size:"pageSize",data:""},scrollTips:{start:"努力加载中..",end:"上拉加载更多",nodata:"没有更多内容",last:"没有更多内容",fail:"点击重新加载"},refreshTips:{start:"刷新中..",release:"松开刷新",end:"下拉刷新",fail:"点击加载",success:"刷新成功"},lastUpdated:!1,cacheHeight:!0,ajax:null,page:1,pageSize:10,autoNext:!0,refreshPage:!0,autoUpdatePage:!0,autoScroll:!0,stopPropagation:!1,autoinit:!0,urlrule:!1,native:!0,needNative:!1,relative:!1,refresh:!0,direction:"y",stopHandle:"",children:".bui-list",handle:".bui-btn",header:".bui-page header",footer:".bui-page footer",height:0,commandRefresh:"html",commandLoad:"append",delay:500,scroll:!0,loading:null,scrollLoading:null,localData:null,template:null,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onInited:null,onBeforeRefresh:null,onRefresh:null,onRefreshed:null,onLoad:null,onLoaded:null,onFirstLoad:null,onFail:null,callback:null},e.config.list,n),l=r.url,c=[],s=r.page,u=!0;r.page;var d,f,p,h={},g=!1,m=r.data;function v(n){var l=r=t.extend(!0,r,n);l.onBeforeInit&&l.onBeforeInit.call(o,l),i=e.obj(l.id),a=i.find(l.children),r=o.config=l,h=r.data;var c=0==r.refresh?null:x,s={id:l.id,children:l.children,handle:l.handle,header:l.header,footer:l.footer,page:l.page,pageSize:l.pageSize,distance:l.distance,backDistance:l.backDistance,stopHandle:l.stopHandle,maxDistance:l.maxDistance,height:l.height,refresh:l.refresh,autoNext:l.autoNext,refreshPage:l.refreshPage,autoScroll:l.autoScroll,scroll:l.scroll,cacheHeight:l.cacheHeight,stopPropagation:l.stopPropagation,scrollTips:l.scrollTips,refreshTips:l.refreshTips,direction:l.direction,lastUpdated:l.lastUpdated,handleMove:l.handleMove,loading:l.loading,scrollLoading:l.scrollLoading,onBeforeTouchstart:l.onBeforeTouchstart,onBeforeTouchmove:l.onBeforeTouchmove,onBeforeTouchend:l.onBeforeTouchend,onBeforeRefresh:l.onBeforeRefresh,onBeforeLoad:l.onBeforeLoad,onRefresh:c&&c.bind(o),onLoad:w};return"html"!=l.commandRefresh&&(l.refreshPage=!1),l.urlrule?l.url=b(l):l.url=l.url,p?p.init(s):p=e.scroll(s),o.toBottom=p.toBottom,o.scrollTop=p.scrollTop,o.to=p.to,g||function(e){e.callback&&i.off("click.bui",e.handle).on("click.bui",e.handle,(function(t){e.callback.call(o,t)})),g=!0}(l),l.uid&&e.history.setUI&&e.history.setUI({uid:l.uid,ui:o}),l.onInited&&l.onInited.call(o,l),this}function b(e){return l.replace("(page)",e.page).replace("(size)",e.pageSize)}r.autoinit&&v(r);var y=null;function w(i,l,s){var g=this,v=s||r.commandLoad;if(h=t.extend(!0,{},m,r.data,h),r.field.page.length&&e.unit.setKeyValue(r.field.page,i,h),r.field.size.length&&e.unit.setKeyValue(r.field.size,l,h),r.page=o.config.page=i,r.data=h,!r.localData)return r.urlrule?r.url=b(r):r.url=r.url,r.success=w,r.fail=function(e,t,n){T.call(g,"fail",e,i,n),r.onFail&&r.onFail.call(o,e,i,n),p&&p.fail(i,l,e)},d=r.ajax?r.ajax(r):e.ajax(r),this;function w(t,l,s){var d,h,m;d="string"==typeof t?t&&JSON.parse(t)||{}:t||{};var b,w,x,k;if("string"==typeof(h=r&&r.field&&""==r.field.data?d||[]:"object"===e.typeof(d)&&e.unit.getKeyValue(r.field.data,d)||[])&&/\[?.+\]$/g.test(h))try{m=JSON.parse(h)}catch(t){m=h,e.showLog(t)}else m=h;h=m&&"array"===e.typeof(m)?m:[],r.localData&&(b=i,w=r.pageSize,h=(k=(b-1)*w)+w>=(x=h).length?x.slice(k,x.length):x.slice(k,k+w));var I=n.template&&n.template.call(o,h,d,i)||"";h.length&&e.array.merge(c,h),a&&a[v](I);var O=p&&p.isRefresh()||!1;T.call(g,"success",t,i,s);try{O?(r.onRefresh&&r.onRefresh.call(o,p,d,s),r.onRefreshed&&r.onRefreshed.call(o,d,s),T.call(g,"refresh",t,i,s),y&&(clearTimeout(y),y=null),y=r.refresh?setTimeout((function(){p.reverse()}),r.delay):null):(T.call(this,"onloadbefore"),u&&r.onFirstLoad&&r.onFirstLoad.call(o,d,s),u=!1,r.onLoad&&r.onLoad.call(o,p,d,s),r.onLoaded&&r.onLoaded.call(o,d,s),T.call(g,"onload",t,i,s)),r.localData?r.autoUpdatePage&&g&&g.updatePage(i,h):(r.autoUpdatePage&&p&&p.updatePage(i,h),i+1),f=h}catch(e){}}"function"==typeof r.localData?w(r.localData()):w(r.localData)}function x(e){var n=s;r.refreshPage||(n=o.config.page+1);var i=r.pageSize;T.call(this,"refreshbefore");var a=t.extend(!0,{page:n,pagesize:i,commandRefresh:"html"},e);return w(a.page,a.pagesize,r.commandRefresh),this}function k(){return c=[],a&&a.html(""),i.find(".bui-scroll-foot").html(""),this}function I(t,n){return e.off.apply(o,arguments),this}function T(t){o.self=this==window||this==o?null:this,e.trigger.apply(o,arguments)}return o}}(window.bui||{},window.libs),function(e,t){e.searchbar=function(n){var i,a,o,r,l={id:"",uid:"",handle:".icon-search,.btn-search",placeholder:"",handleRemove:"."+e.config.icon.remove,delayTime:400,readonly:!1,onInput:null,onChange:null,onRemove:null,onKeydown:null,autoinit:!0,onBeforeInit:null,onInited:null,callback:null},c={name:"searchbar",handle:{},on:function(t,n){return e.on.apply(c,arguments),this},off:h,search:function(e){var t=e||a;return a=t,g.call(this,"search",{},t),s.callback&&s.callback.call(this,{},t),this},placeholder:f,readonly:p,reset:function(){return o.val(""),r.hide(),this},value:function(e){if(void 0===e)return o.val();o.val(e),e&&r.show();return c},destroy:function(e){e=1==e;i&&(i.off(),e&&i.remove());h("search"),h("remove"),h("input")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:d},s=c.config=t.extend(!0,{},l,e.config.searchbar,n),u=!1;function d(n){var l=t.extend(!0,s,n);return l.onBeforeInit&&l.onBeforeInit.call(c,l),i=e.obj(l.id),c.$el=i,s=c.config=l,o=i.find("input"),(r=i.find(l.handleRemove)).length<1&&(o.after('<i class="'+l.handleRemove.substr(1)+'"></i>'),r=i.find(l.handleRemove)),r.hide(),u||function(e){i.off("click.bui",e.handle).on("click.bui",e.handle,(function(t){document.activeElement.blur();var n=o.val();a=n,g.call(c,"search",t,n),e.callback&&e.callback.call(c,t,n)})),i.off("click.bui",e.handleRemove).on("click.bui",e.handleRemove,(function(n){document.activeElement.blur(),o.val("");var i=o.val();a=i,t(this).hide(),g.call(c,"remove",n,i),e.onRemove&&e.onRemove.call(c,n,i)}));var n=!1,l=null;e.onInput&&i.off("input","input").on("compositionstart",(function(){n=!0})).on("compositionend",(function(t){n=!1;var i=o.val();e.onInput.call(c,t,i)})).on("input","input",(function(t){var i=o.val();a=i,i?r.show():r.hide(),g.call(c,"input",t,i),n||(l&&clearTimeout(l),l=setTimeout((function(){e.onInput.call(c,t,i),l=null}),e.delayTime))})),e.onChange&&i.off("change","input").on("change","input",(function(t){var n=o.val();a=n,n?r.show():r.hide(),g.call(c,"change",t,n),e.onChange.call(c,t,n)})),e.onKeydown&&i.off("keydown","input").on("keydown","input",(function(t){var n=o.val();g.call(c,"keydown",t,n),e.onKeydown.call(c,t,n)})),u=!0}(l),l.readonly&&p(l.readonly),l.placeholder&&f(l.placeholder),l.uid&&e.history.setUI&&e.history.setUI({uid:l.uid,ui:c}),l.onInited&&l.onInited.call(c,l),this}function f(e){return o.attr("placeholder",e),this}function p(e){return Boolean(e)&&o.attr("readonly",e),!Boolean(e)&&o.removeAttr("readonly"),this}function h(t,n){return e.off.apply(c,arguments),this}function g(t){c.self=this==window||this==c?null:this,e.trigger.apply(c,arguments)}return s.autoinit&&d(s),c}}(bui||{},libs),function(e,t){e.select=function(n){var i,a,o,r,l={name:"select",handle:{},on:function(t,n){return e.on.apply(l,arguments),this},off:F,value:B,values:function(){var e=[];return x.forEach((function(t,n){e.push({value:t,name:w[n],index:k[n],icon:I[n]})})),e},allValues:function(){var e=[];return s.data&&s.data.forEach((function(t,n){var i=o.eq(n).find("input").prop("checked");t.checked=i,e.push(t)})),e},index:function(){return k.join(",")},active:D,unactive:function(t){var n=[];String(t).indexOf(",")>-1?n=t.split(","):n.push(parseInt(t));return n.forEach((function(t,n){var i=o.eq(t).find("input"),a=i.val(),r=i.attr("text");e.array.delete(w,r),e.array.delete(x,a),i.prop("checked",null)})),A.call(l,"change",{}),this},disabled:function(){var e=u;return e&&e.addClass("disabled"),this},enabled:function(){var e=u;return e&&e.removeClass("disabled"),this},disabledSelect:function(e){if(void 0===e)o.find("input").attr("disabled",!0);else{if("number"!=typeof e)return void console.log("index 必须为数字");o.eq(e).find("input").attr("disabled",!0)}return this},enabledSelect:function(e){if(void 0===e)o.find("input").removeAttr("disabled");else{if("number"!=typeof e)return void console.log("index 必须为数字");o.eq(e).find("input").removeAttr("disabled")}return this},template:y,empty:function(){return i.html(""),s.data=[],O=!1,this},text:R,show:E,hide:N,selectAll:function(){if("checkbox"==s.type){D(s.data.map((function(e,t){return t})).join(","))}else D(0);return this},selectNone:_,reset:function(){return _(),R(s.placeholder),this},clearSearch:function(){i.find(".bui-searchbar-close").trigger("click")},unselect:function(){if("checkbox"==s.type){var t=w.map((function(e,t){return e}));x.map((function(e,t){return e})),w=[],x=[],s.data&&s.data.forEach((function(n,i){var a=o.eq(i).find("input");e.array.index(t,n[g])>-1?a.prop("checked",null):(a.prop("checked",!0),w.push(n[g]),x.push(n[m]))})),B(x.join(",")||""),R(w.join(",")||"")}else _();return this},selected:function(t){var n=[];String(t).indexOf(",")>-1?n=t.split(","):n.push(t);return n.forEach((function(t,n){var i=e.array.index(s.data,t,"name"),a=e.array.index(s.data,t,"value"),r=e.array.index(w,t),l=e.array.index(x,t),c=i>-1?i:a;if(r<0&&l<0&&c>0){var u=s.data[c];o.eq(c).find("input").prop("checked",!0),w.push(u.name),x.push(u.value)}})),A.call(l,"change",{}),this},unselected:function(t){var n=[];String(t).indexOf(",")>-1?n=t.split(","):n.push(t);return n.forEach((function(t,n){s.data.forEach((function(n,i){var a=n[g]||n,r=n[m]||n;t!=r&&t!=a||(o.eq(i).find("input").prop("checked",null),e.array.remove(w,a),e.array.remove(x,r))}))})),A.call(l,"change",{}),this},destroy:function(e){e=1==e;i&&(i.off(),e&&i.remove());u&&(u.off("click.bui"),e&&u.remove());return r&&r.destroy(e),O=!1,F("show"),F("hide"),F("change"),F("select"),F("check"),F("uncheck"),this},widget:function(t){var n={dialog:r||{}};return e.widget.call(n,t)},option:function(t,n){return e.option.call(l,t,n)},config:s,init:C},c=l.config=t.extend(!0,{},n),s=l.config=t.extend(!0,{},{id:"",uid:"",trigger:"",triggerChildren:".span1",handle:".bui-list .bui-btn",className:"",name:"",appendTo:"",data:[],popup:!0,title:"",autoClose:!1,placeholder:"",field:{name:"name",value:"value",image:"image",icon:"icon",search:""},height:0,width:0,mask:!0,useBox:!1,zIndex:110,change:!0,toggle:!1,effect:"fadeInUp",type:"select",direction:"left",position:"bottom",fullscreen:!1,needSearch:!1,value:"",buttons:[],onChange:null,autoinit:!0,onBeforeOpen:null,onBeforeInit:null,template:null,onInited:null,callbackHandle:".bui-dialog-foot .bui-btn",callback:null},e.config.select,n),u=e.obj(s.trigger),d=e.guid(),f=s.name||e.guid(),p=s.placeholder||u&&u.text()||"",h=!0,g=s.field.name,m=s.field.value,v=s.field.image,b=s.field.icon,y=null,w=[],x=[],k=[],I=[],T="",O=!1;function C(n){var f=t.extend(!0,s,n);if(f.onBeforeInit&&f.onBeforeInit.call(l,f),f.appendTo=f.appendTo||e.hasRouter&&router.currentPage()||"body",w=[],x=[],k=[],I=[],s=l.config=f,y="function"==typeof f.template?f.template:j,f.data&&f.data.length||O)var p=y.call(this,f.data);if(l.template=y,!f.popup){if(!f.id)return void e.hint("select id 必须有");i=e.obj(f.id),(f.data&&f.data.length||O)&&i.html(p)}if(f.popup)if(d=f.id&&f.id!==f.trigger&&e.obj(f.id).attr("id")||d,i=e.obj(d),r)i.find(".bui-dialog-list").html(p);else{var g=function(n){var i="",a='<div class="bui-searchbar bui-box">\n                                    <div class="span1">\n                                        <div class="bui-input">\n                                            <i class="'.concat(e.config.icon.search,'"></i>\n                                            <input type="search" value="" placeholder="请输入关键字" />\n                                            <div class="bui-searchbar-close"><i class="').concat(e.config.icon.remove,'"></i></div>\n                                        </div>\n                                    </div>\n                                </div>'),o='<div class="bui-dialog-result" style="top:"></div>',r=s.templateTitle?s.templateTitle.call(l,s)||"":'<div class="bui-dialog-title">'.concat(s.title,"</div>");s.popup&&(i+='<div id="'+d+'" class="bui-dialog bui-dialog-select">',(s.title||s.needSearch)&&(i+='<div class="bui-dialog-head">\n                                '.concat(s.title||s.templateTitle?r:"","\n                                ").concat(s.needSearch?a:"","\n                            </div>")),i+='  <div class="bui-dialog-main">');s.popup&&(i+='<div class="bui-dialog-list"></div>',i+="  </div>",s.buttons.length>0&&(i+='    <div class="bui-dialog-foot">',i+='       <div class="bui-box">',t.each(s.buttons,(function(e,t){i+='        <div class="span1">',i+='             <div class="bui-btn '+(t.className||"")+'" value="'+(t.value||"")+'">'+(t.name||t)+"</div>",i+="        </div>"})),i+="    </div>",i+="    </div>"),i+="".concat(s.needSearch?o:""),i+="</div>");return i}();(c.appendTo||!i.length)&&t(f.appendTo).append(g),(i=e.obj(d)).find(".bui-dialog-list").html(p),(r=e.dialog({id:d,effect:f.effect,mask:f.mask,zIndex:f.zIndex,position:f.position,autoClose:!1,useBox:f.useBox,height:f.height,width:f.width,zoom:!1,fullscreen:f.fullscreen,onMask:function(e){f.autoClose&&N(),f.onMask&&f.onMask.call(l,e)}})).on("open",(function(){if(f.needSearch){var e=i.find(".bui-dialog-head").height(),t=i.find(".bui-dialog-foot").height(),n=i.height()-e-t;i.find(".bui-dialog-result").css({top:e+"px",bottom:t+"px",height:n+"px"})}})),c.appendTo&&f.id&&f.data&&!f.data.length&&(t(f.appendTo).append(i.prop("outerHTML")),i.remove(),i=t(f.appendTo).find(f.id))}l.$el=i,o=i.find(f.handle),f.data&&f.data.length<1&&S(),function(n){u=e.obj(n.trigger),T=n.placeholder||u&&u.text()||n.title,a=u&&u.find(n.triggerChildren).length?u.find(n.triggerChildren):u,n.trigger&&n.popup&&(n.placeholder&&a.html(n.placeholder),u.off("click.bui").on("click.bui",(function(e){var i=n.onBeforeOpen&&n.onBeforeOpen.call(l);t(this).hasClass("disabled")||0==i||E()})));function o(e){e?(p.css("display","block"),f.css("display","block")):(p.css("display","none"),f.css("display","none"))}var r=function(i){var a=t(i.currentTarget).find("input"),o=a.attr("disabled"),r=i.target.tagName;if(!o){var c=a.val(),s=a.attr("text"),u=a.attr("index"),d=a.is(":checked");i.target=a[0],i.index=u||a.parents(".bui-btn").index(),(d&&"INPUT"!==r||!d&&"INPUT"===r)&&(n.toggle||"checkbox"==n.type)?(e.array.remove(w,s),e.array.remove(x,c),e.array.remove(k,u),e.array.remove(I,u),A.call(l,"uncheck",i)):(P({name:s,value:c,index:u}),A.call(l,"check",i)),h&&n.onChange&&n.onChange.call(l,i);var f=w.join(","),p=x.join(",");R(f||""),B(p||"")}},c=function(e){r.call(l,e),n.popup&&n.autoClose&&N(),A.call(l,"select",e),e.stopPropagation()},s=n.needSearch?".bui-dialog-list "+n.handle:n.handle;i.off("click.bui",s).on("click.bui",s,c);var d=function(e){n.callback&&n.callback.call(l,e,l),e.stopPropagation()};i.off("click.bui",n.callbackHandle).on("click.bui",n.callbackHandle,d);var f=i.find(".bui-searchbar-close"),p=i.find(".bui-dialog-result"),g=i.find(".bui-searchbar input");n.data&&n.data.length&&n.needSearch&&(i.find(".btn-search").click((function(e){var t=i.find(".bui-searchbar input").val();L(t),o(t),e.stopPropagation()})),g.on("input",(function(e){var n=t(this).val();L(n),o(n),e.stopPropagation()})),f.click((function(e){g.val(""),p.css("display","none"),t(this).css("display","none"),e.stopPropagation()})),i.off("clilck.bui",".bui-dialog-result .bui-btn").on("click.bui",".bui-dialog-result .bui-btn",(function(i){var a=t(i.currentTarget).find("input"),o=i.target.tagName,r=a.is(":checked"),c=a.attr("text"),s=a.attr("value"),u=e.array.index(n.data,s,"value");(r&&"INPUT"!==o||!r&&"INPUT"===o)&&(n.toggle||"checkbox"==n.type)?(a.prop("checked",!1),A.call(l,"uncheck",i),e.array.remove(w,c),e.array.remove(x,s),e.array.remove(k,u),e.array.remove(I,u)):(a.prop("checked",!0),A.call(l,"check",i),P({name:c,value:s,index:u})),h&&n.onChange&&n.onChange.call(l,i),B(x.join(",")||"",i),R(w.join(",")||""),i.stopPropagation()})));O=!0}(f);var m=u&&(u.attr("value")||u.val()||"");return(f.value||m)&&(B(f.value||m),f.onChange&&f.onChange.call(l,{currentTarget:o,target:o.find("input")[0],value:x.join(",")})),f.uid&&e.history.setUI&&e.history.setUI({uid:f.uid,ui:l}),f.onInited&&f.onInited.call(l,f),this}function S(){var e=[],n=[];return o.find("input").each((function(i,a){var o=t(this);if(!(o.length<1)){var r=o.val(),l=o.attr("text"),c=o.attr("image"),u=o.attr("icon"),d=o.is(":checked");s.data[i]={},s.data[i][g]=l,s.data[i][m]=r,s.data[i][v]=c,s.data[i][b]=u,e.push(r),n.push(l),d&&P({name:l,value:r,index:i})}})),{value:e,text:n}}function P(e){var t=parseInt(e.index,10);switch(s.type){case"radio":case"select":x=[],k=[],I=[],(w=[]).push(e.name),x.push(e.value),I.push(e.icon),k.push(t);break;case"checkbox":w.push(e.name),x.push(e.value),I.push(e.icon),k.push(t)}}function L(t){var n=e.array.filter(s.data,t,s.field.search||s.field.name),a='没有与此相关的结果:<span class="danger-reverse">'.concat(t,"</span>"),o=e.guid();n.length&&(a=j(n,o)),i.find(".bui-dialog-result").css("display","block").html(a)}function j(n,i){var a=i||f,o="",r="";return t.each(n,(function(n,i){var o="string"==typeof i?i:i[g]||i||"",l=i&&i[v]?i[v]||i:"",c=i&&i[b]?i[b]||i:"",u=i&&i[m]?i[m]||i:i||o||n,d={name:a,value:u,text:o,index:n};l&&(d.image=l),c&&(d.icon=c),i=i&&"object"===e.typeof(i)?i:{};var f=function(t){t=t||{};var n=document.createElement("input");for(var i in t)"string"!=typeof t[i]&&"number"!=typeof t[i]||n.setAttribute(i,t[i]);switch(s.type){case"mulelect":case"checkbox":n.setAttribute("type","checkbox"),n.setAttribute("class",s.className||"bui-choose");break;case"select":n.setAttribute("type","radio"),n.setAttribute("class",s.className||"bui-choose");break;case"radio":n.setAttribute("type","radio"),n.setAttribute("class",s.className||"bui-radio");break;default:n.setAttribute("type","checkbox")}return e.array.compare(x,t.value)&&n.setAttribute("checked","true"),n}(t.extend(!0,{},i,d)).outerHTML;if(r+='    <div class="bui-btn bui-box bui-btn-line">',"left"==s.direction&&(r+=f),l){var p=e.unit.endWithImage(l)?'<div class="thumbnail"><img src="'+l+'" alt="" /></div>':'<div class="thumbnail '+l+'"></div>';r+=p}if(c){var h=e.unit.endWithImage(c)?'<i class="icon"><img src="'+c+'" alt="" /></i>':'<i class="icon '+c+'"></i>';r+=h}"center"==s.direction?(r+='        <div class="span1" align="center">'+o+"</div>",r+=f):r+='        <div class="span1">'+o+"</div>","right"==s.direction&&(r+=f),r+="    </div>"})),o+='    <div class="bui-list bui-list-select">',o+=r,o+="    </div>"}function E(e){A.call(this,"beforeshow");var t={};return"function"==typeof e?t.callback=function(){e&&e.call(l),A.call(l,"show")}:"string"==typeof e?t.effect=e:"object"===_typeof(e)&&(t=e),s.popup&&r?(!r.isOpen()&&r.open(t),A.call(l,"show")):(i.css("display","block"),t.callback?t.callback():A.call(l,"show")),this}function N(e){A.call(this,"beforehide");var t={};return"function"==typeof e?t.callback=function(){e&&e.call(l)}:"string"==typeof e?t.effect=e:"object"===_typeof(e)&&(t=e),s.popup&&r?(r.isOpen()&&r.close(t.effect||t.callback),A.call(l,"hide")):(i.css("display","none"),t.callback?t.callback():A.call(l,"hide")),this}function B(t,n){if(void 0===t)return x.join(",");n=n||event;var r=s.needSearch?".bui-dialog-list "+s.handle:s.handle;o=i.find(r);var c=[],d=[],f=[],p=[],v=[],y=[];"string"==typeof t&&t.indexOf(",")>-1?y=t.split(","):"array"===e.typeof(t)?y=t:t&&y.push(t),(s.data.length<1||s.data.length!==o.length)&&(s.data=[],S()),s.data&&s.data.forEach((function(t,n){var i=t&&"object"===e.typeof(t)&&t.hasOwnProperty(g)?String(t[g]):String(t),a=t&&"object"===e.typeof(t)&&t.hasOwnProperty(b)?String(t[b]):"",r=t&&"object"===e.typeof(t)&&t.hasOwnProperty(m)?String(t[m]):String(t)||String(n),l=o.eq(n).find("input");if(""==t)return l.prop("checked",!1),w=[],x=[],k=[],void(I=[]);var u=e.array.index(y,i);e.array.index(y,r)>-1||u>-1?("radio"!=s.type&&"select"!=s.type||(d=[],f=[],v=[],p=[]),d.push(i),f.push(r),p.push(a),v.push(n),c[n]=l,l.prop("checked",!0),o.eq(n).addClass("selected")):(l.prop("checked",!1),o.eq(n).removeClass("selected"))})),w=d.slice(0),x=f.slice(0),k=v.slice(0),I=p.slice(0);var O=n||{target:c[k],index:k};A.call(l,"change",O),!h&&s.onChange&&s.onChange.call(l,O),u&&s.change&&(u[0]&&"INPUT"===u[0].tagName?u.val(f.join(",")):u.attr("value",f.join(",")),a.text(w.join(",")||T)),i.attr("value",f.join(",")),h=!1}function R(e){return void 0===e?w.join(","):(u&&s.change&&(u.attr("text",e),a[0]&&"INPUT"===a[0].tagName?(a.val(e||p),!h&&a.trigger("change")):a.html(e||p)),i.attr("text",e),this)}function D(e){var t=[];return String(e).indexOf(",")>-1?t=e.split(","):t.push(parseInt(e)),w=[],x=[],t.forEach((function(e,t){s.data[e]&&w.push(s.data[e][g]||s.data[e]),s.data[e]&&x.push(s.data[e][m]||s.data[e]||t)})),"checkbox"==s.type||"mulselect"==s.type?(R(w.join(",")),B(x.join(","))):(R(w[0]),B(x[0])),this}function _(){return w=[],x=[],k=[],I=[],(o=i.find(s.handle)).find("input").prop("checked",null),B(""),R(""),A.call(this,"reset"),this}function F(t,n){return e.off.apply(l,arguments),this}function A(t){l.self=this==window||this==l?null:this,e.trigger.apply(l,arguments)}return s.autoinit&&C(s),l}}(window.bui||{},window.libs),function(e,t){e.dropdown=function(n){var i,a,o,r,l,c,s={name:"dropdown",handle:{},on:function(t,n){return e.on.apply(s,arguments),this},off:I,active:y,disabled:function(){var e=a;return e&&e.addClass("disabled"),this},enabled:function(){var e=a;return e&&e.removeClass("disabled"),this},value:v,values:b,change:function(e){v(e),w(e),u.onChange&&u.onChange.call(s,{target:null,currentTarget:null,value:e})},getItem:b,reset:function(){return h="",v(""),w(p),x(),this},text:w,hide:x,show:function(){return a.addClass("active"),c.css("display","block"),T.call(this,"show"),this},isShow:function(){return a.hasClass("active")},hideAll:k,destroy:function(e){e=1==e;i&&(i.off("click.bui"),e&&i.remove());a&&(a.off("click.bui"),e&&a.remove());t("body").off("click.bui"),I("show"),I("hide")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(s,t,n)},config:u,init:m},u=s.config=t.extend(!0,{},{id:".bui-dropdown",handle:".bui-btn",handleChildren:".span1",target:".bui-list",targetHandle:".bui-btn",data:null,position:"bottom",showArrow:!1,showActive:!0,autoClose:!0,stopPropagation:!1,width:0,placeholder:"",field:null,value:"",relative:!0,event:"click.bui",change:!0,autoinit:!0,template:null,onBeforeInit:null,onInited:null,callback:null,onChange:null},e.config.dropdown,n),d=document.documentElement.clientWidth,f=!1,p="",h="",g="";function m(n){var g=t.extend(!0,u,n);if(g.onBeforeInit&&g.onBeforeInit.call(s,g),g.id){if(i=e.obj(g.id),s.$el=i,u=s.config=g,a=i.children(g.handle),c=g.target?i.find(g.target):a.next(),g.placeholder&&w(g.placeholder),p=g.placeholder||a.text()||a.val(),g.data&&g.data.length){g.data=g.field?e.unit.filterField(g.data,g.field):g.data;var m="function"==typeof g.template?g.template.call(s,g.data):function(e){var t="";return t+='<ul class="bui-list">',e.map((function(e,n){t+='<li class="bui-btn" value="'+e.value+'">'+e.name+"</li>"})),t+="</ul>",t}(g.data);c.length?c.remove()&&a.after(m):i.append(m),c=i.find(g.target)}r=g.relative,o=i.attr("position")||g.position;var b=i[0]&&i[0].offsetLeft>=document.documentElement.clientWidth?0:i[0]&&i[0].offsetLeft,I=g.width?-g.width+i.parent().width()+"px":-b+"px",O={bottom:{menuPosition:"bui-menu-bottom",arrowPosition:"bui-arrow-up",left:I},top:{menuPosition:"bui-menu-top",arrowPosition:"bui-arrow-down",left:I},left:{menuPosition:"bui-menu-left",arrowPosition:"bui-arrow-right",left:"auto"},right:{menuPosition:"bui-menu-right",arrowPosition:"bui-arrow-left",left:"100%"}};l=g.width>0?g.width:r?d:g.width||i.parent().width(),parseFloat(l)>0&&c.width(l),function(e,t){c.addClass(e),r&&c.css({left:t})}(g.showArrow?O[o].arrowPosition+" "+O[o].menuPosition:O[o].menuPosition,O[o].left);var C=g.value||a.attr("value")||a.children(g.handleChildren).val();if(C)v(C),g.onChange&&g.onChange.call(s,{target:null,currentTarget:null,value:h});else{var S=c.find(g.targetHandle+".active").eq(0).index();S>-1&&y(S)}return f||function(e){var n="",o=function(i){if(!t(this).hasClass("disabled")){var a=t(this).hasClass("active"),o=e.target?t(this).parent().find(e.target):t(this).next();if(k(),a){if(!1===(e.onBeforeHide&&e.onBeforeHide.call(s,i)))return;t(this).removeClass("active"),o.css("display","none"),T.call(s,"hide"),e.onHide&&e.onHide.call(s,i)}else{if(!1===(e.onBeforeShow&&e.onBeforeShow.call(s,i)))return;t(this).addClass("active"),o.css("display","block"),T.call(s,"show"),e.onShow&&e.onShow.call(s,i)}n=t(this).attr("value")||"",i.stopPropagation()}},r=function(i){var a=t(this),o=a.parent(),r=a.attr("value")||"";t.trim(a.text()),null!=o.attr("change")?o.attr("change"):e.change,e.showActive&&a.addClass("active").siblings().removeClass("active"),v.call(this,r),n!==r&&e.onChange&&e.onChange.call(s,i),u.autoClose&&x(),i.target=this,e.callback&&e.callback.call(s,i),u.stopPropagation&&i.stopPropagation()};e.event.indexOf("hover")>-1?(a.off("mouseenter mouseleave"),a.on("mouseenter",o),a.on("mouseleave",(function(e){t(".bui-dropdown > .bui-btn").removeClass("active"),t(".bui-dropdown > .bui-list").css("display","none")}))):e.event.indexOf("click")>-1&&a.off(e.event).on(e.event,o);i.off("click.bui",e.targetHandle).on("click.bui",e.targetHandle,r);var l=function(e){k(),e.stopPropagation()};u.autoClose&&t("body").off("click.bui").on("click.bui",":not(.bui-dropdown)",l),f=!0}(g),g.uid&&e.history.setUI&&e.history.setUI({uid:g.uid,ui:s}),g.onInited&&g.onInited.call(s,g),this}e.showLog("dropdown id不能为空","bui.dropdown.init")}function v(n){if(void 0===n)return event&&event.target?t(event.target).attr("value")||h:a.attr("value")||h;var i="htmllielement"===e.typeof(this),o=i&&t(this).parent(),r=i?t(this).parents(".bui-dropdown").children(u.handle):a,l=i?o.find(u.targetHandle):c.find(u.targetHandle);if(l.removeClass("active"),u.data&&u.data.length){if(""==n)return h="",void r.attr("value",n);var d="number"==typeof u.data[0].value?Number(n):String(n),f="number"==typeof u.data[0].name?Number(n):String(n),p=e.array.index(u.data,d,"value"),g=e.array.index(u.data,f,"name");p>-1?(l.eq(p).addClass("active"),r.attr("value",n),u.change&&w.call(this,u.data[p].name),h=n):g>-1&&(l.eq(g).addClass("active"),r.attr("value",u.data[g].value),u.change&&w.call(this,n),h=u.data[g].value)}else l.each((function(e,i){var a=i.innerText,o=i.getAttribute("value");a!=n&&o!=n||(t(this).addClass("active"),r.attr("value",o),u.change&&w.call(this,a),h=o)}));return u.change||T.call(s,"change"),h}function b(){return{name:g,value:h}}function y(e){e=parseInt(e);var n=c.find(u.targetHandle).eq(e);n.length>=0&&(v(n.attr("value")||t.trim(n.text())||""),u.showActive&&n.addClass("active").siblings().removeClass("active"));return this}function w(n){if(void 0===n)return g||t.trim(a.text());var i="htmllielement"===e.typeof(this)?t(this).parents(".bui-dropdown").children(u.handle):a,o=i.children(u.handleChildren);return o.length?"INPUT"===o[0].tagName?(o.val(n),o.trigger("change")):o.text(n):"INPUT"===i[0].tagName?(i.val(n),i.trigger("change")):i.text(n),g=n,T.call(s,"change"),this}function x(){return a.removeClass("active"),c.css("display","none"),T.call(this,"hide"),this}function k(){return t(".bui-dropdown > .bui-btn").removeClass("active"),t(".bui-dropdown > .bui-list").css("display","none"),T.call(this,"hide"),this}function I(t,n){return e.off.apply(s,arguments),this}function T(t){s.self=this==window||this==s?null:this,e.trigger.apply(s,arguments)}return u.autoinit&&m(u),s}}(window.bui||{},window.libs),function(e,t){e.accordion=function(n){var i,a,o={name:"accordion",handle:{},on:function(t,n){return e.on.apply(o,arguments),this},off:h,showFirst:function(){l.length>1?l.each((function(e,t){d(0,t)})):d(0);return g.call(this,"show",{target:i[0]}),this},showAll:function(){return(i=p()).each((function(e,n){t(n).addClass("active").next(r.target).css("display","block")})),g.call(this,"showall",{target:i}),this},hideAll:f,disabled:function(e){var t;t="number"==typeof e?i.eq(e):i;return t&&t.addClass("disabled"),this},enabled:function(e){var t;t="number"==typeof e?i.eq(e):i;return t&&t.removeClass("disabled"),this},destroy:function(e){l&&(l.off("click.bui"),l.remove(),l=null);h("hide"),h("show")},show:function(e){var t=/\d/.test(e),n=t?i.eq(e):i,a=n.next(r.target);return n.addClass("active"),a.css("display","block"),g.call(this,"show",{target:t?i[e]:i}),this},hide:function(e){var t=/\d/.test(e),n=t?i.eq(e):i,a=n.next(r.target);return n.removeClass("active"),a.css("display","none"),g.call(this,"hide",{target:t?i[e]:i}),this},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(o,t,n)},config:r,init:s},r=o.config=t.extend(!0,{},{id:"",handle:"dt",target:"dd",height:0,targetHeight:0,single:!1,stopPropagation:!1,lock:!1,data:null,autoinit:!0,onBeforeInit:null,onInited:null,callback:null},e.config.accordion,n),l=null,c=!1;function s(n){var s=t.extend(!0,r,n);return s.onBeforeInit&&s.onBeforeInit.call(o,s),document.documentElement.clientWidth,document.documentElement.clientHeight,l=e.obj(s.id)||e.obj("."+e.prefix("accordion")),r=o.config=s,i=p(),a=s.target.indexOf("#")>-1?e.obj(s.target):l.find(s.target),function(e){i.removeClass("active"),a.css("display","none"),parseFloat(e.targetHeight)>0&&a.height(e.targetHeight);parseFloat(e.height)>0&&l.height(e.height)}(s),c||function(e){var n=function(n){if(!t(this).hasClass("disabled")&&!t(this).attr("href")){if(!1===(e.callback&&e.callback.call(o,n)))return!1;u.call(this,n,e),(e.stopPropagation||!t(this).attr("href"))&&n.stopPropagation()}};e.handle.indexOf("#")>-1?!e.lock&&i.off("click.bui").on("click.bui",n):!e.lock&&l.off("click.bui").on("click.bui",e.handle,n);c=!0}(s),s.uid&&e.history.setUI&&e.history.setUI({uid:s.uid,ui:o}),s.onInited&&s.onInited.call(o,s),this}function u(n,a){var r=t(this),l=r.hasClass("active");i.index(this);var c=a.target.indexOf("#")>-1?e.obj(a.target):r.next(a.target);a.single?l?(r.removeClass("active"),c.css("display","none"),g.call(o,"hide",n)):(f(),r.addClass("active"),c.css("display","block"),g.call(o,"show",n)):l?(r.removeClass("active"),c.css("display","none"),g.call(o,"hide",n)):(r.addClass("active"),c.css("display","block"),g.call(o,"show",n))}function d(e,n){e=e||0;var i=(n?t(n):l).children().eq(e);(i.closest(r.handle).length?i.closest(r.handle):i.find(r.handle)).addClass("active").next(r.target).css("display","block")}function f(){return(i=p()).each((function(e,n){t(n).removeClass("active").next(r.target).css("display","none")})),g.call(this,"hideall",{target:i}),this}function p(){return r.handle.indexOf("#")>-1?e.obj(r.handle):l.find(r.handle)}function h(t,n){return e.off.apply(o,arguments),this}function g(t){o.self=this==window||this==o?null:this,e.trigger.apply(o,arguments)}return r.autoinit&&s(r),o}}(window.bui||{},window.libs),function(e,t){e.rating=function(n){var i,a,o,r,l,c={name:"rating",handle:{},on:function(t,n){return e.on.apply(c,arguments),this},off:m,disabled:function(e){(e=0!=e)?(i.off("click.bui",s.handle),v.call(c,"disabled")):g();return this},enabled:g,show:function(e){var t=function(e){var t,n="",i=(e=String(e)||String(r),0),a=s.stars,o=[];o=e.indexOf(".")>-1?e.split("."):[e,0];var l=parseInt(o[0]);for(t=o[1]/10*100+"%",i=0;i<a;i++)i<l&&(n+='<div class="bui-rating-cell" ><div class="bui-rating-cell-full" style="width:100%;">&nbsp;</div></div>'),i==l&&(n+='<div class="bui-rating-cell" ><div class="bui-rating-cell-full" style="width:'+t+';">&nbsp;</div></div>'),i>l&&(n+='<div class="bui-rating-cell" ><div class="bui-rating-cell-full" style="width:0;">&nbsp;</div></div>');return n}(e);i.attr("value",e).html(t),r=e},value:h,values:function(){var e=[];return i.each((function(t,n){var i={};i.value=n.getAttribute("value")||0,i.name=n.getAttribute("name")||"",i.id=n.id||"",e.push(i)})),e},reset:function(){return h(s.value),this},destroy:function(e){e=1==e;i&&(i.off("click.bui"),e&&i.remove());m("change")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:d},s=c.config=t.extend(!0,{},{id:"",uid:"",handle:".bui-rating-cell",fullClassName:"bui-rating-cell-full",halfClassName:"bui-rating-cell-half",name:"",half:!1,clickFull:!0,stars:5,value:0,disabled:!1,render:!0,autoinit:!0,onBeforeInit:null,onChange:null,onInited:null,callback:null},e.config.rating,n),u=!1;function d(n){var r=t.extend(!0,s,n);if(r.onBeforeInit&&r.onBeforeInit.call(c,r),r.id)return i=e.obj(r.id),c.$el=i,s=c.config=r,a=r.fullClassName,o=r.halfClassName,function(t){var n=[];i.length>1?i.each((function(e,i){var a=i.getAttribute("value")||t.value||0;n.push(a)})):n=t.value;if(t.render){var a=function(t){e.guid();var n="",i=0,a=t.stars;for(i=0;i<a;i++)n+='<div class="bui-rating-cell" ></div>';return n}(t);i.html(a),l=i.children(t.handle)}else l=i.children(t.handle);h(n)}(r),u||f(r),r.uid&&e.history.setUI&&e.history.setUI({uid:r.uid,ui:c}),r.onInited&&r.onInited.call(c,r),this;e.hint("rating id不能为空")}function f(e){if(!e.disabled){var n=String(e.value).indexOf(".")>-1?1:0;i.off("click.bui",e.handle).on("click.bui",e.handle,(function(i){var a=t(this).index(),o=parseInt(h()),r=0;e.half?r=(e.clickFull?n%2==1:n%2==0)?a+.5:a+1:r=a+1;p(r),h(r),n++,o!==r&&e.onChange&&e.onChange.call(c,i),e.callback&&e.callback.call(c,i),i.stopPropagation()}))}u=!0}function p(e,n){var i="object"===_typeof(n)?t(n).find(s.handle):l,r=[];e=String(e),s.half&&e.indexOf(".")>-1?r=e.split("."):r.push(e),i.removeClass(a).removeClass(o),i.each((function(e,n){var i=parseInt(r[0]);1==r.length&&e<i?t(n).addClass(a):2==r.length&&(e<i&&t(n).addClass(a),e==i&&t(n).addClass(o))}))}function h(t){var n;return void 0!==t&&/^-?\d+(\.\d+)?$/.test(t)||"array"===e.typeof(t)?(i.length>1?(i.each((function(e,n){n.setAttribute("value",t[e])})),n=t,i.each((function(e,t){p(n[e]||n,t)}))):(i.attr("value",t),p(t)),r=t,v.call(c,"change",t)):r=parseFloat(i.attr("value")),r}function g(e){return s.disabled=!1,f(s),v.call(c,"enabled"),this}function m(t,n){return e.off.apply(c,arguments),this}function v(t){c.self=this==window||this==c?null:this,e.trigger.apply(c,arguments)}return s.autoinit&&d(s),c}}(window.bui||{},window.libs),function(e,t){e.actionsheet=function(n){var i,a,o,r={name:"actionsheet",handle:{},on:function(t,n){return e.on.apply(r,arguments),this},off:p,disabled:function(e){var t=a;return t&&t.addClass("disabled"),l.disable=!0,this},enabled:function(){var e=a;return e&&e.removeClass("disabled"),l.disable=!1,this},active:function(e){return o.find(".bui-list .bui-btn").removeClass("active").eq(e).addClass("active"),this},hide:d,show:f,destroy:function(e){e=1==e;a&&a.off("click.bui");p("hide"),p("show"),i&&i.destroy(e)},widget:function(t){var n={dialog:i};return e.widget.call(n,t)},option:function(t,n){return"buttons"==t&&void 0!==n?function(t,n){if(n&&"array"===e.typeof(n)){var i=u(n);e.obj(l.id).find(".bui-list").html(i)}}(0,n):e.option.call(r,t,n)},config:l,init:s},l=r.config=t.extend(!1,{},{id:"",appendTo:".bui-page",trigger:"",handle:".bui-btn",position:"bottom",effect:"fadeInUp",zIndex:110,width:0,mask:!0,opacity:.6,data:null,buttons:[],template:null,cancelText:"取消",value:"",disable:!1,autoinit:!0,onMask:null,onBeforeOpen:null,onBeforeClose:null,onBeforeInit:null,onInited:null,callback:null},e.config.actionsheet,n),c=!1;function s(n){var s,p,g=t.extend(!0,l,n);if(g.onBeforeInit&&g.onBeforeInit.call(r,g),g.appendTo=g.appendTo||e.hasRouter&&router.currentPage()||"body",a=e.obj(g.trigger),l=r.config=g,c)e.obj(l.id).find(".bui-list").html(u(g.data||g.buttons));else{var m="function"==typeof g.template?g.template.call(r,g.data||g.buttons):function(e){var t=parseFloat(l.width),n=t>0?"width:"+t+"px;left:50%;right:0;margin-left:-"+t/2+"px;":"",i="";e&&e.length&&(i+='<div id="'+l.id+'" class="bui-actionsheet" style="'+n+'">',i+='    <ul class="bui-list">',i+=u(e),i+="    </ul>",l.cancelText&&(i+='    <div class="bui-btn" value="cancel">'+l.cancelText+"</div>"),i+="</div>");return i}(g.data||g.buttons);e.obj(g.appendTo).append(m)}return i||(i=e.dialog({id:l.id,position:g.position,appendTo:g.appendTo,mask:g.mask,effect:g.effect,opacity:g.opacity,zIndex:g.zIndex,onBeforeOpen:g.onBeforeOpen,onBeforeClose:g.onBeforeClose,onMask:function(){d(),g.onMask&&g.onMask()}})),(o=i.$el()).find(g.handle),r.$el=o,c||(s=function(e){e.target=this,l.callback&&l.callback.call(r,e,r),h.call(r,"click",e)},p=function(e){t(this).hasClass("disabled")||l.disable||f.call(this)},o&&o.off("click.bui",l.handle).on("click.bui",l.handle,s),a&&a.off("click.bui").on("click.bui",p),c=!0),g.uid&&e.history.setUI&&e.history.setUI({uid:g.uid,ui:r}),g.onInited&&g.onInited.call(r,g),this}function u(e){var n="";return t.each(e,(function(e,t){var i=t.value===l.value||t.name===l.value?" active":"";n+='<li class="bui-btn'.concat(i," ").concat(t.className||"",'" value="').concat(t.value||"",'">').concat(t.name||"","</li>")})),n}function d(e){h.call(this,"beforehide");var t={};return"function"==typeof e?t.callback=function(){e&&e.call(r),h.call(r,"hide")}:"string"==typeof e?t.effect=e:"object"===_typeof(e)&&(t=e),i.isOpen()&&i.close(t),this}function f(e){h.call(this,"beforeshow");var t={};return"function"==typeof e?t.callback=function(){e&&e.call(r),h.call(r,"show")}:"string"==typeof e?t.effect=e:"object"===_typeof(e)&&(t=e),!i.isOpen()&&i.open(t),this}function p(t,n){return e.off.apply(r,arguments),this}function h(t){r.self=this==window||this==r?null:this,e.trigger.apply(r,arguments)}return l.value,l.id=l.id||e.guid(),l.autoinit&&s(l),r}}(window.bui||{},window.libs),function(e,t){e.number=function(n){var i,a,o,r,l,c={name:"number",handle:{},on:function(t,n){return e.on.apply(c,arguments),this},off:x,$el:function(t){return e.selector.call(l,t)},disabled:function(n){b();var i=this&&"htmldivelement"===e.typeof(this)?t(this):r;(n=0!=n)?i.attr("disabled","disabled"):i.removeAttr("disabled");return this},enable:function(n){return b(),(this&&e["typeof"](this)==="htmldivelement"?t(this):r).removeAttr("disabled"),this},disablePrev:function(){return a.addClass("disabled"),this},disableNext:function(){return o.addClass("disabled"),this},enablePrev:function(){return a.removeClass("disabled"),this},enableNext:function(){return o.removeClass("disabled"),this},reset:function(){var e=s.value||s.min;return m.call(this,e),e},value:function(e){var t=0;void 0!==e?(m.call(this,e),t=e):t=g.call(this);return t},values:v,prev:y,next:w,destroy:function(e){e=1==e;(l=f.find(s.id))&&(l.off("click.bui"),l.off("input"),e&&l.remove());x("prev"),x("next"),x("change")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:p},s=c.config=t.extend(!0,{},{parentId:".bui-page",id:".bui-number",uid:"",type:"text",min:0,max:100,step:1,value:1,disabled:!1,render:!0,tips:!1,autocheck:!0,decimal:1,name:"",prev:".bui-number-prev",input:"input",next:".bui-number-next",onInput:null,autoinit:!0,inited:null,onBeforeInit:null,onInited:null,onChange:null,callback:null},e.config.number,n),u=!1,d=!1,f=null;function p(n){var p=t.extend(!0,s,n);p.onBeforeInit&&p.onBeforeInit.call(c,p),p.max,p.min,i=p.step,f=n.parentId&&e.obj(p.parentId).length?e.obj(p.parentId):t(p.parentId),"object"===_typeof(p.id)?(l=e.obj(p.id),d=!1):"string"==typeof p.id&&0===p.id.indexOf("#")||n.id&&!n.parentId?(l=e.obj(p.id),d=!0):(l=f.find(p.id),d=!1),s=c.config=p,p.render&&function(t){var n=function(t){var n="";return n+='    <div class="bui-number-prev"><i class="'+e.config.icon.minus+'"></i></div>',n+='    <input class="bui-number-input" type="'+t.type+'" name="'+(t.name||e.guid())+'" value="'+t.value+'" min="'+t.min+'" max="'+t.max+'" step="'+t.step+'"/>',n+='    <div class="bui-number-next"><i class="'+e.config.icon.plus+'"></i></div>'}(t);l.html(n)}(p),a=l.children(p.prev),o=l.children(p.next),r=l.children(p.input),u||function(n){var i=".bui-number "+n.input,a=".bui-number "+n.prev,o=".bui-number "+n.next,r=function(e){var i=t(this).val();e.value=h(i),n.onInput&&n.onInput.call(c,e),e.stopPropagation()},p=function(e){var i=n.autocheck&&isNaN(parseFloat(t(this).val(),10))?0:parseFloat(t(this).val(),10);/^[-\\+]?([1-9]\d*\.?\d*)|(0\.\d*[1-9])$/i.test(i)&&m.call(this,h(i)),e.value=h(i),e.stopPropagation()},g=function(e){var i=t(this).next(s.input);e.value=i.val(),!1===(n.callback&&n.callback.call(c,e))||t(this).hasClass("disabled")||(y.call(i,e),e.preventDefault(),e.stopPropagation())},v=function(e){var i=t(this).prev(s.input);e.value=i.val(),!1===(n.callback&&n.callback.call(c,e))||t(this).hasClass("disabled")||(w.call(i,e),e.preventDefault(),e.stopPropagation())};d?(n.onInput&&l.off("input",n.input).on("input",n.input,e.unit.debounce(r,400)),l.off("change",n.input).on("change",n.input,p),l.off("click.bui",n.prev).on("click.bui",n.prev,g),l.off("click.bui",n.next).on("click.bui",n.next,v)):(n.onInput&&f.off("input",i).on("input",i,e.unit.debounce(r,400)),f.off("change",i).on("change",i,p),f.off("click.bui",a).on("click.bui",a,g),f.off("click.bui",o).on("click.bui",o,v));u=!0}(p);var g=[];return l.length&&l.each((function(t,n){var i=n.getAttribute("value")||p.value;n.id||(n.id=e.guid()),g.push({id:n.id,value:i})})),p.disabled&&r.attr("disabled","disabled"),"object"==_typeof(p.value)?v(p.value):g.length?v(g):m(p.value),p.target=r,p.value=p.value,p.uid&&e.history.setUI&&e.history.setUI({uid:p.uid,ui:c}),p.onInited&&p.onInited.call(c,p),p.inited&&p.inited.call(c,p),this}function h(e,t,n){return t=t||s.min,n=n||s.max,e<t?e=t:e>n&&(e=n),e}function g(){b();var n=this&&"htmldivelement"===e.typeof(this)?t(this):r;return parseFloat(n.val(),10)}function m(n){b();var i=this&&"object"===e.typeof(this)?r:t(this);return Array.prototype.slice.call(i).forEach((function(t,a){var o=t.getAttribute("max")||t.parentElement.getAttribute("data-max")||s.max,r=t.getAttribute("min")||t.parentElement.getAttribute("data-min")||s.min,l=s.autocheck?function(e,t,n){var i=e||0;i>n&&(i=n);i<t&&(i=t);return i}(parseFloat(n),parseFloat(r),parseFloat(o)):parseFloat(n);t.value=l,this&&e.typeof(this),i.trigger("input"),k.call(c,"change",{target:t,value:n}),s.onChange&&s.onChange.call(c,{target:t,value:n})})),this}function v(t){if(l.length<1&&(l=f.find(s.id)),t&&"array"===e.typeof(t))return Array.prototype.slice.call(l).forEach((function(e,n){var i=e.id||e.getAttribute("name")||"",a=e.querySelector("input");i==t[n].id&&(a.value=t[n].value,a.min=t[n].min||s.min,a.max=t[n].max||s.max,a.step=t[n].step||s.step)})),this;var n=[];return Array.prototype.slice.call(l).forEach((function(e,t){var i=e.getAttribute("name")||e.id||"",a=e.querySelector("input"),o=a.value,r=a.getAttribute("min"),l=a.getAttribute("max");n.push({id:i,value:o,name:i,min:r,max:l})})),n}function b(){"object"===_typeof(s.id)?(l=e.obj(s.id),d=!1):"string"==typeof s.id&&0===s.id.indexOf("#")?(l=e.obj(s.id),d=!0):(l=f.find(s.id),d=!1),a=l.children(s.prev),o=l.children(s.next),r=l.children(s.input)}function y(){b();var n=this&&"htmldivelement"===e.typeof(this)?t(this):event?t(event.target).parent().next():r,a=+n.val();a-=i;var o=/^-?\d*\.\d+$/.test(i)?parseFloat(a).toFixed(s.decimal):a;return m.call(n,o),k.call(c,"prev",o),this}function w(){b();var n=this&&"htmldivelement"===e.typeof(this)?t(this):event?t(event.target).parent().prev():r,a=+n.val()+ +i,o=/^-?\d*\.\d+$/.test(i)?parseFloat(a).toFixed(s.decimal):parseFloat(a);return m.call(n[0],o),k.call(c,"next",o),this}function x(t,n){return e.off.apply(c,arguments),this}function k(t){c.self=this==window||this&&this.hasOwnProperty("widget")?null:this,e.trigger.apply(c,arguments)}return s.autoinit&&p(s),c}}(bui||{},libs),function(e,t){e.stepbar=function(n){var i,a,o={name:"stepbar",handle:{},on:function(t,n){return e.on.apply(o,arguments),this},off:d,value:u,getItem:function(e){var t="number"==typeof e?e:u();return r.data[t]},next:function(e){var t=u()+1;return f.call(this,"next",t),u(t,e)},prev:function(e){var t=u()-1;return f.call(this,"prev",t),u(t,e)},destroy:function(e){e=1==e;i&&(i.off("click.bui"),e&&i.remove());d("next"),d("prev"),d("change")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(o,t,n)},config:r,init:s},r=o.config=t.extend(!0,{},{id:null,uid:"",handle:".bui-stepbar-cell",hasNumber:!1,lineCenter:!1,click:!0,autoinit:!0,data:[],template:null,direction:"y",value:null,onBeforeInit:null,onInited:null,onChange:null,callback:null},e.config.stepbar,n),l=0,c=!1;function s(n){var l=t.extend(!0,r,n);if(l.onBeforeInit&&l.onBeforeInit.call(o,l),l.id){i=e.obj(l.id),r=o.config=l;var s,d,f="function"==typeof l.template?l.template.call(o,l.data):(s=l.data,d="",t.each(s,(function(e,t){var n=r.hasNumber?e+1:"",i=r.hasNumber?"bui-stepbar-number ":"",a=t.className||"";d+='<div class="bui-stepbar-cell '+i+a+'">',d+='    <span class="bui-stepbar-dot">'+n+"</span>",d+='    <div class="bui-stepbar-text">',t.title&&(d+="        <h3>"+t.title+"</h3>"),t.subtitle&&(d+='        <p class="bui-stepbar-time">'+t.subtitle+"</p>"),t.content&&(d+='        <p class="bui-stepbar-desc">'+t.content+"</p>"),d+="    </div>",d+="</div>"})),d);if("x"==r.direction?i.addClass("bui-stepbar-center bui-stepbar-line"):(i.addClass("bui-stepbar"),i.removeClass("bui-stepbar-center bui-stepbar-line")),l.data.length&&i.html(f),o.$el=i,a=i.children(),c||function(e){var n=function(n){e.click&&u(t(this).index());e.callback&&e.callback.call(o,n,o)};i.off("click.bui",e.handle).on("click.bui",e.handle,n),c=!0}(l),/^\d/.test(l.value)){var p=+l.value>l.data.length?l.data.length-1:+l.value;u(p=p<0?0:p)}return l.uid&&e.history.setUI&&e.history.setUI({uid:l.uid,ui:o}),l.onInited&&l.onInited.call(o,l),this}e.hint("stepbar id不能为空")}function u(e,n){return n=n||"",/\d/.test(e)?(e>=a.length-1?e=a.length-1:e<0&&(e=0),a.each((function(i,a){i<e&&t(a).removeClass("active "+n).addClass("visited"),i==e&&t(a).removeClass("visited "+n).addClass("active "+n),i>e&&t(a).removeClass("visited active "+n)})),e!=l&&(f.call(o,"change",e),r.onChange&&r.onChange.call(o,e),l=e),e):e=i.children(".active").index()}function d(t,n){return e.off.apply(o,arguments),this}function f(t){o.self=this==window||this==o?null:this,e.trigger.apply(o,arguments)}return r.autoinit&&s(r),o}}(window.bui||{},window.libs);var n=function(e){var t=this,n={updateValuesOnTouchmove:!1,rotateEffect:!1,momentumRatio:7,freeMode:!1};for(var i in e=e||{},n)void 0===e[i]&&(e[i]=n[i]);function a(e){return window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(e):window.mozCancelAnimationFrame?window.mozCancelAnimationFrame(e):window.clearTimeout(e)}function o(e,t){for(var n=0;n<e.length;n++){var i=e[n].style;i.webkitTransform=i.MsTransform=i.msTransform=i.MozTransform=i.OTransform=i.transform=t}return e}function r(e,t){"string"!=typeof t&&(t+="ms");for(var n=0;n<e.length;n++){var i=e[n].style;i.webkitTransitionDuration=i.MsTransitionDuration=i.msTransitionDuration=i.MozTransitionDuration=i.OTransitionDuration=i.transitionDuration=t}return e}function l(e,t){var n,i,a,o;return void 0===t&&(t="x"),a=window.getComputedStyle(e,null),window.WebKitCSSMatrix?((i=a.transform||a.webkitTransform).split(",").length>6&&(i=i.split(", ").map((function(e){return e.replace(",",".")})).join(", ")),o=new WebKitCSSMatrix("none"===i?"":i)):n=(o=a.MozTransform||a.OTransform||a.MsTransform||a.msTransform||a.transform||a.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,")).toString().split(","),"x"===t&&(i=window.WebKitCSSMatrix?o.m41:16===n.length?parseFloat(n[12]):parseFloat(n[4])),"y"===t&&(i=window.WebKitCSSMatrix?o.m42:16===n.length?parseFloat(n[13]):parseFloat(n[5])),i||0}t.params=e,t.cols=[],t.initialized=!1;var c,s,u,d,f,p,h=(c=navigator.userAgent,s=c.match(/(Android);?[\s\/]+([\d.]+)?/),u=c.match(/(iPad).*OS\s([\d_]+)/),d=c.match(/(iPod)(.*OS\s([\d_]+))?/),f=!u&&c.match(/(iPhone\sOS)\s([\d_]+)/),p=!!s,u||d||f||navigator.userAgent.toLowerCase().indexOf("safari")>=0&&navigator.userAgent.toLowerCase().indexOf("chrome")<0&&!p);return t.setValue=function(e,n){var i=0;if(0===t.cols.length)return t.value=e,void t.updateValue(e);for(var a=0;a<t.cols.length;a++)t.cols[a]&&!t.cols[a].divider&&(t.cols[a].setValue(e[i],n),i++)},t.updateValue=function(e){for(var n=e||[],i=[],a=0;a<t.cols.length;a++)t.cols[a].divider||(n.push(t.cols[a].value),i.push(t.cols[a].displayValue));n.indexOf(void 0)>=0||(t.value=n,t.displayValue=i,t.params.onChange&&t.params.onChange(t,t.value,t.displayValue))},t.initPickerCol=function(e,n){var i=$(e),c=i.index(),s=t.cols[c];if(!s.divider){var u,d,f,p,g;s.container=i,s.wrapper=s.container.find(".picker-items-col-wrapper"),s.items=s.wrapper.find(".picker-item"),s.replaceValues=function(e,n,i){s.destroyEvents(),s.values=e,s.displayValues=n;var a=t.columnHTML(s,!0);s.wrapper.html(a),s.items=s.wrapper.find(".picker-item"),s.calcSize(),s.setValue(i||s.values[0],0,!0),s.initEvents()},s.calcSize=function(){var e,n;t.params.rotateEffect&&(s.container.removeClass("picker-items-col-absolute"),s.width||(s.container[0].style.width="")),e=0,n=s.container[0].offsetHeight,s.wrapper[0].offsetHeight,u=s.items[0]&&s.items[0].offsetHeight||20,d=u*s.items.length,f=n/2-d+u/2,p=n/2-u/2,s.width&&(e=s.width,parseInt(e,10)===e&&(e+="px"),s.container[0].style.width=e),t.params.rotateEffect&&(s.width||(s.items.each((function(){var t=$(this);t[0].style.width="auto",e=Math.max(e,t[0].offsetWidth),t[0].style.width=""})),s.container[0].style.width=e+2+"px"),s.container.addClass("picker-items-col-absolute"))},s.calcSize(),o(s.wrapper,"translate3d(0,"+p+"px,0)"),r(s.wrapper,"0ms"),s.setValue=function(e,t,n){void 0===t&&(t="");var i=s.wrapper.find('.picker-item[data-picker-value="'+e+'"]').index();void 0!==i&&-1!==i||(i=0);var a=-i*u+p;o(s.wrapper,"translate3d(0,"+a+"px,0)"),r(s.wrapper,t+"ms");try{s.updateItems(i,a,t,n)}catch(e){}},s.updateItems=function(e,n,i,a){void 0===n&&(n=l(s.wrapper[0],"y")),void 0===e&&(e=-Math.round((n-p)/u)),e<0&&(e=0),e>=s.items.length&&(e=s.items.length-1);var c=s.activeIndex;s.wrapper.find(".picker-selected").removeClass("picker-selected"),r(s.items,i);var d=s.items.eq(e).addClass("picker-selected");o(d,""),t.params.rotateEffect&&s.items.each((function(){var e=$(this),t=(e.index()*u-(p-n))/u,i=Math.ceil(s.height/u/2)+1,a=-18*t;a>180&&(a=180),a<-180&&(a=-180),Math.abs(t)>i?e.addClass("picker-item-far"):e.removeClass("picker-item-far"),o(e,"translate3d(0, "+(-n+p)+"px, "+(h?-110:0)+"px) rotateX("+a+"deg)")})),(a||void 0===a)&&(s.value=d.attr("data-picker-value"),s.displayValue=s.displayValues?s.displayValues[e]:s.value,c!=e&&(s.onChange&&s.onChange(t,s.value,s.displayValue),t.updateValue()))},n&&s.updateItems(0,p,0);var m,v,b,y,w,x,k,I,T,O,C=!0;s.initEvents=function(e){var t=/hp-tablet/gi.test(navigator.appVersion),n="ontouchstart"in window&&!t,i=n?"touchstart":"mousedown",a=n?"touchmove":"mousemove",o=n?"touchend":"mouseup",r=e?"off":"on";s.container[r](i,S),s.container[r](a,P),s.container[r](o,L),"mouseup"==o&&document.documentElement.addEventListener("mouseleave",L,!1),s.items[r]("click",j)},s.destroyEvents=function(){s.initEvents(!0)},s.initEvents()}function S(e){if(!v&&!m){var t=e.originalEvent||e;t.preventDefault(),m=!0,b=y=t.targetTouches?t.targetTouches[0].pageY:t.pageY,w=(new Date).getTime(),C=!0,x=I=l(s.wrapper[0],"y")}}function P(e){if(m){var n=e.originalEvent||e;n.preventDefault(),C=!1,y=n.targetTouches?n.targetTouches[0].pageY:n.pageY,v||(a(g),v=!0,x=I=l(s.wrapper[0],"y"),r(s.wrapper,"0ms")),n.preventDefault(),k=void 0,(I=x+(y-b))<f&&(I=f-Math.pow(f-I,.8),k="min"),I>p&&(I=p+Math.pow(I-p,.8),k="max"),o(s.wrapper,"translate3d(0,"+I+"px,0)"),s.updateItems(void 0,I,0,t.params.updateValuesOnTouchmove),O=I-T||I,(new Date).getTime(),T=I}}function L(e){if(m&&v){var n;m=v=!1,r(s.wrapper,""),k&&o(s.wrapper,"min"===k?"translate3d(0,"+f+"px,0)":"translate3d(0,"+p+"px,0)"),n=(new Date).getTime()-w>300?I:I+O*t.params.momentumRatio,n=Math.max(Math.min(n,p),f);var i=-Math.floor((n-p)/u);t.params.freeMode||(n=-i*u+p),o(s.wrapper,"translate3d(0,"+parseInt(n,10)+"px,0)"),s.updateItems(i,n,"",!0),setTimeout((function(){C=!0}),100)}else m=v=!1}function j(e){if(C){a(g);var t=$(this).attr("data-picker-value");s.setValue(t)}}},t.columnHTML=function(e,t){var n="",i="";if(e.divider)i+='<div class="picker-items-col picker-items-col-divider '+(e.textAlign?"picker-items-col-"+e.textAlign:"")+" "+(e.cssClass||"")+'">'+e.content+"</div>";else{for(var a=0;a<e.values.length;a++)n+='<div class="picker-item" data-picker-value="'+e.values[a]+'">'+(e.displayValues?e.displayValues[a]:e.values[a])+"</div>";i+='<div class="picker-items-col '+(e.textAlign?"picker-items-col-"+e.textAlign:"")+" "+(e.cssClass||"")+'"><div class="picker-items-col-wrapper">'+n+"</div></div>"}return t?n:i},t.layout=function(){var e,n;t.cols=[];var i="";for(n=0;n<t.params.cols.length;n++){var a=t.params.cols[n];i+=t.columnHTML(t.params.cols[n]),t.cols.push(a)}e='<div class="'+("picker-modal picker-columns "+(t.params.cssClass||"")+(t.params.rotateEffect?" picker-3d":""))+'"><div class="picker-modal-inner picker-items">'+i+'<div class="picker-center-highlight"></div></div></div>',t.pickerHTML=e},t.init=function(){t.initialized||(t.layout(),t.container=$(t.pickerHTML),t.container.addClass("picker-modal-inline"),$(t.params.container).html(t.container),t.container.find(".picker-items-col").each((function(){var e=!0;(!t.initialized&&t.params.value||t.initialized&&t.value)&&(e=!1),t.initPickerCol(this,e)})),t.value?t.setValue(t.value,0):t.params.value&&t.setValue(t.params.value,0)),t.initialized=!0},t.init(),t};return function(e,t){e.picker=function(e){return new n(e)}}(window.bui||{}),function(e,t){e.pickerdate=function(){function n(e,t){if(e&&e.constructor==Date)return e;if("number"==typeof e&&13===String(e).length)return new Date(e);e=String(e);var n=new Date,i=n.getFullYear(),a=n.getMonth()+1,o=n.getDate();return(e=e.replace(/[-|年|月]/gim,"/").replace(/[时|分|秒|小时|分钟]/gim,":").replace(/^(\d{4}\/\d+?)($|\s)/,(function(e,t){return t+"/1"})).replace(/[日|号]/gim,"").replace(/^(\d{1,2}\/\d{1,2}?)($|\s)/,(function(e,t){return n.getFullYear()+"/"+t}))).indexOf("/")<0&&e.indexOf(":")>-1&&(e=i+"/"+a+"/"+o+" "+e),4===e.length?e+="/1/1 00:00:00":"MM"===t||"M"===t?e=i+"/"+e+"/1 00:00:00":"dd"!==t&&"d"!==t||(e=i+"/"+a+"/"+e+" 00:00:00"),new Date(e)}function i(i){var a,o,r,l,c,s,u,d,f,p,h,g=e.guid(),m={id:g,title:"",uid:"",height:260,popup:!0,mask:!0,autoinit:!0,zIndex:110,bindValue:!1,handleParent:"",position:"bottom",effect:"fadeInUp",appendTo:"",rotateEffect:!1,modelEvent:"input",buttons:[{name:"取消",className:""},{name:"确定",className:"primary-reverse"}],onBeforeInit:null,onInited:null,autoClose:!1,onCancel:null,onBeforeOpen:null,onOpen:null,onChanged:null,onMask:i.onMask||i.autoClose?function(){b&&b.close()}:null,callback:null},v=null,b=this,y=function(){},w=null,x=t.extend(!0,{},m,i);x.appendTo=x.appendTo||e.hasRouter&&router.currentPage()||"body";var k=x.onBeforeOpen;x.callback=function(e){var o=i.callback&&i.callback.call(b,e);if(!1===o)return!1;if(1==o||void 0===o){if("取消"==t(e.target).text().trim()||"cancel"==t(e.target).text().trim()||"关闭"==t(e.target).text().trim())try{var r=n(a);b.value(r),i.onCancel&&i.onCancel.call(b,e)}catch(e){}else a=b.value(),v&&v[0]&&"INPUT"===v[0].nodeName?(v.val(a),v.trigger(x.modelEvent)):v&&v.text(a),0==x.autoClose&&b&&b.close(),x.onChanged&&x.onChanged.call(b,e);0==x.autoClose&&b&&b.close()}v=null};var I={},T=["FullYear","Month","Date"],O=["Hours","Minutes","Seconds"],C={FullYear:"year",Month:"month",Date:"date",Hours:"hour",Minutes:"minute",Seconds:"second"},S=[];function P(t){var n=new Date,i=[n.getFullYear(),n.getMonth()+1,n.getDate()],a=["0","0","0"];t.forEach((function(e,t){switch(e.type){case"year":i[0]=e.value||n.getFullYear();break;case"month":i[1]=e.value||n.getMonth()+1;break;case"date":i[2]=e.value||n.getDate();break;case"hour":a[0]=e.value||"0";break;case"minute":a[1]=e.value||"0";break;case"second":a[2]=e.value||"0"}}));var o=x.formatValue||d||"";o&&"string"==typeof o&&o.indexOf("M-")<0&&(i[2]=1);var r=i.join("/")+" "+a.join(":");return e.date.convert(r)}function L(e){var t=n(e);return S.map((function(e,n){return t["get"+e]()+("Month"==e?1:0)}))}function j(n){if(!t(this).hasClass("disabled")){if(x.bindValue){v=t(this),b.el=this;var i=v.val()||v.text();i=d&&d.indexOf("y")<0&&d.indexOf("M")>-1?(new Date).getFullYear()+"/"+i:i||e.date.today(d),b.value(i)}!1!==(k&&k.call(b,n))&&(w&&!w.isOpen()&&w.open(),x.onOpen&&x.onOpen.call(b,n))}}this.config={},this.option=function(){},this.cols=function(e){e=e||{};var t=[];return p=[],f=[],I={},S=[],T.forEach((function(n,i){"none"!==e[C[n]]&&(S.push(n),t.push(n))})),O.forEach((function(t,n){"none"!==e[C[t]]&&(S.push(t),p.push(t))})),t.forEach((function(t,n){I[t]=f.length;var i=C[t],a=e[i],o=B[t](a);o.type=i,f.push(o)})),p.forEach((function(n,i){0==i&&0!=t.length?f.push(B.Space()):f.push(B.Divider()),0==t.length&&(f[0].content=""),I[n]=f.length;var a=C[n],o=e[a],r=B[n](o);r.type=a,f.push(r)})),b.picker&&(b.picker.params.cols=f,b.picker.initialized=!1,b.picker.init()),this},this.id=function(e){e&&!c&&(c=e)},this.reset=function(){return b.picker&&(b.picker.initialized=!1,b.picker.init()),this},this.empty=function(){return b.picker&&e.obj(i.handle).val(""),this},this.min=function(e){var t=(new Date).getFullYear()-1+"/01/01 00:00:00";return r=n(e||x.min||t),this},this.max=function(e){var t=(new Date).getFullYear()+1+"/12/31 00:00:00";return l=n(e||x.max||t),this},this.value=function(e){if(e){var t=L(n(e,b.config.formatValue));return b.picker.setValue(t,0),v&&v[0]&&"INPUT"===v[0].nodeName&&v.trigger(b.config.modelEvent),this}return u(b.picker,b.value,b.displayValue)},this.values=function(t){if(t&&"array"===e.typeof(t))return t.forEach((function(t,n){var i=e.$("#"+t.id);i.val(t.value),v&&v[0]&&"INPUT"===v[0].nodeName&&i.trigger(x.modelEvent)})),this.values();var n=[];return e.$(o).each((function(e,t){var i={};i.id=t.id,i.value=t.value||"",i.name=t.name||"",n.push(i)})),n},this.checkValue=function(t,n){var i=this.value(),a=e.$("#"+t).val(),o=e.$("#"+n).val();if(this.el.id.includes(n)?o=i:this.el.id.includes(t)&&(a=i),""!=a&&""!=o){var r=e.date.convert(a).getTime();return e.date.convert(o).getTime()>r}return!0},this.handler=function(t){return t&&o!==t&&(o=t,i.handleParent?e.$(i.handleParent).off("click.bui",o).on("click.bui",o,j):e.$(o).off("click.bui").on("click.bui",j),j.hasOpen=!1,o=t),this};var E={y:function(e,t){return e.getFullYear().toString().slice(-t)},M:function(e,t){return((t>1?"0":"")+(e.getMonth()+1)).slice(-2)},d:function(e,t){return((t>1?"0":"")+e.getDate()).slice(-2)},h:function(e,t){return((t>1?"0":"")+e.getHours()).slice(-2)},m:function(e,t){return((t>1?"0":"")+e.getMinutes()).slice(-2)},s:function(e,t){var n=t>1?"0":"";return(n+e.getSeconds()).slice(-2)}};this.formatValue=function(e){return d=e,u=function(t,n,i){var a=P(t.cols);return e.replace(/y+|M+|d+|h+|m+|s+/g,(function(e){return E[e[0]](a,e.length)}))},b.picker&&b.picker.updateValue(),this},this.formatDate=function(e,t){if(null==e)return"";var i=n(e);t=t||"yyyy-MM-dd";var a={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var o in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[o]:("00"+a[o]).substr((""+a[o]).length)));return t},this.onChange=function(t){var n=this;return s=x.bindValue?function(i){v?v[0]&&"INPUT"===v[0].nodeName?v.val(i):v.text(i):e.obj(o).each((function(e,t){"INPUT"===t.nodeName?t.value=i:t.innerTEXT=i})),t&&t.call(n,i)}:t||y,R.call(this,"change",h),this},this.popup=function(n){if(n.popup&&!w){var i='<div id="'+g+'" class="bui-dialog" >';n.title&&(i+='<div class="bui-dialog-head">'+n.title+"</div>"),i+='<div class="bui-dialog-main"><div id="'+g+'-picker"></div></div>',n.buttons&&n.buttons.length&&(i+='<div class="bui-dialog-foot bui-box">',t.each(n.buttons,(function(e,t){var n="object"==_typeof(t)&&"className"in t?" "+t.className:"",a="object"==_typeof(t)&&"name"in t?t.name:t;i+='<div class="span1"><div class="bui-btn'+n+'">'+a+"</div></div>"})),i+="</div>"),i+="</div>",t(n.appendTo).append(i),c=e.obj(g+"-picker")}else c=e.obj(n.id);return this};var N=function(e,t,n){var i=P(e.cols),a=r["get"+t](),o=l["get"+t](),c=i.getTime(),s=r.getTime(),u=l.getTime();return c<s&&i["get"+t]()<a?("Month"==t&&(a+=1),void e.cols[I[t]].setValue(a)):c>u&&i["get"+t]()>o?("Month"==t&&(o+=1),void e.cols[I[t]].setValue(o)):void(n&&(c<s||c>u)&&e.cols[I[n]].onChange(e))},B={};function R(t){b.self=this==window||this==b?null:this,e.trigger.apply(b,arguments)}B.FullYear=function(e){return{type:"year",values:(e=e||{values:function(){for(var e=[],t=r.getFullYear(),n=l.getFullYear(),i=t;i<=n;i++)e.push(i);return e}()}).values,displayValues:e.displayValues,onChange:function(e,t,n){N(e,"FullYear",I.Month?"Month":"")}}},B.Month=function(e){return{type:"month",values:(e=e||{values:[1,2,3,4,5,6,7,8,9,10,11,12],displayValues:["1","2","3","4","5","6","7","8","9","10","11","12"]}).values,displayValues:e.displayValues,textAlign:"right",onChange:function(e,t,n){for(var i=new Date,a=e.cols[I.FullYear]?e.cols[I.FullYear].value:i.getFullYear(),o=e.cols[I.Month]?e.cols[I.Month].value:i.getMonth()+1,r=new Date(a,parseInt(o),0).getDate(),l=[],c=1;c<=r;c++)l.push(c);var s=e.cols[I.Date];s&&s.replaceValues&&s.replaceValues(l,null,s.value<r?s.value:r),N(e,"Month",I.Date?"Date":"")}}},B.Date=function(e){return{type:"date",values:(e=e||{values:function(){var e=31,t=[];do{t.unshift(e)}while(e--);return t}(),displayValues:function(){var e=31,t=[];do{t.unshift(e+"天")}while(e--);return t}()}).values,displayValues:e.displayValues,onChange:function(e,t,n){N(e,"Date")}}},B.Space=function(){return{type:"space",divider:!0,content:"  "}},B.Hours=function(e){return{type:"hour",values:(e=e||function(){for(var e=[],t=[],n=0;n<24;n++)e.push(n),t.push(("0"+n).slice(-2));return{type:"hour",values:e,displayValues:t}}()).values,displayValues:e.displayValues,onChange:function(e,t,n){N(e,"Hours",I.Minutes?"Minutes":"")}}},B.Divider=function(){return{type:"divider",divider:!0,textAlign:"center",content:":"}},B.Minutes=function(e){return{type:"minute",values:(e=e||function(){for(var e=[],t=[],n=0;n<60;n++)e.push(n),t.push(("0"+n).slice(-2));return{type:"minute",values:e,displayValues:t}}()).values,displayValues:e.displayValues,onChange:function(e,t,n){N(e,"Minutes",I.Seconds?"Seconds":"")}}},B.Seconds=function(e){return{type:"second",values:(e=e||function(){for(var e=[],t=[],n=0;n<60;n++)e.push(n),t.push(("0"+n).slice(-2));return{type:"second",values:e,displayValues:t}}()).values,displayValues:e.displayValues,onChange:function(e,t,n){N(e,"Seconds")}}},b.init=function(i){var o,p,g,m=t.extend(!0,x,i);m.onBeforeInit&&m.onBeforeInit.call(b,m),b.config=m,b.min(m.min),b.max(m.max),b.cols(m.cols),b.id(m.id),b.$el=e.obj(m.handle)||null,b.el=b.$el?b.$el[0]:null,b.handler(m.handle),b.popup(m),""===(h=b.$el&&b.$el.val()||"")&&b.onChange(m.onChange),b.formatValue(m.formatValue||"yyyy-MM-dd hh:mm:ss"),d=m.formatValue||"yyyy-MM-dd hh:mm:ss",b.picker=e.picker({container:c,rotateEffect:m.rotateEffect,value:L(m.value?n(m.value):(o=r,p=l,g=new Date,g.getTime()<o.getTime()?o:g.getTime()>p.getTime()?p:g)),onChange:function(e,t,n){var i=u(e,t,n);h!=i&&(h=i,s&&s.call(b,i),R.call(this,"change",i))},cols:f});var v=m.uid;m.popup&&!w&&(delete m.uid,delete m.onBeforeOpen,(w=e.dialog.call(b,m))&&w.on("open",(function(){a=u(b.picker,b.value,b.displayValue),b.picker&&(b.picker.initialized=!1,b.picker.init()),R.call(b,"show")})),w&&w.on("close",(function(){R.call(b,"hide")}))),v&&e.history.setUI&&e.history.setUI({uid:v,ui:b}),m.onInited&&m.onInited.call(b,m)},x.autoinit&&b.init(x),this.name="pickerdate",this.disabled=function(){var t=e.obj(o);return t&&t.addClass("disabled"),this},this.open=function(e){return w.open(e),this},this.isOpen=function(){return w.isOpen()},this.close=function(e){return w.close(e),this},this.triggerInput=function(e){v.trigger(e||x.modelEvent)},this.modifyTitle=function(t){return e.obj(g).find(".bui-dialog-head").html(t),this},this.enabled=function(){var t=e.obj(o);return t&&t.removeClass("disabled"),this},this.destroy=function(e){e=1==e;this.off("show"),this.off("hide"),this.off("change"),w&&w.destroy(e),b=null},this.widget=function(t){var n={dialog:w||{}};return e.widget.call(n,t)},this.on=function(t,n){return e.on.apply(b,arguments),this},this.off=function(t,n){return e.off.apply(b,arguments),this}}return function(e){return new i(e)}}()}(window.bui||{},window.libs),function(e,t){e.levelselect=function(n){var i={popup:!0,data:[],uid:"",height:300,appendTo:"",title:"所在地区",trigger:null,placeholder:"请选择",level:3,visibleNum:2,scrollNum:1,log:!1,mask:!0,zIndex:121,autoClose:!0,fullscreen:!1,position:"bottom",effect:"fadeInUp",showValue:!0,navScroll:!0,onMask:null,value:[],autoinit:!0,autoNext:!0,stopPropagation:!1,onChange:null,onLastChange:null,onBeforeInit:null,template:null,onInited:null,toggle:!1,onClose:null,delimiter:'<em class="delimiter">&gt;</em>',field:{name:"n",icon:"icon",image:"image",value:"",data:["c","a"]}};n.field.data&&(i.field.data=n.field.data);var a=t.extend(!0,{},i,n),o=[],r=bui.guid(),l=r+"-slide",c=null,s=null,u=0,d=[],f=null,p=null,h=null,g=[],m=[],v=[],b=[],y=null,w={name:"levelselect",init:I,show:T,hide:function(e){E.call(this,"beforehide");var t={};"function"==typeof e?t.callback=function(){e&&e.call(w),E.call(w,"hide")}:"string"==typeof e?t.effect=e:"object"===_typeof(e)&&(t=e);y&&y.close(t)},widget:function(t){var n={dialog:y,slide:f,select:g};return e.widget.call(n,t)},value:C,reset:function(){return g.forEach((function(e,t){e.value(""),0==t?(P(t,a.placeholder),e.text(a.placeholder),f&&f.to(t)):(P(t,""),e.text(""))})),this},setNav:P,destroy:function(e){for(var t=0;t<g.length;t++)g[t].destroy(),b[t].text(""),v[t].off("change"),m[t].off("click");y.destroy(),y=null,f.destroy(),f=null,o=[],c=null,s=null,u=0,d=[],g=[],m=[],v=[],b=[],j("change"),j("lastchange")},option:function(t,n){return e.option.call(w,t,n)},to:function(e,t){return f&&f.to(e,t),this},prev:function(){return f&&f.prev(),this},next:function(){return f&&f.next(),this},on:function(t,n){return e.on.apply(w,arguments),this},off:j,trigger:E};n.appendTo=n.appendTo||e.hasRouter&&router.currentPage()||"body";var x=n.id&&0==n.id.indexOf("#")?e.$(n.id):t(n.appendTo);function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=n;return e.forEach((function(e,a){var o=n;e[t]&&(o=k(e[t],t,n+1))>i&&(i=o)})),i}function I(n){var i=a=w.config=t.extend(!0,{},a,n);i.onBeforeInit&&i.onBeforeInit.call(w,i);var I="";try{i.level=function(t,n){var i=0;return"string"==typeof n?i=k(t,n):"array"===e.typeof(n)&&n.forEach((function(e,a){i+=k(t,n[a])})),i}(i.data,i.field.data)}catch(e){i.level=i.level}1==i.level&&(i.visibleNum=1),i.popup?(y||(I=function(t){var n="";return n+='<div id="'+r+'" class="bui-dialog bui-levelselect" style="display:none;">',n+='    <div class="bui-dialog-head">'+t.title+"</div>",n+='    <div class="bui-dialog-main">',n+=L(t),n+="    </div>",n+='    <div class="bui-dialog-close"><i class="'+e.config.icon.close+'"></i></div>',n+="</div>"}(i),x.append(I),y=bui.dialog({id:r,height:i.height,mask:i.mask,scroll:!1,zIndex:i.zIndex,autoClose:i.autoClose,fullscreen:i.fullscreen,position:i.position,effect:i.effect,onClose:i.onClose&&i.onClose.bind(w),onMask:i.onMask&&i.onMask.bind(w)})),c=e.obj(r)):(I=L(i),x.append(I),c=e.objId(r)),p=e.$(i.trigger);var P=0===i.trigger.indexOf("#")||1===p.length;P?(h=p).empty():h=p.parent(),w.$el=c,s=e.objId(l);var j=0,N=function(){var n;function a(e){var n=t(this).index();f&&f.index(),1==i.visibleNum?f&&f.to(n):n==i.level-1?f&&f.to(n-1):f&&f.to(n),t(this).addClass("active").siblings().removeClass("active"),i.stopPropagation&&e.stopPropagation()}function r(e,t,n){for(var a=0;a<i.level;a++)a>t&&e[a].text(n)}v[n=j]=e.$(".select-level-val-"+n,c),m[n]=e.$(".select-level-"+n,s),P&&h.append('<span class="bui-levelselect-value"></span>'),b[n]=h.find(P?".bui-levelselect-value":i.trigger).eq(n),g[n]||(g[n]=bui.select({id:m[n],type:"select",direction:"right",field:{name:i.field.name,icon:i.field.icon,image:i.field.image,value:i.field.value||i.field.name},popup:!1,toggle:i.toggle,data:[],template:i.template}),g[n].on("change",(function(a){i.log&&console.log("change",n);var l=g[n].index()||0,c=g[n].value()||"",s=g[n].text()||g[n].value(),u=v[n];d.splice(n+1,d.length-n),d[n]={name:s,value:c,index:l};var p=[];"string"==typeof i.field.data?p=o[n][l][i.field.data]||o[n][l]:i.field.data&&"array"===e.typeof(i.field.data)&&i.field.data.forEach((function(e,t){o[n][l][i.field.data[t]]&&o[n][l][i.field.data[t]].length&&(p=o[n][l][i.field.data[t]])})),o[n+1]=p,g[n+1]&&g[n+1].option("data",p),g[n+2]&&g[n+2].option("data",[]),m[n]&&m[n].find(".bui-btn").removeClass("active"),t(a.target).parents(".bui-btn").addClass("active"),S(n);var h=o[n],x=o[n+1]||[],k=x.length?i.delimiter:"";u[0]&&"INPUT"===u[0].tagName?(u.val(s),u.trigger("change")):u&&u.html(s+k),x.length&&v[n+1]&&v[n+1].text(i.placeholder),r(v,n,"");var I=b[n];I[0]&&"INPUT"===I[0].tagName?(I.val(s),I.trigger("change")):I&&I.html(s+k),x.length&&b[n+1]&&b[n+1].text(i.placeholder),r(b,n,""),a.context={trigger:b[n],selector:v[n],index:n,select:g[n],data:o[n]},E.call(w,"change",a,h,x),i.onChange&&i.onChange.call(w,a,h,x),(n==i.level-1||x.length<1)&&(i.onLastChange&&i.onLastChange.call(w,a,h,x),E.call(w,"lastchange",a,h,x)),i.popup&&!y.isOpen()||(x.length?(i.log&&console.log("next"),i.visibleNum>1&&f.index()!==n?i.autoNext&&x.length&&f.next():1==i.visibleNum&&i.autoNext&&x.length&&f.next()):(i.log&&console.log("close"),i.autoClose&&y&&y.close()))})),v[n].on("click.bui",a))};for(j=0;j<i.level;j++)N();var B=document.documentElement.clientHeight,R=i.fullscreen?B:String(i.height).indexOf("%")>-1?B*parseFloat(i.height)/100:i.height;i.popup&&y?y.on("open",(function(e){u=R-c.find(".select-value").height()-c.children(".bui-dialog-head").height(),O(i)})):(u=R,O(i)),v[0]&&v[0].text(i.placeholder),b[0]&&b[0].text(i.placeholder),o[0]=i.data,g[0].option("data",o[0]),i.uid&&e.history.setUI&&e.history.setUI({uid:i.uid,ui:w}),i.value&&C(i.value),i.onInited&&i.onInited.call(this,i),function(e){t(e.trigger).click((function(){T()}))}(i)}function T(e){E.call(this,"beforeshow");var t={};"function"==typeof e?t.callback=function(){e&&e.call(w),E.call(w,"show")}:"string"==typeof e?t.effect=e:"object"===_typeof(e)&&(t=e),y&&y.open(t)}function O(e){f||(f=bui.tab({id:l,height:u,scroll:!0,zoom:!1,visibleNum:e.visibleNum,scrollNum:e.scrollNum}).lock()).on("to",(function(e){S(e)}))}function C(t){if(void 0===t)return d;t&&"array"===e.typeof(t)?t.forEach((function(e,t){"string"==typeof e?g[t].value(e):"object"===_typeof(e)&&(g[t].text(e.name||""),g[t].value(e.value||""))})):e.showLog("levelselect.value() 参数是一个数组类型")}function S(e){t(".select-value > *",c).removeClass("active"),t(".select-value > *",c).eq(e).addClass("active")}function P(e,n){return t(".select-value > *",c).eq(e).html(n),b[e].html(n),this}function L(e){var t="",n=0,i=e.showValue?function(e){var t="",n="";e.navScroll&&(t+='<div class="bui-navbar">',n='style="display:block;white-space:nowrap;text-align:left;"'),t+='<div class="bui-box select-value" '+n+">";for(var i=0;i<e.level;i++)t+='        <span class="select-level-val-'+i+'"></span>';return t+="    </div>",e.navScroll&&(t+="</div>"),t}(e):"";for(e.popup||(t+='<div id="'+r+'" class="bui-levelselect">'),t+=i,t+='<div id="'+l+'" class="bui-tab bui-levelselect-tab">',t+='    <div class="bui-tab-main">',t+="        <ul>",n=0;n<e.level;n++)t+="            <li>",t+='                <div class="select-level-'+n+'"></div>',t+="            </li>";return t+="        </ul>",t+="    </div>",t+="</div>",e.popup||(t+="</div>"),t}function j(t,n){return e.off.apply(w,arguments),this}function E(t){w.self=this==window||this==w?null:this,e.trigger.apply(w,arguments)}return a.onBeforeInit&&a.onBeforeInit.call(w,a),a.autoinit&&I(a),w}}(window.bui||{},window.libs),function(e,t){e.input=function(n){var i,a,o,r,l,c={name:"input",handle:{},empty:p,value:f,values:function(t){var n=[];if(void 0===t)return a.each((function(e,t){var i={};i.id=t.id||"",i.name=t.name||"",i.value=t.value||"",n.push(i)})),n;(t&&"array"===e.typeof(t)?t:[t]).forEach((function(t,n){if(t&&"object"===_typeof(t)){var i=t.id?e.$("#".concat(t.id)):e.$('[name="'.concat(t.name,'"'));i&&i.val(t.value||""),i.trigger("change"),i.trigger(s.event)}else a.val(t||""),l.trigger(s.event)}));return this},reset:function(){return p(),this},toggleType:function(){"text"==a.attr("type")?a.attr("type","password"):a.attr("type","text");return this},on:function(t,n){return e.on.apply(c,arguments),this},off:function(t,n){return e.off.apply(c,arguments),this},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:d},s=c.config=t.extend(!0,{},{id:"",uid:"",target:"input,textarea",event:"input",iconClass:".icon-remove",showIcon:!0,showLength:!1,maxLength:0,value:"",onInput:null,onBlur:null,onFocus:null,autoinit:!0,onBeforeInit:null,onChange:null,onInited:null,callback:null},e.config.searchbar,n),u=!1;function d(n){var d=t.extend(!0,s,n);if(d.onBeforeInit&&d.onBeforeInit.call(c,d),s=c.config=d,""!=d.id&&null!==d.id){if(i=e.obj(d.id),c.$el=i,l=i.find(d.target),a=l,o=e.unit.startWithClass(d.iconClass)?d.iconClass:"."+d.iconClass,!u){if(function(e){var n=!1;l.on(e.event,(function(i){var a=this.value||i.data&&i.data.value||"",s=t(this).parent(),u=s.find(o);""!==(a=String(a))&&e.showIcon?u&&u.length?u.css("display","block"):(s.append('<i class="'+o.replace(/\./g," ").substr(1)+'"></i>'),u=l.find(o)):u&&u.css("display","none"),i.data&&""===i.data.value&&u&&u.css("display","none"),e.showLength&&(a!=t(this).attr("placeholder")&&a.length,(r=s.find("em")).text(a.length)),n||(e.onInput&&e.onInput.call(c,i),h.call(c,"input",i))})).on("compositionstart",(function(){n=!0})).on("compositionend",(function(t){n=!1;var i=a.val();e.onInput&&e.onInput.call(c,t,i)})),e.onChange&&l.on("change",(function(t){e.onChange.call(c,t),h.call(c,"change",t)})),e.onFocus&&l.on("focus",(function(n){var r=this.value;a=t(this),e.showIcon&&(i.find(o).css("display","none"),r&&t(this).next().css("display","block")),e.onFocus.call(c,n),h.call(c,"focus",n)})),e.onBlur&&l.off("blur").on("blur",(function(t){var n=e.onBlur&&e.onBlur.call(c,t);1!=n&&null!==n||this.value,h.call(c,"blur",t)})),e.showIcon&&i.off("click.bui",o).on("click.bui",o,(function(t){e.callback&&e.callback.call(c,t),h.call(c,"click",t)})),u=!0}(d),d.showLength){var p=function(e){a.parent();var t='<span class="bui-input-length"><em>0</em>/'+e.maxLength+"</span>";return t}(d);i.append(p)}d.maxLength>0&&l.attr("maxlength",d.maxLength)}return d.value&&f(d.value),d.uid&&e.history.setUI&&e.history.setUI({uid:d.uid,ui:c}),d.showLength&&l.trigger(d.event),d.onInited&&d.onInited.call(c,d),this}}function f(e){return void 0!==e?(a.val(e),l.trigger(s.event),this):a.val()}function p(e){return e&&e.target?(t(e.target).css("display","none"),t(e.target).prev().val(""),t(e.target).prev().trigger("change")):(a.val(""),a.next().css("display","none"),l.trigger("change")),s.showLength&&r.text(0),this}function h(t){c.self=this==window||this==c?null:this,e.trigger.apply(c,arguments)}return s.autoinit&&d(s),c}}(bui||{},libs),function(e,t){e.timer=function(n){var i={uid:"",interval:1e3,target:null,reduce:!0,onEnd:null,onProcess:null,fixZero:!0,type:"number",time:10,times:0},a=t.extend({},i,n),o=a.reduce,r=null,l=0,c=!1,s=a.time,u=!1,d=null,f=null,p={name:"timer",stop:function(e){l=0,d=g(a),clearTimeout(f),f=null,e&&e.call(this)},start:o?b:y,restart:function(){return l=0,d=g(a),f=clearTimeout(f),w(),this},status:function(){return u},pause:function(){return l=d,c=!0,clearTimeout(f),this}};function h(n){return a=t.extend({},i,n),o=a.reduce,r=a.target?e.obj(a.target):null,l=0,c=!1,s=a.times||a.time,u=!1,d=g(a),f=null,a.uid&&e.history.setUI&&e.history.setUI({uid:a.uid,ui:p}),this}function g(t){var n=null;switch(t.type){case"minute":n=60*parseInt(s,10);break;case"hour":n=60*parseInt(s,10)*60;break;case"day":n=60*parseInt(s,10)*60*24;break;case"date":n=(e.date.convert(s).getTime()-(new Date).getTime())/1e3;break;default:n=parseInt(s,10)}return o||(s=n,n=0),n}function m(t){var n=new Date,i=e.date.format(n,"yyyy-MM-dd"),o=0,l=0,c=0,s="",u=parseInt(t%60,10);switch(a.type){case"minute":case"second":l=parseInt(t/60,10),s="".concat(v(l),":").concat(v(u));break;case"hour":o=parseInt(t/60/60,10),l=parseInt(t/60%60,10),s="".concat(v(o),":").concat(v(l),":").concat(v(u));break;case"date":i=e.date.format(a.times||a.time,"yyyy-MM-dd"),c=parseInt(t/60/60/24,10),o=parseInt(t/60/60%24,10),l=parseInt(t/60%60,10),s="剩余".concat(c,"天 ").concat(v(o),":").concat(v(l),":").concat(v(u));break;case"day":i=e.date.format(n.getTime()+1e3*t,"yyyy-MM-dd"),c=parseInt(t/60/60/24,10),o=parseInt(t/60/60%24,10),l=parseInt(t/60%60,10),s="剩余".concat(c,"天 ").concat(v(o),":").concat(v(l),":").concat(v(u));break;case"number":l=parseInt(t/60,10),s="".concat(v(parseInt(t,10)))}return{init:h,date:i,day:c,hour:o,minute:l,second:u,count:t,value:s,target:r&&r[0]}}function v(e){return e<10&&a.fixZero?"0"+e:e}function b(){c&&(d=l,c=!1);var e=m(d);return d<=0?(d=0,r&&r.text(e.value),a.onEnd&&a.onEnd.call(this,e),clearTimeout(f),void(u=!1)):(r&&r.text(e.value),a.onProcess&&a.onProcess.call(this,e),d--,u=!0,f=setTimeout((function(){b()}),a.interval),this)}function y(){c&&(d=l,c=!1);var e=m(d);return d>=s?(r&&r.text(e.value),d=s,a.onEnd&&a.onEnd.call(this,e),clearTimeout(f),void(u=!1)):(r&&r.text(e.value),a.onProcess&&a.onProcess.call(this,e),d++,u=!0,f=setTimeout((function(){y()}),a.interval),this)}h(a);var w=o?b:y;return p}}(window.bui||{},window.libs),function(e,t){e.extend({name:"floor",config:{id:"",menu:"",handle:".bui-btn",floorItem:".bui-floor-item",footer:".bui-floor-footer",area:.5,delay:200,height:"inherit",distance:1,onScroll:null,onScrollTop:null,onScrollBottom:null,onLoaded:null},callback:function(n){var i=this,a=null,o=null,r=null,l=null,c=!0,s=!1,u=!0,d=!0,f=null,p=0,h=[];function g(e){1===o.length?(r&&r.removeClass("active"),r&&r.eq(e).addClass("active")):o.length>1&&o.each((function(n,a){var o=t(a).find(i.config.handle);o.removeClass("active"),o.eq(e).addClass("active")}))}function m(){h=[],l.each((function(e,t){var n={top:"none"===this.style.display?-1:this.offsetTop,display:this.style.display};h.push(n)}))}i.init=function(n){var r=t.extend(!0,i.config,n);i.config=r,r.id||e.showLog("id 不能为空"),this.resize(r),m(),s||function(e){var n=function(n){if(c){var a=t(this).scrollTop();0===a&&(n.index=0,i.trigger("scrolltop",n),e.onScrollTop&&e.onScrollTop.call(i,n)),a>5&&u&&(i.getSelector(e),m(),u=!1);var o=p*parseFloat(e.area),r=0;for(r=0;r<h.length;r++){var l=h[r];if(l.top>-1){var s=l.top-a;if(l.top==a&&0==a)return g(r),n.index=r,void i.trigger("scrollto",n);s<o&&(g(r),n.index=r,i.trigger("scrollto",n))}}parseInt(a+this.offsetHeight,10)==parseInt(this.scrollHeight,10)&&(n.index=h.length-1,i.trigger("scrollbottom",n),e.onScrollBottom&&e.onScrollBottom.call(i,n))}i.trigger("scroll",n),e.onScroll&&e.onScroll.call(i,n)};a.scroll(n),o&&o.off("click.bui",e.handle).on("click.bui",e.handle,(function(n){c=!1,d&&(i.getSelector(e),m(),d=!1);var a=t(this).index();i.to(a),i.trigger("click",n)})),a.parents("main").css("position","relative"),s=!0}(r),r.onLoaded&&r.onLoaded.call(i,r)},i.getSelector=function(t){return a=e.$(t.id),o=e.$(t.menu),r=o&&o.find(t.handle),l=a.find(t.floorItem),a.find(t.footer),this},i.resize=function(n){if(this.getSelector(n),"string"==typeof n.height&&"inherit"!==n.height){var i=t(window).height()-e.$("header").height()-e.$("footer").height()-a[0].offsetTop;i=n.height.indexOf("%")>-1?t(window).height()*parseInt(n.height,10)/100:i,a.height(i).css("position","relative"),p=i}else"number"==typeof n.height&&n.height>0?(a.height(n.height).css("position","relative"),p=n.height):p=a.height()},i.to=function(e,t){r=o&&o.find(i.config.handle);var n=h[e]&&h[e].top||0;a[0].scrollTop=n,g(e),f&&clearTimeout(f),f=setTimeout((function(){c=!0}),i.config.delay),t&&t.call(i,e),i.trigger("to",e);var l={target:a[0],index:e};i.trigger("scrollto",l)},i.destroy=function(e){e=1==e;a&&(a.off("click.bui"),a.off("scroll"),e&&a.remove(),a=null),o&&(o.off("click.bui"),o=null),i.off("click"),i.off("to"),i.off("scroll"),i.off("scrollto"),i.off("scrolltop"),i.off("scrollbottom"),s=!1},i.init(i.config)}})}(window.bui||{},window.libs),t((function(e){!function(t,n){t.popover=function(i,a,o){var r=t.dialog(),l={className:"bui-popover",title:"",width:"",height:"",scroll:!0,zIndex:121,autoClose:!0,showToolbar:!1,zoom:!0,useBox:!0,position:"center",effect:"zoomIn",fullscreen:!0};l.showToolbar=!0,l.min=!1,l.max=!1,l.showArrow=!1,l.direction="up",l.mask=!1,l.buttons=null,l.onClickMain=null,l.callback=null;var c={},s=null;return(c=n.extend(l,t.config.confirm,i)).className=l.className+" "+(i.className||""),c.showArrow&&(c.className=c.className+" "+"bui-arrow-".concat(c.direction)),s?(s.open(),s):(s=r.create(c),r.open(),c.onClickMain&&r.$el().on("click.bui",".bui-dialog-main",(function(t){if(t.target=this,!1===(c.onClickMain&&c.onClickMain.call(e,t,e)))return!1;t.stopPropagation()})),r)}}(window.bui||{},window.libs)})),function(e,t){e.ajax=function(n){var i=t.Deferred(),a=null,o=t.extend(!0,{},{baseUrl:"",data:{},method:"GET",dataType:"json",timeout:6e4,headers:{},processData:!0,mimeType:"none",cache:!0,async:!0,needJsonString:!1,contentType:null,localData:null,transformRequest:null,transformResponse:null,native:!0,needNative:!1},e.config.ajax,n),r=o.success,l=o.fail||o.error;if(null===o.contentType&&"get"==o.method.toLocaleLowerCase()?o.contentType="text/html;charset=UTF-8":null===o.contentType&&"post"==o.method.toLocaleLowerCase()?o.contentType="application/x-www-form-urlencoded":o.contentType=o.contentType,"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,o.needJsonString)try{o.data="object"===_typeof(o.data)?JSON.stringify(o.data):o.data}catch(e){o.data=o.data}if(o.data=o.transformRequest&&o.transformRequest.call(i,o.data)||o.data,!o.url)return e.showLog("url不能为空","bui.ajax"),i;if(o.url.indexOf("://")>-1?o.url=o.url:o.url.indexOf("./")>-1||o.url.indexOf("../")>-1?o.url=bui.unit.resolvePath(o.url):o.url=o.baseUrl+o.url,o.proxy){var c=o.url.indexOf(o.proxy),s=c>-1?c+1:-1;o.url=o.url.substr(s)}if(i.abort=function(){a&&a.abort()},o.localData)return o.localData=o.transformResponse&&o.transformResponse.call(i,o.localData)||o.localData,r&&r(o.localData,200),i.resolve(o.localData,200),i;if(o.needNative){if(void 0===e.native.ajax)return u(o),i;try{i=e.native.ajax&&e.native.ajax(o)||i}catch(e){}}else u(o);function u(e){e.success=function(t,n,a){var o=null;if("string"==typeof t&&"json"==e.dataType)try{o=JSON.parse(t)}catch(e){o=t}else o=t||{};o=e.transformResponse&&e.transformResponse.call(i,o)||o,r&&r(o,n,a),i.resolve(o,n,a)},e.error=function(t,n,a){var o;if("string"==typeof t&&"json"==e.dataType)try{o=JSON.parse(t)}catch(e){o=t}else o=t||{};l&&l(o,n,a),i.reject(o,n,a)};var n=e.type&&e.type.toUpperCase();e.type=n||e.method.toUpperCase(),a=t.ajax(e)}return i},e.get=function(n,i,a){var o={method:"GET"};o.url=n,o.data=i||{};var r=null,l=a&&a[0];return r=a&&"array"===e.typeof(a)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.get,o,l):o,bui.ajax(r)},e.post=function(n,i,a){var o={method:"POST",contentType:"application/x-www-form-urlencoded"};o.url=n,o.data=i||{};var r=null,l=a&&a[0];return(r=a&&"array"===e.typeof(a)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.post,o,l):o).contentType.indexOf("application/json")>-1&&(r.data="object"===_typeof(r.data)?JSON.stringify(r.data):r.data),bui.ajax(r)},e.put=function(n,i,a){var o={method:"PUT",contentType:"application/json"};o.url=n,o.data=i||{};var r=null,l=a&&a[0];return(r=a&&"array"===e.typeof(a)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.put,o,l):o).contentType.indexOf("application/json")>-1&&(r.data="object"===_typeof(r.data)?JSON.stringify(r.data):r.data),bui.ajax(r)},e.delete=function(n,i,a){var o={method:"DELETE",contentType:"application/json"};o.url=n,o.data=i||{};var r=null,l=a&&a[0];return(r=a&&"array"===e.typeof(a)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.delete,o,l):o).contentType.indexOf("application/json")>-1&&(r.data="object"===_typeof(r.data)?JSON.stringify(r.data):r.data),bui.ajax(r)},e.all=function(n){var i=null;return i=n&&"array"===e.typeof(n)?n:Array.prototype.slice.apply(arguments),t.when.apply(null,i)}}(window.bui||{},window.libs),function(e,t){e.load=function(n){var i,a={url:"",param:{},reload:!!e.hasRouter&&router.config.reload,firstAnimate:!1,replace:!1,native:!0,needNative:!1},o=t.extend(!0,{},a,e.config.load,n),r={},l=o.url;if(o.url)if(document.activeElement.blur(),l.indexOf("tel:")>=0||l.indexOf("mailto:")>=0||l.indexOf("sms:")>=0)e.unit.openExtral(l);else{if(l&&l.indexOf("?")>-1){var c=l.split("?");r=e.unit.keyStringToObject(c[1]),o.url=c[0]}try{var s="string"==typeof o.param&&JSON.parse(o.param)||o.param||{};o.param=t.extend(!0,{},r,s)}catch(t){return void e.showLog("param 参数值必须是一个{}对象","bui.load:web")}if(n&&n.needNative||e.nativeRouter)e.native.load&&e.native.load(o);else if(i=e.setUrlParams(o.url,o.param),"_blank"!==o.target)o.reload?window.location.href=e.hasRouter?"index.html#"+i:i:!o.replace||e.hasRouter?e.hasRouter?window.router.load(o):window.location.href=i:window.location.replace(i);else window.open("about:blank").location.href=e.hasRouter&&0!==i.indexOf("http")?"index.html#"+i:i}else e.showLog("url 不能为空!","bui.load:web")}}(window.bui||{},window.libs),function(e,t){e.getPageParams=function(n){var i=t.Deferred(),a={callback:null,native:!0,needNative:!1};n=n||{};var o=t.extend(!0,{},a,e.config.getPageParams);if("function"==typeof n?o.callback=n:n&&"object"===e.typeof(n)&&(o=t.extend(!0,{},a,e.config.getPageParams,n)),"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,n&&n.needNative||e.nativeRouter)return i=e.native.getPageParams&&e.native.getPageParams(o)||i;if(e.hasRouter){var r=window.router.getPageParams&&window.router.getPageParams()||e.getUrlParams();o.callback&&o.callback(r),i.resolve(r)}else{var l=e.getUrlParams();o.callback&&o.callback(l),i.resolve(l)}return i}}(window.bui||{},window.libs),function(e,t){e.back=function(n){var i,a={index:-1,name:"",effect:"",delay:!0,param:null,native:!0,beforeBack:!0,callback:null};"function"==typeof n?(a.callback=n,i=t.extend(!0,{},a,e.config.back)):i=n&&"object"===e.typeof(n)?t.extend(!0,{},a,e.config.back,n):t.extend(!0,{},a,e.config.back),"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp;var o=e.hasRouter&&router.history&&router.history.getLast()||null;if(!1!==("function"==typeof i.beforeBack?i.beforeBack.call(this,{prevTarget:null,target:o}):i.beforeBack))if(n&&n.needNative||e.nativeRouter)e.native.back&&e.native.back(i);else{if(e.hasRouter)if(window.router.config.syncHistory){var r=e.history.get(),l=r.length-1;if(i.name){var c=e.array.indexs(r,i.name,"name"),s=c.length;i.index=s?-(r.length-c[s-1]-1):-1}if(Math.abs(i.index)>=r.length&&(i.index=-l),Math.abs(i.index)>=window.history.length&&window.router.config.hash&&(i.index=window.router.config.reloadCache?-l:-(window.history.length-1)),0==i.index&&(i.index=-1),i.effect&&sessionStorage.setItem("backEffect",i.effect),window.router.config.hash&&!window.router.config.reloadCache)return void d();(r.length>1||window.history.length>1)&&d()}else window.router.back&&window.router.back(i);else d();var u=null}function d(){var t=e.hasRouter&&e.history.getPrev()||{},n=t.exports||{};if(window.history.go(i.index),e.hasRouter&&i.param){t.param=i.param;var a=window.location.origin+window.location.pathname+"#"+t.pid,o=e.setUrlParams(a,t.param);t.component={},t.page={},window.history.hasOwnProperty("replaceState")&&window.history.replaceState(t,null,o)}u&&clearTimeout(u),i.delay&&i.callback?u=setTimeout((function(){e.hasRouter?i.callback.call(router,n):i.callback.call(e,{})}),500):i.callback&&i.callback()}}}(window.bui||{},window.libs),function(e,t){e.refresh=e.history.refresh}(window.bui||{}),function(e,t){e.run=function(n){var i={};"string"==typeof n?i.id=n:n&&"object"===e.typeof(n)&&(i=t.extend(!0,{},{id:"",name:"",data:null,onFail:null,native:!0,needNative:!0},e.config.run,n));var a=String(i.id);if("object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,n.needNative)e.native.run&&e.native.run(i);else if(a.indexOf("http://")>-1||a.indexOf("https://")>-1){var o=e.setUrlParams(i.id,i.data);if(e.platform.isIos())return void(window.location.href=o);(window.open("","_blank")||window.open("","_newtab")).location.href=o}}}(window.bui||{},window.libs),function(e,t){e.fileselect=function(n){var i,a,o,r=t.extend(!0,{},{uid:"",native:!0,needNative:!1,needCompress:!1,appendTo:"",quality:.8,from:"camera",name:"uploadFiles",width:800,height:800,duration:10,multiple:!1,onSuccess:null,onChange:null,onFail:null,mediaType:"picture"},e.config.fileselect,n),l=this,c={add:function(n){s=null;var i=t.extend(!0,{needChangeData:!0,needCompress:!1,name:"resize.jpg"},r,n);if((u=i).mimeType=n.mimeType?n.mimeType:"",r.onChange=n.onChange||r.onChange,f){switch(n.from){case"picture":case"photo":case"savephoto":a.removeAttr("capture"),a.attr("accept","image/*");break;case"*":case"file":a.removeAttr("capture"),a.attr("accept","*");break;case"camera":a.attr("capture",n.from),a.attr("accept",p);break;default:a.removeAttr("capture"),a.attr("accept",p)}e.platform.isIos()&&"function"==typeof FastClick?a[0].dispatchEvent(new Event("click")):a.trigger("click")}else o.add(i);return this},remove:function(t,n){n=n||"name";if(!f)return d=o.remove(t,n);if("string"==typeof t){d.length&&e.array.remove(d,t,n);var i=d.length?d[d.length-1].data:null;return s=i,a[0].value="",d}return this},clear:function(){d=[],s=null,f?a[0].value="":o.clear();return d},value:function(){f||(s=o.value());return s},data:function(){f||(d=o.data());return d},toFile:x,toBase64:function(n){var i=t.extend(!0,{needCompress:!1,destinationType:"data",mimeType:"",needChangeData:!1},n);if(i.data=i.data||s,i.mimeType=n.mimeType?n.mimeType:i.data&&i.data.type||"image/jpeg",f)try{w(i)}catch(t){e.showLog(t)}else o.toBase64(i);return this},resize:w,toBlob:k,currentIndex:function(){var e="";e=f?d.length-1:o.data().length-1;return e},currentName:function(){var e="";e=f?d[d.length-1].name:o.value().name;return e},init:y},s=null,u=null,d=[],f="object"===_typeof(n)&&void 0!==n.needNative?!n.needNative:e.isWebapp,p="*",h=!1,g=null,m=null,v=null,b=null;function y(n){var y=t.extend(!0,r,n);switch(r.appendTo=y.appendTo||e.hasRouter&&router.currentPage()||"body",y.mediaType){case"allmedeia":p="*";break;case"picture":case"image":p="image/*";break;case"video":p="video/*";break;case"audio":p="audio/*";break;default:p=y.mediaType}return d=[],g=new Image,m=new FileReader,v=document.createElement("canvas"),b=v.getContext("2d"),f?(!function(){if(null==a){i=bui.guid();var e=r.from?'capture="'+r.from+'"':"",n=r.multiple?"multiple":"",o='<input type="file" accept="'+p+'" name="'+r.name+'" id="'+i+'" '+e+" "+n+' style="display:none" />';t(r.appendTo).append(o),a=t("#"+i)||t('input[name="'+r.name+'"]')}}(),h||(c.el=a[0],a.on("change",(function(t){var n=this.files;if(!(n.length<1)){if(n.length>1&&e.showLog("一次只能选一张图片","bui.fileselect:web"),!1===(r.onChange&&r.onChange.call(l,t)))return!1;var i=n[0];s=i;var a={name:i.name,data:i,type:i.type,size:i.size};d.push(a),u.needCompress?(u.data=i,u.mimeType=u.mimeType?u.mimeType:i.type,w(u)):u.onSuccess&&u.onSuccess.call(l,i,d),this.value=""}})),h=!0)):o=e.native.fileselect&&e.native.fileselect.call(this,n,{module:c})||{},y.uid&&e.history.setUI&&e.history.setUI({uid:y.uid,ui:c}),this}function w(n){var i=t.extend(!0,{destinationType:"file",data:null,mimeType:"",quality:.8,width:800,height:800,needCompress:!0,needChangeData:!1,onSuccess:null,onFail:null},r,n);i.data=i.data&&"array"===e.typeof(i.data)?i.data.pop():i.data,g.onload=function(){var t=this.width,n=this.height,a=null,o=i.width,r=i.height,c=t,u=n;i.needCompress&&(t>o||n>r)&&(t/n>o/r?(c=o,u=Math.round(o*(n/t))):(u=r,c=Math.round(r*(t/n)))),v.width=c,v.height=u,b.clearRect(0,0,c,u),b.drawImage(g,0,0,c,u);var f=v.toDataURL(i.mimeType||i.data&&i.data.type||"image/jpeg",i.quality),p=function(e){var t=e.indexOf(".png")>-1||e.indexOf(".jpg")>-1||e.indexOf(".gif")>-1||e.indexOf(".jpeg")>-1;return t?e.substr(0,e.lastIndexOf(".")):e}(i.data.name)||"";switch(i.destinationType){case"file":a=x(f,p);break;case"blob":a=k(f);break;case"data":a=f}if(i.needChangeData){s=a;var h=e.array.index(d,i.data.name,"name");h>-1&&(d[h].data=a,a.size&&(d[h].size=a.size),a.type&&(d[h].type=a.type))}return i.onSuccess&&i.onSuccess.call(l,a,d),a},g.onerror=function(){i.onFail&&i.onFail.call(l,g.src)},m.onload=function(e){g.src=e.target.result};try{var a=i.data&&i.data.type||"";a="object"===_typeof(a)?a.type||"":a||"",i.data&&0==a.indexOf("image")&&m.readAsDataURL(n.data)}catch(t){e.showLog(t)}}function x(t,n){try{n=n||"file";for(var i=t.split(","),a=(i[0].match(/:(.*?);/)||[])[1]||"image/jpeg",o=a.split("/")[1],r=atob(i[1]),l=r.length,c=new Uint8Array(l);l--;)c[l]=r.charCodeAt(l);return new File([c],n+"."+o,{type:a})}catch(t){e.showLog(t)}}function k(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),a=i.length,o=new Uint8Array(a);a--;)o[a]=i.charCodeAt(a);return new Blob([o],{type:n})}return y(r),c}}(bui||{},libs),function(e,t){e.file=function(n){var i,a,o,r,l,c={getFolder:d,removeFolder:function(e){var n=t.extend(!0,{},e);s.needNative?l.removeFolder(n):d({root:n.root,folderName:n.folderName,create:n.create,onSuccess:function(e,t){e.removeRecursively((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}});return this},getFile:h,getFileName:p,removeFile:function(e){var n=t.extend(!0,{},e);s.needNative?l.removeFile(n):h({root:n.root,create:n.create,folderName:n.folderName,fileName:n.fileName,onSuccess:function(e,t){e.remove((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}});return this},toBase64:function(e){return r.toBase64(e),this},open:function(t){var n=t||{};if(!n.url)return;s.needNative?l.open(n):e.showLog("web暂不支持open方法","bui.file.open:web");return this},init:u},s=c.config=t.extend(!0,{},{uid:"",size:10,native:!0,needNative:!1},e.config.file,n);function u(n){return r=e.fileselect(n),a=function(n){var a=t.Deferred();n.needNative?l=e.native.file&&e.native.file(n,{fileselect:r,module:c})||{}:(i="bui.app",o=1024*parseInt(s.size)*1024,window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,navigator.webkitPersistentStorage&&navigator.webkitPersistentStorage.requestQuota(o,(function(e){window.requestFileSystem(window.PERSISTENT,e,(function(e){a.resolve(e)}),u)})));function u(e){var t="";try{switch(e.code){case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}}catch(e){}var n={msg:t};a.reject(n)}return a}(n),!n.needNative&&d({root:!0,create:!0}),n.uid&&e.history.setUI&&e.history.setUI({uid:n.uid,ui:c}),this}function d(e){var n={folderName:i,root:!1,create:!1,msg:"",param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},o=t.extend({},n,e),r="";if(o.create?(r="创建 ",o.param.create=!0):(r="获取 ",o.param.create=!1),s.needNative)l.getFolder(o);else{var u=f(o.folderName);o.root||(u=i+"/"+u),a.done((function(e){e.root.getDirectory(u,o.param,(function(t){o.onSuccess&&o.onSuccess.call(c,t,e)}),(function(e){var t={msg:r+u+" 文件夹失败"};o.onFail&&o.onFail.call(c,t)}))})).fail((function(e){o.onFail&&o.onFail.call(c,{msg:"文件系统还没准备好."})}))}return this}function f(e){return"."==e[0]||"/"==e[0]||" "==e[0]?f(e.slice(1)):"."!=e[0]&&"/"!=e[0]&&" "!=e[0]?e:void 0}function p(e){return e&&e.indexOf("/")>-1?e.slice(e.lastIndexOf("/")+1,e.indexOf("?")>-1?e.indexOf("?"):void 0):e}function h(e){var n=t.extend({},{fileName:"",folderName:"",root:!1,create:!1,param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},e),a="";if(n.create?(a="创建 ",n.param.create=!0):(a="获取 ",n.param.create=!1),n.fileName&&!(n.fileName.indexOf(".")<0)){if(s.needNative)l.getFile(n);else{var o=p(n.fileName);d({root:n.root,folderName:n.folderName,create:!0,onSuccess:function(e,t){var r=e.name==i?e.name+"/"+o:i+"/"+e.name+"/"+o;t.root.getFile(r,n.param,(function(e){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(e){var t={msg:a+o+" 文件失败"};n.onFail&&n.onFail.call(c,t)}))},onFail:function(e){n.onFail&&n.onFail(e)}})}return this}n.onFail&&n.onFail()}return"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,u(s),c}}(window.bui||{},window.libs),function(e,t){e.upload=function(n){var i,a,o,r,l,c,s,u={uid:"",url:"",data:null,headers:{},showProgress:!0,timeout:6e4,contentType:!1,processData:!1,autoClose:!0,multiple:!1,native:!0,name:"uploadFiles",needNative:!1,method:"POST",fileKey:"file",dataType:"json",mediaType:"picture",from:"picture",onProgress:null,onMask:function(){y()},onSuccess:null,onFail:null},d=t.extend(!0,{},u,e.config.upload,n),f=t.Deferred(),p={init:m,add:function(e){return e.onSuccess=e.onSuccess?e.onSuccess.bind(p):null,e.onFail=e.onFail?e.onFail.bind(p):null,a.add(e),this},remove:function(e,t){var n=v(),i=n.length;if(i<1)return this;/\d/.test(e)&&e.indexOf(".")<0?a.remove(n[e].name,t):"string"==typeof e?a.remove(e,t):a.remove(n[i-1].name,t);return this},resize:function(e){return a.resize(e),this},currentIndex:function(){return a.currentIndex()},currentName:function(){return a.currentName()},clear:function(){return a.clear(),this},data:v,start:b,startAll:function(e){var n=t.extend(!0,{needFileinfo:!1},d,e),i=n[n.fileKey]||a.data();n.data||(n.data={});for(var o=[],r=0;r<i.length;r++)i[r],function(e){if(!(e>i.length-1)){if(n.data[n.fileKey]=i[e]&&i[e].data,n.needFileinfo)for(var t in i[e])"data"!==t&&(n.data[t]=i[e]&&i[e][t]);var a=n.onSuccess,r=n.onFail;n.onSuccess=function(t){a&&a.call(p,t),o[e]=t,e==i.length-1&&n.onEnd&&n.onEnd.call(p,o)},n.onFail=function(t){r&&r.call(p,t),o[e]=t,e==i.length-1&&n.onEnd&&n.onEnd.call(p,o)},b(n)}}(r);return f},stop:y,toBase64:function(e){return a.toBase64(e),this},widget:function(t){var n={loading:i,fileselect:a,ajax:o};return e.widget.call(n,t)}},h=d.showProgress,g=d.onProgress;function m(t){return i=e.loading({display:"block",width:30,height:30,opacity:0,autoClose:t.autoClose,callback:t.onMask}),a=e.fileselect.call(p,{native:t.native,needNative:t.needNative,from:t.from,name:t.name,multiple:t.multiple,mediaType:t.mediaType,onChange:t.onChange}),p.el=a.el,t&&t.needNative&&(r=e.native.upload&&e.native.upload(t,{loading:i,fileselect:a,module:p})||{}),t.data?(b(t),t.uid&&e.history.setUI&&e.history.setUI({uid:t.uid,ui:p}),this):this}function v(){return a.data()}function b(e){var n=t.extend(!0,{},d,e);if(c=n.url,l=a.value(),h=n.showProgress,l){if(h&&i.show(),n&&n.needNative)return r.start(n)||f;var s=n.data,u=s&&"object"===_typeof(s)?Object.keys(s):[],g=new FormData,m=!1;return u.forEach((function(e,t){n.fileKey===e&&(m=!0),g.append(e,s[e])})),!m&&g.append(n.fileKey,l),n.data=g,function(e){var n=e.onSuccess,i=e.onFail;return o=t.ajax({url:c,type:e.method,data:e.data,cache:e.cache,headers:e.headers,dataType:e.dataType,contentType:e.contentType,processData:e.processData,timeout:e.timeout,xhr:function(){var e=t.ajaxSettings.xhr();if(w&&e.upload)return e.upload.addEventListener("progress",w,!1),e},success:function(e){x(),n&&n.call(p,e),f.resolve(e)},error:function(e,t,n){x(),i&&i.call(p,e,t),f.reject(e,t,n)}}),f}(n)}}function y(e){return d&&d.needNative?r.stop(e):(i&&i.stop(),o&&o.abort(),e&&e.call(p,i,o)),this}function w(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);s=t.toString()+"%",t<100?(n=s,h&&i&&i.show({text:n})):x(),g&&g.call(p,s)}var n}))}function x(){return i&&i.stop(),this}return"object"===_typeof(n)&&void 0!==n.needNative?n.needNative:e.isWebapp,m(d),p}}(window.bui||{},window.libs),function(e,t){e.download=function(n){var i,a,o,r,l,c={open:function(e){return a.open(e),this},getFile:function(e){var n=t.extend(!0,{autoDown:!0},s,e),i=e.fileName||a.getFileName(n.url);a.getFile({fileName:i,folderName:n.folderName,onSuccess:function(e,t){n.onSuccess&&n.onSuccess.call(c,e.fullPath||e,e,t)},onFail:function(e){n.autoDown=v(n)}})},removeFile:function(t){if(!t.fileName)return e.showLog("请告诉我们你要删除哪个文件, fileName "),this;return t.folderName=t.folderName||s.folderName,a.removeFile(t),this},removeFolder:function(e){return e.folderName=e.folderName||s.folderName,a.removeFolder(e),this},start:v,stop:b,toBase64:function(e){return a.toBase64(e),this},init:m,widget:function(t){var n={loading:h,file:a,ajax:i};return e.widget.call(n,t)}},s=c.config=t.extend(!0,{},{uid:"",url:"",data:{},headers:{},method:"GET",showProgress:!0,timeout:6e4,fileName:"",folderName:"download",native:!0,needNative:!0,onProgress:null,onSuccess:null,onFail:null},e.config.download,n),u="object"===_typeof(n)&&void 0!==n.needNative?!n.needNative:e.isWebapp,d=s.showProgress,f=s.onProgress,p=s.onFail,h=null,g=null;function m(t){return h=t.showProgress&&e.loading({display:"block",width:30,height:30,opacity:0,callback:function(){b()}}),a=e.file({native:t.native,needNative:t.needNative}),t.needNative?o=e.native.download&&e.native.download(t,{file:a,loading:h,module:c})||{}:function(e){if(a.getFolder({folderName:e.folderName,create:!1,onSuccess:function(e,t){e.fullPath},onFail:function(t){a.getFolder({folderName:e.folderName,create:!0,onSuccess:function(e,t){e.fullPath},onFail:function(e){p&&p.call(c,e)}})}}),!e.url)return;v(e)}(t),t.uid&&e.history.setUI&&e.history.setUI({uid:t.uid,ui:c}),this}function v(e){var n=t.extend(!0,{},s,e);r=n.needEncode?encodeURI(n.url):n.url,f=n.onProgress,(d=n.showProgress)&&h&&h.show({text:"0%"}),e.fileName||a.getFileName(n.url),n.needNative?o.start(n):(n.cache=!1,n.contentType=!1,n.processData=!1,i=t.ajax({url:r,type:n.method,data:n.data,cache:n.cache,headers:n.headers,contentType:n.contentType,processData:n.processData,timeout:n.timeout,xhr:function(){var e=t.ajaxSettings.xhr();if(y&&e)return e.addEventListener("progress",y,!1),e},success:function(t){var i=e.fileName||a.getFileName(n.url);a.getFile({fileName:i,folderName:n.folderName,create:!0,onSuccess:function(e,t){n.onSuccess&&n.onSuccess.call(c,e.fullPath,t)}})},fail:function(e){w(),n.onFail&&n.onFail.call(c,e)}}))}function b(e){u?(w(),i&&i.abort(),g&&window.cancelAnimationFrame(g)):o.stop(),e&&e.call(c,h,i)}function y(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,g=window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);l=t.toString()+"%",t<100?(n=l,d&&h&&h.show({text:n})):w(),f&&f.call(c,l)}var n}))}function w(){d&&h&&h.stop()}return m(s),c}}(window.bui||{},window.libs),function(e,t){e.currentPlatform="webapp",e.on("pagereadybefore",(function(){try{e.platform.isPC()?window.viewport=e.viewport(50):window.viewport=e.viewport()}catch(e){}e.config.init.auto&&e.init(),!e.hasRouter&&e.config.component.auto&&loader.components({id:"body"})})),e.webready=function(n){t(document).ready((function(){e.trigger.call(e,"pagereadybefore");var t=loader&&loader.map().globals;n&&n.call(e,t),e.trigger.call(e,"pageready")}))},e.ready=function(n){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp;var i=t.Deferred();if(e.webready(n),!e.isWebapp){if(void 0===e.native.ready)return e.showLog("当前 bui.isWebapp = false; 但bui.js为webapp版本,不支持原生方法,请使用 buijs update -p xxx, 更换bui.js为对应xxx平台版本;"),i;i=e.native.ready&&e.native.ready(n)||i}return i}}(window.bui||{},window.libs),function(e,t){e.init=function(n){var i,a={id:".bui-page",height:0,header:"header",main:"main",footer:"footer",reduceRem:0};if("object"==e.typeof(n))i=t.extend({},a,e.config.init,n);else{var o={};o.height=n,i=t.extend({},a,o)}var r=i.height||document.documentElement.clientHeight||t("body").height()||t("#bui-router").height()||t(".bui-page").height();if(!(e.obj(i.main).length<1)){try{var l=e.obj(i.id),c=i.header.indexOf("#")>-1?e.obj(i.header)[0]:l.children(i.header)[0],s=i.footer.indexOf("#")>-1?e.obj(i.footer)[0]:l.children(i.footer)[0],u=i.main.indexOf("#")>-1?e.obj(i.main):l.children(i.main),d=c?c.offsetHeight:0,f=s?s.offsetHeight:0,p=i.reduceRem>0?e.unit.remToPx(i.reduceRem):0,h=r-d-f-p;if(parseInt(h)>0)u.height(h);else{var g=d+f+p+"px";e.unit.calcHeight(u,g)}}catch(t){e.showLog(t,"bui.init")}return h}},window.addEventListener?window.addEventListener("load",(function(t){e.trigger.call(e,"onload")}),!1):window.attachEvent("onload",(function(t){e.trigger.call(e,"onload")})),t(document).ready((function(){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp,e.trigger.call(e,"pagebefore"),"function"==typeof FastClick&&FastClick.attach(document.body),e.trigger.call(e,"pageinit")}));try{var n="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"",i=n.replace(/hidden/i,"visibilitychange");document.addEventListener(i,(function(t){document[n]?e.trigger.call(e,"pagehide",t):e.trigger.call(e,"pageshow",t)}))}catch(e){}try{navigator.control.gesture(!1),navigator.control.longpressMenu(!1)}catch(e){}}(window.bui||{},window.libs),bui}));
