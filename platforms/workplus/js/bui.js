/* @preserve 
 * @name: BUI v1.6.3  
 * @detail: BUI 是一个免费的UI交互框架, 用于快速定制开发WebApp,微信,混合移动应用(Bingotouch,Link,Dcloud,Apicloud,Appcan等).
 * @site: http://www.easybui.com/ 
 * Copyright © 2017-2020 BUI. All Rights Reserved. 
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e;function t(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}window.libs=window.Zepto||window.jQuery||{},window.bui={},window.router={},(e=window.bui).debug=!0,e.hasRouter=!1,e.nativeRouter=!1,e.isWebapp,e.currentPlatform="",e.log=!0,e.trace=!1,e.native={},e.config={},e.config.namespace="bui",e.config.classNamePrefix=e.config.namespace+"-",e.config.version="1.6.3",e.config.versionCode=20201102,e.version=e.config.version,e.versionCode=e.config.versionCode,e.config.viewport={zoom:!0,create:!0},e.config.init={auto:!0},e.config.ready={},e.config.ajax={},e.config.get={},e.config.put={},e.config.delete={},e.config.post={},e.config.back={},e.config.load={},e.config.getPageParams={},e.config.refresh={},e.config.run={},e.config.checkVersion={},e.config.component={auto:!0},e.config.dialog={},e.config.confirm={},e.config.alert={},e.config.hint={},e.config.prompt={},e.config.loading={},e.config.mask={},e.config.list={},e.config.listview={},e.config.scroll={},e.config.pullrefresh={},e.config.select={},e.config.sidebar={},e.config.slide={},e.config.actionsheet={},e.config.dropdown={},e.config.accordion={},e.config.stepbar={},e.config.rating={},e.config.number={},e.config.file={},e.config.fileselect={},e.config.upload={},e.config.download={},e.config.swipe={},e.config.router={},e.config.loader={},e.config.loader.define={},e.config.loader.load={},e.config.loader.component={},e.config.store={},e.config.floor={},function(e,t){e.prefix=function(t){return e.config.classNamePrefix+t},e.showLog=function(t,n){n=n||"";var i="";"object"==typeof t&&"message"in t&&"name"in t?i=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(i=t),e.log&&console.error(n+" "+i),e.trace&&console.trace&&console.trace(),e.trigger("catcherror",t,n)},e.guid=function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(e=void 0===e?"bui":e||"")+t().substr(e.length)+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e.swipeDirection=function(e,t,n,i){var o=t-e,a=i-n,r=Math.abs(o),l=Math.abs(a);return!(r<9&&l<9)&&(r/l>3?o>0?"swiperight":"swipeleft":a>0?"swipedown":"swipeup")},e.obj=function(n,i){var o=null;i=i||null;var a=e.hasRouter&&router.currentPage()||"html",r=t(a=i||a),l="string"==typeof n;if("object"==typeof n)return o=t(n);if(l&&/^(\d)/.test(n))return o=r.find("[id='"+n+"']");if(l&&/^[a-zA-z]/.test(n)){var c=/^(html|head|body|header|main|footer|ul|li|section|dt|dd|div|span|img|article|i|strong|input|textarea|select|h1|h2|h3|h4|h5|h6|p|view|component|components|iframe)$/gi.test(n)||/^\[.+\]$/.test(n)||n.indexOf("[")>-1?n:"#"+n;return o=r.find(c)}return/^#\d/.test(n)?o=r.find("[id='"+n.substr(1)+"']"):/^\.\d/.test(n)?o=r.find("[class='"+n.substr(1)+"']"):n&&(o=r.find(n)),o},e.$=e.obj,e.objId=function(t){return e.obj(t,"html")},e.selector=function(e){return void 0===e?this:t(e,this)},e.widget=function(e){return e&&e in this?this[e]:this},e.option=function(n,i){if("object"!==e.typeof(n)&&void 0===i)return"string"==typeof n?this.config[n]:this.config;if("id"==n)return e.showLog("不允许修改控件的ID参数"),this;if(n&&"object"===e.typeof(n)){var o=t.extend(this.config,n);return this.init(o)}if(this.config.hasOwnProperty(n)){var a={};a[n]=i;o=t.extend(this.config,a);return this.init(o)}return this}}(window.bui||{},window.libs),function(e,t){e.emitter=function(){function t(){this.handle=Object.create(null)}return t.prototype.on=function(t,n,i){return"function"==typeof n?(i=n,n=this):(i=i,n=n||this),n.handle=n.handle||{},e.unit.stringToArray(t).forEach((function(e,t){void 0===n.handle[e]&&(n.handle[e]=[]),n.handle[e].push(i)})),n},t.prototype.off=function(t,n,i){"function"==typeof n?(i=n,n=this):"function"==typeof i?(i=i,n=n||this):n=this;var o=e.typeof(t);if(void 0===t)n.handle=Object.create(null);else if("string"===o&&"function"==typeof i){var a=n.handle[t]||[];e.array.remove(a,i)}else if("string"===o||"array"===o){"object"!=typeof n.handle&&(n.handle={}),e.unit.stringToArray(t).forEach((function(e,t){n.handle[e]=[]}))}return n},t.prototype.one=function(e,t){var n=this;return this.on(e,(function i(){t&&t.apply(n,arguments),n.off(e,i)})),this},t.prototype.wait=function(t,n){var i=this,o=e.unit.stringToArray(t),a=[],r=!0;return o.forEach((function(t,l){i.on(t,(function(t){a[l]=t,a.length===o.length&&r&&(o.forEach((function(t,n){a[n]=e.history.getLast().component[t]||{}})),n&&n.apply(i,a),r=!1)}))})),this},t.prototype.waited=function(t,n){var i=this,o=e.unit.stringToArray(t),a=[],r=!0;return o.forEach((function(t,l){i.on(t,(function(t){a[l]=t.exports||t,a.length===o.length&&r&&(o.forEach((function(t,n){var i=e.history.getLast().component[t];a[n]=i?i.exports:{}})),n&&n.apply(i,a),r=!1)}))})),this},t.prototype.trigger=function(e){try{if(this.handle[arguments[0]]instanceof Array){var t=this.handle[arguments[0]],n=[].slice.apply(arguments);n.shift();for(var i=0,o=t.length;i<o;i++)t[i]&&t[i].apply(this.self||this,n)}}catch(e){}return this},t.prototype.notify=function(){try{for(var e in this.handle)if(this.handle[e]instanceof Array)for(var t=this.handle[e],n=0,i=t.length;n<i;n++)t[n]&&t[n].apply(this.self||this)}catch(e){}return this},function(e){return new t}}();var n=e.emitter();e.on=n.on,e.off=n.off,e.trigger=n.trigger,e.one=n.one}(window.bui||{}),function(e,t){e.store=function(n){var i={el:null,scope:"",data:null,extends:null,mixins:[],beforeMounts:[],beforeCompiles:[],compileds:[],beforeUpdates:[],mounteds:[],updateds:[],beforeDestroys:[],destroyeds:[],computed:null,methods:null,watch:null,templates:null,beforeMount:null,mounted:null,beforeCompile:null,compiled:null,beforeUpdate:null,updated:null,beforeDestroy:null,destroyed:null,isPublic:!1,modelEvent:"input",scopeSplit:".",delayInput:200,needStatic:!1,needView:!0,needComponent:!1,needCompile:!0,needNative:!1,deep:!0,log:!1,autoinit:!0},o=null;function a(n){var o=null,a=n&&n.extends?[n.extends]:[];e.array.merge(i.mixins,a,n.mixins||[],[n]);var r=t.extend(!0,{},i,e.config.store);return function e(n){var a=0;for(a=0;a<n.length;a++){var l=n[a];l.beforeMount&&i.beforeMounts.push(l.beforeMount),l.beforeCompile&&i.beforeCompiles.push(l.beforeCompile),l.beforeUpdate&&i.beforeUpdates.push(l.beforeUpdate),l.updated&&i.updateds.push(l.updated),l.compiled&&i.compileds.push(l.compiled),l.mounted&&i.mounteds.push(l.mounted),l.beforeDestroy&&i.beforeDestroys.push(l.beforeDestroy),l.destroyed&&i.destroyeds.push(l.destroyed),o=t.extend(!0,r,l),l.mixins&&l.mixins.length&&a<n.length-1&&e(l.mixins)}}(i.mixins),o=t.extend(!0,i,o)}var r,l="function"==typeof(o=a(n)).data?o.data.call(M):o.data,c=o.scope||e.guid(),s=o.computed,u=o.scopeSplit,d=o.methods,f=o.templates,h=o.watch||i.watch,p=(o.delayInput,o.isPublic),g=o.modelEvent,m=o.needStatic,v="",b=!1,y=!0,w={},x={},k={},I=!1,T={},O=e.emitter(),C={target:null};o.el?o.el=o.el:o.el=p?"body":".bui-page",r=o.el,v=0==r.indexOf(".")||0==r.indexOf("#")?r.substr(1):r;var S=null,L=null,j=null,P=null,E=[],N=!0,$=l,F=void 0===o.log?i.log:o.log,B=/b-text|b-html|b-value|b-show|b-hide|b-checked|b-src|b-href|b-bind|b-style|b-class|b-model|b-id|b-data|b-title|b-visible/gim,R={"b-text":function(t){var n="b-text",i=ee.call(this,t,n),o=G.call(this,n),a="",r=e.typeof(t.value),l=i.attr(n),c=re.call(this,n),s=(c[0].keyname,c[0].param);switch(r){case"array":a=te(t,l);break;case"function":a=t.value.apply(M,s);break;default:a=t.value}a=o?!a:a,i.text(a),E=[]},"b-html":function(t){var n="b-html",i=ee.call(this,t,n),o=G.call(this,n),a="",r=e.typeof(t.value),l=i.attr(n),c=re.call(this,n),s=(c[0].keyname,c[0].param);switch(r){case"array":a=te(t,l);break;case"function":a=t.value.apply(M,s);break;default:a=t.value}a=o?!a:a,i.html(a),E=[]},"b-value":function(e){var t=ee.call(this,e,"b-value");p?t.each((function(t,n){ne.call(this,e)})):ne.call(t[0],e);E=[]},"b-show":function(e){var t=ee.call(this,e,"b-show");void 0!==e.value&&1==Boolean(e.value)?this.removeAttribute("style"):void 0!==e.value&&0==Boolean(e.value)&&t.css("display","none");E=[]},"b-visible":function(e){var t=ee.call(this,e,"b-visible");void 0!==e.value&&1==Boolean(e.value)?this.removeAttribute("style"):void 0!==e.value&&0==Boolean(e.value)&&t.css("visibility","hidden");E=[]},"b-hide":function(e){var n="!"+c+u+e.keyname,i=p?t(`[b-show="${n}"]`):S(this);void 0!==e.value&&1==Boolean(e.value)?i.css("display","none"):void 0!==e.value&&0==Boolean(e.value)&&i.removeAttr("style")},"b-checked":function(e){this.checked=!!e.value,E=[]},"b-bind":function(e){var t=ee.call(this,e,"b-bind"),n=this,i=e.keyname,o=e.value;if("object"==typeof o)for(let a in o)pe(i+"."+a,(function(t){oe(ee.call(n,e,"b-bind"),a,t.value)})),oe(t,a,o[a]);else{var a="string"==typeof i&&i.split("."),r=a[a.length-1];oe(t,r,o)}},"b-src":function(e){ee.call(this,e,"b-src").attr("src",e.value),E=[]},"b-title":function(e){ee.call(this,e,"b-title").attr("title",e.value),E=[]},"b-data":function(e){ee.call(this,e,"b-data").attr("data",e.value),E=[]},"b-id":function(e){ee.call(this,e,"b-id").attr("id",e.value),E=[]},"b-href":function(e){ee.call(this,e,"b-href").attr("href",e.value),E=[]},"b-class":function(n){var i=ee.call(this,n,"b-class"),o=this;this.classList;if("object"==typeof n.value)if("array"===e.typeof(n.value)){n.value.length||i.attr("class",""),n.value.forEach((function(e,t){!i.hasClass(e)&&i.addClass(e)}));var a=n.keyname.indeOf(".$index");a>-1?pe(n.keyname.substr(0,a)+"."+t(i).index(),(function(e){var t=ee.call(o,n,"b-class");ae(t,e.value[t.index()],e.value)})):pe(n.keyname,(function(e){var t=ee.call(o,n,"b-class");ae(t,e.value[t.index()],e.value)}))}else for(let e in n.value){let t=n.value[e],a=n.preValue&&n.preValue[e]||"";pe(n.keyname+"."+e,(function(t){ae(ee.call(o,n,"b-class"),e,t.value)})),ae(i,e,t,a)}else if("function"==typeof n.value){var r=re.call(this,"b-class"),l=r[0].keyname,c=r[0].param,s=n.value.apply(M,c);ae(i,l,s,n.preValue)}else{var u="string"==typeof n.keyname&&n.keyname.split("."),d=u[u.length-1];ae(i,d,n.value,n.preValue)}E=[]},"b-model":function(e){var t=ee.call(this,e,"b-model");p?t.each((function(t,n){ie.call(this,e)})):ie.call(t[0],e)},"b-style":function(e){var t=ee.call(this,e,"b-style"),n=this;if("object"==typeof e.value)for(let i in e.value)pe(e.keyname+"."+i,(function(t){ee.call(n,e,"b-style").css(i,t.value)})),t.css(e.value);else t.css(e.keyname,e.value);E=[]}},D={"b-text":[],"b-html":[],"b-value":[],"b-show":[],"b-hide":[],"b-checked":[],"b-bind":[],"b-src":[],"b-title":[],"b-data":[],"b-id":[],"b-href":[],"b-class":[],"b-model":[],"b-style":[]},A={},M=(t.extend(!0,{},l,d,h,s,f),{$methods:d,$refs:T,mixin:a,$options:o,$templates:f,config:o,watch:V,nextTick:function(t){return pe("nexttick",(function(n){try{t&&t.call(M,n)}catch(n){e.showLog(n)}})),this},oneTick:function(t,n){var i="nexttick-"+t;if(k.hasOwnProperty(i))return this;return k[i]=n,pe("nexttick",(function(n){if(n.keyname===t)try{x[t].pop(),0==x[t].length&&k[i]&&k[i].call(M,n)}catch(n){e.showLog(n)}})),this},get:function(t){if(void 0===t)return $=$;if("string"==typeof t){var n=e.unit.getKeyValue(t,$);return E=[],n}return $},set:de,delete:fe,del:fe,observer:ce,compile:q,$mount:q,compileHtml:_,clearKey:function(){return E=[],b=!1,y=!0,I=!1,this},destroy:function(){return E=[],o.beforeDestroys.forEach((function(e,t){e.call(M)})),b=!1,y=!0,I=!1,ge(),o.beforeMounts=[],o.beforeCompiles=[],o.compileds=[],o.mounteds=[],o.beforeUpdates=[],o.updateds=[],o.destroyeds.forEach((function(e,t){e.call(M)})),this},init:H,connect:function(t,n,i){if("object"!=typeof t||!t.hasOwnProperty("$refs"))return M;var o=this;if("string"==typeof n){ue(t,n);var a=e.unit.getKeyValue(n,o.$data);"object"===e.typeof(a)?c(n,a,i||n):l(i||n,a,n)}else{var r=Object.keys($);let n=0;for(;n<r.length;n++){let i=r[n];if(e.array.compare(se,i,"field"))break;ue(t,i);if(t.$data.hasOwnProperty(i)){t.$data[i];let n=o.$data[i];"object"===e.typeof(n)?c(i,n):l(i,n)}}}function l(n,i,o){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i);let a=V(o||n,(function(i){"array"===e.typeof(i)?t[n].$replace(i):t.set(n,i)})),r=e.array.index(se,n,"field");(r<0||se[r]&&t.$options.el!==se[r].el)&&se.push({field:o||n,el:t.$options.el,disconnect:a})}function c(n,a,r){let l=Object.keys(a);for(let a=0;a<l.length;a++){let r=l[a],s=n+"."+r,u=void 0===i,d=u||""==i?r:i+"."+r,f=(ue(t,s),e.unit.getKeyValue(s,o.$data));u?t.set(s,f):t.set(d,f);let h=V(s,(function(e){void 0!==i?t.set(d,e):t.set(s,e)}));var c=e.array.index(se,s,"field");(c<0||se[c]&&t.$options.el!==se[c].el)&&se.push({field:s,el:t.$options.el,disconnect:h})}t.trigger.call(t,r||n,{action:"set",target:null,value:$[n],preValue:null,action:"set",keyname:n,origin:$})}return M},disconnect:function(t){if("string"==typeof t){var n=e.array.get(se,t,"field");n&&n.disconnect()}else se.forEach((function(e,t){e.disconnect()}));return M},on:pe,off:ge,one:function(e,t){if(k.hasOwnProperty(e))return this;return pe(e,t),k[e]=t,this},trigger:me,emitter:O});try{o.autoinit&&H()}catch(t){e.showLog(t)}function H(){var n=(S=e.hasRouter?router.$:t)(o.el);L="object"==typeof o.el?t(o.el):n.length?n:t(o.el),j=L&&L.parent(),P=L&&L.children(),M.$el=L,M.$parent=j,M.$children=P,M.$data=l;for(let e in d)d[e]=d[e].bind(M);return M.$methods=d,d&&function(){try{Object.keys(d).forEach((t=>{l.hasOwnProperty(t)?e.showLog("不能跟data的键值相同:"+t):Object.defineProperty(M,t,{get:function(){return d[t].bind(this)},set:function(){}})}))}catch(t){e.showLog(t)}}(),f&&function(){try{Object.keys(f).forEach((t=>{l.hasOwnProperty(t)?e.showLog("不能跟data的键值相同:"+t):Object.defineProperty(M,t,{get:function(){return f[t].bind(this)},set:function(){}})}))}catch(t){e.showLog(t)}}(),me.call(M,"beforemount"),o.beforeMounts.forEach((function(e,t){e.call(M)})),ce(l),function(){for(let e in l)Object.defineProperty(M,e,{configurable:!0,get(){F&&console.log("1. module getting "+e,E),!b&&y?(b=!0,y=!1,E=[]):(b=!1,y=!1);let t=l[e];return Array.isArray(t)&&C.target&&(w[e]=[],w[e].push(C.target)),t},set(t){F&&console.log("2. module setting "+e,E),E=[],l[e]=t,$[e]=t}})}(),h&&function(t){try{z(t)}catch(t){e.showLog(t)}}(h),s&&function(){try{Object.keys(s).forEach((t=>{if(l.hasOwnProperty(t))e.showLog("不能跟data的键值相同:"+t);else{var n=s[t];Object.defineProperty(M,t,{get:function(){var e,i="function"==typeof n?n.bind(this):n.get.bind(this);return C.target&&(w[t]=[],w[t].push(C.target)),C.target=function(){var e=i();w[t]&&w[t].forEach((e=>e())),me(t,{target:null,value:e,action:"set",keyname:t,param:[],origin:$}),C.target=null,E=[]},e=i(),C.target=null,E=[],e},set:n&&"object"===e.typeof(n)&&n.set||function(){}})}}))}catch(t){e.showLog(t)}}(),p?o.needCompile&&router&&router.on("complete",(function(e){o.needCompile&&q(),N&&o.mounteds.forEach((function(t,n){t.call(M,e)})),$=t.extend(!0,{},l),b=!1,y=!0,me.call(M,"mounted",e),N=!1,E=[]})):(N||ge(),m&&function(){let e=L.html();e=_(e),L.html(e)}(),o.needView?function(e){loader.views({id:e.id,loaded:function(e){q(e.el)},compiled:e.compiled})}({id:L,compiled:function(){o.needCompile&&q(),o.mounteds.forEach((function(e,t){e.call(M)}))}}):(o.needCompile&&q(),o.mounteds.forEach((function(e,t){e.call(M)}))),$=t.extend(!0,{},l),b=!1,y=!0,E=[],me.call(M,"mounted"),N=!1),this}function z(t,n,i){t=t||h;try{let o=Object.keys(t),a=[];o.forEach((function(o,r){let c=i||("object"==typeof t[o]?t[o].handler:t[o]);a.push(o),n&&a.unshift(n);let s=a.join("."),u=t[o];if("object"===e.typeof(u)){let n=u.deep?Object.keys(l[o]):Object.keys(t[o]),i=e.unit.getKeyValue(o,l);n.forEach((function(t,n){let o=s+"."+t,r=i[t];"object"===e.typeof(r)&&z(r,o,c),V(o,c),a=[]})),u.immediate&&u.handler&&u.handler.call(M,l[o],$[o])}V(s,c),a=[]}))}catch(t){e.showLog(t)}}function V(t,n){var i=function(t){try{var i=[t.value,t.preValue||"",t];if("init"!==t.action){var o=n;switch(e.typeof(o)){case"function":o.apply(M,i);break;case"array":o.forEach((function(e,t){e.apply(M,i)}));break;case"string":new Function(o+`(${t.value},${t.preValue||""})`)();break;default:o.apply(M,i)}}}catch(t){e.showLog(t)}};return pe(t,i),ge.bind(this,t,i)}function q(n){try{var i=null,a=null;void 0===n?(i=L,a=o):"string"==typeof n?(i=S(n),a=o):n&&"object"==typeof n&&(i=S(n)||t(n),a=t.extend(!0,{},o,n));var r=!0;if(a.beforeCompiles.forEach((function(e,t){if(!1===(r=e.call(M,a)))return!1})),!1===r)return E=[],!1;if(function(t){var n=t.find(`[b-template*=${c}]`),i=[];if(x={},n.length)try{n.each((function(t,n){var o=S(this),a=re.call(this,"b-template"),r=a[0].keyname,l=a[0].param,s=c+u;l[0]||console.error('b-template 没有找到数据源, 格式为: b-template="page.template(page.sources)"');var d="string"==typeof l[0]&&l[0].replace(new RegExp(s),"")||"",h=o.attr("b-command")||"html",g=o.attr("b-children")||o.children()[0]&&o.children()[0].tagName;W(d,M);p&&ge(d),x.hasOwnProperty(d)?x[d].push(d):x[d]=[d],pe(d,(function(t){try{var n,i=t.param;switch(t.action){case"push":case"unshift":n=i;break;case"splice":n=i.slice(2)||"";break;default:n=t.value}if(f&&f.hasOwnProperty(r)){(l=l.map((function(e,t){return"string"==typeof e&&0==e.indexOf(c+u)&&t>0?W(e.replace(new RegExp(s),""),$):e})))[0]=n;var a=void 0!==n&&"undefined"!==n&&f[r]&&f[r].apply(M,l);void 0===a&&(a="",e.showLog(r+"模板方法需要返回内容，例如：return html;")),p&&(o=S(`[b-template*="${s+d}"]`));var m=t.preValue||[];0==m.length&&"html"==h&&o.empty();var v=g?o.children(g):o.children(),b=v,y=i&&i.length||0;switch(N=!0,t.action){case"push":if(o.append(a),v=o.children(g),y&&y==v.length)Y(v);else if(y>1)for(var w=b.length,x=w;x<v.length;x++)Y(v.eq(w+x-1));else Y(v.last());break;case"unshift":if(o.prepend(a),v=o.children(g),y&&y==v.length)Y(v);else if(y>1)for(x=0;x<y;x++)Y(v.eq(x));else Y(v.first());break;case"pop":v.last().remove(),Y((v=o.children(g)).last());break;case"shift":v.first().remove(),Y((v=o.children(g)).first());break;case"length":break;case"splice":var k=parseInt(i[0]),I=parseInt(i[1]);I>=m.length&&(o.empty(),v=o.children(g));var T=v.length,O=T>0;if(0==I)if(O&&T-1>=k){v.eq(k).before(a),v=o.children(g);for(x=0;x<n.length;x++)Y(v.eq(k+x))}else{o.append(a),v=o.children(g);for(x=0;x<n.length;x++)Y(v.eq(T+x))}else if(I>0){if(void 0!==i[2])if(O&&T-1>=k){v.eq(k).before(a),v=o.children(g);for(x=0;x<n.length;x++)Y(v.eq(k+x))}else{o.append(a),v=o.children(g);for(x=0;x<n.length;x++)Y(v.eq(T+x))}let e=0;switch(h){case"append":e=v.length-t.preValue.length||0;break;case"prepend":case"html":default:e=0}for(x=0;x<I;x++)v.eq(k+n.length+x+e).remove();a&&!t.value.length&&o.html(a)}break;case"reverse":case"sort":o.html(a),Y(o);break;default:o[h](a),Y(o)}me.call(M,"nexttick",t)}else e.showLog(`找不到对应的模板,请检查下 scope:${c} 的templates是否存在${r}`,"bui.store")}catch(t){e.showLog(t)}})),e.array.compare(i,d)||i.push(d),E=[]})),K(i)}catch(t){e.showLog(t)}}(i),Y(i),a.needComponent)return loader.components({id:i,compiled:function(){J(i),Z(i),X(i),!0,U(),E=[],a.compileds.forEach((function(e,t){e.call(M,a)}))}}),this;J(i),Z(i),X(i),!0,U(),E=[],a.compileds.forEach((function(e,t){e.call(M,a)}))}catch(t){e.showLog(t)}return this}function U(){return L.find("[ref]").each((function(){let t=this.getAttribute("ref"),n=T.hasOwnProperty(t),i=null;n&&"htmldivelement"===e.typeof(T[t])?(i=[T[t]],i.push(this),T[t]=i):n&&"array"===e.typeof(T[t])?T[t].push(this):T[t]=this})),this}function _(n){try{var i=this,o="string"==typeof n?n:"",a=new RegExp("{{[\\s]?"+c+u+"(.*?)}}","mg");return o=o.replace(a,(function(n,o){var a=o.split(c+u);""===t.trim(a[0])&&a.shift();var r=a.length>0&&e.unit.getKeyValue(a.join("."),$)||"";return"function"==typeof r?r.call(i):r}))}catch(t){e.showLog(t)}}function W(t,n){let i;if(A&&A.hasOwnProperty(t))i=A[t];else{if(i=e.unit.getKeyValue(t,n),void 0===i)return void(F&&console.warn(`请检查 ${t} 在bui.store scope:${c} 中有没有声明定义`));A[t]=i}return i}function Y(t){try{var n=t,i=[],o=(n[0]&&n[0].outerHTML||n.html()||"").match(B)||[],a=e.array.uniq(o);a.length&&a.forEach((function(t,o){var a=n.find(`[${t}*=${c}]`);a.length<1&&(a=n.closest(`[${t}*=${c}]`)),a.length&&a.each((function(n,o){var a="",r=re.call(this,""+t),l=r[0]&&r[0].keyname||"",c=l.indexOf(".length"),s=c>-1?l.substr(0,c):l,u=r[0]&&r[0].param;W(s,M);var d=re.call(this,"b-linked");if(d.length&&d.forEach((function(t,n){pe(t.keyname,(function(t){me(l,{target:null,value:e.unit.getKeyValue(l,M),action:"set",keyname:l,param:u,origin:$})}))})),"b-show"===t)switch(r[0]&&r[0].rule){case"!":a="b-hide";break;default:a="b-show"}else a=t;if(p){var f=e.array.compare(D[a],s);!f&&D[a].push(s),!f&&pe(s,R[a].bind(this))}else!N&&0===n&&ge(s),pe(s,R[a].bind(this));e.array.compare(i,s)||i.push(s),E=[],b=!1,y=!0}))})),K(i)}catch(t){e.showLog(t)}}function K(e){e.forEach((function(e,t){me(e,{target:null,action:"init",value:A[e],param:null,keyname:e,origin:$}),E=[]}))}function J(n){var i=n,a=`[type="text"][b-model*=${c}],\n                                [type="search"][b-model*=${c}],\n                                [type="password"][b-model*=${c}],\n                                [type="url"][b-model*=${c}],\n                                [type="number"][b-model*=${c}],\n                                [type="email"][b-model*=${c}],\n                                [type="range"][b-model*=${c}],\n                                [type="tel"][b-model*=${c}],\n                                textarea[b-model*=${c}]`;if("input"===o.modelEvent){var r=!1;i.off("input compositionstart compositionend",a).on(g,a,(function(e){r||l.call(e.target,e)})).on("compositionstart",a,(function(e){r=!0,e.stopPropagation()})).on("compositionend",a,(function(e){r=!1,l.call(e.target,e),e.stopPropagation()}))}else i.off(g,a).on(g,a,l);function l(t){var n=t.target.value,i=re.call(this,"b-model"),o=i[0]&&i[0].keyname||"";if(""===o)return e.showLog("b-model的值不能为空"),!1;de(o,n),E=[],t.stopPropagation()}var s=`[type="checkbox"][b-model*=${c}],\n                                [type="radio"][b-model*=${c}]`;i.off("change",s).on("change",s,(function(t){try{var n,o=this,a=this.getAttribute("value")||this.checked,r=this.getAttribute("type"),l=re.call(this,"b-model")[0].keyname,s=this.getAttribute("check-value"),u=this.getAttribute("uncheck-value"),d=this.getAttribute("check"),f=this.getAttribute("uncheck");(d||f||s||u)&&(a=this.checked?s||this.value||d:u||f||""),n=W(l,M);var h=/\{.+\}$/g.test(a)?null:i.find(`[type="checkbox"][b-model="${c+"."+l}"][value="${a}"],\n                [type="radio"][b-model="${c+"."+l}"][value="${a}"]`);switch(r){case"checkbox":this.checked&&(n&&"array"===e.typeof(n)?!e.array.compare(n,a)&&e.unit.getKeyValue(l,M).push(a):de(l,a),this.checked=!0),this.checked||(n&&"array"===e.typeof(n)?e.array.remove(e.unit.getKeyValue(l,M),a):de(l,a),this.checked=!1),h&&h.each((function(e,t){this.checked=o.checked}));break;case"radio":default:de(l,a)}E=[],t.stopPropagation()}catch(t){e.showLog(t)}}));var u=`select[b-model*=${c}]`;i.off("change",u).on("change",u,(function(n){try{var i=t(this).val(),o=(this.selectedIndex,this.multiple),a=re.call(this,"b-model")[0].keyname,r=null;switch(r=W(a,M),o){case!0:"array"!==e.typeof(r)&&e.showLog(a+"的类型必须为数组"),i.splice(0,0,0,i.length+1),r.splice.apply(r,i);break;default:de(a,i)}E=[],n.stopPropagation()}catch(n){e.showLog(n)}}))}function X(e){e.off("change",`[b-checked*=${c}]`).on("change",`[b-checked*=${c}]`,(function(e){var t=this.checked;de(re.call(this,"b-checked")[0].keyname,t),E=[],e.stopPropagation()}))}function Z(e){var t=e;t.off("click.bui",`[b-click*=${c}]`).on("click.bui",`[b-click*=${c}]`,(function(e){var t=Q.call(this,e,"b-click");if(!1===t)return!1;void 0===t&&e.stopPropagation()})),t.off("touchstart",`[b-touchstart*=${c}]`).on("touchstart",`[b-touchstart*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-touchstart"))return!1})),t.off("touchmove",`[b-touchmove*=${c}]`).on("touchmove",`[b-touchmove*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-touchmove"))return!1})),t.off("touchend",`[b-touchend*=${c}]`).on("touchend",`[b-touchend*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-touchend"))return!1})),t.off("scroll",`[b-scroll*=${c}]`).on("scroll",`[b-scroll*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-scroll"))return!1})),t.off("focus",`[b-focus*=${c}]`).on("focus",`[b-focus*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-focus"))return!1})),t.off("change",`[b-change*=${c}]`).on("change",`[b-change*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-change"))return!1})),t.off("blur",`[b-blur*=${c}]`).on("blur",`[b-blur*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-blur"))return!1})),t.off("submit",`[b-submit*=${c}]`).on("submit",`[b-submit*=${c}]`,(function(e){if(!1===Q.call(this,e,"b-submit"))return!1}))}function Q(t,n){var i=re.call(this,n),o=i[0].keyname,a=i[0].param,r=null;a.push(t);try{var l="function"==typeof(r=W(o,M))&&r.apply(M,a);return E=[],me(o,{target:this,value:r,action:"set",keyname:o,param:a,origin:$}),l}catch(t){e.showLog(t)}}function G(e){return 0==this.getAttribute(e).indexOf("!")}function ee(e,n){var i=c+u+e.keyname;return p?t(`[${n}="${i}"]`):S(this)}function te(e,t){return t.indexOf(".length")>-1?e.value.length||0:e.value instanceof Array?e.value.join(","):e.value}function ne(t){var n=this.getAttribute("type"),i=this.value,o=this,a=this.getAttribute("b-value");switch(n){case"radio":i==t.value?this.checked=!0:this.checked=!1;break;case"checkbox":"array"===e.typeof(t.value)&&t.value.forEach((function(e,t){i==e&&(o.checked=!0)}));break;default:this.value=te(t,a)}}function ie(e){var n=this.getAttribute("type"),i=this.value,o=(e.param,this);if("SELECT"===this.nodeName&&this.multiple)e.value.length>1?e.value.forEach((function(e,n){"string"==typeof e?t(o).find(`option[value=${e}]`).attr("selected",!0):t(o).find(`option[value=${e.value}]`).attr("selected",!0)})):this.value=e.value[0];else{switch(n){case"radio":i==e.value?this.checked=!0:this.checked=!1;break;case"checkbox":if(i&&e.value instanceof Array)switch(e.action){case"push":case"unshift":e.param.filter((function(e,t){i!==e||(o.checked=!0)}));break;case"pop":case"shift":e.param.filter((function(e,t){i===e&&(o.checked=!1)}));break;case"splice":var a=e.param,r=parseInt(a[1]),l=a.slice(2);0==r?l.forEach((function(e,t){i===e&&(o.checked=!0)})):r>0&&(e.preValue.forEach((function(t,n){n<=e.param[1]&&(o.checked=!1)})),e.value.forEach((function(e,t){i===e&&(o.checked=!0)})));break;case"length":break;default:e.value.filter((function(e,t){i==e&&(o.checked=!0)}))}else e.value===i||1==e.value?this.checked=!0:this.checked=!1;break;default:if(event&&event.target&&"INPUT"===event.target.nodeName)break;this.value=e.value}E=[]}}function oe(e,t,n){switch(t){case"disabled":n?e.attr(t,n):e.removeAttr(t);break;case"checked":e.prop(t,n);break;default:var i="object"==typeof n?JSON.stringify(n):n;e.attr(t,i)}E=[]}function ae(e,t,n,i){"boolean"==typeof n?(n&&e.addClass(t),!n&&e.removeClass(t)):"string"==typeof n?(p&&e.removeClass(n),i&&e.removeClass(i),n&&!e.hasClass(n)&&e.addClass(n),void 0!==i&&""===n&&e.removeClass(i)):(Boolean(n)&&e.addClass(t),!Boolean(n)&&e.removeClass(t))}function re(t){var n=[],i=this,o=this.getAttribute(t)||"",a=o.indexOf("&")>-1?o.split("&"):o&&[o]||[];try{a.forEach((function(e,o){var a={},r=le.call(i,e,t);a.scope=c,a.rule=r.rule,a.keyname=r.name,a.param=r.param,a.eventType=r.eventType,a.eventProperty=r.eventProperty,n.push(a)}))}catch(t){e.showLog("参数处理出错")}return n}function le(n,i){try{var o=n?n.match(/([^\(|\)]+)/g):[],a="",r="",l=null,s=[],d=null,f=this,h="",p=t(f).attr("b-target"),g=p&&t(f).parents(p)[0]||f,m="",v="";if(h=(h=(l=o[0]&&o[0].indexOf(c+u)>-1?o[0].split(c+u):[c,o[0]])[0].split(c))[0]||h[1]||"",a=c,(r=l[1]||"").indexOf("$index")>-1){let e=t(g).index();r=r.replace("$index",e)}else if(r.indexOf("$id")>-1){let e=g.id;r=r.replace("$id",e)}else if(r.indexOf("$parentIndex")>-1){let e=t(g).parent().index();r=r.replace("$parentIndex",e)}if(void 0!==o[1]){let n=o[1]||"";try{var b=/\{.+\}$/g,y=/\[.+\]$/g;let o=/(\'(.*?)\'.*?)|(\"(.*?)\".*?)|(\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14})|(^((https|http|ftp|rtsp|mms)?:\/\/)[^\,]+)|([a-zA-Z0-9][-a-zA-Z0-9\._]{0,62})|(\{.+\})|(\[.+])|([$\w\.]+)|([\d\.]+)|([\u4e00-\u9fa5|\w|\d]+)/g;s=(n?n.match(o):[]).map((function(n,o){var a=n.replace(/^\"|^\'|\"$|\'$/g,""),r=t(g).attr("b-target"),l=r&&t(g).parents(r)[0]||g;switch(n){case"$this":a=l;break;case"$index":a=t(l).index();break;case"$parentIndex":a=t(l).parent().index();break;case"$parent":a=l.parentNode;break;case"$children":a=t(l).children();break;case"$id":a=l.id;break;case"$text":a=l.textContent;break;case"$value":a=l.value;break;case"$html":a=l.innerHTML}if("b-template"!==i){var s=c+u;e.unit.startWithStr(a,s)&&(a=e.unit.getKeyValue(a.split(s)[1],M))}return b.test(n)||y.test(n)?JSON.parse(n):a}))}catch(t){e.showLog(t,"getArguments"),s=[]}}void 0!==o[2]&&(m=(d=o[2].indexOf(".")>-1?o[2].split("."):[o[2]])[0],v=d[1]||"")}catch(t){e.showLog("参数格式错误:"+n)}return{scope:a,rule:h,name:r,param:s,eventType:m,eventProperty:v}}function ce(t,n){if(!t.hasOwnProperty("widget")||"function"!=typeof t.widget)return function(t,n){if(n&&"array"===e.typeof(n)){if(n.length>1){var i=n.pop();a(e.unit.getKeyValue(n.join("."),t),i)}else a(t,n[0]);return}function a(t,n){let i=t[n];if(i instanceof Array?function(t,n){var i=[],a=Array.prototype;let r=Object.create(a);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var s=a[t];Object.defineProperty(r,t,{enumerable:!0,configurable:!0,value:function(a){let r=[...arguments];me.call(M,"beforeupdate",{target:null,action:t,param:r,value:this,prevValue:[],keyname:n,origin:$}),i.push(n),l.hasOwnProperty(n)||i.unshift(E.join("."));var u=i.join("."),d=this.slice(0);let f=s.apply(this,r);switch(F&&console.log(`5. ${u} action ${t} `),t){case"pop":case"shift":r=[f]}e.unit.setKeyValue(u,this,$);var h=L.find(`[b-template*="${c}.${u}"]`);return me(u,{target:h,action:t,param:r,value:this,preValue:d,keyname:n,origin:$}),w[i[0]]&&"array"===e.typeof(w[i[0]])&&w[i[0]].forEach((e=>e())),i=[],E=[],b=!1,y=!0,me.call(M,"updated",{target:h,action:t,param:r,value:this,preValue:d,keyname:n,origin:$}),o.updateds.forEach((function(e,i){e.call(M,{target:h,action:t,param:r,value:this,preValue:d,keyname:n,origin:$})})),f}})})),r.$index=function(t,n){return e.array.index(this,t,n)},r.$include=function(t,n){return e.array.compare(this,t,n)},r.$empty=function(){return e.array.empty(this)},r.$replace=function(t){return e.array.replace(this,t)},r.$merge=function(){return e.array.merge(this,...arguments)},r.$get=function(t,n){return e.array.get(this,t,n)},r.$set=function(t,n,i){return e.array.set(this,t,n,i)},r.$delete=function(t,n){return e.array.delete(this,t,n)},r.$deleteIndex=function(t){return e.array.deleteIndex(this,t)},t.__proto__=r}(i,n):function(t,n){let i=t[n],a="function"==typeof i?i.call(M):i;var r=[];Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get(e){return F&&console.log(`3. data getting ${n}:`,a),O.target=this,(b||!b&&y)&&E.push(n),C.target&&r.push(C.target),a},set(t){if(t===a)return E=[],I=!1,b=!1,y=!0,!0;O.target===this&&(E=[]),O.target=this,(!y||!b&&y)&&E.push(n);var i=E.join(".");!I&&me.call(M,"beforeupdate",{action:"set",value:t,preValue:a,keyname:i,origin:$}),!I&&o.beforeUpdates.forEach((function(e,n){e.call(M,{action:"set",value:t,preValue:a,keyname:i,origin:$})})),F&&console.log("4. data setting "+i,t);var c=e.unit.getKeyValue(i,$);return a=t,r.forEach((e=>e())),!I&&me(i,{action:"set",value:a,preValue:c,keyname:i,origin:$}),e.unit.setKeyValue(i,a,$),a instanceof Array?ce(l,E):"object"===e.typeof(a)&&(o.deep&&ce(t),a&&Object.keys(a).forEach((function(e,t){var i=n+"."+e;E=[],me(i,{target:null,value:a[e],preValue:c&&c[e],action:"set",keyname:i,origin:$})}))),!I&&me.call(M,"updated",{action:"set",value:a,preValue:c,keyname:i,origin:$}),!I&&o.updateds.forEach((function(e,t){e.call(M,{action:"set",value:a,preValue:c,keyname:i,origin:$})})),E=[],I=!1,b=!1,y=!0,!0}})}(t,n),i&&"object"===e.typeof(i))return ce(i)}Object.keys(t).forEach((function(e){a(t,e)}))}(t,n)}var se=[];function ue(t,n){var i=e.array.index(se,n,"field");return!!(i>-1&&se[i]&&t.$options.el===se[i].el)&&(se[i].disconnect&&se[i].disconnect(),!0)}function de(n,i){var a=null;if(E=[],"string"==typeof n&&void 0!==i){F&&console.log(`set ${n} `),I=!0,me.call(M,"beforeupdate",{action:"set",target:null,value:a,preValue:r,action:"set",keyname:n,origin:$}),o.beforeUpdates.forEach((function(e,t){e.call(M,{action:"set",target:null,value:a,preValue:r,action:"set",keyname:n,origin:$})}));var r=e.unit.getKeyValue(n,$);i&&"object"===e.typeof(i)?(a=t.extend(!0,{},i),Object.keys(i).forEach((function(e,t){var o=n+"."+e;me.call(M,o,{target:null,value:i[e],preValue:r,action:"set",keyname:o,origin:$})}))):a=i,e.unit.setKeyValue(n,i,l),e.unit.setKeyValue(n,a,$),me.call(M,n,{target:null,value:a,preValue:r,action:"set",keyname:n,origin:$}),me.call(M,"updated",{action:"set",target:null,value:a,preValue:r,action:"set",keyname:n,origin:$}),o.updateds.forEach((function(e,t){e.call(M,{action:"set",target:null,value:a,preValue:r,action:"set",keyname:n,origin:$})})),"object"==typeof i&&(i instanceof Array?ce(l,n.split(u)):ce(i)),E=[]}else n&&"object"===e.typeof(n)&&($=t.extend(!0,{},$,n),he(n));return $}function fe(t,n){return function(t,n){"string"==typeof t&&(e.unit.delKey(t,$),n&&n.call(M,t))}(t,(function(e){me(t)})),$}function he(t,n){for(var i in t){var o=void 0===n?i:n+i,a=t[i];me(o,{target:null,value:a,preValue:$[i]||"undefined",action:"set",param:null,keyname:o,origin:$}),a&&"object"===e.typeof(a)&&he(a,i+".")}}function pe(t,n){var i="";return i=t&&"array"===e.typeof(t)?t.map((function(e,t){return v+"_"+c+u+e})):v+"_"+c+u+t,O.on.call(M,i,n),this}function ge(e,t){if(e){var n=v+"_"+c+u+e;O.off.call(M,n,t)}else M.handle={};return this}function me(e){var t=v+"_"+c+u+e;return F&&console.warn(t,"trigger"),arguments[0]=t,O.trigger.apply(M,arguments),b=!1,y=!0,this}return M}}(window.bui||{},window.libs),function(e,t){e.viewport=function(n,i){e.trigger.call(e,"viewportbefore");var o,a=document.querySelector("meta[name=viewport]"),r="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no",l=window.devicePixelRatio,c=document.documentElement.clientWidth,s=document.documentElement.clientHeight,u=parseInt(c)*parseInt(l),d=parseInt(s)*parseInt(l);if(c=c>s?s+24:c,a)e.config.viewport.create&&(a.content=r);else{var f=document.createElement("meta");f.name="viewport",f.content=r;var h=document.head;e.config.viewport.create&&h.appendChild(f),f=null}var p=e.array.index([240,320,360,375,384,393,412,414,435,480,512,540,768,1024,1536,2048,2732,534,854,750],document.documentElement.clientWidth);function g(t){var n=i||750,a=document.head.parentNode,r=t||(c/n*100).toFixed(2);return o=r||48,e.config.viewport.zoom&&(a.style.fontSize=o+"px"),e.trigger.call(e,"viewportinit"),this}return p>-1&&void 0===n?o=[32,42.67,48,50,51.2,52.4,54.93,55.2,58,64,68.27,60,60,60,60,60,60,60,60,60][p]:g(n),{width:function(e){return c||t("body").width()||t("#bui-router").width()||t(".bui-page").width()},height:function(e){return s||t("body").height()||t("#bui-router").height()||t(".bui-page").height()},fontSize:o,screenWidth:function(e){return u},screenHeight:function(e){return d},ratio:function(e){return l},init:g}}}(window.bui||{},window.libs),function(e,t){e.loader=function(n){var i,o=t.extend({},{cache:!0,log:!1,baseUrl:"",relativePath:"pages",needNative:!1,deepView:!1,viewTag:"view",componentTag:"component",deepComponent:!0,scriptSuffix:".js"},e.config.loader,n),r=e.emitter(),l=[],c=[],s={},u={baseUrl:"",modules:{},globals:{}},d={},f={init:function(e){return e=e||{},o=t.extend({},o,e),f.config=o,this},config:o,define:function(n,i,a){var r={moduleName:"",template:"",script:"",path:"",props:null,isComponent:!1,params:null,data:null,depend:[],beforeCreate:null,created:null,beforeLoad:null,loaded:null,hide:null,exports:null,show:null,beforeDestroy:null,destroyed:null},l={},c="";try{var s=v().name?v():function(e){var t=window.location.pathname,n=t.indexOf(".html"),i="",o="";o=n>-1?(i=t.substr(1,n))+".js":(i=t.substr(1))+".js";return{name:i,src:o}}(),f=s.name}catch(e){}var p=[];if(void 0===n)return e.showLog("define第1个参数不能为空"),this;"function"==typeof n?(a=n,c=f,i=[]):"object"===e.typeof(n)?(c=f,i=n.depend||[],a=n.loaded,l=t.extend(!0,{},r,n)):"array"===e.typeof(n)?(a=i,i=n,c=f):"function"==typeof i?(c=n,a=i,i=[]):(c=n,i=i,a=a);var g=d.hasOwnProperty(c)&&d[c].script||s.src,y=window.location.href.substr(0,window.location.href.indexOf("#")).replace("index.html","");g=g.replace(y,""),o.log&&console.log("define "+c),i.length&&(p=m(i,g));if("string"==typeof c&&"function"==typeof a){(l=n&&"object"===e.typeof(n)?t.extend(!0,{},r,d[c],e.config.loader.define,n):t.extend(!0,{},r,d[c],e.config.loader.define)).moduleName=c,l.depend=p,l.style=[],l.script=g,l.path=g.substr(0,g.lastIndexOf("/")+1),l.loaded=function(){var e=[b,d[f]&&d[f].exports,d[f],u.globals],t=[];p.length&&p.forEach((function(e,n){d[e]&&t.push(d[e].exports)}));var n=t.concat(e);return a&&a.apply(this,n)},l.isDefined=!0,h(l)}else e.showLog("define "+c+"模块的参数格式不对");return l},global:function(e){if("object"==typeof e)h({globals:e});else{if("function"!=typeof e)return h().globals;h({globals:e.call(f,u.globals)})}return f},require:b,destroy:function(n){o.log&&console.log("destroy "+n);var i="string"==typeof n?d[n]:null;if(i){i.beforeDestroy&&i.beforeDestroy.call(i);var a=t('script[name="'+n+'"]').attr("src");l=e.array.remove(l,a),t('script[name="'+n+'"]').remove(),delete u.modules[n],d=u.modules,i.destroyed&&i.destroyed.call(i)}},map:h,import:L,importCss:function(t,n){return new Promise((function(i,a){if("string"==typeof t){var r=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),l=document.createElement("link")||{};l.href=r+(o.cache?"":"?t="+(new Date).getTime()),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),n&&l.setAttribute("id",n),document.head&&document.head.appendChild(l),l=null,i(t,n)}else e.showLog(t+"的格式不正确")}))},importSync:j,importHtml:P,load:w,checkLoad:function(t){var n=!0,i=[];if(d=u.modules,"string"==typeof t){t.indexOf(",")>-1?i=t.split(","):i.push(t)}else t&&"array"===e.typeof(t)&&(i=t||[]);if(i.length)i.forEach((function(e,t){d.hasOwnProperty(e)||(n=!1),d[e]&&!1===d[e].isLoaded&&(n=!1)}));else for(var o in d)d[o]&&!1===d[o].isLoaded&&(n=!1);return n},components:I,component:k,delay:function(n){var i=t.extend(!0,{id:"",deepView:o.deepView,deepComponent:o.deepComponent,delay:!1,everytime:!1,param:null,beforeLoad:null,loaded:null,compiled:null},n),a=e.$(i.id);for(let e=0;e<a.length;e++){let n=a[e],r=n&&n.getAttribute("delay"),l=n&&n.tagName.toLowerCase();("true"===r||i.everytime)&&("true"===r&&l===o.componentTag||i.everytime?(i.isSelf=!0,i.id=n,i.everytime?n.removeAttribute("delay"):n.setAttribute("delay","false"),k(i)):"true"===r&&l===o.viewTag||i.everytime?(i.isSelf=!0,i.id=n,n.removeAttribute("delay"),S(i)):(i.isSelf=!1,l=t(n).find('[delay="true"]')[0]&&t(n).find('[delay="true"]')[0].tagName.toLowerCase(),t(n).find('[delay="true"]').removeAttr("delay"),l===o.componentTag&&k(i),l===o.viewTag&&S(i)))}return this},views:C,view:S,get:function(e){if("string"==typeof e)return u.modules[e]||null},set:p,one:function(e,t){return r.one.apply(f,arguments),this},wait:function(e,t){return r.wait.apply(f,arguments),this},waited:function(e,t){return r.waited.apply(f,arguments),this},on:function(t,n){var i=e.history.getLast("id"),o=arguments,a=e.unit.stringToArray(t);return a.forEach((function(e,t){o[0]=i+"-"+e,r.on.apply(f,o)})),this},off:function(t,n){var i=e.history.getLast("id"),o=arguments,a=e.unit.stringToArray(t);return a.forEach((function(e,t){o[0]=i+"-"+e,r.off.apply(f,o)})),this},trigger:F};function h(n){if(void 0===n)return u;if("object"==typeof n&&(n.hasOwnProperty("modules")||n.hasOwnProperty("baseUrl")||n.hasOwnProperty("globals")))u=t.extend(!0,{},u,n),d=u.modules;else if("object"==typeof n&&n.hasOwnProperty("moduleName")){var i=function(n){var i={id:"",moduleName:"",template:"",data:null,props:null,isComponent:!1,params:null,depend:[],script:"",style:[],isDefined:!1,isLoaded:!1,beforeCreate:null,created:null,beforeLoad:null,loaded:null,show:null,hide:null,beforeDestroy:null,destroyed:null,path:"",exports:{},dependExports:[]},o={};d.hasOwnProperty(n.moduleName)&&(o=t.extend(!0,{},d[n.moduleName]));var a=t.extend(!0,{},i,o,n);n.props&&(a.props=n.props);return a.params=e.history.getParams("url"),a}(n);d[n.moduleName]=i||{},u=t.extend(!0,u,{modules:d}),d=u.modules}return u}function p(t,n){if(n&&"object"===e.typeof(n)){if(n.moduleName=t,n.hasOwnProperty("loaded")&&"function"==typeof n.loaded){var i=n.loaded;n.loaded=function(){d=u.modules;var e=n.moduleName,t=d[e].depend,o=[b,d[e]&&d[e].exports,d[e],u.globals],a=[];t.length&&t.forEach((function(e,t){d[e]&&a.push(d[e].exports)}));var r=a.concat(o);return i&&i.apply(this,r)},n.script=n.moduleName+".js",n.path=n.script.substr(0,n.script.lastIndexOf("/")+1)}n.depend&&n.depend.length&&(n.depend=m(n.depend,n.script)),h(n)}return this}function g(e,t){var n=e,i=t.lastIndexOf("/"),o=t.substr(0,i);return e.indexOf("../")>-1?(e=e.replace(/\..\//g,(function(e){var t=o.lastIndexOf("/");return o=o.substr(0,t),""})),n=o?o+"/"+e:e):e.indexOf("./")>-1&&(n=o+"/"+e.replace(/\.\//g,"")),n}function m(e,t){for(var n=[],i=0;i<e.length;i++){var o=e[i],a=o.indexOf("./")>-1?g(o,t):o;if(a.indexOf(".css")>-1)a.indexOf("css!")>-1?styles.push(a.substr(4)):styles.push(a);else{var r=a.indexOf(".js");r>-1&&(a=a.substr(0,r)),n.push(a),d.hasOwnProperty(a)||h({moduleName:a})}}return n}function v(){var e,n=window.location.href,r=[],l=document.currentScript;if(n.indexOf("#")>-1?r=n.split("#"):r.push(n),i=r[0].replace("/index.html","")+"/",l)return e=l.src.replace(i,""),{name:l.getAttribute("name")||e.substr("0",e.indexOf(o.scriptSuffix)),src:e};try{a()}catch(e){var c=(c=(e.stack||e.sourceURL||e.stacktrace||"").split(/[@ ]/g).pop().replace(/(:\d+)?:\d+$/i,"")).replace(new RegExp(i,"g"),"");return{name:(l=t('script[src="'+c+'"]')[0])?l.getAttribute("name"):c.replace(o.scriptSuffix,""),src:c}}}function b(t,n){if(o.log&&console.log("require "+t),t&&"string"==typeof t){if(t.indexOf(".css")>-1)return L(t,n);if(t.indexOf(".html")>-1)return L(t,n);t=[t]}if(n&&"function"!=typeof n)return e.showLog("require第2个参数格式为function","bui.loader.require"),this;try{(function(t,n){var i=[];function a(t,n){t=t||[],d=u.modules;var r=e.array.uniq(t);r.length>1&&r.forEach((function(e,t){var n=d[e];(n&&1==n.isLoaded||n.loaded)&&r.splice(t,1)})),r.forEach((function(t,l){var c=d[t];if(d[t]&&d[t].style&&d[t]&&d[t].style.length&&N(d[t].style),e.array.compare(i,t)||i.unshift(t),c&&c.isLoaded){if(!1===(c&&c.beforeLoad&&c.beforeLoad.call(c,c.depend)))return!1;l==r.length-1&&(n&&n.apply(c),i=[])}else if(c&&c.loaded){if(s(t,l),!1===(d[t].beforeCreate&&d[t].beforeCreate.call(d[t])))return!1;d[t].created&&d[t].created.call(d[t])}else E(t,(function(){var e=d[t];if(!1===(e&&e.beforeCreate&&e.beforeCreate.call(d[t])))return!1;e&&e.style&&e.style.length&&N(e.style),e&&e.created&&e.created.call(d[t]),s(t,l)}),(function(){l==r.length-1&&(n&&n.apply(null),i=[])}));function s(e,t){var i=d[e];return i&&(i.isDefined=!0),i.id=c?c.id:"",i.props=c?c.props:{},!1!==(i&&i.beforeLoad&&i.beforeLoad.call(i,i.depend))&&(i&&i.depend&&i.depend.length?(o.log&&console.warn(i.moduleName+" depend:"),o.log&&console.log(i.depend),void a(i.depend,n)):void(t==r.length-1&&n&&n.apply(i)))}}))}a(t,(function(){if(function(e){var t=!0,n=e||[];if(d=u.modules,n.length){let e=0;for(;e<n.length;e++){let a=n[e];var i=d[a];if(i&&!1===i.isDefined)return t=!1,o.log&&console.warn("check defined false:"+i.moduleName),o.log&&console.warn("wait modules:"),o.log&&console.warn(n),t}}else for(var a in d)if(d[a]&&!1===d[a].isDefined)return t=!1,o.log&&console.warn("check defined false:"+i.moduleName),t;return t}(i)){var a=[];t.forEach((function(i,o){p(i,{params:e.history.getParams("url")}),y(i),a.push(d[i]&&d[i].exports),o===t.length-1&&n&&n.apply(f,a||[])}))}}))})(t=t.map((function(t,n){return e.unit.resolvePath(t)})),n)}catch(t){e.showLog(t,"bui.loader.require")}return this}function y(t){d=u.modules;var n="string"==typeof t?d[t]||{}:t,i=n.depend||[],a=null,r=[];n.dependExports=[];try{if(i.length)for(var l=0;l<i.length;l++){var c=i[l],s=d[c];s.isLoaded?r[l]=s.exports:r[l]=y(s)||s.exports,s.exports=r[l],n.dependExports.push(r[l]),s.isLoaded=!0}a=n.isLoaded&&!n.isComponent?n.exports:n.loaded&&n.loaded.apply(n,r),n.exports=a||d[n.moduleName]&&d[n.moduleName].exports,n.isLoaded=!0,F(n.moduleName,n,n.exports),o.log&&console.log("execute "+n.moduleName)}catch(t){e.showLog(t,"bui.loader.execute")}return a}function w(n){var i=t.extend(!0,{id:"",cacheHtml:!1,cache:!1,url:"",script:"",param:null,template:null,beforeLoad:null,loaded:null},e.config.loader.load,n);if(i.id){if(i.url){if(!1===("function"==typeof i.beforeLoad?i.beforeLoad.call(f):i.beforeLoad))return this;var o=function(e){var t=d,n={},i=e&&e.indexOf(".html");i>-1?(n.url=e,n.module=e.substr(0,i)):(n.url=t[e]&&t[e].template||e+".html",n.module=e);return n}(i.url);if(i.script){var a=i.script.indexOf(".js");o.module=i.script.substr(0,a)}var r="string"==typeof i.id&&(i.id.indexOf("#")>-1||i.id.indexOf(".")>-1)?i.id.substr(1):i.id;i.id=r,i.name=o.module,i.url=o.url,h({id:r,moduleName:o.module,props:i.param}),e.history.getLast().currentComponent=r,e.history.setComponent({id:i.id,name:i.name,url:i.url,param:i.param||null});var l=h().modules[i.name];if(l&&"function"==typeof l.template){var c=l.template.call(l)||"";return!i.cacheHtml&&e.obj(i.id).html(c),x(i),this}if(i.cacheHtml)return x(i),this;if("function"==typeof o.url){var s=o.url(i)||"";return!i.cacheHtml&&e.obj(i.id).html(s),x(i),this}return L(o.url,(function(t){!i.cacheHtml&&e.obj(i.id).html(t),x(i)}),(function(e){i.onFail&&i.onFail.call(this,o)})),this}e.showLog("url不能为空")}else e.showLog("id不能为空")}function x(t){var n=h().modules[t.name];if(!1===(n.beforeLoad&&n.beforeLoad.call(n,n.depend)))return!1;if(p(t.name,{id:t.id,props:t.param||null,isComponent:!0}),n.isLoaded&&"function"==typeof n.loaded&&!t.cache){n.id=t.id,n.exports=n.loaded&&n.loaded.call(n,n.exports)||n.exports;var i={id:t.id,name:t.name,url:t.url,param:t.param||null,exports:n.exports||{}};return e.history.setComponent(i),window.store&&window.store.$mount&&window.store.$mount(t.id),t.loaded&&t.loaded.call(n,n.exports),F(t.id,i),f}e.checkLoad(t.name);b(t.name,(function(i){var o={id:t.id,name:t.name,url:t.url,param:t.param||null,exports:i||{}};e.history.setComponent(o),window.store&&window.store.$mount&&window.store.$mount(t.id),t.loaded&&t.loaded.call(n,i),F(t.id,o)}))}function k(n){var i=t.extend(!0,{id:"",isSelf:!0,deepComponent:o.deepComponent,cache:!1,cacheHtml:!1,delay:!0,param:null,beforeLoad:null,loaded:null,compiled:null},e.config.loader.component,n),a=null;a=""===i.id?e.$(o.componentTag):i.isSelf?e.$(i.id):e.$(i.id).find(o.componentTag);var r=[],l=[],c=[],s=[],u=h().modules;for(let n=0;n<a.length;n++){let o=a[n];var d=e.guid();!o.id&&o.setAttribute("id",d);var f=e.unit.getAttributes(o),p=f.parentId=i&&i.id||e.history.getLast().id||"bui-page",g=e.$(p).parents("component"),m=i.isSelf?g[0]&&g[0].id:i.id;"array"===e.typeof(p)?m=i.isSelf?g&&g[0].id:p[0].id:"object"==typeof f.parentId&&e.typeof(f.parentId).indexOf("element")>-1&&(m=i.isSelf?g[0]&&g[0].id:p.id);var v=m&&e.history.getComponent(m,"name");if(v)f.parentId=m,f.parentName=v;else{var b=e.history.getLast();f.parentId=b.id,f.parentName=b.name}var y=f.name||o.getAttribute("name"),x="true"===f.rendered||i.cacheHtml;if(y&&(!f.delay||!i.delay)){f=t.extend(!0,{},f,i.param);var k=u[y],I=o.innerHTML,O=k&&"string"==typeof k.template?k.template:y+".html",C=k&&k.script?k.script:y+".js";O=O||y+".html",k&&"function"==typeof k.template?r.push({id:o.id,el:o,name:y,cacheHtml:x,cache:i.cache,deepComponent:i.deepComponent,template:k.template||"",url:O,srcript:C,slot:I,param:f}):(c.push(O),s.push(C),l.push({id:o.id,el:o,name:y,cacheHtml:x,cache:i.cache,deepComponent:i.deepComponent,url:O,srcript:C,slot:I,param:f}))}}return r.length&&(r.forEach((function(e,t){w({id:e.id,url:e.url,param:e.param||null,template:e.template,cacheHtml:e.cacheHtml,cache:e.cache,beforeLoad:i.beforeLoad})})),i.data=r,T(i)),l.length?(j(e.array.merge(c,s),(function(e){!function t(n){var o=l[n];return n==l.length?(i.data=l,T(i),this):o?(o.template=e[n],void w({id:o.id,url:o.url,param:o.param||null,cacheHtml:o.cacheHtml,cache:o.cache,beforeLoad:i.beforeLoad,loaded:function(e){t(n+1)},onFail:function(){t(n+1)}})):this}(0)})),this):(i.compiled&&i.compiled(i.data),F("componentcompiled",i.data),!1)}function I(e){return k(t.extend(!0,{id:"",isSelf:!1,deepComponent:o.deepComponent,cache:!1,cacheHtml:!1,beforeLoad:null,loaded:null,compiled:null},e)),this}function T(t){for(let i=0;i<t.data.length;i++){let a=t.data[i];new RegExp(`<${o.viewTag}.+name=`,"gi").test(a.template)&&C({id:a.id});var n=new RegExp(`<${o.componentTag}.+name=`,"gi");new RegExp(`<${o.componentTag}.+name="${a.name}"`,"gi").test(a.template)?e.showLog(`请检查代码, <${o.componentTag} name="${a.name}"></${o.componentTag}>的模板里面存在循环嵌套`):(t.deepComponent&&n.test(a.template)&&I({id:a.id}),t.loaded&&t.loaded(a),F("componentloaded",a))}t.compiled&&t.compiled(t.data),F("componentcompiled",t.data)}function O(n){for(let l=0;l<n.data.length;l++){let c=n.data[l];if(!c.cacheHtml){c.el.innerHTML=c.template;var i=new RegExp(`<${o.componentTag}.+name`,"gi");new RegExp(`<${o.componentTag}.+name="${c.name}"`,"gi");i.test(c.template)&&I({id:c.id});var a=new RegExp(`<${o.viewTag}.+name="${c.name}"`,"gi"),r=new RegExp(`<${o.viewTag}.+name="${c.name}"`,"gi");if(r.test(c.template)){e.showLog(`请检查代码, <${o.viewTag} name="${c.name}"></${o.viewTag}>的模板里面存在循环嵌套`);continue}n.deepView&&a.test(c.template)&&!r.test(c.template)&&C({id:t(c.el)})}n.loaded&&n.loaded(c),F("viewloaded",c)}n.compiled&&n.compiled(n.data),F("viewcompiled",n.data)}function C(e){return S(t.extend(!0,{id:"",isSelf:!1,deepView:o.deepView,loaded:null,compiled:null},e)),this}function S(n){var i=t.extend(!0,{id:"",isSelf:!0,deepView:o.deepView,loaded:null,compiled:null},n),a=null;a=""===i.id?e.$(o.viewTag):i.isSelf?e.$(i.id):e.$(i.id).find(o.viewTag);var r=[],l=[],c=loader.map().modules;for(let t=0;t<a.length;t++){let n=a[t];var s=n.getAttribute("name"),u=n.getAttribute("delay"),d=c[s],f="true"===n.getAttribute("rendered"),h=e.guid();if(!n.id&&n.setAttribute("id",h),"true"!==u){var p=n.innerHTML,g=d&&d.template?d.template:s+".html";d&&"function"==typeof d.template?l.push({id:n.id,el:n,name:s,cacheHtml:f,template:d.template.call(d)||"",url:g,slot:p}):r.push({id:n.id,el:n,name:s,cacheHtml:f,url:g,slot:p})}}return l.length&&(l.forEach((function(e,t){e.el.innerHTML=e.template,window.store&&window.store.$mount&&window.store.$mount(i.id)})),i.data=l,O(i)),function e(t){if(t==r.length)return i.data=r,void O(i);r[t]&&P(r[t].url,(function(n){r[t].template=n,e(t+1)}),(function(n){r[t].template="",e(t+1)}))}(0),this}function L(n,i,o){return new Promise((function(a,r){if("string"==typeof n)(n=e.unit.resolvePath(n)).indexOf(".css")>-1?(i&&i(n),$(n).then((function(e){a(n)}))):n.indexOf(".html")>-1||n.indexOf(".htm")>-1?P(n).then((function(e){if("function"!=typeof i)return t(i).html(e),o&&o(e),void a(e);i&&i(e),a(e)}),(function(e){o&&o(e),r(e)})):E(n).then((function(e){i&&i(e),a(e)}),(function(e){o&&o(e),r(e)}));else if(n&&"array"===e.typeof(n)){var l=n.map((function(t,n){return(t=e.unit.resolvePath(t)).indexOf(".css")>-1?$(t):t.indexOf(".html")>-1||t.indexOf(".htm")>-1?P(t):E(t)}));Promise.all(l).then((function(e){i&&i(e),a(e)}),(function(e){o&&o(e),r(e)}))}}))}function j(t,n,i){return new Promise((function(o,a){if("string"==typeof t)L(t,n,i);else if(t&&"array"===e.typeof(t)){var r=[];!function i(a){if(a==t.length)return n&&n(r),void o(r);var l=e.unit.resolvePath(t[a]);return l.indexOf(".css")>-1?$(l,(function(e){r.push(e),i(a+1)})):l.indexOf(".html")>-1||l.indexOf(".htm")>-1?P(l,(function(e){r.push(e),i(a+1)}),(function(e){i(a+1)})):E(l,(function(e){r.push(e),i(a+1)}),(function(e){i(a+1)}))}(0)}}))}function P(t,n,i){return new Promise((function(a,r){var l="function"==typeof n;if(t=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),s.hasOwnProperty(t))return l?n&&n.call(f,s[t],200):"string"==typeof n&&e.$(n).html(s[t]),a(s[t],200),this;"string"==typeof t&&bui.ajax({baseUrl:o.baseUrl,url:t,dataType:"html",contentType:"text/html;charset=UTF-8",mimeType:"html",processData:!1,needNative:o.needNative,cache:o.cache,data:null,success:function(o,r,c){s[t]=o,l?n&&n.call(f,o,r,c):"string"==typeof n&&(e.$(n).html(o),i&&i.call(f,o,r,c)),a(o,r)},error:function(e,t,n){l&&i&&i.call(f,e,t,n),r(e,t,n)}})}))}function E(n,i,a){return new Promise((function(r,c){var s;if(d=u.modules,void 0===n||""==n)return a&&a.call(this,n),c(n),this;if(n in d)s=n,n=d[n].script||s+o.scriptSuffix;else{var f=n.indexOf(o.scriptSuffix);f>-1?s=(n=n).substr(0,f):(s=n,n+=o.scriptSuffix)}n=e.hasRouter?n:e.unit.relativePath(n,o.relativePath);var h=document.createElement("script")||{},p=o.cache?"":"?t="+(new Date).getTime(),g=n.indexOf("http://")>-1||n.indexOf("https://")>-1;h.type="text/javascript",h.async=!1,h.src=g?n+p:u.baseUrl+n+p,h.setAttribute("name",s),h.onload=function(){o.log&&console.log("create "+n),i&&i(n),r(n)},h.onerror=function(e){o.log&&console.log("createError "+n),a&&a(n),c(n)};var m=e.array.index(l,n);return d[s]&&d[s].isDefined?(i&&i(n),r(n)):(m>-1&&d.hasOwnProperty(s)&&t('script[name="'+s+'"]').remove(),m>-1&&!d.hasOwnProperty(s)&&t('script[name="'+s+'"]').remove(),document.body&&document.body.appendChild(h),o.cache&&l.push(n)),h=null,this}))}function N(t){return new Promise((function(n,i){t.length;if("array"===e.typeof(t)){var o=t.map((function(e){return $(e)}));return Promise.all(o)}return $(t)}))}function $(t,n){return new Promise((function(i,a){if("string"==typeof t){if(e.array.index(c,t)<0){var r=e.hasRouter?t:e.unit.relativePath(t,o.relativePath),l=document.createElement("link")||{};l.href=r+(o.cache?"":"?t="+(new Date).getTime()),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),document.head&&document.head.appendChild(l),l=null,c.push(t)}i(t,n)}else e.showLog(t+"的格式不正确")}))}function F(t){f.self=this==window||this==f?null:this;var n=e.history.getLast("id");arguments[0]=n+"-"+t,r.trigger.apply(f,arguments)}return f},window.loader=e.loader(),e.define=loader.define,e.require=loader.require,e.map=loader.map,e.import=loader.import,e.checkLoad=loader.checkLoad,e.checkDefine=loader.checkDefine,e.checkImport=loader.checkImport}(window.bui||{},window.libs),function(e,t){e.toggle=function(n){if("string"==typeof n){var i=n||"";(n={}).id=i}var o,a,r={show:function(t,n){if(s)return;if(d=e.objId(l.id),!f&&!h)return!1;f=!1,"function"==typeof t?(t=t,n=n||a||""):(n=t||a||"",t=null);d[0]&&"none"==d[0].style.display&&d.css("display",c);d.addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n?(l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),p=!0,f=!0):d.one("webkitAnimationEnd",(function(){try{!p&&d.css("display",c),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),p=!0,f=!0}catch(t){e.showLog(t,"toggle show method")}}));return this},hide:function(t,n){if(s)return;if(d=e.objId(l.id),!f&&!h)return;h=!1,"function"==typeof t?(t=t,n=n||o||""):(n=t||o||"",t=null);d.css("display",c).addClass("animated "+n),"showIn"==n||"showOut"==n||"none"==n?(d.css("display","none"),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),p=!1,h=!0):d.one("webkitAnimationEnd",(function(){try{d.css("display","none"),l.revert&&d.removeClass("animated "+n),t&&t.call(r,this),p=!1,h=!0}catch(t){e.showLog(t,"toggle hide method")}}));return this},remove:function(){return d.remove(),this},isShow:function(){return p},destroy:function(e){e=1==e;d&&(d.off(),e&&d.remove());s=!0},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(r,t,n)},config:l,init:g},l=r.config=t.extend(!0,{},{id:"",effect:"fadeIn",useBox:!1,revert:!0,inOrder:!1},n),c=l.useBox?"-webkit-box":"block",s=!1,u={show:["fadeIn","fadeInLeft","fadeInRight","fadeInDown","fadeInUp","fadeInLeftBig","fadeInRightBig","fadeInUpBig","fadeInDownBig","zoomIn","bounceIn","rotateIn","rollIn","flipInX","flipInY","lightSpeedIn","showIn","slideInRight","slideInLeft","coverInLeft","coverInRight","zoomSlideInLeft","zoomSlideInRight","pushInLeft","pushInRight"],hide:["fadeOut","fadeOutLeft","fadeOutRight","fadeOutUp","fadeOutDown","fadeOutLeftBig","fadeOutRightBig","fadeOutDownBig","fadeOutUpBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutRight","slideOutLeft","coverOutLeft","coverOutRight","zoomSlideOutLeft","zoomSlideOutRight","pushOutLeft","pushOutRight"],hideInOrder:["fadeOut","fadeOutRight","fadeOutLeft","fadeOutDown","fadeOutUp","fadeOutRightBig","fadeOutLeftBig","fadeOutUpBig","fadeOutDownBig","zoomOut","bounceOut","rotateOut","rollOut","flipOutX","flipOutY","lightSpeedOut","showOut","slideOutLeft","slideOutRight","coverOutRight","coverOutLeft","zoomSlideOutRight","zoomSlideOutLeft","pushOutRight","pushOutLeft"]},d=null,f=!0,h=!0,p=!1;function g(t){if(s=!1,(t=t||l).id){d=e.objId(t.id),l=r.config=t,d.attr("class")||"";var n=t.effect,i=t.inOrder?e.array.index(u.hideInOrder,n):e.array.index(u.hide,n),c=n&&(e.array.index(u.show,n)>-1?e.array.index(u.show,n):i);return p=!(d[0]&&"none"==d[0].style.display||"none"==d.css("display")),c<0?(a=u.show[0],o=t.inOrder?u.hideInOrder[0]:u.hide[0]):(a=u.show[c],o=t.inOrder?u.hideInOrder[c]:u.hide[c]),this}e.showLog("toggle id不能为空","bui.toggle")}return l.id&&g(l),r}}(window.bui||{},window.libs),function(e,t){e.unit={},e.unit.remToPx=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100;return e=(parseFloat(e)*t).toFixed(2)},e.unit.pxToRem=function(e){var t=window&&window.viewport&&window.viewport.fontSize||100;return e=(parseFloat(e)/t).toFixed(2)},e.unit.pxToRemZoom=function(e){return e=(parseFloat(e)/100).toFixed(2)},e.unit.debounce=function(e,t,n){var i;return function(){var o=n||this,a=arguments,r=function(){i=null,e.apply(o,a)};clearTimeout(i),i=setTimeout(r,t)}},e.unit.throttle=function(e,t,n){var i,o;return t||(t=250),function(){var a=n||this,r=+new Date,l=arguments;i&&r<i+t?(clearTimeout(o),o=setTimeout((function(){i=r,e.apply(a,l)}),t)):(i=r,e.apply(a,l))}},e.unit.startWithCss=function(e){var t=new RegExp("^\\.|^#");return"string"==typeof e&&t.test(e)},e.unit.startWithStr=function(e,t){var n=new RegExp("^"+t);return"string"==typeof e&&n.test(e)},e.unit.startWithId=function(e){var t=new RegExp("^#");return"string"==typeof e&&t.test(e)},e.unit.startWithClass=function(e){var t=new RegExp("^\\.");return"string"==typeof e&&t.test(e)},e.unit.endWithImage=function(e){var t=new RegExp("(.png|.jpg|.gif)$");return"string"==typeof e&&t.test(e)},e.unit.tel=function(t){var n,i="tel:";return 0==(t=String(t)).indexOf("+")&&(i="wtai://wp/mc;"),n=t,window.location.href=i+n,e},e.unit.sms=function(t,n){var i=navigator.userAgent,o=/(iPhone|iPad|iOS)/i.test(i)?"&":"?";return window.location.href="sms:"+t+o+"body="+n,e},e.unit.mailto=function(t){return"string"==typeof(t="email"in t?t:{}).email&&t.email.indexOf("@")>0?window.location.href="mailto:"+t.email+"?subject="+(t.subject||"")+"&body="+(t.body||"")+"&cc="+(t.cc||""):e.showLog(email+"格式不正确"),e},e.unit.openExtral=function(t){var n=[],i="";if((t=String(t)).indexOf("mailto:")>=0)if((i=(n=t.split("mailto:"))[1]).indexOf("?")>-1){var o=i.split("?"),a=e.unit.keyStringToObject(o[1]);a.email=o[0],e.unit.mailto(a)}else e.unit.mailto({email:i});if(t.indexOf("tel:")>=0&&(n=t.split("tel:"),i=parseInt(n[1]),e.unit.tel(i)),t.indexOf("sms:")>=0)if(i=(n=t.split("sms:"))[1],t.indexOf("=")>=0){var r=t.split("=")[1];e.unit.sms(i,r)}else e.unit.sms(i);return e},e.unit.objectToKeyString=function(e,t){var n="";for(var i in e){n+="&"+i+"="+(t?encodeURIComponent(e[i]):e[i])}return n.substr(1)},e.unit.keyStringToObject=function(t,n){var i,o={},a=[];try{for(a=t.split("&"),i=0;i<a.length;i++){var r=n?decodeURIComponent(a[i].split("=")[1]):a[i].split("=")[1];o[a[i].split("=")[0]]=r}}catch(t){e.showLog(t)}return o},e.unit.checkTargetInclude=function(e,n){var i=n,o=[];if(i.indexOf(",")>-1){var a,r=(o=i.split(",")).length;for(a=0;a<r;a++){var l=o[a];l.indexOf(".")>-1&&(o[a]=l.substr(1))}}else i.indexOf(".")>-1?o[0]=i.substr(1):o[0]=i;var c,s=o.length;for(c=0;c<s;c++)if(t(e).hasClass(o[c])||t(e).closest("."+o[c]).length)return!0;return!1},e.unit.jsonToString=function(t){return"object"==typeof t?function(t){var n;if("object"===e.typeof(t)){for(var i in t)t[i]=o(t,i);n=JSON.stringify(t)}else"array"===e.typeof(t)?(t.forEach((function(e,n){t[n]=o(t,n)})),n=JSON.stringify(t)):n=t;function o(t,n){var i=t[n];return i&&"object"===e.typeof(i)?t[n]=function(t){if(t&&"object"===e.typeof(t)){for(var n in t){var i=t[n];"object"==typeof i&&(t[n]=JSON.stringify(i))}return t}}(i):i&&"array"===e.typeof(i)?t[n]=function(t){if(t&&"array"===e.typeof(t))return t.forEach((function(e,n){"object"==typeof e&&(t[n]=JSON.stringify(e))})),t}(i):t[n]=i,t[n]}return n}(t):t},e.unit.stringToJson=function(t){return t&&function t(n){var i,o;try{if(i="object"==typeof n?n:JSON.parse(n),"array"===e.typeof(i))i.forEach((function(e,n){i[n]=t(e)}));else if("object"===e.typeof(i))for(var a in i){var r=i[a];i[a]=t(r)}o=i}catch(e){o=n}return o}(t)},e.unit.stringToArray=function(t){var n=e.typeof(t);return"array"===n?t:"string"===n&&t.indexOf(",")>-1?t.split(","):[t]},e.unit.setKeyValue=function(e,t,n){var i=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(n,o){if(i.length)return e(i.shift(),o[n]||{});o[n]=t}(i.shift(),n)},e.unit.getKeyValue=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(t,i){var o=i[t];if(o&&"string"==typeof o&&o.indexOf("{")>-1&&o.indexOf("}")>-1)try{i[t]=JSON.parse(o)}catch(e){i[t]=o}return void 0!==o&&n.length?e(n.shift(),o):o}(n.shift(),t)},e.unit.getKeyObj=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(t,i){var o=i[t];return!o instanceof Array&&o instanceof Object?e(n.shift(),o):o}(n.shift(),t)},e.unit.getKeyName=function(e){var t=field&&field.indexOf(".")>-1?field.split("."):[field];return function e(n,i){var o=i[n];return!o instanceof Array&&o instanceof Object?e(t.shift(),o):o}(t.shift(),e)},e.unit.delKey=function(e,t){var n=e&&e.indexOf(".")>-1?e.split("."):[e];return function e(i,o){return n.length?e(n.shift(),o[i]):(delete o[i],t)}(n.shift(),t)},e.unit.calcHeight=function(e,n){var i=t(e);i[0]&&(i[0].style.height="calc(100% - "+n+")")},e.unit.resolvePath=function(t){if(!e.hasRouter)return t;var n=t=t||"",i=(router&&router.history&&router.history.getLast()||{url:n}).url||"";if("function"==typeof i)return n;var o=i.lastIndexOf("/"),a=i.substr(0,o);return t.indexOf("../")>-1?(t=t.replace(/\..\//g,(function(e){var t=a.lastIndexOf("/");return a=a.substr(0,t),""})),n=a?a+"/"+t:t):t.indexOf("./")>-1&&(n=a+"/"+t.replace(/\.\//g,"")),n},e.unit.filterField=function(t,n){var i={};if("object"==typeof n){var o="object"===e.typeof(t),a="object"===e.typeof(n),r="array"===e.typeof(t),l="array"===e.typeof(n);if(o){if(a)for(let e in n)i[e]=n[e]?t[n[e]]:t[e];else l&&n.forEach((function(e,n){i[e]=t[e]}));return i}return r?(i=[],l?t.forEach((function(e,t){let o={};n.forEach((function(t,n){o[t]=e[t]})),i.push(o)})):a&&t.forEach((function(e,t){let o={};for(let t in n)o[t]=n[t]?e[n[t]]:e[t];i.push(o)})),i):void 0}},e.unit.fixZero=function(e){return e<10?"0"+e:e},e.unit.getAttributes=function(t){if("object"!=typeof t)return null;var n={},i=/\{.+\}$/g,o=/\[.+\]$/g;return t.attributes&&Object.keys(t.attributes).forEach((function(a,r){var l=t.attributes[a],c=l.value;if(i.test(c)||o.test(c))try{c=JSON.parse(c)}catch(t){c=c,e.showLog(t)}n[l.name]=c})),n},e.unit.resolvePathname=function(e,t){t=t||0;var n=e.lastIndexOf("/"),i=e.substring(t,n);return i.indexOf("/")>-1?i.split("/"):[i]},e.unit.relativeUrl=function(e,t){var n=[];return t.length>=e.length?t.forEach((function(t,i){let o=e[i];o&&t===o||(o&&t!==o?(n.unshift(".."),n.push(t)):n.push(t))})):e.forEach((function(e,i){let o=t[i];o&&e===o||(o&&e!==o?(n.unshift(".."),n.push(o)):n.unshift(".."))})),n},e.unit.relativePath=function(t,n){n=n||"pages";var i=window.self.location.href;if(i.indexOf("source.html?url=")>-1&&i.indexOf("code=")>-1)return t;if(0===t.indexOf("http://")||0===t.indexOf("https://"))return t;var o=window.location.href,a=o.indexOf(n),r=t&&t.indexOf("/")>-1?t.split("/"):[t],l=[];if(a<0){var c=window.location.pathname.toLocaleLowerCase(),s=c.indexOf("www"),u=c.indexOf("src"),d=c.indexOf("dist");if(s>-1){let t=e.unit.resolvePathname(c,s+4);l=e.unit.relativeUrl(t,r)}else if(d>-1){let t=e.unit.resolvePathname(c,d+5);l=e.unit.relativeUrl(t,r)}else{if(!(u>-1))return 0==t.indexOf("/")?t.replace("/",""):t;{let t=e.unit.resolvePathname(c,u+4);l=e.unit.relativeUrl(t,r)}}}else{let t=e.unit.resolvePathname(o,a);l=e.unit.relativeUrl(t,r)}return l.join("/")},e.unit.between=function(t,n,i){var o=!0,a=new Date;if(n=n||0,i=i||e.date.convert(a.getFullYear+"/12/31").getTime(),"number"==typeof t)(t<n||t>i)&&(o=!1);else{n||e.showLog("bui.unit.between 第2个参数为最小日期");try{n=e.date.convert(n).getTime(),i=e.date.convert(i).getTime(),((t=e.date.convert(t).getTime())<n||t>i)&&(o=!1)}catch(t){e.showLog("bui.unit.between 用来检测数字或者日期,请检查参数格式是否正确")}}return o},e.unit.numberunit=function(e){var t=+e,n=t;return t>1e4&&(n=parseFloat(t/1e4).toFixed(1)+"万"),n}}(window.bui||{},window.libs),function(e,t){var n,i,o,a;e.history=(o=[],a={get:function(t,n){if(void 0===t)return o;{let i=n||"name";return e.array.get(o,t,i)}},getLast:function(e){var t=o.length-1,n=o[t]||{};return e?n[e]:n},getPrev:function(e){var t=o.length-2,n=o[t]||{};return e?n[e]:n},getParams:function(e){var t=this.getLast(),n={};switch(e){case"page":n=this.getPageParam()||n;break;case"part":case"component":n=this.getComponentParam()||n;break;case"url":n=t.param||bui.getUrlParams();break;default:n=this.getComponentParam(e)||this.getPageParam(e)||t.param||bui.getUrlParams()}return n},setComponent:function(e){return this.getLast().component[e.id]=e,e},getComponentParam:function(e){var t=this.getLast(),n=e||t.currentComponent;return n&&t.component[n]&&t.component[n].param||null},getComponent:function(t,n){if(void 0!==t){n=n||"exports";var i=this.getLast();return i.component[t]&&i.component[t][n]||null}e.showLog("必须传component id才能获取实例")},getParentComponent:function(){var e=this.getComponentParam();return e&&e.parentId&&this.getComponent(e.parentId)||this.getLast("exports")},getParentParams:function(){var e=this.getComponentParam();return this.getParams(e.parentId)||this.getLast("param")||null},getPage:function(t,n){if(void 0!==t){n=n||"exports";var i=this.getLast(),o=null,a=i.page;if(a.hasOwnProperty(t))o=a[t]&&a[t][n]||{};else if(t){var r=Object.keys(a);for(let e=0;e<r.length;e++){let i=a[r[e]]||{};if(i.name===t)return i[n]}}else{var l=i.currentPage;o=a[l]&&a[l][n]||{}}return o}e.showLog("必须传page id 或者 模块名才能获取实例")},getPageDialog:function(t){if(void 0!==t){var n=this.getLast();return n.page[t]&&n.page[t].dialog||null}e.showLog("必须传page id才能获取对话框信息")},setPage:function(e){var n=this.getLast();if("object"!=typeof e)return e;if(e&&e.hasOwnProperty("id")){var i=t.extend(!0,{},n.page[e.id],e);return n.page[e.id]=i,e}},getPageParam:function(e){var t=this.getLast(),n=e||t.currentPage;return n&&t.page[n]&&t.page[n].param||null},add:function(n){var i=t.extend(!0,{id:"",name:"",url:"",replace:!1,syncHistory:!0,component:{},param:{},part:{},page:{},toggle:null,effect:"push"},n),a=o;if(n.toggle){var r=t.extend(!0,{},i,n);i.toggle=null,a.push(r)}else a.push(i);var l=window.location.origin+window.location.pathname+"#"+i.name,c=e.setUrlParams(l,i.param);return i.syncHistory&&"pushState"in window.history&&window.history.pushState(i,null,c),a},replace:function(n){n=t.extend(!0,{id:"",name:"",url:"",replace:!1,syncHistory:!0,param:{},part:{},page:{},toggle:null,effect:"push"},opts);var i=o,a=i.length-1,r=window.location.origin+window.location.pathname+"#"+n.name,l=e.setUrlParams(r,n.param);if(a>-1){if(opts.toggle){var c=t.extend(!0,{},n,opts);n.toggle=null,i.splice(a,1,c)}else i.splice(a,1,n);n.syncHistory&&"replaceState"in window.history&&window.history.replaceState(n,null,l)}return i},refresh:function(){if(e.hasRouter){var n=a.getLast(),i=loader.get(n.name);loader.import(n.url,(function(o){t("#"+n.id).html(o),e.config.init.auto&&e.init(),router.config.needView&&loader.views(),i.loaded(),router.config.needComponent&&loader.components()}))}else window.location.reload(!0)},removeNext:function(t){var n=o,i=t.index;if(parseInt(i)<0)return e.showLog("index 必须大于或者等于0"),n;var a=n.length-i;n.splice(i,a);var r=this.getLast(),l=window.location.origin+window.location.pathname+"#"+r.name,c=e.setUrlParams(l,r.param);return t.syncHistory&&"replaceState"in window.history&&window.history.replaceState(r.param,null,c),n},removeLast:function(e){var t=o.length-1;return this.removeNext({index:t,syncHistory:!1!==e})},check:function(t){var n=o;return e.array.compare(n,t,"name")||e.array.compare(n,t,"url")||e.array.compare(n,t,"id")},checkComponent:function(t){var n=this.getLast(),i=Object.keys(n.component);return e.array.compare(i,t)},checkPage:function(e,t){var n=this.getLast(),i=Object.keys(n.page);for(let t=0;t<i.length;t++){let o=i[t],a=n.page[o];if(a.name===e||a.id===e)return!0}return!1},epmty:function(e){return o=[]}},n=function(t){var n=(t=t&&t.replace(window.location.origin,"")||window.location.pathname).indexOf(".html"),i=t.indexOf("?"),o="",a="",r="",l=null,c=loader.map().modules;if(i>-1){var s=t.substr(i+1);l=e.unit.keyStringToObject(s,!0)}return n>-1?(a=(o=0==t.indexOf("/")?t.substr(1,n-1):t.substr(0,n-1))+".html",r=o+".js"):(a=c[o=t]&&c[o].template||"",r=c[o]&&c[o].script||""),{pid:o,name:o,url:a,src:r,param:l}}(window.location.href),i=e.guid(),t(document).ready((function(){document.body.setAttribute("id",i)})),o.push({id:e.guid(),pid:n.pid,name:n.pid,url:n.url,src:n.src,param:n.param,page:{},component:{}}),a)}(window.bui||{},window.libs),function(e,t){e.router=function(n){var i,o,a,r=t.extend({},{id:"",progress:!1,syncHistory:!0,autoInit:!0,firstAnimate:!1,path:"",indexModule:{moduleName:"main",template:"pages/main/main.html",script:"pages/main/main.js"},repairPath:!0,errorPage:"",hash:!1,cache:!0,reloadCache:!1,reload:!1,swipe:!1,swipeBack:!1,distance:100,startDistance:5,swipeDistance:50,onSwipeRight:null,onSwipeLeft:null,onSwipeUp:null,onSwipeDown:null,onBeforeSwipeRight:null,onSwipeCancel:null,pageMove:!0,needNative:!1,needView:!1,needComponent:!0,useScroll:"main,.bui-tab-main>ul>li,.bui-dialog-main,.bui-scroll,.bui-scroll-x",beforeBack:null,beforeLoad:null,loaded:null,store:null,width:0,height:0,async:!0,effect:"push",hashPrefix:"#",scriptSuffix:".js",pageSuffix:".html"},e.config.router,n),l=null,c=this,s=null,u=null,d=null,f="",h="",p=!0,g=!0,m=!1,v=!1,b={none:{inRight:"showIn",inLeft:"showIn"},fadein:{inRight:"fadeIn",inLeft:"fadeIn"},fadeinslide:{inRight:"fadeInRight",inLeft:"fadeInLeft"},slide:{inRight:"slideInRight",inLeft:"slideInLeft"},push:{inRight:"pushInRight",inLeft:"pushInLeft"},zoom:{inRight:"zoomIn",inLeft:"zoomIn"},cover:{inRight:"coverInRight",inLeft:"coverInLeft"},zoomslide:{inRight:"zoomSlideInRight",inLeft:"zoomSlideInLeft"},fadeinslideback:{inRight:"fadeInLeft",inLeft:"fadeInRight"},slideback:{inRight:"slideInLeft",inLeft:"slideInRight"},pushback:{inRight:"pushInLeft",inLeft:"pushInRight"},coverback:{inRight:"coverInLeft",inLeft:"coverInRight"},zoomslideback:{inRight:"zoomSlideInLeft",inLeft:"zoomSlideInRight"}},y={},w={},x={},k={},I=!1,T={},O={},C=loader.map(r.indexModule),S=e.history.epmty(),L=C.modules,j=e.storage({local:!1});function P(e){var t=window.location.hash||window.location.search,n=window.location.search,i=n&&n.indexOf("?"),o=(e=0!=e,t&&t.indexOf("?")),a=o>-1?t&&t.substr(1,o-1):window.location.hash.substr(1),l=a&&a.indexOf(r.pageSuffix),c=l>-1?a.substr(0,l):a,s=l>-1?a:a+r.pageSuffix,u={};function d(t,n){for(var i=t&&t.substr(n+1),o=i&&i.split("&"),a=0;a<o.length;a++){var r=e?decodeURIComponent(o[a].split("=")[1]):o[a].split("=")[1];u[o[a].split("=")[0]]=r}}return o>-1&&(d(n,i),d(t,o)),{pid:c,url:s,param:u}}function E(n){var i={id:"",url:"",param:{},effect:"",command:"html",path:r.path,repairPath:r.repairPath,firstAnimate:r.firstAnimate,progress:r.progress,reload:r.reload,autoInit:r.autoInit,needView:r.needView,needComponent:r.needComponent,replace:!1,iframe:!1,decode:!1,part:!1,cache:r.cache,callback:null,beforeLoad:r.beforeLoad,loaded:r.loaded},c=t.extend(!0,{},i,n),f=t.Deferred(),g=w.getLast()||null;S[S.length-2];c.url.indexOf("./")>-1&&(c.url=function(e,t){var n=e,i=t.url.lastIndexOf("/"),o=t.url.substr(0,i);e.indexOf("../")>-1?(e=e.replace(/\..\//g,(function(e){var t=o.lastIndexOf("/");return o=o.substr(0,t),""})),n=o?o+"/"+e:e):e.indexOf("./")>-1&&(n=o+"/"+e.replace(/\.\//g,""));return n}(c.url,g)),c.repairPath&&0===c.url.indexOf("/")&&(c.url=c.url.substr(1)),c.path&&(c.path="/"==c.path[c.path.length-1]?c.path:c.path+"/"),c.url=c.url in L||c.iframe||c.url.indexOf("http:")>-1?c.url:c.path+c.url,document.activeElement.blur();var v,b={};c.id=(c.id&&c.id.indexOf("#")>-1?c.id.substr(1):c.id)||"";var k=c.replace||c.part?g.id:c.id||e.guid(),C=e.objId(k);if(!c.url)return e.showLog("url 不能为空","bui.router.load"),f.promise();if(c.url=c.decode?decodeURIComponent(c.url):c.url,c.url.indexOf("tel:")>=0||c.url.indexOf("mailto:")>=0||c.url.indexOf("sms:")>=0)return e.unit.openExtral(c.url),f.promise();if(c.url&&c.url.indexOf("?")>-1){var j=c.url.split("?");b=e.unit.keyStringToObject(j[1]),c.url=j[0]}v=t.extend(!0,{},b,c.param),"undefined"==c.url&&(c.url="main"),c.iframe=Boolean(c.iframe);var P=N(c.url),$=P.pid,F=c.iframe?c.url:P.url,H={id:k,pid:$,name:$,url:"function"==typeof F?c.url:F,replace:c.replace,param:v,component:{},page:{},toggle:null,exports:{},effect:n.effect||r.effect,syncHistory:r.syncHistory};c.part?g:H,a&&a.show(),c.progress&&o&&o.show(),loader.map({moduleName:$,id:k});loader.get(H.pid);if(S.length&&c.effect){var q=S.length-1;S[q].effect=c.effect}!m&&!c.part&&!c.replace&&w.add(H),c.replace&&w.replace(H);var U=H,_="function"==typeof c.beforeLoad?c.beforeLoad.call(V,{prevTarget:g,target:H}):c.beforeLoad;if(z.call(V,"loadbefore",{prevTarget:g,target:H}),z.call(V,"beforeload",{prevTarget:g,target:H}),!1===_)return p=!1,this;if(c.part&&(e.history.setComponent({id:k,pid:$,url:F,param:v}),U.currentComponent=k,S.splice(S.length-1,1,U)),c.part||H,x[$])!function(e){X(T.get(e.pid,"template")),e.part||(K(),!m&&J((function(){e.progress&&o&&o.hide()}))),Z(e)}({pid:$,progress:c.progress,part:c.part}),z.call(V,"complete",{prevTarget:g,target:H}),c.loaded&&c.loaded({prevTarget:g,target:H}),c.callback&&c.callback({prevTarget:g,target:H}),r.needComponent&&loader.components();else{if(c.iframe)return function(t){var n=function(t){var n=t.param?e.setUrlParams(t.url,t.param):t.url,i="",o=e.platform.isIos()?'scrolling="no"':"";return i+='<div id="'+t.id+'" class="bui-router-item bui-router-fixiframe" data-page="'+t.pid+'">',i+='<iframe class="bui-router-iframe" src="'+n+'" '+o+"></iframe>",i+="</div>"}({id:t.id,pid:t.pid,url:t.url,param:t.param});s&&s.attr("data-main",t.id).append(n),J((function(){c.progress&&o&&o.hide()}))}({id:k,pid:$,url:c.url,param:v}),f.promise();if(c.part)return B(F,(function(t,n,i){e.objId(k)[c.command](t),Y(Q),c.cache&&T.add($,{id:k,pid:$,template:t}),a&&a.hide(),c.progress&&o&&o.hide()}),(function(e,t,n){W(F,e),z.call(V,"loadfail",e,t,n)})),f.promise();B(F,(function(e,t,n){if("object"==typeof e)return W(F,e),!1;X(e),c.cache&&T.add($,{id:k,pid:$,template:e}),K(),c.firstAnimate?J((function(){Y(Q),c.progress&&o&&o.hide(),O.add($,{id:k,pid:$,param:v})})):(J((function(){c.progress&&o&&o.hide()})),Y(Q),O.add($,{id:k,pid:$,param:v}))}),(function(e,t,n){W(F,e),z.call(V,"loadfail",e,t,n)}))}function W(t,n,i,l){if(a&&a.hide(),c.progress&&o&&o.hide(),w.removeLast(),f.reject(t),"object"==typeof n)return e.showLog("找不到页面"+t,"bui.router.load"),r.errorPage&&function(e){!function(e){var t,n=window.location.href,i=(t=(t=n.indexOf(r.hashPrefix))>-1?t:0)>-1?n.substr(0,t):n;E({url:r.errorPage||i,param:{error:e}}),z.call(V,"error",{target:e,status:404})}(e)}(t),!1}function Y(t){m||y[$]?(U.exports=y[$],Z({pid:$}),I&&J(),t&&t(),r.needComponent&&loader.components()):(loader.checkLoad($)?(Z({pid:$}),r.needComponent&&loader.components(),t&&t()):loader.require($,(function(n){try{if(c.firstAnimate&&c.progress&&o&&o.hide(),y[$]=n||null,H.exports=n,f.resolve(n),p||c.firstAnimate||c.replace){var i=loader.get($);i&&i.show&&i.show({type:"firstload",target:H})}t&&t(),c.loaded&&c.loaded({prevTarget:g,target:H}),c.callback&&c.callback({prevTarget:g,target:H}),r.needComponent&&loader.components()}catch(t){e.showLog(t,"bui.router.load"),f.reject()}})),z.call(V,"complete",{prevTarget:g,target:H}))}function K(){var t=(l=e.objId(U.id))&&l.find(".bui-page");t&&t.length&&c.autoInit&&e.init({id:t,height:h})}function J(t){l=e.objId(k),R(),D();try{if(p||m||c.replace||c.part){!c.firstAnimate&&c.progress&&o&&o.hide(),t&&t(),a&&a.hide(),l&&l.css("zIndex",5);var n="pageshow-"+w.getLast().pid;z.call(V,"pageshow",{type:"load",target:w.getLast()}),z.call(V,n,{type:"load",target:w.getLast()})}else u&&u.hide(),d&&d.show((function(){!c.firstAnimate&&c.progress&&o&&o.hide(),t&&t(),l&&l.css("zIndex",5),a&&a.hide();var e=S[S.length-2]||{},n=w.getLast(),i=loader.get(n.pid),r=e&&e.pid&&loader.get(e.pid)||null,s="pageshow-"+n.pid,u="pagehide-"+e.pid;z.call(V,u,{type:"load",target:S[S.length-2]}),z.call(V,s,{type:"load",target:w.getLast()}),z.call(V,"pagehide",{type:"load",target:S[S.length-2]}),z.call(V,"pageshow",{type:"load",target:w.getLast()}),r&&r.hide&&r.hide({type:"load",target:S[S.length-2]}),i&&i.show&&i.show({type:"load",target:w.getLast()})}))}catch(t){e.showLog(t,"bui.router.doAnimate")}}function X(t){var n="";if(V.store&&(t=V.store.compileHtml(t)),c.part)n=M({content:t}),c.id?C.html(n):e.showLog("id 不能为空","router.loadPart");else if(c.replace){var i=w.getLast();C=S.length?e.objId(i.id):s,i.pid=$,i.url=F,i.param=v;e.array.index(S,$,"pid");n=$ in x?T.get($,"template"):M({content:t}),C.html(n).attr("data-page",$)}else m||(n=A({id:k,content:t,pid:$}),s&&s.attr("data-main",k).append(n));return r.needView&&loader.views({compiled:function(){V.store&&!V.store.config.isPublic&&V.store.config.needCompile&&V.store.compile("#"+k)}}),!V.store||r.needView||V.store.config.isPublic||V.store.config.needCompile&&V.store.compile("#"+k),n}function Z(e){var t=w.getLast(),n=L[e.pid]&&L[e.pid]||{},i=n.loaded,l=i&&i.apply(n,n.dependExports)||n.exports;y[e.pid]=l||null,n.exports=l,t.exports=l,m&&z.call(V,"refresh",{prevTarget:g,target:t}),a&&a.hide(),r.progress&&o&&o.hide(),f.resolve(l),m=!1,p=!1}function Q(){var e=S[S.length-2]||null,t=w.getLast();p&&!c.part&&(z.call(V,"firstload",{prevTarget:e,target:t}),p=!1),c.part?z.call(V,"loadpart",{prevTarget:e,target:t}):z.call(V,"load",{prevTarget:e,target:t})}return f.promise()}function N(e){var t="",n=e;C=loader.map(),L=C.modules;var i=n.indexOf(r.pageSuffix);return i>-1?(n=(t=n).substr(0,i),L.hasOwnProperty(n)&&(t=L[n]&&L[n].template||t||"")):t=L[n=n]&&L[n].template||n+r.pageSuffix||"",{pid:n,url:t}}function $(n){var i=this,o={};"function"==typeof n?o.callback=n:o=n||{};var a=t.extend(!0,{index:-1,name:"",beforeBack:r.beforeBack,callback:null,loaded:r.loaded},o),l=parseInt(a.index),c=S.length;if(C=loader.map(),L=C.modules,!(l>0)){var f=w.getLast(),h=c-1,p=f.toggle;if(p)return p.hide(),void R();var m="function"==typeof a.beforeBack?a.beforeBack.call(V,{prevTarget:null,target:f}):o.beforeBack;z.call(V,"beforeback",{prevTarget:null,target:f});var v=loader.get(f.pid);return v&&v.beforeDestroy&&v.beforeDestroy(),!1===m?this:(a.name&&(l=F(a.name)),Math.abs(l)>h&&(l=-h),c>1&&g&&(l<-1&&D(l),g=!1,o.effect&&(u.option({effect:o.effect}),d.option({effect:o.effect})),u&&u.show(),d&&d.hide((function(){var n=c+l;!function(e){s.children().each((function(n,i){n>=e&&t(i).remove()}))}(n),w.removeNext(n),D();var o=R(),r=o.pid;e.objId(o.id).css("zIndex",5),function(){var e;e=y[r]||{};var t=loader.get(o.pid);a.callback&&a.callback.call(i,e,o),a.backed&&a.backed.call(V,{prevTarget:f,target:o}),z.call(V,"back",{prevTarget:f,target:o}),o;var n="pageshow-"+o.pid,l="pagehide-"+f.pid;v&&v.hide&&v.hide({type:"back",target:f}),t&&t.show&&t.show({type:"back",target:o}),z.call(V,l,{type:"back",target:f}),z.call(V,n,{type:"back",target:o}),z.call(V,"pageshow",{type:"back",target:o}),z.call(V,"pagehide",{type:"back",target:f}),v&&v.destroyed&&v.destroyed(),g=!0}()}))),this)}e.showLog("index 参数只能是负数","bui.router.back")}function F(t){var n,i=e.array.indexs(S,t,"pid"),o=i.length;if(o){var a=-(S.length-i[o-1]-1);n=0==a?-1:a}else n=-1;return n}function B(t,n,i){if("string"==typeof t){loader.importHtml(t,(function(e,t,i){e=function(e){var t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,n=/<body[^>]*>([\s\S]*)<\/body>/.exec(e);if(n&&2===n.length)return n[1].replace(t,"");return e}(e),n&&n(e,t,i),z.call(V,"success",e,t,i)}),(function(e,t,n){i&&i(e,t,n),z.call(V,"fail",e,t,n)}))}else if("function"==typeof t){var o=t&&t();n&&n(o,200,{}),z.call(V,"success",o,200,{})}else e.showLog("url 不能为空","bui.router.requestUrl")}function R(){var t=w.getLast(),n=t.id||"",i=t.effect||r.effect;return n&&(z.call(V,"beforepageshow",{target:t}),d=null,d=e.toggle({id:document.getElementById(n),effect:b[i]&&b[i].inRight||""}),s&&s.attr("data-main",n)),t}function D(t){t=t||-1;var n=S.length+t-1,i=S[n],o=i&&i.id||"",a=i&&i.effect||r.effect;return o&&(z.call(V,"beforepagehide",{target:i}),u=null,u=e.toggle({id:document.getElementById(o),effect:b[a]&&b[a].inLeft||""})),i}function A(e){var t="";return t+='<div id="'+e.id+'" class="bui-router-item" data-page="'+e.pid+'">',t+=e.content||"",t+="</div>"}function M(e){var t="";return t+=e.content}function H(t,n){return e.on.apply(V,arguments),this}function z(t){V.self=this==window||this==V?null:this,e.trigger.apply(V,arguments)}e.hasRouter=!0,w.get=function(){return S},w.add=function(n){if((n=n||{}).toggle){var i=t.extend(!0,{},n);n.toggle=null,S.push(i)}else S.push(n);var o=window.location.origin+window.location.pathname+"#"+n.pid,a=e.setUrlParams(o,n.param);if(!p)return r.syncHistory&&"pushState"in window.history&&window.history.pushState(n,null,a),S;r.syncHistory&&"replaceState"in window.history&&window.history.replaceState(n,null,a)},w.prepend=function(t){t=t||{};var n=window.location.origin+window.location.pathname+"#"+t.pid;e.setUrlParams(n,t.param);return S.unshift(t),S},w.replace=function(t){t=t||{};var n=S.length-1,i=window.location.origin+window.location.pathname+"#"+t.pid,o=e.setUrlParams(i,t.param);return n>-1&&(S.splice(n,1,t),r.syncHistory&&"replaceState"in window.history&&window.history.replaceState(t,null,o)),S},w.getLast=function(e){var t=S.length-1,n=S[t]||{};return e?n[e]:n},w.removeNext=function(t){var n=S.length-t;S.splice(t,n);var i=w.getLast(),o=window.location.origin+window.location.pathname+"#"+i.pid,a=e.setUrlParams(o,i.param);r.syncHistory&&"replaceState"in window.history&&window.history.replaceState(i.param,null,a)},w.removeLast=function(){var e=S.length-1;w.removeNext(e)},w.checkLoad=function(t){return e.array.compare(S,t,"pid")||e.array.compare(S,t,"url")||e.array.compare(S,t,"id")},T.add=function(e,t){return x[e]=t||{},x[e]},T.del=function(e){delete x[e]},T.get=function(e,t){return t?(x[e]||{})[t]:x[e]},T.save=function(){if(S.length>1){var e=i.html();j.set("cacheHtml",e),j.set("cacheHistory",S),j.set("hasCache","true")}},T.load=function(){var t=j.get("cacheHtml",0),n=j.get("cacheHistory",0),o=[];if(n.length>1){i.html(t),s=i.children(".bui-router-main"),$({name:P().pid});try{n.forEach((function(e,t){var n="string"==typeof e?JSON.parse(e):e;o.push(n)}));var a=o[o.length-1];a,loader.require(a.pid,(function(e){y[a.pid]=e||null})),H("back",(function(e){loader.require(e.target.pid,(function(t){y[e.target.pid]=t||null}))}))}catch(t){e.showLog(t)}S=o,R(),D(),p=!1,I=!0,T.clear()}},T.clear=function(){j.remove("cacheHistory"),j.remove("cacheHtml"),j.remove("hasCache")},O.add=function(e,t){return k[e]=t||{},k[e]},O.get=function(e,t){return t?(k[e]||{})[t]:k[e]};var V={init:function(n){if(V.store=n.store||null,delete n.store,n=t.extend(!0,{},r,e.config.router,n),r=V.config=n,"pages/main/main.html"===n.indexModule.template&&"pages/main/main.js"===n.indexModule.script||(C=loader.map(n.indexModule)),v&&"effect"in n&&S.forEach((function(e,t){e.effect=n.effect})),!n.id)return e.showLog("id 不能为空","bui.router.init"),!1;if(i=e.objId(n.id),a=bui.mask({appendTo:i,opacity:0,autoClose:!1}),o=e.loading({display:"block",width:30,height:30,opacity:0}),s=i.children(".bui-router-main"),f=n.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",h=n.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",!s.length){var l=function(e){var t="";String(f).indexOf("%"),String(h).indexOf("%");return t+='<div class="bui-router-main">',t+="</div>"}();i.html(l),s=i.children(".bui-router-main")}return(n.width>0||String(n.width).indexOf("%")>-1)&&s.width(n.width),(n.height>0||String(n.height).indexOf("%")>-1)&&s.height(n.height),function(n){if(function(){var t=j.get("hasCache",0);Boolean(t)&&r.reloadCache?T.load():function(t){try{var n=P();if(n.pid){if(n.pid.indexOf("http://")>-1||n.pid.indexOf("https://")>-1)return void E({url:n.pid,param:n.param,iframe:!0});E({url:n.pid,param:n.param})}else E({url:r.indexModule.moduleName,param:n.param||{}})}catch(t){e.showLog(t,"bui.router.loadUrl")}}()}(),n.swipe&&function(n){var o=/hp-tablet/gi.test(navigator.appVersion),a="ontouchstart"in window&&!o,l=0,c=0,s=!1,u=null,d=null,f={x1:0,x2:0,y1:0,y2:0,direction:""};i.on("touchstart",(function(i){var o=i.originalEvent&&i.originalEvent.targetTouches||i.targetTouches,l=a?o[0]:i;f.x1=l.pageX,f.y1=l.pageY,s=t(i.target).closest(r.useScroll).length,S.length>1&&f.x1>0&&f.x1<n.distance&&(u=t("#"+w.getLast().id),d=e.history.getPrev().id?t("#"+e.history.getPrev().id):null)})),i.on("touchmove",(function(i){var o=i.originalEvent&&i.originalEvent.targetTouches||i.targetTouches,h=a?o[0]:i;f.x2=h.pageX,f.y2=h.pageY,o.length>1||i.scale&&1!==i.scale||(s=t(i.target).closest(r.useScroll).length,f.x2-f.x1>0&&!s&&i.preventDefault(),f.direction||(f.direction=e.swipeDirection(f.x1,f.x2,f.y1,f.y2)),"swipeleft"!==f.direction&&"swiperight"!==f.direction||(i.preventDefault(),i.stopPropagation()),l=Math.abs(f.x2-f.x1),c=Math.abs(f.y2-f.y1),"swiperight"===f.direction&&l>n.startDistance&&n.swipeBack&&(d&&d.css("display","block"),n.pageMove&&u&&u.css("transform",`translateX(${l}px)`),i.preventDefault()))})),i.on("touchend",(function(e){(s=t(e.target).closest(r.useScroll).length,"swiperight"===f.direction&&f.x1>n.distance&&n.swipeBack&&(l=0),"swiperight"===f.direction&&l>n.swipeDistance)&&(!1!==(n.onBeforeSwipeRight&&n.onBeforeSwipeRight())&&n.swipeBack&&bui.back(),n.onSwipeRight&&n.onSwipeRight(e),z.call(V,"swiperight"));"swipeleft"===f.direction&&l>n.swipeDistance&&(n.onSwipeLeft&&n.onSwipeLeft(e),z.call(V,"swipeleft")),"swipeup"===f.direction&&c>n.swipeDistance&&!s&&(n.onSwipeUp&&n.onSwipeUp(e),z.call(V,"swipeup")),"swipedown"===f.direction&&c>n.swipeDistance&&!s&&(n.onSwipeDown&&n.onSwipeDown(e),z.call(V,"swipedown")),l<n.swipeDistance&&(d&&d.css("display","none"),u&&u.css("transform","translateX(0)")),l=0,s=!1,f={x1:0,x2:0,y1:0,y2:0,direction:""},u=null,d=null,e.stopPropagation()}))}(n),window.addEventListener("beforeunload",(function(e){r.reloadCache&&T.save(),z.call(c,"beforeunload",{target:S[S.length-1]})})),n.hash)return window.addEventListener("hashchange",(function(t){var n=P(),i=""==n.pid||"undefined"==n.pid?"main":n.pid,o=e.array.indexs(S,i,"pid"),a=o[o.length-1];a>-1?($({index:-(S.length-a-1||1)}),z.call(c,"popstate",{type:"back",prevTarget:S[a-1],target:S[a]})):(E({url:i,param:n.param,replace:!0}),z.call(c,"popstate",{type:"load",prevTarget:S[S.length-2],target:S[S.length-1]}))})),this;r.syncHistory&&"pushState"in window.history&&window.addEventListener("popstate",(function(t){var n=P(),i=""==n.pid?r.indexModule.moduleName:n.pid,o=F(i);e.array.index(S,i,"pid")>-1?($({index:o,param:n.param}),z.call(c,"popstate",{type:"back",prevTarget:S[o-1],target:S[o]})):(E({url:i,param:n.param}),z.call(c,"popstate",{type:"load",prevTarget:S[S.length-2],target:S[S.length-1]}))}))}(n),z.call(this,"init",{target:i[0]}),V},option:function(t,n){return v=!0,e.option.call(V,t,n)},config:r,data:{},on:H,off:function(t,n){return e.off.apply(V,arguments),this},trigger:z,load:E,resize:function(e){return(e=e||{}).width=e.width||r.width,e.height=e.height||r.height,window.viewport=bui.viewport(),f=e.width||window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth||"100%",h=e.height||window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight||"100%",s.css({width:f,height:h}),z.call(this,"resize",{target:S[S.length-1]}),this},destroy:function(t){return"string"==typeof t&&"main"!==t?(loader.destroy(t),T.del(t),t in y&&delete y[t]):e.showLog("参数只能是字符串"),this},loadPart:function(e){var n=t.Deferred(),i=t.extend(!0,{},{id:"",url:"",param:{},loaded:null},e);return i.loaded=function(t){e.loaded&&e.loaded.call(V,t),n.resolve(t),z.call(V,"loadpart",t)},loader.load(i),n.promise()},replace:function(e){return E({url:(e=e||{}).url||"",param:e.param||{},replace:!0}),this},refresh:function(){var t=S.length-1,n=S[t],i=S.length>1?S[S.length-2]:null;return e.history.refresh(),z.call(V,"refresh",{prevTarget:i,target:n}),this},back:$,isLoad:function(e){var t;return e&&(t=e in y),t},$:function(t){var n=w.getLast(),i=document.getElementById(n.id)||document;return e.obj(t,i)},currentId:function(e){return w.getLast().id},currentPage:function(){var e=w.getLast();return document.getElementById(e.id)},currentModule:function(){return w.getLast()},getPageParams:function(){return w.getLast().param},getPartParams:function(t){return e.history.getComponentParam(t)},getHistory:w.get,preload:function(n){var i=t.Deferred(),o=function(t,o){return B(t.url,(function(i){var a=e.guid(),r=N(t.url).pid,l=(A({id:a,content:i,pid:r}),[]);T.add(r,{id:a,pid:r,template:i}),l.push(r),t.style&&"array"===e.typeof(t.style)?t.style.forEach((function(e,t){l.push(e)})):t.style&&"string"===e.typeof(t.style)&&l.push(t.style),t.script&&"array"===e.typeof(t.script)?t.script.forEach((function(e,t){l.push(e)})):t.script&&"string"===e.typeof(t.script)&&l.push(t.script),loader.import(l,(function(){z.call(V,"preloadafter",{prevTarget:null,target:null}),o&&o(n)}),(function(){z.call(V,"preloadafter",{prevTarget:null,target:null}),o&&o(n)}))}),(function(n){e.showLog(t.url+"请求失败"),i.reject(t.url)})),i.promise()};return n&&"object"===e.typeof(n)?"url"in n&&o(n,(function(){i.resolve(n)})):n&&"array"===e.typeof(n)&&n.forEach((function(e,t){t==n.length-1?"url"in e&&o(e,(function(){i.resolve(n)})):"url"in e&&o(e)})),i},initScroll:function(n){var i=w.getLast(),o=e.objId(i.id),a="object"==typeof n?t(n):o.find(".bui-page");return a.length&&e.init({id:a,height:h}),this},history:{get:w.get,check:w.checkLoad,getLast:w.getLast,add:w.add,removeLast:w.removeLast,replace:w.replace}};return V}}(window.bui||{},window.libs),function(e,t){class n{constructor(n){this._default={log:!1,hasLife:!0,onBeforeInit:null,onInited:null},this._plugin=n||{name:"",depend:null,config:null,param:null,callback:null};let i=e.config.hasOwnProperty(this._plugin.name)?e.config[this._plugin.name]:null;this.config=t.extend(!0,{},this._default,i,this._plugin.config,this._plugin.param),this.initStatus=!1,this.reinitStatus=!1,this.widgets=Object.create(null),this.init()}widget(e){return e&&e in this.widgets?this.widgets[e]:this.widgets}init(e){let n=this,i=e||null;n.config=t.extend(!0,this.config,i);let o=n.config,a=o.hasLife&&o.onBeforeInit&&o.onBeforeInit.call(n,o);return o.log&&console.log(n._plugin.name+" before init"),!1===a||(n._plugin.callback&&n._plugin.callback.call(n,o),o.log&&console.log(n._plugin.name+" init"),o.hasLife&&o.onInited&&o.onInited.call(n,o),o.log&&console.log(n._plugin.name+" after inited"),this.initStatus=!0),n}reinit(){return this.destroy(),this.init(),this.config.log&&console.log(this._plugin.name+" reinit"),this}destroy(e){return this.beforeDestroy&&this.beforeDestroy(),this.beforeDestroy=null,this.widgets={},this.off(),this.initStatus=!1,e&&e.call(this),this.config.log&&console.log(this._plugin.name+" destroyed"),this}prefix(t){return e.config.classNamePrefix+t}showLog(t,n){n=n||"";let i="";return"object"==typeof t&&"message"in t&&"name"in t?i=t.message+":"+t.name+"&&stack:"+t.stack:"string"==typeof t&&(i=t),e.log&&console.error(n+" "+i),e.trace&&console.trace&&console.trace(),this}option(n,i){if("object"!==e.typeof(n)&&void 0===i)return"string"==typeof n?this.config[n]:this.config;{let o=this;if("id"==n)return e.showLog("不允许修改控件的ID参数"),this;if(n&&"object"===e.typeof(n)){let e=t.extend(this.config,n);return o&&o.init(e)}if(this.config.hasOwnProperty(n)){let e={};e[n]=i;let a=t.extend(this.config,e);return o&&o.init(a)}}return this}get emitter(){return e.emitter()}get on(){return this.emitter.on}get off(){return this.emitter.off}get trigger(){return this.emitter.trigger}}e.extend=function(t){new class{constructor(e){this.init(e)}init(i){let o=i.name;return this.checkName(o)?(e[o]=function(e){return t.param=e,new n(t)},this):this}checkName(t){return t?e.hasOwnProperty(t)?(console.warn(`已有相同名为${t}的插件或方法,请重新换个名称注册.`),!1):(this.name=t,!0):(console.warn("插件名字不能为空"),!1)}}(t)}}(window.bui||{},window.libs);t((function(e){!function(t,n){t.extend({name:"page",config:{dialogid:"",url:"",param:null,script:"",appendTo:"",className:"bui-dialog-page",effect:"",pageSuffix:".html",height:0,width:0,iframe:!1,openFirst:!0,closeFirst:!1,autoClose:!1,needRemove:!1,useBox:!0,syncHistory:!1,title:"",buttons:null,mask:!1,life:!0,scroll:!1,needView:!1,needComponent:!0,cache:!0,close:!1,autoload:!0,fullscreen:!0,effect:"fadeInRight",onError:null,beforeClose:null,closed:null,beforeOpen:null,opened:null,beforeLoad:null,loaded:null},callback:function(i){var o=this,a=o.config,r="body"==o.appendTo?n:t.obj,l="",c=!1,s=(loader.map().modules,o.widgets.dialog=t.dialog({autoinit:!1,needRemove:i.needRemove})),u=null,d=!1;function f(e,t){var n="";return n+=`<div class="bui-dialog-main">${e}</div>${t.close?'<div class="bui-dialog-close"><i class="icon-close"></i></div>':""}`}function h(e){var n=loader.map().modules[u.module]||{};if(n.hide&&a.life){var i=t.hasRouter?t.history.getLast():{};n.hide({type:"page",target:i})}"function"==typeof e&&e.call(o,n),a.closed&&a.closed.call(o,n)}function p(n,i){var r=t.history.getLast(),l=(loader.map().modules||{})[n];if(a.cache&&c&&!d)return!a.openFirst&&s.open(),"function"==typeof i&&i.call(o,l.exports),o;if(t.history.setPage({id:s.config.id,name:n,url:a.url,dialog:s,param:a.param}),d=!1,l&&"function"==typeof l.loaded){var u=l.loaded&&l.loaded.call(e,l.exports)||l.exports;t.history.setPage({id:s.config.id,name:n,url:a.url,dialog:s,exports:u,param:a.param});var f=loader.map().modules[n]||{};return f.show&&a.life&&f.show({type:"page",target:r}),"function"==typeof i&&i.call(o,u),o.compile({id:s.config.id}),a.opened&&a.opened.call(o,u),!a.openFirst&&s.open(),this}loader.require(n,(function(e){var l=loader.map().modules[n]||{};t.history.setPage({id:s.config.id,name:n,url:a.url,dialog:s,exports:e,param:a.param}),l.show&&a.life&&l.show({type:"page",target:r}),"function"==typeof i&&i.call(o,e),o.compile({id:s.config.id}),a.opened&&a.opened.call(o,e)})),c=!0}function g(e){var t=loader.map().modules,n={},i=e.indexOf(a.pageSuffix);return i>-1?(n.url=e,n.module=e.substr(0,i)):(n.url=t[e]&&t[e].template||e+a.pageSuffix,n.module=e),n}o.init=function(e){var i=n.extend(!0,{},o.config,e);if(i.onClose=function(){t.hasRouter&&i.syncHistory&&bui.back(),h()},u=g(i.url),i.iframe){var a=t.platform.isIos()?'scrolling="no"':"";return i.content=`<iframe class="bui-router-iframe" src="${i.url}" ${a} ></iframe>`,s.create(i),i.autoload&&s.open(),i.loaded&&i.loaded.call(o,u),o}if(i.script){var c=i.script.indexOf(".js");u.module=i.script.substr(0,c)}return!1===(i.beforeLoad&&i.beforeLoad.call(o,u))?this:(loader.import(u.url,(function(e){"object"!=typeof e?(l=f(e,i),i.id?(s.init(i),r(i.id).html(e)):(i.content=e,s=s.create(i)),i.autoload&&o.open(),i.loaded&&i.loaded.call(o,u)):i.onError&&i.onError.call(o,e)})),o)},o.compile=function(e){var t=n.extend(!0,{id:s.config.id,cacheHtml:!1,cache:!1,needComponent:a.needComponent,needView:a.needView},e);t.needView&&loader.views(t),t.needComponent&&loader.components(t)},o.reload=function(e){var t=a=n.extend(!0,o.config,a,e);if(d=!0,u=g(t.url),t.script){var i=t.script.indexOf(".js");u.module=t.script.substr(0,i)}if(!1===(t.beforeLoad&&t.beforeLoad.call(o,u)))return this;loader.import(u.url,(function(e){"object"!=typeof e?(l=f(e,t),r("#"+(s.config.id||t.dialogid)).html(l),p(u.module),t.loaded&&t.loaded.call(o,u)):t.onError&&t.onError.call(o,e)}))},o.toggle=function(e,t){return o.isOpen()?o.close(t):o.open(e),o},o.isOpen=s.isOpen,o.close=function(e){return!1===(i.beforeClose&&a.beforeClose.call(o))?this:(t.hasRouter&&a.syncHistory&&t.history.removeLast(a.syncHistory),a.closeFirst?(s.close((function(){o.trigger("close"),h(e)})),o):(h(e),s.close(),o.trigger("close"),o))},o.remove=function(e){return s.remove(e),o.trigger("remove"),o},o.open=function(e){if(!1===(a.beforeOpen&&a.beforeOpen.call(o)))return this;if(a.iframe)return s.open(e),o;var n={hide:o.close,show:o.open};return t.hasRouter&&a.syncHistory&&t.history.add({id:s.config.id,name:u.module,url:a.url,replace:!1,param:a.param||{},part:{},page:{},effect:"push",toggle:n,syncHistory:a.syncHistory}),loader.map({moduleName:u.module,id:s.config.id}),t.history.getLast().currentPage=s.config.id,a.openFirst?(s.open((function(){o.trigger("open"),p(u.module,e)})),o):(p(u.module,e),s.open(),o.trigger("open"),o)},o.setParam=function(e){var i=n.extend(!0,{},a.param,e);t.history.setPage({id:s.config.id,param:i})},o.init(a)}})}(window.bui||{},window.libs)}));!function(e,t){e.setUrlParams=function(t,n,i){i=0!=i,n="object"==typeof n?n:{};var o=e.unit.objectToKeyString(n,i);return""==o?t:t+"?"+o},e.getUrlParams=function(t){t=0!=t;var n=window.location.href,i=n.indexOf("?"),o={};if(i>-1){var a=n.substr(i+1);o=e.unit.keyStringToObject(a,t)}return o},e.getUrlParam=function(e){var t=window.location.href,n=new RegExp("(^|&|.)"+e+"=([^&]*)(&|$)","i"),i=t.substr(1).match(n);return null!=i?decodeURIComponent(i[2]):null},e.typeof=function(e){var t=Object.prototype.toString.call(e).slice(8,-1);return t=t.toLowerCase()},e.setting=function(t,n){return"string"==typeof t&&"object"==typeof n?e.config[t]=n:"string"==typeof t&&void 0===n?e.config[t]:e.config}}(window.bui||{}),function(e,t){e.array={},e.array.index=e.inArray=function(e,t,n){var i,o;e instanceof Array?(i=e||[],o=t):(i=t||[],o=e);for(var a=0;a<i.length;a++){var r=i[a];if((r&&r[n]||r)===o)return parseInt(a)}return-1},e.array.compare=e.compareArray=function(e,t,n){var i,o;e instanceof Array?(i=e||[],o=t):(i=t||[],o=e);for(var a=0;a<i.length;a++){var r=i[a];if((r&&r[n]||r)===o)return!0}return!1},e.array.remove=e.removeArray=function(t,n,i){var o,a;return t instanceof Array?(o=t||[],a=n):(o=n||[],a=t||[]),e.array.delete(o,a,i),o},e.array.filter=e.filterArray=function(t,n,i){var o,a;t instanceof Array?(o=t||[],a=n):(o=n||[],a=t);var r=[];for(var l in o)try{var c=o[l]&&o[l][i]||o[l];new RegExp(a).test(c)&&r.push(o[l])}catch(t){e.showLog(t)}return r},e.array.indexs=e.indexArray=function(e,t,n){var i,o;e instanceof Array?(i=e||[],o=t):(i=t||[],o=e);var a=[];for(var r in i){(i[r]&&i[r][n]||i[r])===o&&a.push(+r)}return a},e.array.excess=e.excessArray=function(e,t,n){var i;i=e instanceof Array?e||[]:t||[];var o={},a=[];for(var r in i)try{var l=i[r]&&i[r][n]||i[r];o[l]!==l&&(o[l]=l,a.push(i[r]))}catch(e){}return a},e.array.uniq=function(t,n){var i=[];for(let o=0;o<t.length;o++){let a=void 0===n,r=t[o],l=a?r:r[n]||r;e.array.index(i,l,n)<0&&i.push(r)}return i},e.array.copy=e.copyArray=function(t,n,i){var o=[];if(n=n||0,i=i||t&&t.length,!t||"array"===e.typeof(t))return t.forEach((function(e,t){o.push(e)})),o.splice(n,i)||[]},e.array.empty=function(t){if(!t||"array"===e.typeof(t))return t.splice(0,t.length)},e.array.replace=function(t,n){if(!(t&&"array"!==e.typeof(t)||n&&"array"!==e.typeof(n))){var i=[0,t.length].concat(n);return t.splice.apply(t,i)}},e.array.merge=function(t){if(!t||"array"===e.typeof(t)){var n=arguments,i=n.length-1,o=n[i],a="string"==typeof o;if(a&&n.length>1){let a=i,r=[];for(let e=0;e<a;e++){let i=Array.prototype.slice.call(n[e],0);t.forEach((function(e,t){let n=e[o]||e;i instanceof Array&&i.forEach((function(t,a){let r=t[o]||t;if(n===r){for(let n in t)e[n]=t[n];i.splice(a,1)}}))})),r.push(i)}return e.array.merge(t,...r)}var r=[t.length,0].concat(...Array.prototype.slice.call(arguments,1));return t.splice.apply(t,r),t}},e.array.get=function(t,n,i){if(!t||"array"===e.typeof(t)){for(var o,a=null,r=0;r<t.length;r++){((a=t[r])&&a[i]||a)===n&&(o=a)}return o}},e.array.getAll=function(e,t,n){e=e||[];var i=[],o=null;for(var a in e)try{var r=(o=e[a])&&o[n]||o;t&&t instanceof Array?t.forEach((function(e,t){r===e&&i.push(o)})):r===t&&i.push(o)}catch(e){}return i},e.array.set=function(t,n,i,o){if(!t||"array"===e.typeof(t)){var a=/\d/.test(n)&&"number"==typeof n;if(a&&i)return t.splice(n,1,i),t;for(let r=0;r<t.length;r++){let l=t[r],c=void 0===o?l:l[o]||l;if(a?r===n:c===n){if(o){if(i&&"object"===e.typeof(i))for(let e in i)l[e]=i[e];else l[o]=i;t.splice(r,1,l)}else t.splice(r,1,i);return t}}return t}},e.array.setAll=function(t,n,i,o){if(!t||"array"===e.typeof(t))return t.filter((function(a,r){let l=void 0===o?a:a[o]||a;if(r==n||l===n)if(o){if(i&&"object"===e.typeof(i))for(let e in i)a[e]=i[e];else a[o]=i;t.splice(r,1,a)}else t.splice(r,1,i)})),t},e.array.delete=function(t,n,i){if(!t||"array"===e.typeof(t)){var o=[],a=e.array.copy(t);return n&&"array"===e.typeof(n)?n.forEach((function(e,t){r(void 0!==i&&e[i]||e)})):r(n),o}function r(e){var n=0;for(let r=0;r<a.length;r++){let l=r-n,c=t.length!==a.length,s=c?t[l]||{}:t[r]||{};if((void 0!==i?s[i]:s)===e)return c?t.splice(l,1):t.splice(r,1),o.push(r),void++n}}},e.array.deleteIndex=function(t,n){if(!t||"array"===e.typeof(t)){var i=[];return n&&"array"===e.typeof(n)?n.forEach((function(n,o){i.push(t[n]),e.array.remove(t,t[n])})):(i.push(t[n]),e.array.remove(t,t[n])),i}}}(window.bui||{}),function(e,t){e.storage=function(t){var n=1,i=!0,o="",a=!1,r=!0;"number"==typeof t||"string"==typeof t?n=0==parseInt(t)?0:parseInt(t)||1:"object"==typeof t&&(n=t&&0==t.size?0:t.size||1,r=!t||0!=t.local,i=!t||0!=t.reverse,a=!(!t||1!=t.deep),o=t.prefix||"");var l=i?"push":"unshift",c=r?localStorage:sessionStorage;function s(t,n,i){t=o+t;var r,l=c.getItem(t)||"";try{r=a?l&&e.unit.stringToJson(l):l&&JSON.parse(l)}catch(t){r=l,e.showLog(t.name+": "+t.message,"bui.storage.get")}if("number"==typeof n&&i)r=r&&r[n]&&r[n][i]||void 0;else if("string"==typeof n){var s=e.array.index(r,n,i);r=r&&r[s]}else r="number"==typeof n?r&&r[n]||void 0:r;return r}return{get:s,getAll:function(e){for(var t={},n=parseInt(e)||0,i=0;i<localStorage.length;i++){var a=localStorage.key(i);a.substr(o.length);if(o&&0===a.indexOf(o))try{var r=JSON.parse(c.getItem(a));t[a]=void 0!==e?r[n]:r}catch(e){t[a]=c.getItem(a)}if(""===o)try{t[a]=JSON.parse(c.getItem(a))}catch(e){t[a]=c.getItem(a)}}return t},set:function(t,i,a){t=o+t;var r=1==n?null:c.getItem(t),s=[],u="",d=a?i[a]:i;if(null===r){s.push(i),u=JSON.stringify(s);try{c.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{var f=JSON.parse(r);if(e.array.compare(f,d,a)){e.array.remove(f,d,a),f[l](i);try{u=JSON.stringify(f),c.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}else{f[l](i),f.length>n&&0!=n&&("unshift"==l?f.pop():f.shift());try{u=JSON.stringify(f),c.setItem(t,u)}catch(e){"QuotaExceededError"==e.name&&console.log("超出本地存储限额！")}}}return this},remove:function(t,n,i){if("string"==typeof(t=o+t)){var a=s(t)||[];if("number"==typeof n){var r="number"==typeof i?i:r;a.splice(n,r);try{var l=JSON.stringify(a)||"";c.setItem(t,l)}catch(t){e.showLog(t.name+": "+t.message,"bui.storage.remove")}}else if("string"==typeof n){var u=e.array.remove(a,n,i);try{l=JSON.stringify(u)||"";c.setItem(t,l)}catch(t){e.showLog(t.name+": "+t.message,"bui.storage.remove")}}else c.removeItem(t);return this}e.showLog("要删除的字段名只能是字符串","bui.storage.remove")},clear:function(){if(o)for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);0===t.indexOf(o)&&c.removeItem(t)}else c.clear();return this}}}}(window.bui||{}),function(e,t){var n;e.platform=(n=navigator.userAgent,{isAndroid:function(e){return/(Android|Linux)/i.test(n)},isIphone:function(e){return/(iPhone)/i.test(n)},isIpad:function(e){return/(iPad)/i.test(n)},isIos:function(e){return/(iPhone|iPad|iOS)/i.test(n)},isWeiXin:function(e){return/(micromessenger)/i.test(n)},isBingotouch:function(e){return/(crosswalk)/i.test(n)},isMac:function(){return/Macintosh/i.test(n)},isIphoneX:function(e){var t=!1,n=3==window.devicePixelRatio&&375==window.screen.width&&812==window.screen.height,i=2==window.devicePixelRatio&&414==window.screen.width&&896==window.screen.height,o=3==window.devicePixelRatio&&414==window.screen.width&&896==window.screen.height;return(n||i||o)&&(t=!0),t},isWindow:function(e){return/Windows NT/i.test(n)}})}(window.bui||{}),function(e,t){e.date={},e.date.format=function(e,t){if(null==e)return"";var n=this.convert(e);t=t||"yyyy-MM-dd";var i={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};for(var o in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[o]:("00"+i[o]).substr((""+i[o]).length)));return t},e.date.convert=function(e,t){if(e&&e.constructor==Date)return e;if("number"==typeof e&&13===String(e).length)return new Date(e);e=String(e);var n=new Date,i=n.getFullYear(),o=n.getMonth()+1,a=n.getDate();if((e=e.replace(/[-|年|月]/gim,"/").replace(/[时|分|秒|小时|分钟]/gim,":").replace(/^(\d{4}\/\d+?)($|\s)/,(function(e,t){return t+"/1"})).replace(/[日|号]/gim,"").replace(/^(\d{1,2}\/\d{1,2}?)($|\s)/,(function(e,t){return n.getFullYear()+"/"+t}))).indexOf("T")>-1&&-1==e.indexOf("GMT")){var r=(e=e.replace("T"," ")).indexOf(".")>-1?e.split("."):[e];return new Date(r[0])}if(e.indexOf("GMT")>-1){var l=(r=e.split(" "))[3]+"/"+{Jan:"1",Feb:"2",Mar:"3",Apr:"4",May:"5",Jun:"6",Jul:"7",Aug:"8",Sep:"9",Oct:"10",Nov:"11",Dec:"12"}[r[1]]+"/"+r[2]+" "+r[4];return new Date(l)}return e.indexOf("/")<0&&e.indexOf(":")>-1&&(e=i+"/"+o+"/"+a+" "+e),4===e.length?e+="/1/1 00:00:00":"MM"===t||"M"===t?e=i+"/"+e+"/1 00:00:00":"dd"!==t&&"d"!==t||(e=i+"/"+o+"/"+e+" 00:00:00"),new Date(e)},e.date.after=function(e,t,n){t=0===t?0:t||1;var i=this.convert(e).getTime()+1e3*parseInt(t)*3600*24;return this.format(i,n||"yyyy-MM-dd")},e.date.afterTime=function(e,t,n){var i=0===t?0:t||30,o=this.format(new Date,"yyyy/MM/dd")+" "+e,a=new Date(o).getTime()+1e3*i*60;return this.format(a,n||"hh:mm")},e.date.count=function(t,n,i){var o,a;switch(i){case"number":o=t,a=n;break;case"hour":let e=this.format(new Date,"yyyy/MM/dd"),i=e+" "+t,r=this.convert(i),l=e+" "+n,c=this.convert(l);o=r.getTime(),a=c.getTime();break;case"date":default:o=this.convert(t).getTime(),a=this.convert(n).getTime()}var r=o-a;r=Math.abs(r);var l=parseInt(r/1e3/3600/24,10),c=parseInt(r/1e3/3600%24,10),s=parseInt(r/1e3/60%60,10),u=parseInt(r/1e3%60,10);return{value:r,day:l,hour:c,minute:s,second:u,tip:`${l}天 ${e.unit.fixZero(c)}:${e.unit.fixZero(s)}:${e.unit.fixZero(u)}`}},e.date.countMonth=function(e){var t=this.convert(e),n=t.getMonth()+1;return t.setMonth(n),t.setDate(0),t.getDate()},e.date.toWeek=function(e,t){var n=this.convert(e),i=null;switch(t){case 1:i=["周日","周一","周二","周三","周四","周五","周六"];break;default:i=t||["星期天","星期一","星期二","星期三","星期四","星期五","星期六"]}return i[n.getDay()]},e.date.today=function(e){return e=e||"M-d",this.format(new Date,e)},e.date.fromnow=function(e){var t=+new Date,n=this.convert(e).getTime(),i="",o=this.count(t,n,"date"),a=t>n?"前":"后";return o.day?i=o.day+"天"+a:o.hour?i=o.hour+"小时"+a:o.minute?i=o.minute+"分钟"+a:o.second&&(i=o.second+"秒"+a),i}}(window.bui||{}),function(e,t){e.animate=function(n){if("object"==typeof n&&n.id)n=n||{};else{var i=n||"";(n={}).id=i}var o,a,r,l,c={origin:function(e){var t=String(e);return o.css({"-webkit-transform-origin":t,"transform-origin":t}),this},transition:p,property:function(e,t){var n={};"object"==typeof e?(n=e,t=""):"string"==typeof e&&(n[e]=t||"");return o.css(n),this},open3D:function(e){return e=parseFloat(e)||100,a=!0,o.parent().css({perspective:e+"px"}),this},transform:function(e,t){o.css({"-webkit-transform":e,transform:e}),t&&"none"!=p&&o.one("webkitTransitionEnd",(function(){t.call(c,this)}));return this},start:function(e){var t=a?u.join("")+"translateZ(0)":u.join("");try{d[m]=[],d[m].push(l.join("")),l=[],m++}catch(e){}o.css({"-webkit-transform":t,transform:t}),"none"!=f?o.one("webkitTransitionEnd",(function(){e&&e.call(c,this)})):e&&e.call(c,this);return this},stop:function(e){o.css({"-webkit-transform":"",transform:""}),"none"!=f&&o.one("webkitTransitionEnd",(function(){e&&e.call(c,this)}));return g(),this},clear:g,left:function(e){e=e;var t=Math.abs(parseFloat(e));e="string"==typeof e&&e.indexOf("%")>-1?"-"+e:r?-t/100+"rem":-t+"px";var n="translateX("+e+")";return l.push(n),u.push(n),this},right:function(e){e=e;var t=Math.abs(parseFloat(e));e="string"==typeof e&&e.indexOf("%")>-1?e:r?t/100+"rem":t+"px";var n="translateX("+e+")";return l.push(n),u.push(n),this},up:function(e){e=e;var t=Math.abs(parseFloat(e));e="string"==typeof e&&e.indexOf("%")>-1?"-"+e:r?-t/100+"rem":-t+"px";var n="translateY("+e+")";return l.push(n),u.push(n),this},down:function(e){e=e;var t=Math.abs(parseFloat(e));e="string"==typeof e&&e.indexOf("%")>-1?e:r?t/100+"rem":t+"px";var n="translateY("+e+")";return l.push(n),u.push(n),this},scale:function(e){var t=String(e),n="scale("+(e=t.indexOf(",")>-1?t:e+",1")+")";return l.push(n),u.push(n),this},scaleX:function(e){var t="scaleX("+(e=String(e))+")";return l.push(t),u.push(t),this},scaleY:function(e){var t="scaleY("+(e=String(e))+")";return l.push(t),u.push(t),this},rotate:function(e){var t=String(e),n="rotate("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},rotateX:function(e){var t=String(e),n="rotateX("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},rotateY:function(e){var t=String(e),n="rotateY("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},skew:function(e){var n=String(e),i=[];n.indexOf(",")>-1?(i=n.split(","),e="",t.each(i,(function(t,n){t<2&&(e+=n.indexOf("deg")>-1?","+n:","+n+"deg")})),e=e.substr(1)):e=n.indexOf("deg")>-1?n:n+"deg,0";var o="skew("+e+")";return l.push(o),u.push(o),this},skewX:function(e){var t=String(e),n="skewX("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},skewY:function(e){var t=String(e),n="skewY("+(e=t.indexOf("deg")>-1?t:t+"deg")+")";return l.push(n),u.push(n),this},reverse:function(e){var t,n=0,i=d.reverse();return function e(r){var l=r[n]||[],c=r[n+1]||[];t=a?l.join("")+"translateZ(0)":l.join(""),t=u.join("")+t.replace(/\(.*?\)/g,"(0)"),o.css({"-webkit-transform":"",transform:""}),n++;try{o.one("webkitTransitionEnd",(function(){if(!c||!c.length)return n=0,void(historyCache=[]);e(i)}))}catch(e){}}(i),this},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:h},s=c.config=t.extend(!0,{},{id:"",zoom:!0,open3D:!1,animates:[]},n),u=[],d=[],f="all 300ms ease-out";function h(t){if(t.id)return(o=e.objId(t.id)).css({"-webkit-transition":f,transition:f}),a=t.open3D,r=t.zoom,l=t.animates||[],s=c.config=t,this;e.showLog("animate id不能为空","bui.animate")}function p(e,t){var n=t||"ease-out";return f="number"==typeof e?"all "+e+"ms "+n:0==e||"none"==e?"none":1==e?"all 300ms "+n:e||"all 300ms "+n,o.css({"-webkit-transition":f,transition:f}),this}function g(){return l=[],u=[],d=[],m=0,this}h(s);var m=0;return c}}(window.bui||{},window.libs),function(e,t){e.mask=function(n){var i,o,a={id:"",appendTo:"",className:"",opacity:.3,background:"",zIndex:100,autoTrigger:!1,autoClose:!1,onBeforeInit:null,onInited:null,callback:null},r={name:"mask",handle:{},on:function(t,n){return e.on.apply(r,arguments),this},off:y,hide:b,show:function(t){if(p)return;(d=e.objId(s))&&d.length?(d.css("display","block"),!h&&u.css("position","relative"),o=!0):m(l);return w.call(r,"show"),this},isShow:function(){return o},remove:v,destroy:function(e){v(),u&&u.off("click.mask");y("show"),y("hide"),p=!0},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(r,t,n)},config:l,init:g},l=r.config=t.extend(!0,{},a,e.config.mask,n),c=e.guid(),s=l.id?l.id.indexOf("#")>-1?l.id.substring(1):l.id:c,u=(t("body"),e.objId(l.appendTo)),d=null,f=!1,h=!1,p=!1;function g(n){p=!1;var o=t.extend(!0,a,l,n);return o.onBeforeInit&&o.onBeforeInit.call(r,o),o.appendTo=o.appendTo||"body",u=e.objId(o.appendTo),h=u[0]&&"COMPONENT"===u[0].tagName,l=r.config=o,i=u.css("position"),o.autoTrigger&&m(o),d=e.objId(o.id),o.onInited&&o.onInited.call(r,o),this}function m(n){if(!p){var i=t.extend(!0,{},a,l,n),c=function(t){var n=t.background?t.background:"rgba(0,0,0,"+t.opacity+")",i="";return i+'<div id="'+s+'" class="'+e.prefix("mask")+" "+t.className+'" style="background:'+n+";z-index:"+t.zIndex+'"></div>'}(i);return(d=e.objId(s))&&d.length?d.css("display","block"):(u.append(c),!h&&u.css("position","relative"),d=e.objId(s)),o=!0,w.call(r,"show"),f||function(e){d.off("click.bui").on("click.bui",(function(t){e.callback&&e.callback.call(r,t),e.autoClose&&b(),t.stopPropagation()})),f=!0}(i),this}}function v(){if(!p)return d&&d.remove(),d=null,u.css("position",i||"static"),o=!1,f=!1,w.call(r,"hide"),this}function b(){if(!p)return d&&d.css("display","none"),!h&&u.css("position","relative"),o=!1,w.call(r,"hide"),this}function y(t,n){return e.off.apply(r,arguments),this}function w(t){r.self=this==window||this==r?null:this,e.trigger.apply(r,arguments)}return g(l),r}}(window.bui||{},window.libs),function(e,t){e.loading=function(n){var i,o={name:"loading",handle:{},on:function(t,n){return e.on.apply(o,arguments),this},off:k,start:b,stop:w,isLoading:function(){return f},pause:function(){if(d)return;return s&&s.addClass("bui-loading-pause"),I.call(this,"pause"),this},text:y,showRing:function(){if(d)return;return s=e.objId(l),s.children(".bui-loading-cell").css("display","inline-block"),s.removeClass("bui-loading-pause"),this},hideRing:function(){if(d)return;return s=e.objId(l),s.children(".bui-loading-cell").css("display","none"),s.addClass("bui-loading-pause"),this},show:function(n){var i=n||{};if(d)return;var o=t.extend(!0,a,i);(s=e.objId(o.id))&&s.length?(y(o.text),s[0].style.display="-webkit-box",m&&m.show(),I.call(this,"show")):b(o);a.timeout&&(h&&clearTimeout(h),h=setTimeout((function(e){x()}),a.timeout));return f=!0,this},hide:x,destroy:function(e){e=1==e;w(),r&&r.off("click.bui");k("show"),k("hide"),k("start"),k("stop"),k("pause"),k("remove"),m&&m.destroy(e),d=!0},widget:function(t){var n={mask:m||{}};return e.widget.call(n,t)},option:function(t,n){return e.option.call(o,t,n)},config:a,init:v},a=o.config=t.extend(!0,{},{appendTo:"",width:30,height:30,text:"",onlyText:!1,mask:!0,zIndex:"",autoTrigger:!1,autoClose:!0,timeout:0,opacity:0,display:"block",template:null,onBeforeInit:null,onInited:null,callback:null},e.config.loading,n),r=(t("body"),null),l=e.guid(),c=l+"-mask",s=e.objId(l),u=!1,d=!1,f=!1,h=null;a.id=l;var p=a.callback;a.callback=function(e){a.autoClose&&w(),p&&p.call(o,e)};var g=t.extend(!0,{},a,{id:c}),m=a.mask?e.mask(g):null;function v(i){d=!1;var c=t.extend(!0,{},a,i);return c.onBeforeInit&&c.onBeforeInit.call(o,n),c.appendTo=c.appendTo||"body",r=t(c.appendTo),a=o.config=c,c.autoTrigger&&s.length<1&&b(c),s=e.objId(l),c.onInited&&c.onInited.call(o,c),this}function b(n){if(!d){var i=t.extend(!0,{},a,n);if(s=e.objId(l),s.children(".bui-loading-cell"),s.hasClass("bui-loading-pause"))s.removeClass("bui-loading-pause"),I.call(this,"start");else{s.length&&s.remove();var c=function(t){var n=(t=t||{}).text,i=r.width()||document.documentElement.clientWidth,a=n&&"block"==t.display?parseInt(t.height)+30:parseInt(t.height),c=-i/2,s=-a/2,u="block"==t.display?e.prefix("loading-block"):e.prefix("loading-inline"),d="";return d+='<div id="'+l+'" class="'+e.prefix("loading")+" "+u+'" style="width:'+i+"px;height:"+a+"px;line-height:"+a+"px;margin-left:"+c+"px;margin-top:"+s+"px;"+(t.zIndex?"z-index:"+t.zIndex:"")+'" >',t.onlyText||(d+='<div class="'+e.prefix("loading-cell")+'" style="width:'+parseFloat(t.width)+"px;height:"+parseFloat(t.height)+'px;"></div>'),d+='<div class="'+e.prefix("loading-text")+'">'+t.text+"</div>",d+="</div>",t&&t.template?t.template.call(o,t):d}(i);r.append(c),m&&m.show(),I.call(this,"show")}return i.timeout&&(h&&clearTimeout(h),h=setTimeout((function(){w()}),i.timeout)),u||function(e){var t=e||a;r.off("click.bui","#"+l).on("click.bui","#"+l,(function(e){t.callback&&t.callback.call(o,e),e.stopPropagation()})),u=!0}(i),f=!0,this}}function y(t){if(!d)return s=e.objId(l),i=s.children(".bui-loading-text"),void 0===t?i&&i.text():(i&&i.html(t),this)}function w(){if(!d)return(s=e.objId(l))&&s.remove(),s=null,m&&m.remove(),u=!1,f=!1,I.call(this,"remove"),I.call(this,"hide"),this}function x(){if(!d)return s=e.objId(l),(a.appendTo||s&&s.length)&&(s.css("display","none"),m&&m.hide()),f=!1,I.call(this,"hide"),this}function k(t,n){return e.off.apply(o,arguments),this}function I(t){o.self=this==window||this==o?null:this,e.trigger.apply(o,arguments)}return v(a),o}}(window.bui||{},window.libs),function(e,t){e.slide=function(n){var i,o,a,r,l,c,s,u,d,f,h,p,g,m,v,b,y,w,x,k,I,T,O,C,S,L,j,P={name:"slide",handle:{},on:ve,off:be,to:ae,load:function(n){var i=t.extend(!0,{},{id:null,url:"",preload:!1,param:{},success:null,fail:null},n),o=i.url||"",a=null,u=c.length?$+1:0;if(i.id)a=e.obj(i.id);else{var d=c.eq(u);d.length?a=d:(!function(t){var n,i=e.guid(),o=(t=t||1,"");for(n=0;n<t;n++)o+='<li id="'+i+'" style="-webkit-box-flex:1;box-flex:1;width:'+g+"px;height:"+b+'px;"></li>';r.append(o),c=r.children();var a=g*c.length;s=c.length,l.width(a)}(),c=r.children(),a=c.eq(u))}if(o)if($=u,A[u]=i.param,o in B){var f="cache";e.array.compare(D,u)||(D.push(u),a.html(B[o]),i.success&&i.success.call(P,B[o],f),ye.call(P,"load",B[o],f)),i.preload||ae(u)}else loader.importHtml(o,(function(t,n){t?(B[o]=t,e.array.compare(D,u)||(D.push(u),a.html(B[o]),i.success&&i.success.call(P,B[o],n),ye.call(P,"load",t,n)),i.preload||ae(u)):(i.fail&&i.fail.call(a,t,n),ye.call(P,"loadfail",t,n))}),(function(e,t){i.fail&&i.fail.call(P,e,t),ye.call(P,"loadfail",e,t)}));return this},resize:function(e){var i=t.extend(!0,{},n,e);return J(i),X(i),ae($,"none"),this},getPageParams:function(e){return A[e="number"==typeof e?e:$]||{}},getPages:Z,$active:ge,currentMain:ge,currentMenu:function(e){var t=void 0===e?$:e;return a.eq(t)[0]},prev:ce,next:se,stop:le,start:function(e){re(e)},lock:fe,index:function(){return E.loop?$-1:$},unlock:he,destroy:function(e){e=1==e;le(),o&&(o.off("click.bui"),e&&o.remove());i&&(i.off(),e&&i.remove());be("stop"),be("play"),be("first"),be("last"),be("to")},widget:function(t){var n={loading:R};return e.widget.call(n,t)},option:function(t,n){return e.option.call(P,t,n)},config:E,init:K},E=P.config=t.extend(!0,{},{id:"",menu:".bui-slide-head > ul",children:".bui-slide-main > ul",main:".bui-slide-main",header:"header",footer:"footer",item:"li",prev:".bui-slide-prev",next:".bui-slide-next",alignClassName:"",alignPage:"center",stopHandle:"",width:0,height:0,data:null,zoom:!0,transition:200,interval:5e3,relative:!1,swipe:!0,animate:!0,delay:!1,bufferEffect:!0,visibleNum:1,scrollNum:1,distance:40,direction:"x",autoplay:!1,loop:!1,cross:!1,autoheight:!1,autoinit:!0,scroll:!1,index:0,fullscreen:!1,autopage:!1,autoload:!1,needLoading:!1,async:!0,template:null,callback:null,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeTo:null,onBeforeInit:null,onInited:null,onStart:null,onMove:null,onEnd:null},e.config.slide,n),N={},$=0,F=!1,B={},R=null,D=[],A=[],M=!1,H={x:{},y:{}},z=/hp-tablet/gi.test(navigator.appVersion),V="ontouchstart"in window&&!z,q="",U=0,_=0,W=!1,Y=!1;N={x1:0,x2:0,y1:0,y2:0,direction:""};try{E.autoinit&&K(E)}catch(t){e.showLog(t)}function K(n){var s=t.extend(!1,E,n);if(!1===(s.onBeforeInit&&s.onBeforeInit.call(P,s)))return this;if(s.id){if(i=e.obj(s.id),s.relative){var u=i.parent().width();s.width=u}if(E=P.config=s,q=s.direction,"function"==typeof s.template)i.html(s.template.call(P,s.data||[])||"");else if(s.data&&!s.template){if(i.find(s.main).length<=0){var d=function(e){return`<div class="${e.main.substr(1)}">\n              <ul class="bui-slide-main-ul">\n              </ul>\n            </div>`}(s);i.html(d)}var f=i.find(s.children),h=me.call(P,s.data);f.html(h)}if(s.needLoading&&(R=bui.loading({appendTo:i})),o=0==s.menu.indexOf("#")?e.obj(s.menu):i.find(s.menu).eq(0),a=o.children(),r=i.find(s.children).eq(0),l=r.parent(),c=r.children(),C=c.length,s.loop&&c.length){var p=c.eq(c.length-1).clone(!0),g=c.eq(0).clone(!0);r.prepend(p).append(g);var m=(c=r.children()).length-1;be("afterto"),ve("afterto",(function(e){0==e&&ae(m-1,"none"),e==m&&ae(1,"none")})),ae(1,"none"),!i.hasClass(".bui-slide-loop")&&i.addClass("bui-slide-loop")}if(s.cross&&c.length){function v(e){var t=c.eq(e);t.removeClass("bui-cross-prev").removeClass("bui-cross-next"),t.prev().removeClass("bui-cross-next").addClass("bui-cross-prev"),t.next().removeClass("bui-cross-prev").addClass("bui-cross-next")}!i.hasClass(".bui-slide-cross")&&i.addClass("bui-slide-cross"),be("to",v),ve("to",v),s.loop?ae(1,"none"):ae(0,"none")}return J(s),X(s),(O=s.autoplay)&&re(),F||(!function(){var e=function(e){var n=t(this).hasClass("active"),i=t(this).index(),o=t(this).attr("disabled"),a=t(this).hasClass("disabled")||""==o||"true"==o||"disabled"==o;if(e.currentIndex=i,e.prevIndex=$,!1===(E.onBeforeTo&&E.onBeforeTo.call(P,e)))return!1;n||a||(E.animate?ae(i):ae(i,"none"),O&&re()),e.stopPropagation()};0==E.menu.indexOf("#")?o.off("click.bui","li").on("click.bui","li",e):i.off("click.bui",E.menu+" li").on("click.bui",E.menu+" li",e);i.off("click.bui",E.prev).on("click.bui",E.prev,ce),i.off("click.bui",E.next).on("click.bui",E.next,se);var n=E.children+" "+E.item;E.data&&i.off("click.bui",n).on("click.bui",n,(function(e){var n=t(e.currentTarget),i=n.attr("href"),o="true"==n.attr("data-reload"),a="true"==n.attr("data-iframe"),r="true"==n.attr("data-page"),l="true"==n.attr("data-close"),c="true"==n.attr("data-synchistory");i&&r?bui.page({url:i,iframe:a,close:l,synchistory:c}):i&&bui.load({url:i,reload:o,iframe:a}),ye.call(P,"click",e),E.callback&&E.callback.call(P,e,P),e.stopPropagation()})),he(),E.swipe||fe();F=!0}(),M=!0),$=r.children(".active").length?r.children(".active").index():$||s.index,parseInt(s.index)>0?ae(s.index,"none"):ae($,"none"),s.onInited&&s.onInited.call(P,s),this}e.showLog("slide id不能为空","bui.slide.init")}function J(e){k=document.documentElement.clientWidth,I=document.documentElement.clientHeight,e.height=String(e.height).indexOf("%")>-1?parseFloat(e.height)/100*I:parseFloat(e.height),e.width=String(e.width).indexOf("%")>-1?parseFloat(e.width)/100*k:parseFloat(e.width),c=r.children();var t=i.parents(".bui-page"),n=(i.parents("main"),i[0]&&i[0].offsetTop||0),a=t.children(e.header),l=(a[0]&&a[0].offsetHeight,t.children(e.footer)),u=l[0]&&l[0].offsetHeight||0;y=I-(u||0)-n,y=i.parent("main").length?i.parent("main").height():y,w=0==e.height?y:e.height;var m="static"==o.parent().css("position")?o.css("position"):o.parent().css("position");x=i.find(e.menu).length?"absolute"==m||"fixed"==m?w:w-(o[0]&&o[0].offsetHeight||0):w,p=e.fullscreen?I:0==e.height?x:e.height,h=e.fullscreen?k:e.width||k,s=c.length,g="x"==q?h/E.visibleNum:h,b="y"==q?p/E.visibleNum:p,T="y"==E.direction?b*E.scrollNum:g*E.scrollNum,d=h*s/E.visibleNum,f=p*s/E.visibleNum}function X(e){c=r.children(),C=e.loop?c.length-2:c.length,H={x:{swipeDir:"swipeleft",swipeDir2:"swiperight",width:T},y:{swipeDir:"swipeup",swipeDir2:"swipedown",width:T}},l[(S={x:{parentInitKey:"width",parentInitValue:d,boxCss:"display:-webkit-box;display:box;-webkit-box-align: start;-webkit-box-pack: center;width:100%;",boxItemCSS:"-webkit-box-flex:1;box-flex:1;width:"+g+"px;height:"+b+"px;"},y:{parentInitKey:"height",parentInitValue:f,box:"display:-webkit-box;display:box;-webkit-box-align: start;-webkit-box-pack: center;width:100%;-webkit-box-orient: vertical;box-orient: vertical;",boxItemCSS:"-webkit-box-flex:1;box-flex:1;width:"+g+"px;height:"+b+"px;"}})[q].parentInitKey](S[q].parentInitValue);var n,o=c.length;for(n=0;n<o;n++){var s=c[n].getAttribute("data-scroll"),u=null==s?E.scroll:"false"!=s;S[q].boxItemCSS=S[q].boxItemCSS+(u?"overflow:auto;":"overflow:hidden;"),c[n].style.cssText=S[q].boxItemCSS}try{r[0]&&(r[0].style.cssText=S[q].boxCss)}catch(e){console.log("请检查下children参数是否正确.","bui.slide id:"+E.id)}var p="y"==q&&E.visibleNum>1?x/E.visibleNum:x,m=E.zoom?w/100+"rem":w+"px",v=E.zoom?p/100+"rem":p+"px";E.zoom;if(E.fullscreen?(t("main").css({position:"static"}),i.addClass("bui-slide-fullscreen").css({position:"absolute",top:0,left:0,right:0,bottom:0,"z-index":10,overflow:"hidden",width:h,height:I}),c.addClass(E.alignClassName||"bui-box-center").css("height",I)):(i.css({position:"relative",overflow:"hidden",width:h,height:m}),c.addClass(E.alignClassName).height(v)),E.autoheight&&i.addClass("bui-slide-autoheight"),E.autopage){var y=function(e,t){var n,i="",o=(t=t||1,e);for(i+=`<div class="bui-slide-head bui-align-${E.alignPage}">`,i+="<ul >",n=1;n<Number(o)+1;n++)i+="<li "+(n==t?'class="active"':"")+">"+n+"</li>";return i+="</ul >",i+="</div >"}(Z(),r.find(".active").index()+1);i.children(".bui-slide-head").remove(),i.append(y),a=i.find(E.menu).eq(0).children()}}function Z(){var e=C,t=parseInt(e/E.visibleNum),n=parseInt(e/E.scrollNum),i=1==E.visibleNum?t:t+1,o=1==E.scrollNum?n:n+1,a=1==E.scrollNum||E.scrollNum==e?i:o;return a=E.loop?a+2:a}function Q(t){var n=t.originalEvent&&t.originalEvent.targetTouches||t.targetTouches,i=V?n[0]:t;if(N.x1=i.pageX,N.y1=i.pageY,N.direction="",!1===(E.onBeforeTouchstart&&E.onBeforeTouchstart.call(P,t,N)))return!1;E.stopHandle&&e.unit.checkTargetInclude(t.target,E.stopHandle)?W=!1:(L=-$*T,j=-$*T,n.length>1||t.scale&&1!==t.scale?ne("x"==q?L:j):(O&&(le(),O=!0),ye.call(P,"touchstart",t,N),E.onStart&&E.onStart.call(P,t,N,P),W=!0))}function G(n){var i=n.originalEvent&&n.originalEvent.targetTouches||n.targetTouches;if(i.length>1||n.scale&&1!==n.scale)ne("x"==q?L:j);else if(W){var o=V?i[0]:n;if(N.x2=o.pageX,N.y2=o.pageY,!1===(E.onBeforeTouchmove&&E.onBeforeTouchmove.call(P,n,N)))return!1;N.direction||(N.direction=e.swipeDirection(N.x1,N.x2,N.y1,N.y2)),"swipeleft"!==N.direction&&"swiperight"!==N.direction||(n.preventDefault(),n.stopPropagation()),ye.call(P,"touchmove",n,N);try{if("y"==q&&E.scroll){var a=t(n.target).closest(".active"),r=a[0].scrollTop||0,l=a[0].scrollHeight||0,c=a[0].offsetHeight||0;if("swipedown"===N.direction&&r>1)return void(Y=!1);if("swipeup"===N.direction&&l-r-c>=2)return void(Y=!1)}}catch(n){}m=N.x2-N.x1,v=N.y2-N.y1,H.x.move=L+m,H.x.absDelta=Math.abs(m),H.y.move=j+v,H.y.absDelta=Math.abs(v);var s=Z();N.direction!==H[q].swipeDir&&N.direction!==H[q].swipeDir2||(E.delay&&H[q].absDelta>E.distance&&ne(H[q].move,"none"),E.delay||((E.bufferEffect||0==$&&s>1&&("swipeleft"==N.direction||"swipeup"==N.direction)||$==s-1&&s>1&&("swiperight"==N.direction||"swipedown"==N.direction)||$>0&&$<s-1&&s>1)&&ne(H[q].move,"none"),n.preventDefault()),E.onMove&&E.onMove.call(P,n,N,P)),Y=!0}}function ee(e){switch(ye.call(P,"touchend",e,N),N.direction){case"swiperight":case"swipedown":e.currentIndex=$-1;break;case"swipeleft":case"swipeup":e.currentIndex=$+1}if(e.prevIndex=$,!1===(E.onBeforeTouchend&&E.onBeforeTouchend.call(P,e,N)))return!1;if(Y){if(m=N.x2-N.x1,v=N.y2-N.y1,H.x.delta=L,H.x.absDelta=Math.abs(m),H.y.delta=j,H.y.absDelta=Math.abs(v),"x"!=E.direction||"swipeleft"!=N.direction&&"swiperight"!=N.direction){if("y"==E.direction&&("swipeup"==N.direction||"swipedown"==N.direction))t=E.onBeforeTo&&E.onBeforeTo.call(P,e)}else var t=E.onBeforeTo&&E.onBeforeTo.call(P,e);if(!1===t)return ne(H[q].delta),"swipeleft"!=N.direction&&"swiperight"!=N.direction||e.stopPropagation(),U+=N.y2-N.y1,_+=N.x2-N.x1,N.lastX=_,N.lastY=U,N={x1:0,x2:0,y1:0,y2:0,direction:""},W=!1,Y=!1,oe(),!1;H[q].absDelta>E.distance?(te.call(this,e,N,H),E.onEnd&&E.onEnd.call(P,e,N,P)):H[q].absDelta<E.distance&&ne(H[q].delta),O&&re(),"swipeleft"!=N.direction&&"swiperight"!=N.direction||e.stopPropagation(),U+=N.y2-N.y1,_+=N.x2-N.x1,N.lastX=_,N.lastY=U,N={x1:0,x2:0,y1:0,y2:0,direction:""},W=!1,Y=!1,oe()}}function te(e,t,i){var o;if(ue(),$=r.children(".active").index(),t.direction==i[q].swipeDir){var a=c.length,l=a-E.visibleNum,s=a%E.scrollNum!=0?l+1:l/E.scrollNum+1;if($>=s-1)o=$,i[q].delta=-o*i[q].width,ne(i[q].delta),$=o,de(o),ye.call(P,"last",o);else if(o=$+1,i[q].delta=-o*i[q].width,ne(i[q].delta),$=o,de(o),n.autoload)pe($);else{c.eq($);if(n.loop&&$>C)return;ye.call(P,"to",o)}ye.call(P,"next",o)}else if(t.direction==i[q].swipeDir2)if($>0){if(o=$-1,i[q].delta=-o*i[q].width,ne(i[q].delta),$=o,de(o),n.autoload)pe($);else{c.eq($);if(n.loop&&0==$)return;ye.call(P,"to",o)}ye.call(P,"prev",o)}else o=$,i[q].delta=-o*i[q].width,ne(i[q].delta),$=o,de(o),ye.call(P,"first",o)}function ne(e,t){var n=E.transition;t=t||"all "+n+"ms",e=e||0;switch(q){case"x":ie(e+"px",0,t,l);break;case"y":ie(0,e+"px",t,l)}return this}function ie(e,t,n,o){var a=t||0;"y"==q&&E.zoom&&String(t).indexOf("%")<=-1&&(a=parseInt(t)/100+"rem");o=o||i;var r=e=e||0,l=String(e).indexOf("%")>-1?String(e):r,c=String(t).indexOf("%")>-1?String(t):a;n="number"==typeof n?"all "+n+"ms":n||"all 300ms";try{o.css({"-webkit-transition":n,transition:n,"-webkit-transform":"translate("+l+","+c+")",transform:"translate("+l+","+c+")"})}catch(e){console.log(e.message)}}function oe(e){l.one("webkitTransitionEnd",(function(){l.css({"-webkit-transition":"none",transition:"none"}),e&&e.call(P,$),ye.call(P,"afterto",$)}))}function ae(e,i,o){ue();var r=0,l=null;o=0!=o;if("string"==typeof e&&e.indexOf(".html")>-1){var s=[];a.each((function(n,i){var o=t(i).attr("href")||void 0;s[n]=o,o==e&&(r=n)}))}else r=parseInt(e);"function"==typeof i&&(l=i,i="");var u={x:{transform:-r*parseFloat(T)},y:{transform:-r*parseFloat(T)}},d=Z();if(t(".bui-slide-video video").each((function(e,t){this.pause()})),r>=d||r<0)return!1;if(ne(u[q].transform,i),$=r,de(r),O&&re(),n.autoload)pe($);else{c.eq($);if(!o)return;ye.call(P,"to",r)}return oe(l),this}function re(e){e=e||E.interval;le(),O=!0;var t=$;u=setInterval((function(){var e=Z();t>=0&&t<e-1?t+=1:t=0,ae(t)}),e),ye.call(P,"play")}function le(e){if(u)try{window.clearInterval(u),O=!1,ye.call(P,"stop")}catch(e){}return this}function ce(){var e=$-1;return E.loop&&e<1&&(e=parseInt(C/E.scrollNum)),ae(e),ye.call(P,"prev",e),this}function se(){var e=$+1;return E.loop&&e>parseInt(C/E.scrollNum)+1&&(e=1),ae(e),ye.call(P,"next",e),this}function ue(t){o=0==(t=E).menu.indexOf("#")?e.obj(t.menu):i.find(t.menu).eq(0),a=o.children(),r=i.find(t.children).eq(0),l=r.parent(),c=r.children()}function de(e){e=e||0,c.removeClass("active"),c.eq(e).addClass("active"),a.removeClass("active"),a.eq(e).addClass("active")}function fe(){return i.off("touchstart",E.children,Q).off("touchmove",E.children,G).off("touchend",E.children,ee).off("touchcancel"),ye.call(P,"lock"),this}function he(e){return i.on("touchstart",E.children,Q).on("touchmove",E.children,G).on("touchend",E.children,ee).on("touchcancel",(function(){ne("x"==q?L:j)})),ye.call(P,"unlock"),this}function pe(t){var n=c.eq(t),i=a.eq(t).attr("href")||"";if(e.array.compare(D,t))return ye.call(P,"to",t,"200"),!1;E.autoload&&(i?(i=e.unit.resolvePath(i))in B?(n.html(B[i]),D.push(t),!M&&ye.call(P,"load",t,status),!M&&ye.call(P,"to",t,status),M=!1):(B[i]="",R&&R.show(),loader&&loader.import(i,(function(e){B[i]=e,n.html(e),D.push(t),ye.call(P,"load",t,status),!M&&ye.call(P,"to",t,status),M=!1,R&&R.hide()}),(function(e,n){ye.call(P,"loadfail",t,n),R&&R.hide()}))):(!M&&ye.call(P,"to",t),M=!1))}function ge(e){var t=void 0===e?$:e;return c.eq(t)[0]}function me(e){var t="";return(e=e||[]).length&&e.forEach((function(e,n){var i=e.title?`<div class="bui-slide-title">${e.title}</div>`:"",o=e.background?`<div class="bui-slide-img" style="background-image:url(${e.background})"></div>`:`<div class="bui-slide-img"><img src="${e.image}" alt="${e.title||""}"/></div>`,a="";if("video"==e.type||e.video){var r=e.video||{};a=`<div class="bui-slide-video">\n                        <video class="bui-video" src="${e.src||r.src}" width="${e.width||r.width||"100%"}" height="${e.height||r.height||"100%"}" poster="${e.poster||r.poster||""}" ${e.preload||r.preload?"preload":""} ${e.muted||r.muted?"muted":""} ${e.autoplay||r.autoplay?"autoplay":""} ${e.controls||r.controls?"controls":""} ${e.loop||r.loop?"loop":""} ${e.fullscreen||r.fullscreen?"fullscreen":""}></video>\n                        </div>`}t+=`<li data-id="${e.id||""}" href="${e.url||""}" data-reload="${e.reload||!1}" data-iframe="${e.iframe||!1}" data-page="${e.page||!1}" data-close="${e.page||!0}" data-synchistory="${e.synchistory||!1}">\n                  ${a||o}\n                  ${i}\n                  </li>`})),t}function ve(t,n){return e.on.apply(P,arguments),this}function be(t,n){return e.off.apply(P,arguments),this}function ye(t){P.self=this==window||this==P?null:this,e.trigger.apply(P,arguments)}return P}}(window.bui||{},window.libs),function(e,t){var n,i;e.swipe=(n=null,i=null,function(o){var a,r,l,c,s,u,d,f,h,p,g,m,v={name:"swipe",handle:{},active:function(){return n},isActive:function(){return R},on:function(t,n){return e.on.apply(v,arguments),this},off:de,close:function(){if(!B)return le(),this},open:function(e){if(!B){var t=e||{};t.transition=t.transition||b.transition,t.index=t.index||0;var n,i=t.target;switch(z=i,i){case"swiperight":t.target=h.eq(t.index),n=t.target.parent().index(),t.handle=x?a.children().eq(n).children(b.handle):r,F=t.handle,t.target,c=h.attr("data-moving")||m,I&&ee(t);break;case"swipeleft":t.target=f.eq(t.index),n=t.target.parent().index(),t.handle=x?a.children().eq(n).children(b.handle):r,F=t.handle,t.target,c=f.attr("data-moving")||m,T&&G(t);break;case"swipedown":t.target=g.eq(t.index),n=t.target.parent().index(),t.handle=x?a.children().eq(n).children(b.handle):r,F=t.handle,t.target,c=g.attr("data-moving")||m,C&&ne(t);break;case"swipeup":t.target=p.eq(t.index),n=t.target.parent().index(),t.handle=x?a.children().eq(n).children(b.handle):r,F=t.handle,t.target,c=p.attr("data-moving")||m,O&&te(t);break;default:t.target=h.eq(t.index),n=t.target.parent().index(),t.handle=x?a.children().eq(n).children(b.handle):r,F=t.handle,t.target,I&&ee(t)}return fe.call(v,"open",i),this}},destroy:function(e){e=1==e,a&&(a.off(),e&&a.remove()),de("open"),de("close"),B=!0},lock:ue,unlock:function(){if(!B)return a.on("touchmove",J).on("touchend",X).on("touchcancel",(function(){})),fe.call(v,"unlock"),this},init:U},b=v.config=t.extend(!0,{},{id:"",handle:".handle",swiperight:".swiperight",swipeleft:".swipeleft",swipeup:".swipeup",swipedown:".swipedown",direction:"x",stopHandle:"",hasChild:!1,handleMove:!0,targetMove:!0,alwaysTrigger:!1,width:0,height:0,movingDistance:280,initDistance:0,zoom:!1,distance:40,autoinit:!0,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onInited:null,transition:300},e.config.swipe,o),y={},w=b.direction,x=b.hasChild,k=!1,I=!1,T=!1,O=!1,C=!1,S=!1,L=!1,j=!1,P=!1,E=b.handleMove,N=b.targetMove,$=!1,F=null,B=!1,R=!1,D=/hp-tablet/gi.test(navigator.appVersion),A="ontouchstart"in window&&!D,M=!1,H=!1,z=(y={x1:0,x2:0,y1:0,y2:0,direction:"",deltax:0,movingleft:0,movingright:0,movingup:0,movingdown:0,scrollObj:null},""),V=b.initDistance,q=document.documentElement;function U(i){var o=t.extend(!0,b,i);if(o.onBeforeInit&&o.onBeforeInit.call(v,o),B=!1,o.id)return a=e.obj(o.id),s=o.width>0?o.width:q.clientWidth,u=o.height>0?o.height:q.clientHeight,r=a.children(o.handle),l=x?a.children():a,f=l.children(o.swipeleft),h=l.children(o.swiperight),p=l.children(o.swipeup),g=l.children(o.swipedown),m=parseFloat(o.movingDistance),c=m,Y(),k||(_(),k=!0),n&&n.close(),$||(ue(),a.on("touchstart",K).on("touchmove",J).on("touchend",X).on("touchcancel",(function(){})),$=!0),o.onInited&&o.onInited.call(v,o),this;e.showLog("swipe id不能为空","bui.swipe.init")}function _(e){l.css({width:s,position:"relative",overflow:"hidden"}),!x&&l.css({height:u}),r.css({position:"relative","z-index":10});try{var t=f.attr("data-moving")||m,n=h.attr("data-moving")||m,i=p.attr("data-moving")||m,o=g.attr("data-moving")||m,a=W(t),c=W(n),d=W(i),v=W(o);T&&f.css({width:a}),I&&h.css({width:c}),C&&g.css({height:v}),O&&p.css({height:d})}catch(e){}}function W(e){return b.zoom?e/100+"rem":e+"px"}function Y(){"x"==w?(I=!!h.length,T=!!f.length):"y"==w?(C=!!g.length,O=!!p.length):"xy"==w&&(C=!!g.length,O=!!p.length,T=!!f.length,I=!!h.length)}function K(n){var i=n.originalEvent&&n.originalEvent.targetTouches||n.targetTouches;if(i.length>1||n.scale&&1!==n.scale)M=!1;else if(b.stopHandle&&e.unit.checkTargetInclude(n.target,b.stopHandle))M=!1;else{var o=A?i[0]:n;if(y.id=b.id,y.x1=o.pageX,y.y1=o.pageY,y.direction="",d=t(n.target).closest(b.handle),!1===(b.onBeforeTouchstart&&b.onBeforeTouchstart.call(v,n,y)))return!1;fe.call(v,"touchstart",n,y);var a=t(n.target).closest(".bui-scroll"),c=t(n.target).closest(".bui-tab-main li.active"),s=t(n.target).closest("main"),u=t(n.target).closest(".swipedown"),k=t(n.target).closest(".swipeup"),S=u.length?u:k.length?k:d;if(y.scrollObj=a.length?a:c.length?c:s.length?s:u.length?u:S,y.scrollObj.scrollTop(),x&&!R&&(l=(r=d).parent(),f=l.children(b.swipeleft),h=l.children(b.swiperight),p=l.children(b.swipeup),g=l.children(b.swipedown),Y(),l.index(),_(),(0==b.height||""==l[0].style.height)&&l.height(d[0]&&d[0].offsetHeight)),y.movingleft=parseInt(f.attr("data-moving")||m),y.movingright=parseInt(h.attr("data-moving")||m),y.movingup=parseInt(p.attr("data-moving")||m),y.movingdown=parseInt(g.attr("data-moving")||m),d.length){var L=!1;switch(w){case"x":L=!(!T&&!I);break;case"y":L=!(!O&&!C);break;case"xy":L=!!(T||I||O||C)}}M=null==L||1==L}}function J(t){var o=t.originalEvent&&t.originalEvent.targetTouches||t.targetTouches;if(o.length>1||t.scale&&1!==t.scale)le();else{var l=A?o[0]:t;if(y.x2=l.pageX,y.y2=l.pageY,!1===(b.onBeforeTouchmove&&b.onBeforeTouchmove.call(v,t,y)))return!1;if(fe.call(v,"touchmove",t,y),n&&t.stopPropagation(),M){var s=y.scrollObj.scrollTop()<=0,u=(y.scrollObj[0]&&y.scrollObj[0].scrollHeight)-(y.scrollObj[0]&&y.scrollObj[0].offsetHeight)-y.scrollObj.scrollTop()<=2,m=y.y2-y.y1>0,w=y.y2-y.y1<0;if(j){if(m&&s)return H=!1,void t.preventDefault();if(w&&u&&t.preventDefault(),w&&!u)return void(H=!1);if(m&&!s)return void(H=!1)}if(C&&!j&&(m&&s&&t.preventDefault(),w&&u&&t.preventDefault()),!C&&m&&s&&t.preventDefault(),P){if(m&&s&&t.preventDefault(),w&&u)return t.preventDefault(),void(H=!1);if(w&&!u)return void(H=!1);if(m&&!s)return void(H=!1)}y.direction||(y.direction=e.swipeDirection(y.x1,y.x2,y.y1,y.y2)),"swipeleft"!==y.direction&&"swiperight"!==y.direction||t.preventDefault();try{if("swipeup"===y.direction||"swipedown"===y.direction){var x=a[0].scrollTop||0,k=(a[0].scrollHeight,d[0].scrollTop,d[0].scrollHeight,y.scrollObj[0]&&y.scrollObj[0].scrollTop||0),$=y.scrollObj[0]&&y.scrollObj[0].offsetHeight||0,F=y.scrollObj[0]&&y.scrollObj[0].scrollHeight||0,B=!1,D=!1;x<=0&&k<=0&&(B=!0),F-k-$<=2&&(D=!0)}}catch(t){}var z="swiperight"==y.direction||"swipeleft"==y.direction?y.x2-y.x1:y.y2-y.y1,q=0;y.deltax=R?Math.abs(z):Math.abs(z)+V,!I||"swiperight"!=y.direction||L||R||i?!B||!C||"swipedown"!=y.direction||j||R||i?!T||"swipeleft"!=y.direction||S||R||i?!D||!O||"swipeup"!=y.direction||P||R||i?"swipeleft"==y.direction&&L?(c=y.movingright,q=Z(y,y.movingright),N&&se(-y.deltax,0,"none",i||h),E&&se(-q,0,"none",r),fe.call(v,"movingleft",t,y),H=!0,t.stopPropagation()):"swipeup"==y.direction&&j?(c=y.movingdown,q=Z(y,y.movingdown),N&&se(0,-y.deltax,"none",i||g),E&&se(0,-q,"none",r),fe.call(v,"movingup",t,y),H=!0,t.preventDefault(),t.stopPropagation()):"swiperight"==y.direction&&S?(c=y.movingleft,q=Z(y,y.movingleft),N&&se(y.deltax,0,"none",i||f),E&&se(q,0,"none",r),fe.call(v,"movingright",t,y),H=!0,t.stopPropagation()):"swipedown"==y.direction&&P&&(c=y.movingup,q=Z(y,y.movingup),N&&se(0,y.deltax,"none",i||p),E&&se(0,q,"none",r),fe.call(v,"movingdown",t,y),H=!0,t.preventDefault(),t.stopPropagation()):(c=y.movingup,q=Q(y,y.movingup),N&&se(0,q,"none",p),E&&se(0,-y.deltax,"none",r),fe.call(v,"movingup",t,y),H=!0,t.preventDefault(),t.stopPropagation()):(c=y.movingleft,q=Q(y,y.movingleft),N&&se(q,0,"none",f),E&&se(-y.deltax,0,"none",r),fe.call(v,"movingleft",t,y),H=!0,t.stopPropagation()):(c=y.movingdown,q=Z(y,y.movingdown),N&&se(0,q,"none",g),E&&se(0,y.deltax,"none",r),fe.call(v,"movingdown",t,y),H=!0,t.preventDefault(),t.stopPropagation()):(c=y.movingright,q=Z(y,y.movingright),N&&se(q,0,"none",h),E&&se(y.deltax,0,"none",r),fe.call(v,"movingright",t,y),H=!0,t.stopPropagation())}}}function X(e){if(fe.call(v,"touchend",e,y),!1===(b.onBeforeTouchend&&b.onBeforeTouchend.call(v,e,y)))return!1;if(H){var t="swiperight"==y.direction||"swipeleft"==y.direction?Math.abs(y.x2-y.x1):Math.abs(y.y2-y.y1),n="";switch(y.direction){case"swiperight":n="swipeleft";break;case"swipeleft":n="swiperight";break;case"swipeup":n="swipedown";break;case"swipedown":n="swipeup"}I&&"swiperight"==y.direction&&t>b.distance&&!L&&!R?(ee(),fe.call(v,y.direction,e,y),fe.call(v,"open",y.direction)):T&&"swipeleft"==y.direction&&t>b.distance&&!S&&!R?(G(),fe.call(v,y.direction,e,y),fe.call(v,"open",y.direction)):O&&"swipeup"==y.direction&&t>b.distance&&!P&&!R?(te(),fe.call(v,y.direction,e,y),fe.call(v,"open",y.direction)):C&&"swipedown"==y.direction&&t>b.distance&&!j&&!R?(ne(),fe.call(v,y.direction,e,y),fe.call(v,"open",y.direction)):R&&t<b.distance?(T&&S&&G(),I&&L&&ee(),O&&P&&te(),C&&j&&ne(),fe.call(v,y.direction,e,y),b.alwaysTrigger&&fe.call(v,"open",y.direction)):R&&t>b.distance?(T&&S&&oe(),I&&L&&ie(),O&&P&&ae(),C&&j&&re(),fe.call(v,y.direction,e,y),fe.call(v,"close",n)):!R&&t<b.distance&&("swipeleft"===y.direction&&T&&!S&&oe(),"swiperight"===y.direction&&I&&!L&&ie(),"swipeup"===y.direction&&O&&!P&&ae(),"swipedown"===y.direction&&C&&!j&&re(),b.alwaysTrigger&&fe.call(v,"close",n),fe.call(v,y.direction,e,y)),z=y.direction,M=!1,H=!1,e.stopPropagation()}}function Z(e,t){var n=-t+e.deltax;return n=n>0?0:n}function Q(e,t){var n=t-e.deltax;return n=n>t?t:n}function G(e){(e=e||{}).transition=e.transition||b.transition,e.target=e.target||f,e.handle=e.handle||r,n&&n.close(),R=!0,S=!0,x&&(n=v,i=f,q.addEventListener("click",ce,!0)),N&&se(0,0,e.transition,e.target),E&&se(-c,0,e.transition,e.handle)}function ee(e){(e=e||{}).transition=e.transition||b.transition,e.target=e.target||h,e.handle=e.handle||r,n&&n.close(),R=!0,L=!0,x&&(n=v,i=h,q.addEventListener("click",ce,!0)),N&&se(0,0,e.transition,e.target),E&&se(c,0,e.transition,e.handle)}function te(e){(e=e||{}).transition=e.transition||b.transition,e.target=e.target||p,e.handle=e.handle||r,n&&n.close(),R=!0,P=!0,x&&(n=v,i=p,q.addEventListener("click",ce,!0)),N&&se(0,0,e.transition,e.target),E&&se(0,-c,e.transition,e.handle)}function ne(e){(e=e||{}).transition=e.transition||b.transition,e.target=e.target||g,e.handle=e.handle||r,n&&n.close(),R=!0,j=!0,x&&(n=v,i=g,q.addEventListener("click",ce,!0)),N&&se(0,0,e.transition,e.target),E&&se(0,c,e.transition,e.handle)}function ie(e){(e=e||{}).transition=e.transition||b.transition,e.target=h,e.handle=F||r,R=!1,L=!1,x&&(n=null,i=null,F=null,q.removeEventListener("click",ce,!0)),N&&se(-(c+1),0,e.transition,e.target),E&&se(V,0,e.transition,e.handle)}function oe(e){(e=e||{}).transition=e.transition||b.transition,e.target=f,e.handle=F||r,R=!1,S=!1,x&&(n=null,i=null,F=null,q.removeEventListener("click",ce,!0)),N&&se("101%",0,e.transition,e.target),E&&se(-V,0,e.transition,e.handle)}function ae(e){(e=e||{}).transition=e.transition||b.transition,e.target=p,e.handle=F||r,R=!1,P=!1,x&&(n=null,i=null,F=null,q.removeEventListener("click",ce,!0)),N&&se(0,"100%",e.transition,e.target),E&&se(0,-V,e.transition,e.handle)}function re(e){(e=e||{}).transition=e.transition||b.transition,e.target=g,e.handle=F||r,R=!1,j=!1,x&&(n=null,i=null,F=null,q.removeEventListener("click",ce,!0)),N&&se(0,-c,e.transition,e.target),E&&se(0,V,e.transition,e.handle)}function le(){L&&ie(),S&&oe(),j&&re(),P&&ae(),fe.call(v,"close",z)}function ce(e){var i=t(e.target),o=i.closest(f).length||i.closest(h).length||i.closest(p).length||i.closest(g).length||e.target.className.indexOf("bui-mask")>-1||e.target.className.indexOf("bui-click")>-1;n&&(o||(n.close(),e.stopPropagation()))}function se(e,t,n,i){var o=i||a,r=(e=e||0,t=t||0,b.zoom?parseFloat(e)/100+"rem":parseFloat(e)+"px"),l=b.zoom?parseFloat(t)/100+"rem":parseFloat(t)+"px",c=String(e).indexOf("%")>-1?e:r,s=String(t).indexOf("%")>-1?t:l;return n="number"==typeof n?"all "+n+"ms":n||"all 300ms",o.css({"-webkit-transition":n,transition:n,"-webkit-transform":"translate("+c+","+s+")",transform:"translate("+c+","+s+")"}).one("webkitTransitionEnd",(function(){o.css({"-webkit-transition":"none",transition:"none"})})),this}function ue(){if(!B)return a.off("touchmove",J).off("touchend",X).off("touchcancel",(function(){})),fe.call(v,"lock"),this}function de(t,n){return e.off.apply(v,arguments),this}function fe(t){v.self=this==window||this==v?null:this,e.trigger.apply(v,arguments)}return b.autoinit&&U(b),v})}(window.bui||{},window.libs),function(e,t){e.sidebar=function(n){var i,o={name:"sidebar",handle:{},on:function(t,n){return e.on.apply(o,arguments),this},off:p,active:function(){return i.active()},isActive:function(){return c},open:f,close:h,lock:function(){return i.lock(),g.call(this,"lock"),this},unlock:function(e){return i.unlock(),g.call(this,"unlock"),this},destroy:function(e){e=1==e;u&&u.off("click.bui");p("open"),p("close"),r&&r.destroy(e),i&&i.destroy(e)},widget:function(t){var n={swipe:i,mask:r};return e.widget.call(n,t)},option:function(t,n){return e.option.call(o,t,n)},config:a,init:d},a=o.config=t.extend(!0,{},{id:"",trigger:"",handle:".bui-page",swiperight:".swiperight",swipeleft:".swipeleft",handleMove:!0,zIndex:121,mask:!0,width:280,opacity:.1,height:0,zoom:!0,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,autoinit:!0,onBeforeInit:null,onInited:null,distance:40},e.config.sidebar,n),r=null,l=null,c=!1,s=!1,u=null;function d(n){var d=t.extend(!0,a,n);return d.onBeforeInit&&d.onBeforeInit.call(o,d),a=o.config=d,d.trigger&&(u=e.obj(d.trigger)),l=e.obj(d.handle),i||(i=e.swipe({id:d.id,handle:d.handle,movingDistance:d.width,swiperight:d.swiperight,swipeleft:d.swipeleft,direction:"x",hasChild:!1,width:0,height:0,onBeforeTouchstart:d.onBeforeTouchstart,onBeforeTouchmove:d.onBeforeTouchmove,onBeforeTouchend:d.onBeforeTouchend,handleMove:d.handleMove,zoom:d.zoom,distance:d.distance,transition:300})),a.mask&&!r&&(r=bui.mask({id:d.id+"-mask",appendTo:l,autoTrigger:!1,zIndex:d.zIndex-1,opacity:d.opacity,callback:function(){i.close()}})),s||(!function(){var e=this;i.on("open",(function(t){u&&u.addClass("active"),r&&r.show(),l.css("overflow-y","hidden"),c=!0,g.call(e,"open",t)})),i.on("close",(function(){u&&u.removeClass("active"),r&&r.hide(),l.css("overflow-y","auto"),c=!1,g.call(e,"close")})),u&&u.off("click.bui").on("click.bui",(function(e){if(!t(this).hasClass("disabled")){var n=t(this).attr("data-target")||"swiperight";c?h():f({target:n})}})),s=!0}(),d.height>0&&e.obj(d.id).height(d.height)),d.onInited&&d.onInited.call(o,d),this}function f(e){var t=e||{};return t.target=t.target||"swiperight",t.transition=t.transition||300,i.open(t),this}function h(){return i.close(),this}function p(t,n){return e.off.apply(o,arguments),this}function g(t){o.self=this==window||this==o?null:this,e.trigger.apply(o,arguments)}return a.autoinit&&d(a),o}}(bui||{},libs),function(e,t){e.listview=function(n){var i,o,a,r={name:"listview",active:function(){return i.active()},lock:function(){return i.lock(),d.call(this,"lock"),this},unlock:function(e){return i.unlock(),d.call(this,"unlock"),this},open:function(e){var t=e||{};return t.target=t.target||("right"==l.position?l.swipeleft.substr(1):l.swiperight.substr(1)),t.transition=t.transition||300,t.index=t.index||0,i.open(t),this},close:function(){return i.close(),this},destroy:function(e){e=1==e;a&&(a.off("click.bui"),a=null);o&&(o.off("click.bui"),e&&o.remove(),o=null);u("open"),u("close"),i&&i.destroy(e),l=null,r=null},widget:function(t){var n={swipe:i};return e.widget.call(n,t)},option:function(t,n){return e.option.call(r,t,n)},config:l,init:s},l=r.config=t.extend(!0,{},{id:"",data:[],handle:".bui-btn",swiperight:".swiperight",swipeleft:".swipeleft",position:"right",width:0,height:0,menuWidth:160,menuHeight:0,distance:80,zoom:!1,autoinit:!0,template:null,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onInited:null,callback:null},e.config.listview,n),c=!1;function s(n){var s=t.extend(!0,l,n);return s.onBeforeInit&&s.onBeforeInit.call(r,s),l=r.config=s,o=e.obj(s.id),(a=o.children()).length&&function(e){e.height>0&&o.height(e.height);e.data&&e.data.length?a.each((function(n,i){var o=t(i),a=o.attr("status"),l=e.menuHeight>0?e.menuHeight:i.offsetHeight;if(!a){var c="function"==typeof e.template?e.template.call(r,e.data):function(e){var n="",i="right"==e.position?e.swipeleft.substr(1):e.swiperight.substr(1);return n+='<div class="bui-listview-menu '+i+'">',t.each(e.data,(function(e,t){n+='    <div class="bui-btn '+t.classname+'">'+t.text+"</div>"})),n+="</div>"}(e);o.append(c).attr("status","1")}i.style.height||t(i).height(l)})):a.each((function(n,i){var o=e.menuHeight>0?e.menuHeight:i.offsetHeight;i.style.height||t(i).height(o)}))}(s),c||function(e){var t=this,n=function(t){t.ui=r,e.callback&&e.callback.call(r,t,i)};o.off("click.bui",".bui-listview-menu .bui-btn").on("click.bui",".bui-listview-menu .bui-btn",n),(i=bui.swipe({id:e.id,handle:e.handle,movingDistance:e.menuWidth,swiperight:e.swiperight,swipeleft:e.swipeleft,direction:"x",hasChild:!0,width:e.width,height:0,zoom:e.zoom,distance:e.distance,onBeforeTouchstart:e.onBeforeTouchstart,onBeforeTouchmove:e.onBeforeTouchmove,onBeforeTouchend:e.onBeforeTouchend,transition:300})).on("open",(function(e){d.call(t,"open",e)})),i.on("close",(function(e){d.call(t,"close",e)})),c=!0}(s),s.onInited&&s.onInited.call(r,s),this}function u(t,n){return e.off.apply(r,arguments),this}function d(t){r.self=this==window||this==r?null:this,e.trigger.apply(r,arguments)}return l.autoinit&&s(l),r}}(window.bui||{},window.libs),function(e,t){e.btn=function(n){var i,o,a,r,l={},c={load:function(n){n=n;var s=0;i.off("click.bui",r).on("click.bui",r,(function(i){var r=t(this),u=l.beforeCallback||l.beforeLoad;if(!1===(u&&u.call(c,i)))return i.preventDefault(),i.stopPropagation(),!1;var d=n||r.attr("href"),f=r.attr("target"),h="true"===r.attr("iframe"),p="true"===r.attr("firstAnimate"),g=r.attr("disabled"),m=r.hasClass("disabled")||""==g||"true"==g||"disabled"==g;if(d&&!m&&!(d&&d.indexOf("javascript:")>-1)){var v=r.attr("param")||"",b=v&&v.indexOf("{")>-1&&v.indexOf("}")>-1?JSON.parse(r.attr("param")):{};(r.attr("progress")?"false"!=r.attr("progress"):o)&&e.loading({autoTrigger:!0,display:"block",opacity:0,timeout:l.timeout});var y=+new Date;if(y-s<350)return!1;s=y;var w={url:d,param:b,replace:a,firstAnimate:p,iframe:h};return"_blank"==f?e.run({id:d,data:b}):e.load(w),i.preventDefault(),i.stopPropagation(),!1}}))},submit:function(n,o){o=o||{};var a=null;l.id&&l.handle?i.off("click.bui",r).on("click.bui",r,c):i.click(c);function c(i){if(!1===(l.beforeCallback&&l.beforeCallback.call(this,i)))return i.preventDefault(),i.stopPropagation(),!1;var r=this,c=t(r).css("background-color");if(!t(this).hasClass("disabled")&&"true"!=t(this).attr("disabled")){var s="none"==c?"#fff":c;if(o.appendTo=r,o.background=o.background||s,o.display=o.display||"inline",o.width=o.width||15,o.height=o.height||15,o.text=o.text||"加载中",o.autoClose=1==o.autoClose,o.autoTrigger=0!=o.autoTrigger,a){if(a.isLoading())return;a.show()}else a=e.loading(o);return n&&n.call(r,a,i)}}},click:function(e){var n=0;l.id&&l.handle?i.off("click.bui",r).on("click.bui",r,o):i.click(o);function o(i){if(!1===(l.beforeCallback&&l.beforeCallback.call(this,i)))return i.preventDefault(),i.stopPropagation(),!1;if(!t(this).hasClass("disabled")&&"true"!=t(this).attr("disabled")){var o=+new Date;return!(o-n<350)&&(n=o,e&&e.call(this,i))}}},off:function(){return i.off("click.bui",r),this}};return function(n){n&&"object"===e.typeof(n)?(l.id=n.id||"",l.handle=n.handle||"",l.progress="progress"in n&&n.progress,l.replace="replace"in n&&n.replace,l.timeout=n.timeout||3e3,l.beforeCallback=n.beforeCallback||null,i=t(l.id)):"string"==typeof n&&(l.id=n||"",l.handle="",l.progress=!1,l.replace=!1,l.timeout=3e3,l.beforeCallback=null,i=e.obj(l.id));r=l.handle,o=l.progress,a=l.replace}(n),c}}(window.bui||{},window.libs),function(e,t){e.dialog=function(n){var i,o,a,r,l={id:"",dialogid:"",title:"",effect:"zoomIn",content:"",className:"",appendTo:"",position:"center",style:null,fullscreen:!1,useBox:!1,width:0,height:0,mask:!0,opacity:.3,render:!1,needRemove:"",autoClose:!0,close:!0,scroll:!0,closeText:"",zoom:!1,zIndex:101,buttons:[],onBeforeClose:null,onBeforeOpen:null,onBeforeInit:null,autoinit:!0,onInited:null,onMask:null,onClose:null,callback:null},c={name:"dialog",selector:S,$el:S,$:S,handle:{},on:function(t,n){return e.on.apply(c,arguments),this},off:L,open:function(n){if(p||w)return;var a={width:s.width,height:s.height,zoom:s.zoom,fullscreen:s.fullscreen,position:s.position,scroll:s.scroll,onBeforeOpen:s.onBeforeOpen,useBox:s.useBox,effect:"",callback:null},l=a;"function"==typeof n?l.callback=n:"string"==typeof n?l.effect=n:n&&"object"===e.typeof(n)&&(l=t.extend(!0,{},a,n));var u=l.onBeforeOpen&&l.onBeforeOpen.call(c,{toggle:o});if(T.call(c,"beforeopen",{toggle:o}),!1===u)return this;var h=s.useBox?"-webkit-box":"block";if(i&&i.css("display",h),0==(i.attr("status")||0)){d=String(l.width).indexOf("%")>-1?b*parseFloat(l.width)/100:l.width||i.width(),f=String(l.height).indexOf("%")>-1?y*parseFloat(l.height)/100:l.height||i.height();var m=e.unit.pxToRemZoom(d),v=e.unit.pxToRemZoom(f),x=l.zoom?m+"rem":d+"px",k=l.zoom?v+"rem":f+"px",I=l.zoom?"-"+v/2+"rem":"-"+f/2+"px",O=l.zoom?"-"+m/2+"rem":"-"+d/2+"px";if(l.fullscreen&&"custom"!=l.position||i.css({width:x,height:k}),"center"!=l.position||l.fullscreen||i.css({top:"50%","margin-top":I,left:"50%","margin-left":O,right:"auto"}),l.fullscreen&&i.addClass("bui-dialog-fullscreen"),l.scroll&&!l.useBox){var S=i.children(".bui-dialog-head"),L=i.children(".bui-dialog-foot"),j=i.children(".bui-dialog-main"),P=S.length?S.height():0,E=L.length?L.height():0,N=i.height()-P-E;j.css({height:N})}i.attr("status","1")}r&&r.show(),o.show((function(e){p=!0,l.callback&&l.callback.call(c,{toggle:o}),T.call(c,"openafter",{toggle:o}),T.call(c,"afteropen",{toggle:o})}),l.effect),g||C();return T.call(c,"open",{toggle:o}),this},close:I,isOpen:p,top:function(t){return t=t||s.zIndex+e.$(".bui-dialog").length,e.$(".bui-dialog").css("z-index",s.zIndex),e.$(".bui-mask").css("z-index",s.zIndex-1),i.css("z-index",t),r&&e.$("#"+r.config.id).css("z-index",t-1),c.config.zIndex=t,s.zIndex=t,this},template:k,toggle:function(e,t){c.isOpen()?c.close(t):c.open(e);return this},create:function(e){var n=e||{};l.title=s.title||"提示",l.content=s.content||"",l.close=!1,l.render=!0,l.autoClose=s.autoClose,l.mask=s.mask,l.buttons=s.buttons&&s.buttons.length?s.buttons:["确定"],l.callback=s.callback||null;var i=t.extend(!0,l,n);return T.call(c,"create"),x(i)},remove:O,destroy:function(){var e=1==e;i&&(i.off("click.bui"),i.remove(),i=null);L("open"),L("close"),r&&r.destroy(e),o&&o.destroy(e),w=!0},widget:function(t){var n={toggle:o,mask:r};return e.widget.call(n,t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:x},s=c.config=t.extend(!1,{},l,e.config.dialog,n),u="",d="",f="",h="fadeInDown",p=!1,g=!1,m=""!==s.needRemove?s.needRemove:!!s.render,v={},b=window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth,y=window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight,w=!1;function x(n){var l=t.extend(!0,s,n);switch(l.onBeforeInit&&l.onBeforeInit.call(c,l),l.appendTo=l.appendTo||e.hasRouter&&router.currentPage()||"body",w=!1,a=l.effect,m=""!==l.needRemove?l.needRemove:!!l.render,b=window&&window.viewport&&window.viewport.width()||document.documentElement.clientWidth,y=window&&window.viewport&&window.viewport.height()||document.documentElement.clientHeight,l.position){case"top":u="bui-dialog-top",a=l.effect||"fadeInDown";break;case"bottom":u="bui-dialog-bottom",a=l.effect||"fadeInUp";break;case"left":u="bui-dialog-left",a=l.effect||"fadeInLeft";break;case"right":u="bui-dialog-right",a=l.effect||"fadeInRight";break;case"center":u="bui-dialog-center",a=l.effect||h;break;case"custom":u="bui-dialog-custom",a=l.effect||h}l.fullscreen&&(u="bui-dialog-fullscreen",a=l.effect||h),l.render?(l.id=l.dialogid||e.guid(),function(n){var i=k(n),o=e.$("#"+n.id);o.length&&o.remove();t(n.appendTo).append(i)}(l),i=e.objId(l.id)):((i=e.obj(l.id)).addClass(u).css("z-index",l.zIndex),l.useBox&&i.addClass("bui-box-vertical")),l.style&&i.css(l.style),d=i.width()>b?b:i.width(),f=i.height()>y?y:i.height(),i.css("display","none"),o||(o=e.toggle({id:l.id,effect:a,useBox:l.useBox})),s=c.config=l;try{var p="object"==typeof l.id?t(l.id).attr("id")+"-mask":l.id+"-mask";n.mask&&!r&&(r=e.mask({id:p,opacity:n.opacity,appendTo:i.parent(),autoTrigger:!1,onlyOne:!0,autoClose:!1,zIndex:parseInt(n.zIndex,10)-1,callback:function(e){if(!1===(n.onMask&&n.onMask.call(c,e)))return!1;s.autoClose&&(m?I(O):I())}}))}catch(t){e.showLog(t)}return g&&!s.render||C(),l.onInited&&l.onInited.call(c,l),c}function k(e){var n="",i=e.useBox?"bui-box-vertical ":"";return n+='<div id="'+e.id+'" class="bui-dialog '+i+u+" "+e.className+'" style="display:block;z-index:'+e.zIndex+'">',e.title&&(n+='\t<div class="bui-dialog-head">'+e.title+"</div>"),n+='\t<div class="bui-dialog-main">',e.content&&(n+=e.content),n+="\t</div>",e.buttons&&e.buttons.length&&(n+='\t<div class="bui-dialog-foot"><div class="bui-box">',t(e.buttons).each((function(e,t){n+='\t\t<div class="bui-btn span1 '+(t.className||"")+'" value="'+(t.value||"")+'">'+(t.name||t)+"</div>"})),n+="\t</div></div>"),e.close&&(n+='   <div class="bui-dialog-close">'+(e.closeText?e.closeText:'<i class="icon-close"></i>')+"</div>"),n+="</div>"}function p(e){return p}function I(t){if(p&&!w){var n={};"function"==typeof t?n.callback=t:"string"==typeof t?(n.effect=t,n.callback=s.onClose):t&&"object"===e.typeof(t)&&(n=t),n.onBeforeClose=s.onBeforeClose;var i=n.onBeforeClose&&n.onBeforeClose.call(c,{toggle:o});if(T.call(c,"beforeclose",{toggle:o}),!1===i)return this;try{o.hide((function(e){p=!1,n.callback&&n.callback.call(c,{toggle:o})}),n.effect),r&&r.hide(),T.call(this,"close",{toggle:o})}catch(t){e.showLog(t,"bui.dialog.close")}return this}}function T(e,t){if(v[e]instanceof Array)for(var n=v[e],i=0,o=n.length;i<o;i++)n[i](t)}function O(){try{i.remove(),r&&r.remove(),T.call(this,"remove")}catch(t){e.showLog(t,"bui.dialog.remove")}return this}function C(){return i.off("click.bui",".bui-dialog-close").on("click.bui",".bui-dialog-close",(function(e){m?I(O):I(),s.onClose&&s.onClose.call(c,e,c),e.stopPropagation()})),i.on("click.bui",".bui-dialog-foot .bui-btn",(function(e){if(e.target=this,!1===(s.callback&&s.callback.call(c,e,c)))return!1;s.autoClose&&(m?I(O):I()),e.stopPropagation()})),g=!0,this}function S(t){return e.selector.call(i,t)}function L(t,n){return e.off.apply(c,arguments),this}function T(t){c.self=this==window||this==c?null:this,e.trigger.apply(c,arguments)}return s.id&&s.autoinit&&x(s),c}}(bui||{},libs),function(e,t){e.alert=function(n,i){var o=e.dialog(),a={className:"bui-alert",title:"",width:580,height:360,scroll:!0,zIndex:121,position:"center",autoClose:!0,zoom:!0,buttons:[{name:"确定",className:"primary-reverse"}]};a.callback=i||function(){};var r=t.extend(a,e.config.alert),l="";try{l="string"==typeof n&&n.indexOf("<")>-1&&n.indexOf(">")>-1?"<xmp>"+n+"</xmp>":!n||"object"!==e.typeof(n)&&"array"!==e.typeof(n)?n&&"function"===e.typeof(n)?n.toString():n:JSON.stringify(n),r.content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+l+"</div>"}catch(t){e.showLog(t,"bui.alert")}return o.create(r).open(),o}}(window.bui||{},window.libs),function(e,t){e.confirm=function(n,i){var o=e.dialog(),a={className:"bui-confirm",title:"",width:580,height:360,scroll:!0,zIndex:121,autoClose:!0,zoom:!0,position:"center",buttons:[{name:"取消",className:""},{name:"确定",className:"primary-reverse"}]};a.callback=i||function(){};var r={};return"object"==typeof n?(n.content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+n.content+"</div>",r=t.extend(a,e.config.confirm,n)):((r=t.extend(a,e.config.confirm)).content='<div class="bui-dialog-text bui-box-center" style="height:100%;">'+n+"</div>",r.callback=i||function(){}),o.create(r).open(),o}}(window.bui||{},window.libs);t((function(e){!function(t,n){t.prompt=function(i,o){var a=t.dialog(),r={className:"bui-prompt",title:"",width:580,height:400,scroll:!0,autoClose:!1,zoom:!0,zIndex:121,position:"center",buttons:[{name:"取消",className:""},{name:"确定",className:"primary-reverse"}]};r.callback=o||function(){},r.placeholder="",r.row=1,r.type="text",r.value="",r.onChange=null;var l={},c="",s="";switch("object"==typeof i?c=(l=n.extend(r,t.config.prompt,i)).content||"":((l=n.extend(r,t.config.prompt)).callback=o||function(){},c=i||""),l.type){case"number":l.content='<div class="bui-prompt-main bui-box-vertical"> <div class="bui-prompt-label">'+c+'</div> <div class="span1"> <input class="bui-prompt-text" placeholder="'+l.placeholder+'" type="'+l.type+'" value="'+l.value+'"/> </div> </div>';break;default:l.content='<div class="bui-prompt-main bui-box-vertical"> <div class="bui-prompt-label">'+c+'</div> <div class="span1"> <textarea class="bui-prompt-text" placeholder="'+l.placeholder+'" rows="'+l.row+'" >'+l.value+"</textarea> </div> </div>"}return a.create(l).open(),n("#"+a.config.id).on("change",".bui-prompt-text",(function(t){s=this.value,l.onChange&&l.onChange.call(e,t)})),a.value=function(e){return void 0===e?s:(n("#"+a.config.id).find(".bui-prompt-text").val(e),s=e)},a.focus=function(e){n("#"+a.config.id).find(".bui-prompt-text").focus()},a}}(window.bui||{},window.libs)}));!function(e,t){e.hint=function(n,i){if("number"==typeof n||"string"==typeof n){var o=n||"";(n={}).content=o,n.onClose=i||null}else"object"==typeof n&&(n=n);var a,r,l={name:"hint",handle:{},on:function(t,n){return e.on.apply(l,arguments),this},off:v,remove:m,hide:function(e,t){var n=this;"function"==typeof e?(e=e,t=t||c.effect||""):(t=e||c.effect||"",e=null);u&&(h=!1,u.hide((function(){e&&e.call(l,{toggle:u}),b.call(n,"hide",{toggle:u})}),t));return this},show:function(e,t){var n=this;"function"==typeof e?(e=e,t=t||c.effect||""):(t=e||c.effect||"",e=null);u&&(h=!0,u.show((function(t){b.call(n,"show",{toggle:u}),e&&e.call(l,{toggle:u})}),t));c.autoClose&&(r&&clearTimeout(r),r=setTimeout((function(){c.autoTrigger?m():u.hide(),c.onClose&&c.onClose.call(l)}),c.timeout));return this},text:function(e){return d.find(".bui-hint-inner").length&&d.find(".bui-hint-inner").html(e),this},isShow:function(){return h},destroy:function(e){e=1==e;d.off("click.bui"),u&&u.destroy(e),v("show"),v("hide")},widget:function(t){var n={toggle:u};return e.widget.call(n,t)},option:function(t,n){return e.option.call(l,t,n)},config:c,init:g},c=l.config=t.extend(!0,{},{appendTo:"",content:"",timeout:2e3,autoClose:!0,showClose:!1,autoTrigger:!0,useBox:!0,opacity:1,background:"",effect:"fadeInUp",skin:"",position:"bottom",width:0,height:0,onBeforeInit:null,onInited:null,onClose:null,onHided:null},e.config.hint,n),s=0,u=null,d=null,f="",h=!1,p=!1;function g(n){var i=t.extend(!0,c,n);return i.onBeforeInit&&i.onBeforeInit.call(l,i),a=e.guid(),f="top"===i.position?"fadeInDown":"bottom"===i.position?"fadeInUp":i.effect,c=l.config=i,function(n,i,o,a){var r,l="12"+o,s=a?e.obj(a):t("body");switch(c.position){case"top":r="bui-hint-top";break;case"bottom":r="bui-hint-bottom";break;case"center":r="bui-hint-center"}var u=c.height;c.width=String(c.width).indexOf("%")>-1?750*parseFloat(c.width)/100:parseFloat(c.width),c.height=parseFloat(c.height)||0;var d=c.background?"background:"+c.background:"",f=c.width>0?"width:"+c.width/100+"rem;margin-left:-"+c.width/100/2+"rem;":"",h=c.height>0?"height:"+c.height/100+"rem;":"",p="auto"==u?"height:auto;":h,g="center"===c.position&&c.width>0?"margin-top:-"+c.height/100/2+"rem;":"",m=d+";z-index:"+l+";opacity:"+c.opacity+";"+f+p+g,v='<div id="'+n+'" class="bui-hint '+r+" "+c.skin+'" style="'+m+'"><span class="bui-hint-inner">'+i+"</span>"+(c.showClose?'<div class="bui-hint-close"><i class="icon-close"></i></div>':"")+"</div>";s.append(v),a&&s.css("position","relative")}(a,i.content,s,i.appendTo),++s,d=e.objId(a),u||(u=e.toggle({id:d,effect:f,useBox:i.useBox})),h=!0,i.autoTrigger?u.show():u.hide("showIn"),i.autoClose&&(r&&clearTimeout(r),r=setTimeout((function(){i.autoTrigger?m(i.onHided):u.hide(i.onHided),i.onClose&&i.onClose.call(l)}),i.timeout)),p||function(e){e.showClose&&d.off("click.bui",".bui-hint-close").on("click.bui",".bui-hint-close",(function(t){e.autoTrigger?m(e.onHided):u.hide(e.onHided),e.onClose&&e.onClose.call(l,t)})),p=!0}(i),i.onInited&&i.onInited.call(l,i),this}function m(e){var t=this;return u&&(h=!1,u.hide((function(){u.remove(),e&&e.call(l),b.call(t,"remove",{toggle:u}),u=null}))),this}function v(t,n){return e.off.apply(l,arguments),this}function b(t){l.self=this==window||this==l?null:this,e.trigger.apply(l,arguments)}return g(c),l}}(window.bui||{},window.libs),function(e,t){e.pullrefresh=function(n){var i,o,a,r,l,c,s,u="."+e.prefix("scroll-head"),d="."+e.prefix("scroll-main"),f="."+e.prefix("scroll-foot"),h={id:"",stopHandle:"",childrenTop:u,childrenMain:d,handleMove:"main",header:".bui-page header",footer:".bui-page footer",distance:90,maxDistance:0,autoLoad:!0,lastUpdated:!1,height:0,cacheHeight:!0,refreshTips:{start:"刷新中..",release:"松开刷新",end:"下拉刷新",fail:"刷新失败,请检查下网络再试试",success:"刷新成功"},autoinit:!0,stopPropagation:!1,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onBeforeRefresh:null,onInited:null,onRefresh:null},p={name:"pullrefresh",handle:{},on:function(t,n){return e.on.apply(p,arguments),this},off:q,reverse:function(e,t,n){x||(k.show({text:g.refreshTips.success,onlyText:!1}),H(e,t),O.one("webkitTransitionEnd",(function(){k&&k.hide().pause(),x=!1,n&&n.call(p)})));return this},refresh:function(){H(g.distance/2,!0),k.start({text:g.refreshTips.start,onlyText:!1}),g.onRefresh&&s()},setHeight:V,resize:function(e){var t=e||{height:0,width:0};this.setHeight(t),t&&t.width>0&&i.width(t.width);return this},fail:function(){x=!0,H(),e.hint(g.refreshTips.fail),U.call(p,"fail")},lock:function(e){return m=!0,i.off("touchstart",F).off("touchmove",D).off("touchend",A).off("touchcancel",H),H(),e&&e.call(p),U.call(p,"lock"),this},unlock:M,destroy:function(e){e=1==e;i&&(i.off(),e&&i.remove());k&&k.destroy(e),q("refresh"),q("movingdown"),q("swipedown")},widget:function(t){var n={loading:k};return e.widget.call(n,t)},option:function(t,n){return e.option.call(p,t,n)},config:g,init:E},g=p.config=t.extend(!0,{},h,e.config.pullrefresh,n),m=!1,v=(new Date).getTime(),b=0,y=!1,w=!1,x=!1,k=null,I=/hp-tablet/gi.test(navigator.appVersion),T="ontouchstart"in window&&!I,O=null,C=0,S=0,L=!1,j=!1,P={x1:0,x2:0,y1:0,y2:0,direction:""};function E(n){var l=t.extend(!0,g,n);if(l.onBeforeInit&&l.onBeforeInit.call(p,l),l.id)return i=e.obj(l.id),g=p.config=l,i[0],o=i.children(u),a=i.children(d),r=i.children(f),O="head"===l.handleMove?o:a,s=N,c=l.refreshTips.end,k||(k=e.loading({appendTo:o,width:15,height:15,autoClose:!1,text:c,onlyText:!0,display:"inline",autoTrigger:!1,mask:!1})),l.autoLoad&&(y=!0,k.start({text:l.refreshTips.start,onlyText:!1}),s()),w||function(e){m||M();w=!0}(),V(l.height),l.onInited&&l.onInited.call(p,l),this;e.hint("pullrefresh id不能为空")}function N(){v=(new Date).getTime(),g.onBeforeRefresh&&g.onBeforeRefresh.call(p),g.onRefresh&&g.onRefresh.call(p),U.call(p,"refresh")}g.autoinit&&E(g);var $=0;function F(n){var a=n.originalEvent&&n.originalEvent.targetTouches||n.targetTouches,r=T?a[0]:n;if(P.x1=r.pageX,P.y1=r.pageY,P.direction="",$=i.scrollTop(),g.stopHandle&&e.unit.checkTargetInclude(n.target,g.stopHandle))L=!1;else if(a.length>1||n.scale&&1!==n.scale)L=!1;else{var l,s,u;if(!1===(g.onBeforeTouchstart&&g.onBeforeTouchstart.call(p,n,P)))return!1;c=g.lastUpdated?(l=(new Date).getTime()-v,s=Math.floor(l/36e5),u=Math.floor(l/6e4),s<=0&&u<=0?"刚刚更新":s<=0&&u>0?u+"分钟前更新":"上次更新时间:"+(s<10?"0"+s:s)+":"+(u<10?"0"+u:u)):g.refreshTips.end,U.call(p,"touchstart",n,P),"head"===g.handleMove&&o.css("zIndex",10),t(window).scrollTop()<=0&&$<=0&&g.onRefresh&&!y?(L=!0,t(this).css("touch-action","none")):(L=!1,o.css("zIndex",0)),g.stopPropagation&&n.stopPropagation()}}var B=!1,R=!1;function D(t){var n=t.originalEvent&&t.originalEvent.targetTouches||t.targetTouches||[];if(L)if(n.length>1||t.scale&&1!==t.scale)H();else{var i=T?n[0]:t;if(P.x2=i.pageX,P.y2=i.pageY,!1===(g.onBeforeTouchmove&&g.onBeforeTouchmove.call(p,t,P)))return!1;P.direction||(P.direction=e.swipeDirection(P.x1,P.x2,P.y1,P.y2)),U.call(p,"touchmove",t,P),"swipeleft"!==P.direction&&"swiperight"!==P.direction||t.preventDefault(),P.y2-P.y1>0&&$<=0&&t.preventDefault(),"swipedown"==P.direction?(U.call(p,"movingdown",t,P),H((l=Math.abs(P.y2-P.y1))/2,!1),l>=g.distance?B||(k.show({text:g.refreshTips.release,onlyText:!1}).pause(),B=!0):R||(k.show({text:c,onlyText:!1}).pause(),R=!0),j=!0,g.maxDistance>g.distance&&l>=g.maxDistance&&(k.show({text:g.refreshTips.start,onlyText:!1}),y=!0,g.onRefresh&&s(),j=!1,B=!1,R=!1,C+=(P={}).y2-P.y1,S+=P.x2-P.x1,P.lastX=S,P.lastY=C,P={x1:0,x2:0,y1:0,y2:0,direction:""},L=!1,j=!1),t.preventDefault(),t.stopPropagation()):"swipeup"==P.direction&&(U.call(p,"movingup",t,P),j=!0,t.stopPropagation()),k&&k.pause()}else H()}function A(e){return U.call(p,"touchend",e,P),!1!==(g.onBeforeTouchend&&g.onBeforeTouchend.call(p,e,P))&&(t(this).css("touch-action","auto"),j?("swipedown"==P.direction?(U.call(p,P.direction,e,P),l>=g.distance?(H(g.distance/2),k.show({text:g.refreshTips.start,onlyText:!1}).start(),y=!0,g.onRefresh&&s()):H(),e.stopPropagation(),B=!1,R=!1,P={}):"swipeup"==P.direction&&(U.call(p,P.direction,e,P),e.stopPropagation()),C+=P.y2-P.y1,S+=P.x2-P.x1,P.lastX=S,P.lastY=C,P={x1:0,x2:0,y1:0,y2:0,direction:""},L=!1,j=!1,void o.css("zIndex",0)):(P={x1:0,x2:0,y1:0,y2:0,direction:""},L=!1,void(j=!1)))}function M(e){return m=!1,i.on("touchstart",F).on("touchmove",D).on("touchend",A).on("touchcancel",H),e&&e.call(this),U.call(p,"unlock"),this}function H(e,t){y=!1;var n=(t=0!=t)?"all 300ms ease-out":"none";return z(0,(e=e||0)+"px",n,O),r.length&&("head"===g.handleMove?r.find(".bui-loading-text").text(""):z(0,e+"px",n,r)),this}function z(e,t,n,o){o=o||i;var a=e=e||0,r=t=t||0,l=String(e).indexOf("%")>-1?String(e):a,c=String(t).indexOf("%")>-1?String(t):r;n="number"==typeof n?"all "+n+"ms":n||"all 300ms";try{o.css({"-webkit-transition":n,transition:n,"-webkit-transform":"translate("+l+","+c+")",transform:"translate("+l+","+c+")"}),o.one("webkitTransitionEnd",(function(){o.css({"-webkit-transition":"none",transition:"none"}),k.hide()}))}catch(e){console.log(e.message)}}function V(t){e.$(".bui-page");var n=i.parents(".active").length?i.parents(".active"):i.parents(".bui-tab-main"),o=((n.length?n.height():i.parents(".bui-tab").height())||i.parents(".bui-page").height()||i.parents(".bui-dialog-main"))-(i[0]&&i[0].offsetTop),a=t?parseFloat(t):o;0==b&&(b=a);g.cacheHeight;i.height(b)}function q(t,n){return e.off.apply(p,arguments),this}function U(t){p.self=this==window||this==p?null:this,e.trigger.apply(p,arguments)}return p}}(window.bui||{},window.libs),function(e,t){e.scroll=function(n){var i,o,a,r,l,c,s,u,d,f="."+e.prefix("list"),h="."+e.prefix("scroll-head"),p="."+e.prefix("scroll-main"),g="."+e.prefix("scroll-foot"),m={id:"",childrenTop:h,childrenMain:p,childrenBottom:g,children:f,stopHandle:"",header:".bui-page header",footer:".bui-page footer",handle:"li",distance:100,endDistance:5,height:0,page:1,pageSize:10,stopPropagation:!1,handleMove:"main",lastUpdated:!0,autoRefresh:!1,autoNext:!0,autoScroll:!0,refresh:!0,cacheHeight:!0,refreshPage:!0,scroll:!0,delayTime:100,direction:"y",scrollTips:{start:"努力加载中..",end:"上拉加载更多",nodata:"没有更多内容",last:"没有更多内容",fail:"点击重新加载"},refreshTips:{start:"刷新中..",release:"松开刷新",end:"下拉刷新",fail:"点击加载",success:"刷新成功"},autoinit:!0,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onInited:null,onScrolling:null,onBeforeRefresh:null,onRefresh:null,onBeforeLoad:null,onLoad:null},v={name:"scroll",handle:{},on:function(t,n){return e.on.apply(v,arguments),this},off:A,reverse:function(e){return u&&u.reverse(),e&&e.call(v,u),this},updateCache:B,updatePage:B,getPage:function(){return b.page},getCache:function(e){return P},clearCache:function(e){return void(P={})},resize:function(e){var t=e||{height:0,width:0};w=0,this.setHeight(t),t&&t.width>0&&i.width(t.width);return this},fail:function(e,t){return k=!0,x.show({text:b.scrollTips.fail,onlyText:!0,callback:function(n){$(e,t)}}),u&&u.lock(),this},filter:function(t,n){var i,o,a=[];if(t&&n)for(i in P){var r=e.array.filter(P[i],t,n)||[];if(r.length)for(o in r)a.push(r[o])}return a},to:R,toBottom:function(e){i[0]&&(i[0].scrollTop=i[0].scrollHeight,e&&e.call(v));return this},scrollTop:function(e){var n=0;n="object"==typeof e||"string"==typeof e&&e.indexOf("#")>-1?t(e)[0].offsetTop:parseInt(e)||0;return o.scrollTop=n,this},lock:function(){return i.off("scroll"),M.call(v,"lock"),this},unlock:function(t){return i.on("scroll",e.unit.debounce(N,b.delayTime)),M.call(v,"unlock"),this},lockrefresh:function(){return u.lock(),this},unlockrefresh:function(){return u.unlock(),this},refresh:function(){return R(1),u&&u.refresh(),this},load:function(e){return S=e=e||S,s&&s.call(v,S,L),this},nextPage:function(){return s&&s.call(v,++S,L),this},prevPage:function(){S-- >0&&s&&s.call(v,S--,L);return this},setHeight:D,isRefresh:function(){return C},destroy:function(e){e=1==e;i&&(i.off("scroll"),e&&i.remove());u&&u.destroy(e),x&&x.destroy(e),A("loadpage"),A("lastpage"),A("scrolltop"),A("scrollbottom"),A("scrollend")},widget:function(t){var n={pullrefresh:u,loading:x};return e.widget.call(n,t)},option:function(t,n){return e.option.call(v,t,n)},config:b,init:E},b=v.config=t.extend(!0,{},m,e.config.scroll,n),y=b.page,w=0,x=null,k=!1,I=!0,T=!0,O=!1,C=!1,S=b.page,L=b.pageSize,j=!1,P={};function E(n){var a=t.extend(!0,b,n);if(a.onBeforeInit&&a.onBeforeInit.call(v,a),t(window),a.id){i=e.obj(a.id),S=a.page,L=a.pageSize,b=v.config=a,I=!0,T=!0,O=!1,C=!1,o=i[0],i.children(h),l=i.children(p),r=i.children(g),l.css({position:"relative"}),x||(x=e.loading({appendTo:r,width:20,height:20,autoClose:!1,text:a.scrollTips.start,zIndex:10,display:"inline",autoTrigger:!1,mask:!1})),c=F,s=$,u?u.init({id:a.id,onBeforeRefresh:a.onBeforeRefresh,onRefresh:c,distance:a.distance,maxDistance:a.maxDistance,lastUpdated:a.lastUpdated,height:a.height,cacheHeight:a.cacheHeight,stopPropagation:a.stopPropagation,handleMove:a.handleMove,refreshTips:a.refreshTips,autoLoad:a.autoRefresh}):a.refresh&&a.onRefresh?((u=e.pullrefresh({id:a.id,onBeforeRefresh:a.onBeforeRefresh,onRefresh:c,distance:a.distance,stopHandle:a.stopHandle,maxDistance:a.maxDistance,lastUpdated:a.lastUpdated,header:a.header,footer:a.footer,height:a.height,handleMove:a.handleMove,cacheHeight:a.cacheHeight,stopPropagation:a.stopPropagation,onBeforeTouchstart:a.onBeforeTouchstart,onBeforeTouchmove:a.onBeforeTouchmove,onBeforeTouchend:a.onBeforeTouchend,refreshTips:a.refreshTips,autoLoad:a.autoRefresh})).lock(),k=!0):"y"===a.direction&&D(a.height),"x"===a.direction&&i.addClass("bui-box-center").attr("direction","x");try{s&&s.call(v,S,L)}catch(t){e.showLog(t,"bui.scroll.init")}return j||a.scroll&&function(t){i.off("scroll").on("scroll",e.unit.debounce(N,t.delayTime)),j=!0}(a),a.onInited&&a.onInited.call(v,a),this}e.hint("scroll id不能为空")}function N(e){var t=e.target,n=t.scrollTop||0,i=t.scrollLeft||0;"y"===b.direction?0==n?M.call(v,"scrolltop",e):t.scrollTop+t.clientHeight>=(t&&t.scrollHeight-b.endDistance)&&b.onLoad&&(b.page=v.config.page=++S,b.autoScroll&&s&&s.call(v,b.page,L),M.call(v,"scrollbottom",e)):0==i?M.call(v,"scrolltop",e):t.scrollLeft+t.clientWidth>=(t&&t.scrollWidth-b.endDistance)&&b.onLoad&&(b.page=v.config.page=++S,b.autoScroll&&s&&s.call(v,b.page,L),M.call(v,"scrollbottom",e)),M.call(v,"scrollend",e),b.onScrolling&&b.onScrolling.call(v,e,v)}function $(e,t){return C=!1,T&&!O&&(b.page=v.config.page=e,b.onBeforeLoad&&b.onBeforeLoad.call(v,e,t),b.onLoad&&x&&x.start({text:b.scrollTips.start,onlyText:!1}),b.onLoad&&b.onLoad.call(v,e,t)),k&&b.refresh&&u&&u.unlock(),this}function F(){T=!0,O=!1,I=!0,C=!0,b.refreshPage&&(S=y,L=b.pageSize,P={}),b.page=v.config.page=S,M.call(v,"refresh",S),b.onRefresh&&b.onRefresh.call(v,S,L)}function B(t,n,o){o=0!=o;if(!n||"array"!=e.typeof(n))return x&&x.stop(),e.showLog("scroll 控件的updatePage 第2个参数,必须是一个数组,如果是list控件,检测field的data映射是否准确","bui.scroll.updatePage"),void(n=[]);n=n,d&&clearTimeout(d),d=setTimeout((function(){var e=parseInt(i.height()),a=parseInt(i.find(b.childrenMain)[0]&&i.find(b.childrenMain)[0].scrollHeight);if(o)if(n&&n.length>L-1){if(T=!0,O=!1,I=!1,x&&x.start({text:b.scrollTips.end,onlyText:!0}),a>=10&&a<e&&b.autoNext&&b.onLoad){var r=++S;s&&s.call(v,r,L)}M.call(v,"loadpage",n,S)}else{T=!1,O=!0;var l=I&&n&&n.length<1?b.scrollTips.nodata:b.scrollTips.last;x&&x.start({text:l,onlyText:!0}),M.call(v,"loadpage",n,S),M.call(v,"lastpage",n,S)}else T=!1,O=!0,x&&x.stop();return P[t]=n}),10)}function R(e,t){e=e||0;a=i.find(b.children).children(b.handle);var n=i.height(),r=parseFloat(a.height()),l=o.scrollHeight,c=r*parseInt(e)-r;return l>n&&(o.scrollTop=c,M.call(v,"to",e),t&&t.call(v,parseInt(e))),this}function D(t){e.$(".bui-page");var n=i.parents(".active").length?i.parents(".active"):i.parents(".bui-tab-main"),o=((n.length?n.height():i.parents(".bui-tab").height())||i.parents(".bui-page").height())-(i[0]&&i[0].offsetTop),a=t?parseFloat(t):o;0==w&&(w=a);b.cacheHeight;i.height(w)}function A(t,n){return e.off.apply(v,arguments),this}function M(t){v.self=this==window||this==v?null:this,e.trigger.apply(v,arguments)}return b.autoinit&&E(b),v}}(window.bui||{},window.libs),function(e,t){e.list=function(n){var i,o,a,r,l,c={name:"list",handle:{},on:function(t,n){return e.on.apply(c,arguments),this},off:y,empty:function(){return o.html(""),this},updatePage:function(){var e=l.getPage();return l.updatePage(e,r),this},getPage:function(){return l.getPage()},refresh:function(){return w.call(this,"refreshbefore"),l.refresh(),this},reload:function(){return w.call(this,"refreshbefore"),b(),this},resize:function(e){return l.resize(e),this},modify:function(e){return s=c.config=t.extend(!0,{},c.config,e),f=s.data,this},destroy:function(e){e=1==e;i&&(i.off("click.bui"),e&&i.remove(),i=null);y("refreshbefore"),y("refresh"),y("success"),y("fail"),l&&l.destroy(e)},widget:function(t){var n={scroll:l,ajax:a};return e.widget.call(n,t)},option:function(n,i){return"data"==n&&void 0!==i?function(n,i){var o;if("string"==typeof i)try{o=JSON.parse(i)}catch(t){return void e.showLog("data 参数必须为对象","bui.list.modifyData")}else o=i;return f=t.extend(!0,{},p,o)}(0,i):e.option.call(c,n,i)},config:s,init:g},s=c.config=t.extend(!0,{},{id:"",url:"",data:{},method:"GET",dataType:"json",headers:{},contentType:null,timeout:2e4,field:{page:"page",size:"pageSize",data:""},scrollTips:{start:"努力加载中..",end:"上拉加载更多",nodata:"没有更多内容",last:"没有更多内容",fail:"点击重新加载"},refreshTips:{start:"刷新中..",release:"松开刷新",end:"下拉刷新",fail:"点击加载",success:"刷新成功"},lastUpdated:!1,cacheHeight:!0,ajax:null,page:1,pageSize:10,autoNext:!0,refreshPage:!0,autoUpdatePage:!0,autoScroll:!0,stopPropagation:!1,autoinit:!0,urlrule:!1,native:!0,needNative:!1,relative:!1,refresh:!0,direction:"y",stopHandle:"",children:".bui-list",handle:".bui-btn",header:".bui-page header",footer:".bui-page footer",height:0,commandRefresh:"html",commandLoad:"append",scroll:!0,localData:null,template:null,onBeforeTouchstart:null,onBeforeTouchmove:null,onBeforeTouchend:null,onBeforeInit:null,onInited:null,onBeforeRefresh:null,onRefresh:null,onLoad:null,onFail:null,callback:null},e.config.list,n),u=s.url,d=s.page,f=(s.page,{}),h=!1,p=s.data;function g(n){var a=s=t.extend(!0,s,n);a.onBeforeInit&&a.onBeforeInit.call(c,a),i=e.obj(a.id),o=i.find(a.children),s=c.config=a,f=s.data;var r=0==s.refresh?null:b,u={id:a.id,children:a.children,handle:a.handle,header:a.header,footer:a.footer,page:a.page,pageSize:a.pageSize,distance:a.distance,stopHandle:a.stopHandle,maxDistance:a.maxDistance,height:a.height,refresh:a.refresh,autoNext:a.autoNext,refreshPage:a.refreshPage,autoScroll:a.autoScroll,scroll:a.scroll,cacheHeight:a.cacheHeight,stopPropagation:a.stopPropagation,scrollTips:a.scrollTips,refreshTips:a.refreshTips,direction:a.direction,lastUpdated:a.lastUpdated,handleMove:a.handleMove,onBeforeTouchstart:a.onBeforeTouchstart,onBeforeTouchmove:a.onBeforeTouchmove,onBeforeTouchend:a.onBeforeTouchend,onBeforeRefresh:a.onBeforeRefresh,onBeforeLoad:a.onBeforeLoad,onRefresh:r,onLoad:v};return"html"!=a.commandRefresh&&(a.refreshPage=!1),a.urlrule&&(a.url=m(a)),l?l.init(u):l=e.scroll(u),c.toBottom=l.toBottom,c.scrollTop=l.scrollTop,c.to=l.to,h||function(e){e.callback&&i.off("click.bui",e.handle).on("click.bui",e.handle,(function(t){e.callback.call(c,t)})),h=!0}(a),a.onInited&&a.onInited.call(c,a),this}function m(e){return u.replace("(page)",e.page).replace("(size)",e.pageSize)}function v(i,u,d){var h=this,g=d||s.commandLoad;if(f=t.extend(!0,{},p,s.data,f),s.field.page.length&&e.unit.setKeyValue(s.field.page,i,f),s.field.size.length&&e.unit.setKeyValue(s.field.size,u,f),s.page=c.config.page=i,s.data=f,!s.localData)return s.urlrule&&(s.url=m(s)),s.success=v,s.fail=function(e,t,n){w.call(h,"fail",e,i,n),s.onFail&&s.onFail.call(c,e,i,n),l&&l.fail(i,u,e)},a=s.ajax?s.ajax(s):e.ajax(s),this;function v(t,a,u){var d,f,p;d="string"==typeof t?t&&JSON.parse(t)||{}:t||{};var m,v,b,y;if("string"==typeof(f=s&&s.field&&""==s.field.data?d||[]:"object"===e.typeof(d)&&e.unit.getKeyValue(s.field.data,d)||[])&&/\[?.+\]$/g.test(f))try{p=JSON.parse(f)}catch(t){p=f,e.showLog(t)}else p=f;f=p&&"array"===e.typeof(p)?p:[],s.localData&&(m=i,v=s.pageSize,f=(y=(m-1)*v)+v>=(b=f).length?b.slice(y,b.length):b.slice(y,y+v));var x=n.template&&n.template.call(c,f,d,i)||"";o&&o[g](x);var k=l&&l.isRefresh()||!1;w.call(h,"success",t,i,u);try{k?(s.onRefresh&&s.onRefresh.call(c,l,d,u),w.call(h,"refresh",t,i,u),s.refresh&&l.reverse()):(w.call(this,"onloadbefore"),s.onLoad&&s.onLoad.call(c,l,d,u),w.call(h,"onload",t,i,u)),s.localData?s.autoUpdatePage&&h&&h.updatePage(i,f):s.autoUpdatePage&&l&&l.updatePage(i,f),r=f}catch(e){}}v(s.localData)}function b(){var e=d;s.refreshPage||(e=c.config.page+1);var t=s.pageSize;return w.call(this,"refreshbefore"),v(e,t,s.commandRefresh),this}function y(t,n){return e.off.apply(c,arguments),this}function w(t){c.self=this==window||this==c?null:this,e.trigger.apply(c,arguments)}return s.autoinit&&g(s),c}}(window.bui||{},window.libs),function(e,t){e.searchbar=function(n){var i,o,a,r,l={name:"searchbar",handle:{},on:function(t,n){return e.on.apply(l,arguments),this},off:d,search:function(e){var t=e||o;return o=t,f.call(this,"search",{},t),c.callback&&c.callback.call(this,{},t),this},reset:function(){return a.val(""),r.hide(),this},value:function(e){if(void 0===e)return a.val();a.val(e),e&&r.show();return l},destroy:function(e){e=1==e;i&&(i.off(),e&&i.remove());d("search"),d("remove"),d("input")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(l,t,n)},config:c,init:u},c=l.config=t.extend(!0,{},{id:"",handle:".icon-search,.btn-search",handleRemove:".icon-removefill",delayTime:400,onInput:null,onChange:null,onRemove:null,autoinit:!0,onBeforeInit:null,onInited:null,callback:null},e.config.searchbar,n),s=!1;function u(n){var u=t.extend(!0,c,n);return u.onBeforeInit&&u.onBeforeInit.call(l,u),i=e.obj(u.id),l.$el=i,c=l.config=u,a=i.find("input"),(r=i.find(u.handleRemove)).length<1&&(a.after('<i class="'+u.handleRemove.substr(1)+'"></i>'),r=i.find(u.handleRemove)),r.hide(),s||function(e){i.off("click.bui",e.handle).on("click.bui",e.handle,(function(t){document.activeElement.blur();var n=a.val();o=n,f.call(l,"search",t,n),e.callback&&e.callback.call(l,t,n)})),i.off("click.bui",e.handleRemove).on("click.bui",e.handleRemove,(function(n){document.activeElement.blur(),a.val("");var i=a.val();o=i,t(this).hide(),f.call(l,"remove",n,i),e.onRemove&&e.onRemove.call(l,n,i)}));var n=!1,c=null;e.onInput&&i.off("input","input").on("compositionstart",(function(){n=!0})).on("compositionend",(function(t){n=!1;var i=a.val();e.onInput.call(l,t,i)})).on("input","input",(function(t){var i=a.val();o=i,i?r.show():r.hide(),f.call(l,"input",t,i),n||(c&&clearTimeout(c),c=setTimeout((function(){e.onInput.call(l,t,i),c=null}),e.delayTime))})),e.onChange&&i.off("change","input").on("change","input",(function(t){var n=a.val();o=n,n?r.show():r.hide(),f.call(l,"change",t,n),e.onChange.call(l,t,n)})),s=!0}(u),u.onInited&&u.onInited.call(l,u),this}function d(t,n){return e.off.apply(l,arguments),this}function f(t){l.self=this==window||this==l?null:this,e.trigger.apply(l,arguments)}return c.autoinit&&u(c),l}}(bui||{},libs),function(e,t){e.select=function(n){var i,o,a,r,l,c,s={name:"select",handle:{},on:function(t,n){return e.on.apply(s,arguments),this},off:B,value:E,values:function(){var e=[];return w.forEach((function(t,n){e.push({value:t,name:y[n],index:x[n],icon:k[n]})})),e},allValues:function(){var e=[];return u.data&&u.data.forEach((function(t,n){var i=l.eq(n).find("input").prop("checked");t.checked=i,e.push(t)})),e},index:function(){return x.join(",")},active:$,unactive:function(t){var n=[];String(t).indexOf(",")>-1?n=t.split(","):n.push(parseInt(t));return n.forEach((function(t,n){var i=l.eq(t).find("input"),o=i.val(),a=i.attr("text");e.array.delete(y,a),e.array.delete(w,o),i.prop("checked",null)})),R.call(s,"change",{}),this},disabled:function(){var e=i;return e&&e.addClass("disabled"),this},enabled:function(){var e=i;return e&&e.removeClass("disabled"),this},disabledSelect:function(e){if(void 0===e)l.find("input").attr("disabled",!0);else{if("number"!=typeof e)return void console.log("index 必须为数字");l.eq(e).find("input").attr("disabled",!0)}return this},enabledSelect:function(e){if(void 0===e)l.find("input").removeAttr("disabled");else{if("number"!=typeof e)return void console.log("index 必须为数字");l.eq(e).find("input").removeAttr("disabled")}return this},template:b,empty:function(){return o.html(""),u.data=[],T=!1,this},text:N,show:j,hide:P,selectAll:function(){if("checkbox"==u.type){$(u.data.map((function(e,t){return t})).join(","))}else $(0);return this},selectNone:F,reset:function(){return F(),N(I),this},clearSearch:function(){o.find(".bui-searchbar-close").trigger("click")},unselect:function(){if("checkbox"==u.type){var t=y.map((function(e,t){return e}));w.map((function(e,t){return e}));y=[],w=[],u.data&&u.data.forEach((function(n,i){var o=l.eq(i).find("input");e.array.index(t,n[p])>-1?o.prop("checked",null):(o.prop("checked",!0),y.push(n[p]),w.push(n[g]))})),E(w.join(",")||""),N(y.join(",")||"")}else F();return this},unselected:function(t){var n=[];String(t).indexOf(",")>-1?n=t.split(","):n.push(t);return n.forEach((function(t,n){u.data.forEach((function(n,i){var o=n[p]||n,a=n[g]||n;t!=a&&t!=o||(l.eq(i).find("input").prop("checked",null),e.array.remove(y,o),e.array.remove(w,a))}))})),R.call(s,"change",{}),this},destroy:function(e){e=1==e;o&&(o.off(),e&&o.remove());i&&(i.off("click.bui"),e&&i.remove());return c&&c.destroy(e),T=!1,B("show"),B("hide"),B("change"),B("select"),B("check"),B("uncheck"),this},widget:function(t){var n={dialog:c||{}};return e.widget.call(n,t)},option:function(t,n){return e.option.call(s,t,n)},config:u,init:O},u=s.config=t.extend(!0,{},{id:"",trigger:"",triggerChildren:".span1",handle:".bui-list .bui-btn",className:"",name:"",appendTo:"",data:[],popup:!0,title:"",autoClose:!1,placeholder:"",field:{name:"name",value:"value",image:"image",icon:"icon"},height:0,width:0,mask:!0,zIndex:110,change:!0,toggle:!1,effect:"fadeInUp",type:"select",direction:"left",position:"bottom",fullscreen:!1,needSearch:!1,value:"",buttons:[],onChange:null,autoinit:!0,onBeforeOpen:null,onBeforeInit:null,template:null,onInited:null,callbackHandle:".bui-dialog-foot .bui-btn",callback:null},e.config.select,n),d=e.guid(),f=u.name||e.guid(),h=!0,p=u.field.name,g=u.field.value,m=u.field.image,v=u.field.icon,b=null,y=[],w=[],x=[],k=[],I="",T=!1;function O(n){var f,O,$=t.extend(!0,u,n);if($.onBeforeInit&&$.onBeforeInit.call(s,$),$.appendTo=$.appendTo||e.hasRouter&&router.currentPage()||"body",y=[],w=[],x=[],k=[],d=$.id?e.obj($.id).attr("id"):d,u=s.config=$,b="function"==typeof $.template?$.template:L,$.data&&$.data.length||T)var F=b.call(this,$.data);if(s.template=b,$.popup)if(c)o.find(".bui-dialog-list").html(F);else{if($.id)o=e.obj($.id);else{var B=function(e){var n="",i='<div class="bui-searchbar bui-box">\n                                    <div class="span1">\n                                        <div class="bui-input">\n                                            <i class="icon-search"></i>\n                                            <input type="search" value="" placeholder="请输入关键字" />\n                                            <div class="bui-searchbar-close"><i class="icon-removefill"></i></div>\n                                        </div>\n                                    </div>\n                                </div>',o='<div class="bui-dialog-result"></div>',a=u.templateTitle?u.templateTitle.call(s,u)||"":`<div class="bui-dialog-title">${u.title}</div>`;u.popup&&(n+='<div id="'+d+'" class="bui-dialog bui-dialog-select">',(u.title||u.needSearch)&&(n+=`<div class="bui-dialog-head">\n                                ${u.title||u.templateTitle?a:""}\n                                ${u.needSearch?i:""}\n                            </div>`),n+='  <div class="bui-dialog-main">');u.popup&&(n+='<div class="bui-dialog-list"></div>',n+=""+(u.needSearch?o:""),n+="  </div>",u.buttons.length>0&&(n+='    <div class="bui-dialog-foot bui-box">',t.each(u.buttons,(function(e,t){n+='        <div class="span1">',n+='             <div class="bui-btn '+(t.className||"")+'" value="'+(t.value||"")+'">'+(t.name||t)+"</div>",n+="        </div>"})),n+="    </div>"),n+="</div>");return n}();t($.appendTo).append(B),(o=e.obj(d)).find(".bui-dialog-list").html(F)}c=e.dialog({id:d,effect:$.effect,mask:$.mask,zIndex:$.zIndex,position:$.position,autoClose:!1,height:$.height,width:$.width,zoom:!1,fullscreen:$.fullscreen,onMask:function(e){P()}}),$.appendTo&&$.id&&(t($.appendTo).append(o.prop("outerHTML")),o.remove(),o=t($.id))}else{if(!$.id)return void e.hint("select id 必须有");o=e.obj($.id),($.data&&$.data.length||T)&&o.html(F)}return s.$el=o,l=o.find($.handle),$.data&&$.data.length<1&&(f=[],O=[],l.find("input").each((function(e,n){var i=t(this);if(!(i.length<1)){var o=i.val(),a=i.attr("text"),r=i.attr("image"),l=i.attr("icon"),c=i.is(":checked");u.data[e]={},u.data[e][p]=a,u.data[e][g]=o,u.data[e][m]=r,u.data[e][v]=l,f.push(o),O.push(a),c&&C({name:a,value:o,index:e})}}))),function(n){n.trigger&&(i=e.obj(n.trigger),I=n.placeholder||i.text()||n.title,r=i.find(n.triggerChildren).length?i.find(n.triggerChildren):i,a=n.placeholder||t.trim(r.html()||""),n.placeholder&&r.html(n.placeholder),i.off("click.bui").on("click.bui",(function(e){var i=n.onBeforeOpen&&n.onBeforeOpen.call(s);t(this).hasClass("disabled")||0==i||j()})));function l(e){e?(g.css("display","block"),p.css("display","block")):(g.css("display","none"),p.css("display","none"))}var c=function(i){var o=t(i.target[i.target.length-1]);if(!o.attr("disabled")){var a=o.val(),r=o.attr("text"),l=o.attr("index"),c="INPUT"!==i.srcElement.nodeName?o.is(":checked"):!o.is(":checked");i.target=o[0],i.index=l,c?c&&(n.toggle||"checkbox"==n.type)&&(R.call(s,"uncheck",i),e.array.remove(y,r),e.array.remove(w,a),e.array.remove(x,l),e.array.remove(k,l)):(R.call(s,"check",i),C({name:r,value:a,index:l})),h&&n.onChange&&n.onChange.call(s,i),E(w.join(",")||"",i),N(y.join(",")||""),i.stopPropagation()}},u=function(e){var i=null;e.srcElement=e.originalEvent&&e.originalEvent.srcElement||e.srcElement,i=t(this).find("input"),e.target=[i[0]],c.call(s,e),n.popup&&n.autoClose&&P(),R.call(s,"select",e),e.stopPropagation()},d=n.needSearch?".bui-dialog-list "+n.handle:n.handle;o.off("click.bui",d).on("click.bui",d,u);var f=function(e){n.callback&&n.callback.call(s,e,s),e.stopPropagation()};o.off("click.bui",n.callbackHandle).on("click.bui",n.callbackHandle,f);var p=o.find(".bui-searchbar-close"),g=o.find(".bui-dialog-result"),m=o.find(".bui-searchbar input");n.data&&n.data.length&&n.needSearch&&(o.find(".btn-search").click((function(e){var t=o.find(".bui-searchbar input").val();S(t),l(t),e.stopPropagation()})),m.on("input",(function(e){var n=t(this).val();S(n),l(n),e.stopPropagation()})),p.click((function(e){m.val(""),g.css("display","none"),t(this).css("display","none"),e.stopPropagation()})),o.on("click.bui",".bui-dialog-result .bui-btn",(function(i){var o=t(this).find("input"),a="INPUT"!==i.srcElement.nodeName?o.is(":checked"):!o.is(":checked"),r=o.attr("text"),l=o.attr("value"),c=e.array.index(n.data,l,"value");a&&(n.toggle||"checkbox"==n.type)?(o.prop("checked",!1),R.call(s,"uncheck",i),e.array.remove(y,r),e.array.remove(w,l),e.array.remove(x,c),e.array.remove(k,c),n.onChange&&n.onChange.call(s,i)):(o.prop("checked",!0),R.call(s,"check",i),C({name:r,value:l,index:c}),n.onChange&&n.onChange.call(s,i)),E(w.join(",")||"",i),N(y.join(",")||""),i.stopPropagation()})));T=!0}($),$.value&&E($.value),$.onInited&&$.onInited.call(s,$),this}function C(e){var t=parseInt(e.index,10);switch(u.type){case"radio":case"select":w=[],x=[],k=[],(y=[]).push(e.name),w.push(e.value),k.push(e.icon),x.push(t);break;case"checkbox":y.push(e.name),w.push(e.value),k.push(e.icon),x.push(t)}}function S(t){var n=e.array.filter(u.data,t,u.field.name),i=`没有与此相关的结果:<span class="danger-reverse">${t}</span>`,a=e.guid();n.length&&(i=L(n,a)),o.find(".bui-dialog-result").css("display","block").html(i)}function L(n,i){var o=i||f,a="",r="";return t.each(n,(function(n,i){var a="string"==typeof i?i:i[p]||i||"",l=i&&i[m]?i[m]||i:"",c=i&&i[v]?i[v]||i:"",s=i&&i[g]?i[g]||i:i||a||n,d={name:o,value:s,text:a,index:n};l&&(d.image=l),c&&(d.icon=c),i=i&&"object"===e.typeof(i)?i:{};var f=function(t){t=t||{};var n=document.createElement("input");for(var i in t)"string"!=typeof t[i]&&"number"!=typeof t[i]||n.setAttribute(i,t[i]);switch(u.type){case"mulelect":n.setAttribute("type","checkbox"),n.setAttribute("class",u.className||"bui-choose");break;case"select":n.setAttribute("type","radio"),n.setAttribute("class",u.className||"bui-choose");break;case"radio":n.setAttribute("type","radio"),n.setAttribute("class",u.className||"bui-radio");break;case"checkbox":n.setAttribute("type","checkbox"),n.setAttribute("class",u.className||"bui-choose");break;default:n.setAttribute("type","checkbox")}return e.array.compare(w,t.value)&&n.setAttribute("checked","true"),n}(t.extend(!0,{},i,d)).outerHTML;if(r+='    <div class="bui-btn bui-box bui-btn-line">',"left"==u.direction&&(r+=f),l){var h=e.unit.endWithImage(l)?'<div class="thumbnail"><img src="'+l+'" alt="" /></div>':'<div class="thumbnail '+l+'"></div>';r+=h}if(c){var b=e.unit.endWithImage(c)?'<i class="icon"><img src="'+c+'" alt="" /></i>':'<i class="icon '+c+'"></i>';r+=b}"center"==u.direction?(r+='        <div class="span1" align="center">'+a+"</div>",r+=f):r+='        <div class="span1">'+a+"</div>","right"==u.direction&&(r+=f),r+="    </div>"})),a+='    <div class="bui-list bui-list-select">',a+=r,a+="    </div>"}function j(e){R.call(this,"beforeshow");var t={};return"function"==typeof e?t.callback=function(){e&&e.call(s),R.call(s,"show")}:"string"==typeof e?t.effect=e:"object"==typeof e&&(t=e),u.popup&&c?(!c.isOpen()&&c.open(t),R.call(s,"show")):(o.css("display","block"),t.callback?t.callback():R.call(s,"show")),this}function P(e){R.call(this,"beforehide");var t={};return"function"==typeof e?t.callback=function(){e&&e.call(s)}:"string"==typeof e?t.effect=e:"object"==typeof e&&(t=e),u.popup&&c?(c.isOpen()&&c.close(t.effect||t.callback),R.call(s,"hide")):(o.css("display","none"),t.callback?t.callback():R.call(s,"hide")),this}function E(t,n){if(void 0===t)return w.join(",");n=n||event,l=o.find(u.handle);var a=[],c=[],d=[],f=[],m=[],b=[];"string"==typeof t&&t.indexOf(",")>-1?b=t.split(","):t instanceof Array?b=t:t&&b.push(t),u.data&&u.data.forEach((function(t,n){var i=t&&"object"===e.typeof(t)&&t.hasOwnProperty(p)?String(t[p]):String(t),o=t&&"object"===e.typeof(t)&&t.hasOwnProperty(v)?String(t[v]):"",r=t&&"object"===e.typeof(t)&&t.hasOwnProperty(g)?String(t[g]):String(t)||String(n),s=l.eq(n).find("input");if(""==t)return s.prop("checked",!1),y=[],w=[],x=[],void(k=[]);var h=e.array.index(b,i);e.array.index(b,r)>-1||h>-1?("radio"!=u.type&&"select"!=u.type||(c=[],d=[],m=[],f=[]),c.push(i),d.push(r),f.push(o),m.push(n),a[n]=s,s.prop("checked",!0)):s.prop("checked",!1)})),y=c.slice(0),w=d.slice(0),x=m.slice(0),k=f.slice(0);var T=n||{target:a[a.length-1],index:x};R.call(s,"change",T),!h&&u.onChange&&u.onChange.call(s,n),i&&u.change&&(i.attr("value",d.join(",")),r.text(y.join(",")||I)),o.attr("value",d.join(",")),h=!1}function N(e){return void 0===e?y.join(","):(i&&u.change&&(i.attr("text",e),r.html(e||a)),o.attr("text",e),this)}function $(e){var t=[];return String(e).indexOf(",")>-1?t=e.split(","):t.push(parseInt(e)),y=[],w=[],t.forEach((function(e,t){u.data[e]&&y.push(u.data[e][p]||u.data[e]),u.data[e]&&w.push(u.data[e][g]||u.data[e]||t)})),"checkbox"==u.type||"mulselect"==u.type?(N(y.join(",")),E(w.join(","))):(N(y[0]),E(w[0])),this}function F(){return y=[],w=[],x=[],k=[],l.find("input").prop("checked",null),E(""),N(""),R.call(this,"reset"),this}function B(t,n){return e.off.apply(s,arguments),this}function R(t){s.self=this==window||this==s?null:this,e.trigger.apply(s,arguments)}return u.autoinit&&O(u),s}}(window.bui||{},window.libs),function(e,t){e.dropdown=function(n){var i,o,a,r,l,c,s={name:"dropdown",handle:{},on:function(t,n){return e.on.apply(s,arguments),this},off:k,active:b,disabled:function(){var e=o;return e&&e.addClass("disabled"),this},enabled:function(){var e=o;return e&&e.removeClass("disabled"),this},value:v,values:function(){return{name:g,value:p}},reset:function(){return p="",v(""),y(h),w(),this},text:y,hide:w,show:function(){return o.addClass("active"),c.css("display","block"),I.call(this,"show"),this},hideAll:x,destroy:function(e){e=1==e;i&&(i.off("click.bui"),e&&i.remove());o&&(o.off("click.bui"),e&&o.remove());t("body").off("click.bui"),k("show"),k("hide")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(s,t,n)},config:u,init:m},u=s.config=t.extend(!0,{},{id:"",handle:".bui-btn",handleChildren:".span1",target:".bui-list",targetHandle:".bui-btn",data:null,position:"bottom",showArrow:!1,showActive:!0,autoClose:!0,stopPropagation:!1,width:0,value:"",relative:!0,change:!0,autoinit:!0,template:null,onBeforeInit:null,onInited:null,callback:null,onChange:null},e.config.dropdown,n),d=document.documentElement.clientWidth,f=!1,h="",p="",g="";function m(n){var p=t.extend(!0,u,n);if(p.onBeforeInit&&p.onBeforeInit.call(s,p),p.id){if(i=e.obj(p.id),s.$el=i,u=s.config=p,o=i.children(p.handle),c=p.target?i.find(p.target):o.next(),h=o.text(),p.data&&p.data.length){var g="function"==typeof p.template?p.template.call(s,p.data):function(e){var t="";return t+='<ul class="bui-list">',e.map((function(e,n){t+='<li class="bui-btn" value="'+e.value+'">'+e.name+"</li>"})),t+="</ul>"}(p.data);c.length?c.remove()&&o.after(g):i.append(g),c=i.find(p.target)}r=p.relative,a=i.attr("position")||p.position;var m=i[0]&&i[0].offsetLeft>=document.documentElement.clientWidth?0:i[0]&&i[0].offsetLeft,y=p.width?"auto":-m+"px",k={bottom:{menuPosition:"bui-menu-bottom",arrowPosition:"bui-arrow-up",left:y},top:{menuPosition:"bui-menu-top",arrowPosition:"bui-arrow-down",left:y},left:{menuPosition:"bui-menu-left",arrowPosition:"bui-arrow-right",left:"auto"},right:{menuPosition:"bui-menu-right",arrowPosition:"bui-arrow-left",left:"100%"}};if(l=p.width>0?p.width:r?d:p.width,parseFloat(l)>0&&c.width(l),function(e,t){c.addClass(e),r&&c.css({left:t})}(p.showArrow?k[a].arrowPosition+" "+k[a].menuPosition:k[a].menuPosition,k[a].left),p.value)v(p.value);else{var T=c.find(p.targetHandle+".active").eq(0).index();T>-1&&b(T)}return f||function(e){var n=function(n){if(!t(this).hasClass("disabled")){var i=t(this).hasClass("active"),o=e.target?t(this).parent().find(e.target):t(this).next();x(),i?(t(this).removeClass("active"),o.css("display","none"),I.call(s,"hide")):(t(this).addClass("active"),o.css("display","block"),I.call(s,"show")),n.stopPropagation()}},a=function(n){var i=t(this),o=i.parent(),a=v(),r=i.attr("value")||"";t.trim(i.text()),null!=o.attr("change")?o.attr("change"):e.change;e.showActive&&i.addClass("active").siblings().removeClass("active"),v.call(this,r),u.autoClose&&w(),n.target=this,e.callback&&e.callback.call(s,n),a!==r&&e.onChange&&e.onChange.call(s,n),u.stopPropagation&&n.stopPropagation()};o.off("click.bui").on("click.bui",n),i.off("click.bui",e.targetHandle).on("click.bui",e.targetHandle,a);var r=function(e){x(),e.stopPropagation()};u.autoClose&&t("body").off("click.bui").on("click.bui",":not(.bui-dropdown)",r),f=!0}(p),p.onInited&&p.onInited.call(s,p),this}e.showLog("dropdown id不能为空","bui.dropdown.init")}function v(n){if(void 0===n)return o.attr("value");var i="htmllielement"===e.typeof(this),a=i&&t(this).parent(),r=i?t(this).parents(".bui-dropdown").children(u.handle):o,l=i?a.find(u.targetHandle):c.find(u.targetHandle);if(l.removeClass("active"),u.data&&u.data.length){if(""==n)return p="",void r.attr("value",n);var d=e.array.index(u.data,String(n),"value"),f=e.array.index(u.data,String(n),"name");d>-1?(l.eq(d).addClass("active"),r.attr("value",n),u.change&&y.call(this,u.data[d].name),p=n):f>-1&&(l.eq(f).addClass("active"),r.attr("value",u.data[f].value),u.change&&y.call(this,n),p=u.data[f].value)}else l.each((function(e,i){var o=i.innerText,a=i.getAttribute("value");o!=n&&a!=n||(t(this).addClass("active"),r.attr("value",a),u.change&&y.call(this,o),p=a)}));u.change||I.call(s,"change")}function b(e){e=parseInt(e);var n=c.find(u.targetHandle).eq(e);n.length>=0&&(v(n.attr("value")||t.trim(n.text())||""),u.showActive&&n.addClass("active").siblings().removeClass("active"));return this}function y(n){if(void 0===n)return g||t.trim(o.text());var i="htmllielement"===e.typeof(this)?t(this).parents(".bui-dropdown").children(u.handle):o,a=i.children(u.handleChildren);return a.length?a.text(n):i.text(n),g=n,I.call(s,"change"),this}function w(){return o.removeClass("active"),c.css("display","none"),I.call(this,"hide"),this}function x(){return t(".bui-dropdown > .bui-btn").removeClass("active"),t(".bui-dropdown > .bui-list").css("display","none"),I.call(this,"hide"),this}function k(t,n){return e.off.apply(s,arguments),this}function I(t){s.self=this==window||this==s?null:this,e.trigger.apply(s,arguments)}return u.autoinit&&m(u),s}}(window.bui||{},window.libs),function(e,t){e.accordion=function(n){var i,o,a={name:"accordion",handle:{},on:function(t,n){return e.on.apply(a,arguments),this},off:p,showFirst:function(){l.length>1?l.each((function(e,t){d(0,t)})):d(0);return g.call(this,"show",{target:i[0]}),this},showAll:function(){return(i=h()).each((function(e,n){t(n).addClass("active").next(r.target).css("display","block")})),g.call(this,"showall",{target:i}),this},hideAll:f,disabled:function(e){var t;t="number"==typeof e?i.eq(e):i;return t&&t.addClass("disabled"),this},enabled:function(e){var t;t="number"==typeof e?i.eq(e):i;return t&&t.removeClass("disabled"),this},destroy:function(e){l&&(l.off("click.bui"),l.remove(),l=null);p("hide"),p("show")},show:function(e){e=Number(e)||0;var t=i.eq(e).length?i.eq(e):i,n=o.eq(e).length?o.eq(e):t.next(r.target);return t.addClass("active"),n.css("display","block"),g.call(this,"show",{target:i[e]}),this},hide:function(e){e=Number(e)||0;var t=i.eq(e).length?i.eq(e):i,n=o.eq(e).length?o.eq(e):t.next(r.target);return t.removeClass("active"),n.css("display","none"),g.call(this,"hide",{target:i[e]}),this},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(a,t,n)},config:r,init:s},r=a.config=t.extend(!0,{},{id:"",handle:"dt",target:"dd",height:0,targetHeight:0,single:!1,stopPropagation:!1,lock:!1,autoinit:!0,onBeforeInit:null,onInited:null,callback:null},e.config.accordion,n),l=null,c=!1;function s(n){var s=t.extend(!0,r,n);return s.onBeforeInit&&s.onBeforeInit.call(a,s),document.documentElement.clientWidth,document.documentElement.clientHeight,l=e.obj(s.id)||e.obj("."+e.prefix("accordion")),r=a.config=s,i=h(),o=s.target.indexOf("#")>-1?e.obj(s.target):l.children(s.target),function(e){i.removeClass("active"),o.css("display","none"),parseFloat(e.targetHeight)>0&&o.height(e.targetHeight);parseFloat(e.height)>0&&l.height(e.height)}(s),c||function(e){var n=function(n){if(!t(this).hasClass("disabled")&&!t(this).attr("href")){if(!1===(e.callback&&e.callback.call(a,n)))return!1;u.call(this,n,e),(e.stopPropagation||!t(this).attr("href"))&&n.stopPropagation()}};e.handle.indexOf("#")>-1?!e.lock&&i.off("click.bui").on("click.bui",n):!e.lock&&l.off("click.bui").on("click.bui",e.handle,n);c=!0}(s),s.onInited&&s.onInited.call(a,s),this}function u(n,o){var r=t(this),l=r.hasClass("active"),c=(i.index(this),o.target.indexOf("#")>-1?e.obj(o.target):r.next(o.target));o.single?l?(r.removeClass("active"),c.css("display","none"),g.call(a,"hide",n)):(f(),r.addClass("active"),c.css("display","block"),g.call(a,"show",n)):l?(r.removeClass("active"),c.css("display","none"),g.call(a,"hide",n)):(r.addClass("active"),c.css("display","block"),g.call(a,"show",n))}function d(e,n){e=e||0;(n?t(n):l).children(r.handle).eq(e).addClass("active").next(r.target).css("display","block")}function f(){return(i=h()).each((function(e,n){t(n).removeClass("active").next(r.target).css("display","none")})),g.call(this,"hideall",{target:i}),this}function h(){return r.handle.indexOf("#")>-1?e.obj(r.handle):l.children(r.handle)}function p(t,n){return e.off.apply(a,arguments),this}function g(t){a.self=this==window||this==a?null:this,e.trigger.apply(a,arguments)}return r.autoinit&&s(r),a}}(window.bui||{},window.libs),function(e,t){e.rating=function(n){var i,o,a,r,l,c={name:"rating",handle:{},on:function(t,n){return e.on.apply(c,arguments),this},off:m,disabled:function(e){(e=0!=e)?(i.off("click.bui",s.handle),v.call(c,"disabled")):g();return this},enabled:g,show:function(e){var t=function(e){var t,n="",i=(e=String(e)||String(r),0),o=s.stars,a=[];a=e.indexOf(".")>-1?e.split("."):[e,0];var l=parseInt(a[0]);for(t=a[1]/10*100+"%",i=0;i<o;i++)i<l&&(n+='<div class="bui-rating-cell" ><div class="bui-rating-cell-full" style="width:100%;">&nbsp;</div></div>'),i==l&&(n+='<div class="bui-rating-cell" ><div class="bui-rating-cell-full" style="width:'+t+';">&nbsp;</div></div>'),i>l&&(n+='<div class="bui-rating-cell" ><div class="bui-rating-cell-full" style="width:0;">&nbsp;</div></div>');return n}(e);i.attr("value",e).html(t),r=e},value:p,reset:function(){return p(s.value),this},destroy:function(e){e=1==e;i&&(i.off("click.bui"),e&&i.remove());m("change")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:d},s=c.config=t.extend(!0,{},{id:"",handle:".bui-rating-cell",fullClassName:"bui-rating-cell-full",halfClassName:"bui-rating-cell-half",half:!1,stars:5,value:0,disabled:!1,render:!0,autoinit:!0,onBeforeInit:null,onChange:null,onInited:null,callback:null},e.config.rating,n),u=!1;function d(n){var r=t.extend(!0,s,n);if(r.onBeforeInit&&r.onBeforeInit.call(c,r),r.id)return i=e.obj(r.id),c.$el=i,s=c.config=r,o=r.fullClassName,a=r.halfClassName,function(t){if(t.render){var n=function(t){e.guid();var n="",i=0,o=t.stars;for(i=0;i<o;i++)n+='<div class="bui-rating-cell" ></div>';return n}(t);i.html(n),l=i.children(t.handle)}else l=i.children(t.handle);p(t.value)}(r),u||f(r),r.onInited&&r.onInited.call(c,r),this;e.hint("rating id不能为空")}function f(e){if(!e.disabled){var n=String(e.value).indexOf(".")>-1?1:0;i.off("click.bui",e.handle).on("click.bui",e.handle,(function(i){var o=t(this).index(),a=parseInt(p()),r=0;h(r=e.half&&n%2==0?o+.5:o+1),p(r),n++,a!==r&&e.onChange&&e.onChange.call(c,i),e.callback&&e.callback.call(c,i),i.stopPropagation()}))}u=!0}function h(e){var n=[];e=String(e),s.half&&e.indexOf(".")>-1?n=e.split("."):n.push(e),l.removeClass(o).removeClass(a),l.each((function(e,i){var r=parseInt(n[0]);1==n.length&&e<r?t(i).addClass(o):2==n.length&&(e<r&&t(i).addClass(o),e==r&&t(i).addClass(a))}))}function p(e){return void 0!==e&&/^-?\d+(\.\d+)?$/.test(e)?(i.attr("value",e),h(e),r=e,v.call(c,"change",e)):r=i.attr("value"),r}function g(e){return s.disabled=!1,f(s),v.call(c,"enabled"),this}function m(t,n){return e.off.apply(c,arguments),this}function v(t){c.self=this==window||this==c?null:this,e.trigger.apply(c,arguments)}return s.autoinit&&d(s),c}}(window.bui||{},window.libs),function(e,t){e.actionsheet=function(n){var i,o,a,r={name:"actionsheet",handle:{},on:function(t,n){return e.on.apply(r,arguments),this},off:h,disabled:function(e){var t=o;return t&&t.addClass("disabled"),this},enabled:function(){var e=o;return e&&e.removeClass("disabled"),this},hide:d,show:f,destroy:function(e){e=1==e;o&&o.off("click.bui");h("hide"),h("show"),i&&i.destroy(e)},widget:function(t){var n={dialog:i};return e.widget.call(n,t)},option:function(t,n){return"buttons"==t&&void 0!==n?function(t,n){if(n&&"array"===e.typeof(n)){var i=u(n);e.obj(l.id).find(".bui-list").html(i)}}(0,n):e.option.call(r,t,n)},config:l,init:s},l=r.config=t.extend(!1,{},{id:"",appendTo:".bui-page",trigger:"",handle:".bui-btn",position:"bottom",effect:"fadeInUp",zIndex:110,width:0,mask:!0,opacity:.6,data:null,buttons:[],template:null,cancelText:"取消",autoinit:!0,onMask:null,onBeforeOpen:null,onBeforeClose:null,onBeforeInit:null,onInited:null,callback:null},e.config.actionsheet,n),c=!1;function s(n){var s,h,g=t.extend(!0,l,n);if(g.onBeforeInit&&g.onBeforeInit.call(r,g),o=e.obj(g.trigger),l=r.config=g,c)e.obj(l.id).find(".bui-list").html(u(g.data||g.buttons));else{var m="function"==typeof g.template?g.template.call(r,g.data||g.buttons):function(e){var t=parseFloat(l.width),n=t>0?"width:"+t+"px;left:50%;right:0;margin-left:-"+t/2+"px;":"",i="";e&&e.length&&(i+='<div id="'+l.id+'" class="bui-actionsheet" style="'+n+'">',i+='    <ul class="bui-list">',i+=u(e),i+="    </ul>",l.cancelText&&(i+='    <div class="bui-btn" value="cancel">'+l.cancelText+"</div>"),i+="</div>");return i}(g.data||g.buttons);e.obj(g.appendTo).append(m)}return i||(i=e.dialog({id:l.id,position:g.position,mask:g.mask,effect:g.effect,opacity:g.opacity,zIndex:g.zIndex,onBeforeOpen:g.onBeforeOpen,onBeforeClose:g.onBeforeClose,onMask:function(){d(),g.onMask&&g.onMask()}})),a=i.$el(),a.find(g.handle),c||(s=function(e){e.target=this,l.callback&&l.callback.call(r,e,r),p.call(r,"click",e)},h=function(e){t(this).hasClass("disabled")||f.call(this)},a&&a.off("click.bui",l.handle).on("click.bui",l.handle,s),o&&o.off("click.bui").on("click.bui",h),c=!0),g.onInited&&g.onInited.call(r,g),this}function u(e){var n="";return t.each(e,(function(e,t){n+='        <li class="bui-btn '+(t.className||"")+'" value="'+(t.value||"")+'">'+(t.name||"")+"</li>"})),n}function d(e){p.call(this,"beforehide");var t={};return"function"==typeof e?t.callback=function(){e&&e.call(r),p.call(r,"hide")}:"string"==typeof e?t.effect=e:"object"==typeof e&&(t=e),i.isOpen()&&i.close(t),this}function f(e){p.call(this,"beforeshow");var t={};return"function"==typeof e?t.callback=function(){e&&e.call(r),p.call(r,"show")}:"string"==typeof e?t.effect=e:"object"==typeof e&&(t=e),!i.isOpen()&&i.open(t),this}function h(t,n){return e.off.apply(r,arguments),this}function p(t){r.self=this==window||this==r?null:this,e.trigger.apply(r,arguments)}return l.id=l.id||e.guid(),l.autoinit&&s(l),r}}(window.bui||{},window.libs),function(e,t){e.number=function(n){var i,o,a,r={name:"number",handle:{},on:function(t,n){return e.on.apply(r,arguments),this},off:b,$el:function(t){return e.selector.call(a,t)},disabled:function(n){g();var i=this&&"htmldivelement"===e.typeof(this)?t(this):o;(n=0!=n)?i.attr("disabled","disabled"):i.removeAttr("disabled");return this},reset:function(){var e=l.value||l.min;return p.call(this,e),e},value:function(e){var t=0;void 0!==e?(p.call(this,e),t=e):t=h.call(this);return t},values:function(t){a.length<1&&(a=u.find(l.id));if(t&&"array"===e.typeof(t))return Array.prototype.slice.call(a).forEach((function(e,n){(e.id||e.getAttribute("name")||"")==t[n].id&&(e.querySelector("input").value=t[n].value)})),this;var n=[];Array.prototype.slice.call(a).forEach((function(e,t){var i=e.id||e.getAttribute("name")||"",o=e.querySelector("input").value;n.push({id:i,value:o})}));return n},prev:m,next:v,destroy:function(e){e=1==e;(a=u.find(l.id))&&(a.off("click.bui"),a.off("input"),e&&a.remove());b("prev"),b("next"),b("change")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(r,t,n)},config:l,init:d},l=r.config=t.extend(!0,{},{parentId:".bui-page",id:".bui-number",min:0,max:100,step:1,value:1,disabled:!1,render:!0,tips:!1,autocheck:!0,decimal:1,name:"",prev:".bui-number-prev",input:"input",next:".bui-number-next",onInput:null,autoinit:!0,inited:null,onBeforeInit:null,onInited:null,onChange:null,callback:null},e.config.number,n),c=!1,s=!1,u=null;function d(n){var d=t.extend(!0,l,n);return d.onBeforeInit&&d.onBeforeInit.call(r,d),d.max,d.min,i=d.step,u=e.obj(d.parentId),"object"==typeof d.id?(a=e.obj(d.id),s=!1):"string"==typeof d.id&&0===d.id.indexOf("#")?(a=e.obj(d.id),s=!0):(a=u.find(d.id),s=!1),l=r.config=d,d.render&&function(t){var n=function(t){var n="";return n+='    <div class="bui-number-prev"><i class="icon-minus"></i></div>',n+='    <input class="bui-number-input" type="text" name="'+(t.name||e.guid())+'" value="'+t.value+'"/>',n+='    <div class="bui-number-next"><i class="icon-plus"></i></div>'}(t);a.html(n)}(d),a.children(d.prev),a.children(d.next),o=a.children(d.input),c||function(n){var i=".bui-number "+n.input,o=".bui-number "+n.prev,d=".bui-number "+n.next,h=function(e){var i=t(this).val();e.value=f(i),n.onInput&&n.onInput.call(r,e),e.stopPropagation()},g=function(e){var i=n.autocheck&&isNaN(parseFloat(t(this).val(),10))?0:parseFloat(t(this).val(),10);/^[-\\+]?([0-9])+$/i.test(i)&&p.call(this,f(i)),e.value=f(i),n.onChange&&n.onChange.call(r,e),e.stopPropagation()},b=function(e){var i=t(this).next(l.input);e.value=i.val(),m.call(i,e),n.callback&&n.callback.call(r,e),e.preventDefault(),e.stopPropagation()},y=function(e){var i=t(this).prev(l.input);e.value=i.val(),v.call(i,e),n.callback&&n.callback.call(r,e),e.preventDefault(),e.stopPropagation()};s?(n.onInput&&a.off("input",n.input).on("input",n.input,e.unit.debounce(h,400)),a.off("change",n.input).on("change",n.input,g),a.off("click.bui",n.prev).on("click.bui",n.prev,b),a.off("click.bui",n.next).on("click.bui",n.next,y)):(n.onInput&&u.off("input",i).on("input",i,e.unit.debounce(h,400)),u.off("change",i).on("change",i,g),u.off("click.bui",o).on("click.bui",o,b),u.off("click.bui",d).on("click.bui",d,y));c=!0}(d),d.disabled&&o.attr("disabled","disabled"),p(d.value),d.target=o,d.value=d.value,d.onInited&&d.onInited.call(r,d),d.inited&&d.inited.call(r,d),this}function f(e,t,n){return t=t||l.min,n=n||l.max,e<t?e=t:e>n&&(e=n),e}function h(){g();var n=this&&"htmldivelement"===e.typeof(this)?t(this):o;return parseInt(n.val(),10)}function p(n){g();var i=this&&"object"===e.typeof(this)?o:t(this);return Array.prototype.slice.call(i).forEach((function(t,i){var o=t.getAttribute("max")||t.parentElement.getAttribute("data-max")||l.max,a=t.getAttribute("min")||t.parentElement.getAttribute("data-min")||l.min,c=l.autocheck?function(e,t,n){var i=e||0;i>n&&(i=n);i<t&&(i=t);i&&i>=t&&i<=n&&(i=i);return i}(n,a,o):n;t.value=c;this&&e.typeof(this);y.call(r,"change",{target:t,value:n}),l.onChange&&l.onChange.call(r,{target:t,value:n})})),this}function g(){"object"==typeof l.id?(a=e.obj(l.id),s=!1):"string"==typeof l.id&&0===l.id.indexOf("#")?(a=e.obj(l.id),s=!0):(a=u.find(l.id),s=!1),a.children(l.prev),a.children(l.next),o=a.children(l.input)}function m(){g();var n=this&&"htmldivelement"===e.typeof(this)?t(this):event?t(event.target).parent().next():o,a=+n.val();a-=i;var c=/^-?\d*\.\d+$/.test(i)?parseFloat(a).toFixed(l.decimal):a;return p.call(n,c),y.call(r,"prev",c),this}function v(){g();var n=this&&"htmldivelement"===e.typeof(this)?t(this):event?t(event.target).parent().prev():o,a=+n.val();a+=i;var c=/^-?\d*\.\d+$/.test(i)?parseFloat(a).toFixed(l.decimal):a;return p.call(n[0],c),y.call(r,"next",c),this}function b(t,n){return e.off.apply(r,arguments),this}function y(t){r.self=this==window||this&&this.hasOwnProperty("widget")?null:this,e.trigger.apply(r,arguments)}return l.autoinit&&d(l),r}}(bui||{},libs),function(e,t){e.stepbar=function(n){var i,o,a={name:"stepbar",handle:{},on:function(t,n){return e.on.apply(a,arguments),this},off:u,value:s,next:function(e){var t=s()+1;return d.call(this,"next",t),s(t,e)},prev:function(e){var t=s()-1;return d.call(this,"prev",t),s(t,e)},destroy:function(e){e=1==e;i&&(i.off("click.bui"),e&&i.remove());u("next"),u("prev"),u("change")},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(a,t,n)},config:r,init:c},r=a.config=t.extend(!0,{},{id:null,handle:".bui-stepbar-cell",hasNumber:!1,lineCenter:!1,click:!0,autoinit:!0,data:[],template:null,value:null,onBeforeInit:null,onInited:null,callback:null},e.config.stepbar,n),l=!1;function c(n){var c=t.extend(!0,r,n);if(c.onBeforeInit&&c.onBeforeInit.call(a,c),c.id){i=e.obj(c.id),r=a.config=c;var u,d,f="function"==typeof c.template?c.template.call(a,c.data):(u=c.data,d="",t.each(u,(function(e,t){var n=r.hasNumber?e+1:"",i=r.hasNumber?"bui-stepbar-number ":"",o=t.className||"";d+='<div class="bui-stepbar-cell '+i+o+'">',d+='    <span class="bui-stepbar-dot">'+n+"</span>",d+='    <div class="bui-stepbar-text">',t.title&&(d+="        <h3>"+t.title+"</h3>"),t.subtitle&&(d+='        <p class="bui-stepbar-time">'+t.subtitle+"</p>"),t.content&&(d+='        <p class="bui-stepbar-desc">'+t.content+"</p>"),d+="    </div>",d+="</div>"})),d);return c.lineCenter&&i.addClass("bui-stepbar-center"),c.data.length&&i.html(f),a.$el=i,o=i.children(),l||function(e){var n=function(n){e.click&&s(t(this).index());e.callback&&e.callback.call(a,n,a)};i.off("click.bui",e.handle).on("click.bui",e.handle,n),l=!0}(c),"number"==typeof c.value&&s(c.value),c.onInited&&c.onInited.call(a,c),this}e.hint("stepbar id不能为空")}function s(e,n){return n=n||"","number"==typeof e?(e=e>=o.length-1?o.length-1:e<0?0:e,o.each((function(i,o){i<e&&t(o).removeClass("active "+n).addClass("visited"),i==e&&t(o).removeClass("visited "+n).addClass("active "+n),i>e&&t(o).removeClass("visited active "+n)})),d.call(this,"change",e),e):e=i.children(".active").index()}function u(t,n){return e.off.apply(a,arguments),this}function d(t){a.self=this==window||this==a?null:this,e.trigger.apply(a,arguments)}return r.autoinit&&c(r),a}}(window.bui||{},window.libs);var n=function(e){var t=this,n={updateValuesOnTouchmove:!1,rotateEffect:!1,momentumRatio:7,freeMode:!1};for(var i in e=e||{},n)void 0===e[i]&&(e[i]=n[i]);function o(e){return window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(e):window.mozCancelAnimationFrame?window.mozCancelAnimationFrame(e):window.clearTimeout(e)}function a(e,t){for(var n=0;n<e.length;n++){var i=e[n].style;i.webkitTransform=i.MsTransform=i.msTransform=i.MozTransform=i.OTransform=i.transform=t}return e}function r(e,t){"string"!=typeof t&&(t+="ms");for(var n=0;n<e.length;n++){var i=e[n].style;i.webkitTransitionDuration=i.MsTransitionDuration=i.msTransitionDuration=i.MozTransitionDuration=i.OTransitionDuration=i.transitionDuration=t}return e}function l(e,t){var n,i,o,a;return void 0===t&&(t="x"),o=window.getComputedStyle(e,null),window.WebKitCSSMatrix?((i=o.transform||o.webkitTransform).split(",").length>6&&(i=i.split(", ").map((function(e){return e.replace(",",".")})).join(", ")),a=new WebKitCSSMatrix("none"===i?"":i)):n=(a=o.MozTransform||o.OTransform||o.MsTransform||o.msTransform||o.transform||o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,")).toString().split(","),"x"===t&&(i=window.WebKitCSSMatrix?a.m41:16===n.length?parseFloat(n[12]):parseFloat(n[4])),"y"===t&&(i=window.WebKitCSSMatrix?a.m42:16===n.length?parseFloat(n[13]):parseFloat(n[5])),i||0}t.params=e,t.cols=[],t.initialized=!1;var c,s,u,d,f,h,p=(c=navigator.userAgent,s=c.match(/(Android);?[\s\/]+([\d.]+)?/),u=c.match(/(iPad).*OS\s([\d_]+)/),d=c.match(/(iPod)(.*OS\s([\d_]+))?/),f=!u&&c.match(/(iPhone\sOS)\s([\d_]+)/),h=!!s,u||d||f||navigator.userAgent.toLowerCase().indexOf("safari")>=0&&navigator.userAgent.toLowerCase().indexOf("chrome")<0&&!h);return t.setValue=function(e,n){var i=0;if(0===t.cols.length)return t.value=e,void t.updateValue(e);for(var o=0;o<t.cols.length;o++)t.cols[o]&&!t.cols[o].divider&&(t.cols[o].setValue(e[i],n),i++)},t.updateValue=function(e){for(var n=e||[],i=[],o=0;o<t.cols.length;o++)t.cols[o].divider||(n.push(t.cols[o].value),i.push(t.cols[o].displayValue));n.indexOf(void 0)>=0||(t.value=n,t.displayValue=i,t.params.onChange&&t.params.onChange(t,t.value,t.displayValue))},t.initPickerCol=function(e,n){var i=$(e),c=i.index(),s=t.cols[c];if(!s.divider){var u,d,f,h,g;s.container=i,s.wrapper=s.container.find(".picker-items-col-wrapper"),s.items=s.wrapper.find(".picker-item"),s.replaceValues=function(e,n,i){s.destroyEvents(),s.values=e,s.displayValues=n;var o=t.columnHTML(s,!0);s.wrapper.html(o),s.items=s.wrapper.find(".picker-item"),s.calcSize(),s.setValue(i||s.values[0],0,!0),s.initEvents()},s.calcSize=function(){var e,n;t.params.rotateEffect&&(s.container.removeClass("picker-items-col-absolute"),s.width||(s.container[0].style.width="")),e=0,n=s.container[0].offsetHeight,s.wrapper[0].offsetHeight,u=s.items[0].offsetHeight,d=u*s.items.length,f=n/2-d+u/2,h=n/2-u/2,s.width&&(e=s.width,parseInt(e,10)===e&&(e+="px"),s.container[0].style.width=e),t.params.rotateEffect&&(s.width||(s.items.each((function(){var t=$(this);t[0].style.width="auto",e=Math.max(e,t[0].offsetWidth),t[0].style.width=""})),s.container[0].style.width=e+2+"px"),s.container.addClass("picker-items-col-absolute"))},s.calcSize(),a(s.wrapper,"translate3d(0,"+h+"px,0)"),r(s.wrapper,"0ms"),s.setValue=function(e,t,n){void 0===t&&(t="");var i=s.wrapper.find('.picker-item[data-picker-value="'+e+'"]').index();void 0!==i&&-1!==i||(i=0);var o=-i*u+h;a(s.wrapper,"translate3d(0,"+o+"px,0)"),r(s.wrapper,t+"ms");try{s.updateItems(i,o,t,n)}catch(e){}},s.updateItems=function(e,n,i,o){void 0===n&&(n=l(s.wrapper[0],"y")),void 0===e&&(e=-Math.round((n-h)/u)),e<0&&(e=0),e>=s.items.length&&(e=s.items.length-1);var c=s.activeIndex;s.wrapper.find(".picker-selected").removeClass("picker-selected"),r(s.items,i);var d=s.items.eq(e).addClass("picker-selected");a(d,""),t.params.rotateEffect&&s.items.each((function(){var e=$(this),t=(e.index()*u-(h-n))/u,i=Math.ceil(s.height/u/2)+1,o=-18*t;o>180&&(o=180),o<-180&&(o=-180),Math.abs(t)>i?e.addClass("picker-item-far"):e.removeClass("picker-item-far"),a(e,"translate3d(0, "+(-n+h)+"px, "+(p?-110:0)+"px) rotateX("+o+"deg)")})),(o||void 0===o)&&(s.value=d.attr("data-picker-value"),s.displayValue=s.displayValues?s.displayValues[e]:s.value,c!=e&&(s.onChange&&s.onChange(t,s.value,s.displayValue),t.updateValue()))},n&&s.updateItems(0,h,0);var m,v,b,y,w,x,k,I,T,O,C=!0;s.initEvents=function(e){var t=/hp-tablet/gi.test(navigator.appVersion),n="ontouchstart"in window&&!t,i=n?"touchstart":"mousedown",o=n?"touchmove":"mousemove",a=n?"touchend":"mouseup",r=e?"off":"on";s.container[r](i,S),s.container[r](o,L),s.container[r](a,j),"mouseup"==a&&document.documentElement.addEventListener("mouseleave",j,!1),s.items[r]("click",P)},s.destroyEvents=function(){s.initEvents(!0)},s.initEvents()}function S(e){if(!v&&!m){var t=e.originalEvent||e;t.preventDefault(),m=!0,b=y=t.targetTouches?t.targetTouches[0].pageY:t.pageY,w=(new Date).getTime(),C=!0,x=I=l(s.wrapper[0],"y")}}function L(e){if(m){var n=e.originalEvent||e;n.preventDefault(),C=!1,y=n.targetTouches?n.targetTouches[0].pageY:n.pageY,v||(o(g),v=!0,x=I=l(s.wrapper[0],"y"),r(s.wrapper,"0ms")),n.preventDefault(),k=void 0,(I=x+(y-b))<f&&(I=f-Math.pow(f-I,.8),k="min"),I>h&&(I=h+Math.pow(I-h,.8),k="max"),a(s.wrapper,"translate3d(0,"+I+"px,0)"),s.updateItems(void 0,I,0,t.params.updateValuesOnTouchmove),O=I-T||I,(new Date).getTime(),T=I}}function j(e){if(m&&v){var n;m=v=!1,r(s.wrapper,""),k&&a(s.wrapper,"min"===k?"translate3d(0,"+f+"px,0)":"translate3d(0,"+h+"px,0)"),n=(new Date).getTime()-w>300?I:I+O*t.params.momentumRatio,n=Math.max(Math.min(n,h),f);var i=-Math.floor((n-h)/u);t.params.freeMode||(n=-i*u+h),a(s.wrapper,"translate3d(0,"+parseInt(n,10)+"px,0)"),s.updateItems(i,n,"",!0),setTimeout((function(){C=!0}),100)}else m=v=!1}function P(e){if(C){o(g);var t=$(this).attr("data-picker-value");s.setValue(t)}}},t.columnHTML=function(e,t){var n="",i="";if(e.divider)i+='<div class="picker-items-col picker-items-col-divider '+(e.textAlign?"picker-items-col-"+e.textAlign:"")+" "+(e.cssClass||"")+'">'+e.content+"</div>";else{for(var o=0;o<e.values.length;o++)n+='<div class="picker-item" data-picker-value="'+e.values[o]+'">'+(e.displayValues?e.displayValues[o]:e.values[o])+"</div>";i+='<div class="picker-items-col '+(e.textAlign?"picker-items-col-"+e.textAlign:"")+" "+(e.cssClass||"")+'"><div class="picker-items-col-wrapper">'+n+"</div></div>"}return t?n:i},t.layout=function(){var e,n;t.cols=[];var i="";for(n=0;n<t.params.cols.length;n++){var o=t.params.cols[n];i+=t.columnHTML(t.params.cols[n]),t.cols.push(o)}e='<div class="'+("picker-modal picker-columns "+(t.params.cssClass||"")+(t.params.rotateEffect?" picker-3d":""))+'"><div class="picker-modal-inner picker-items">'+i+'<div class="picker-center-highlight"></div></div></div>',t.pickerHTML=e},t.init=function(){t.initialized||(t.layout(),t.container=$(t.pickerHTML),t.container.addClass("picker-modal-inline"),$(t.params.container).html(t.container),t.container.find(".picker-items-col").each((function(){var e=!0;(!t.initialized&&t.params.value||t.initialized&&t.value)&&(e=!1),t.initPickerCol(this,e)})),t.value?t.setValue(t.value,0):t.params.value&&t.setValue(t.params.value,0)),t.initialized=!0},t.init(),t};!function(e,t){e.picker=function(e){return new n(e)}}(window.bui||{}),function(e,t){e.pickerdate=function(){function n(e,t){if(e&&e.constructor==Date)return e;if("number"==typeof e&&13===String(e).length)return new Date(e);e=String(e);var n=new Date,i=n.getFullYear(),o=n.getMonth()+1,a=n.getDate();return(e=e.replace(/[-|年|月]/gim,"/").replace(/[时|分|秒|小时|分钟]/gim,":").replace(/^(\d{4}\/\d+?)($|\s)/,(function(e,t){return t+"/1"})).replace(/[日|号]/gim,"").replace(/^(\d{1,2}\/\d{1,2}?)($|\s)/,(function(e,t){return n.getFullYear()+"/"+t}))).indexOf("/")<0&&e.indexOf(":")>-1&&(e=i+"/"+o+"/"+a+" "+e),4===e.length?e+="/1/1 00:00:00":"MM"===t||"M"===t?e=i+"/"+e+"/1 00:00:00":"dd"!==t&&"d"!==t||(e=i+"/"+o+"/"+e+" 00:00:00"),new Date(e)}function i(i){var o,a,r,l,c,s,u,d,f,h,p=e.guid(),g={id:p,title:"",height:260,popup:!0,mask:!0,autoinit:!0,zIndex:110,bindValue:!1,handleParent:"",position:"bottom",effect:"fadeInUp",appendTo:"",rotateEffect:!1,buttons:[{name:"取消",className:""},{name:"确定",className:"primary-reverse"}],onBeforeInit:null,onInited:null,onMask:function(){y&&y.close()},callback:null},m=null,v=this,b=function(){},y=null,w=t.extend(!0,{},g,i);w.appendTo=w.appendTo||e.hasRouter&&router.currentPage()||"body",w.callback=function(e){var a=i.callback&&i.callback.call(v,e);if(!1===a)return!1;if(1==a||void 0===a)if("取消"==t(e.target).text().trim()||"cancel"==t(e.target).text().trim()||"关闭"==t(e.target).text().trim())try{var r=n(o);v.value(r)}catch(e){}else o=v.value();m=null};var x={},k=["FullYear","Month","Date"],I=["Hours","Minutes","Seconds"],T={FullYear:"year",Month:"month",Date:"date",Hours:"hour",Minutes:"minute",Seconds:"second"},O=[];function C(e){var t=new Date("1970/1/1");return O.forEach((function(n,i){t["set"+n](e[x[n]].value-("Month"==n?1:0))})),t}function S(e){var t=n(e);return O.map((function(e,n){return t["get"+e]()+("Month"==e?1:0)}))}function L(){if(!t(this).hasClass("disabled")){if(w.bindValue){m=t(this),v.el=this;var e=m.val()||m.text();v.value(e)}y&&!y.isOpen()&&y.open()}}this.config={},this.option=function(){},this.cols=function(e){e=e||{};var t=[];return f=[],d=[],x={},O=[],k.forEach((function(n,i){"none"!==e[T[n]]&&(O.push(n),t.push(n))})),I.forEach((function(t,n){"none"!==e[T[t]]&&(O.push(t),f.push(t))})),t.forEach((function(t,n){x[t]=d.length,d.push(E[t](e[T[t]]))})),f.forEach((function(n,i){0==i&&0!=t.length?d.push(E.Space()):d.push(E.Divider()),0==t.length&&(d[0].content=""),x[n]=d.length,d.push(E[n](e[T[n]]))})),v.picker&&(v.picker.params.cols=d,v.picker.initialized=!1,v.picker.init()),this},this.id=function(e){e&&!c&&(c=e)},this.reset=function(){return v.picker&&(v.picker.initialized=!1,v.picker.init()),this},this.empty=function(){return v.picker&&e.obj(i.handle).val(""),this},this.min=function(e){var t=(new Date).getFullYear()-1+"/01/01 00:00:00";return r=n(e||w.min||t),this},this.max=function(e){var t=(new Date).getFullYear()+1+"/12/31 00:00:00";return l=n(e||w.max||t),this},this.value=function(e){if(e){var t=S(n(e,v.config.formatValue));return v.picker.setValue(t,0),this}return u(v.picker,v.value,v.displayValue)},this.handler=function(t){return t&&a!==t&&(a=t,i.handleParent?e.$(i.handleParent).off("click.bui",a).on("click.bui",a,L):e.$(a).off("click.bui").on("click.bui",L),L.hasOpen=!1,a=t),this};var j={y:function(e,t){return e.getFullYear().toString().slice(-t)},M:function(e,t){return((t>1?"0":"")+(e.getMonth()+1)).slice(-2)},d:function(e,t){return((t>1?"0":"")+e.getDate()).slice(-2)},h:function(e,t){return((t>1?"0":"")+e.getHours()).slice(-2)},m:function(e,t){return((t>1?"0":"")+e.getMinutes()).slice(-2)},s:function(e,t){return((t>1?"0":"")+e.getSeconds()).slice(-2)}};this.formatValue=function(e){return u=function(t,n,i){var o=C(t.cols);return e.replace(/y+|M+|d+|h+|m+|s+/g,(function(e){return j[e[0]](o,e.length)}))},v.picker&&v.picker.updateValue(),this},this.formatDate=function(e,t){if(null==e)return"";var i=n(e);t=t||"yyyy-MM-dd";var o={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),o)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?o[a]:("00"+o[a]).substr((""+o[a]).length)));return t},this.onChange=function(t){var n=this;return s=w.bindValue?function(i){m?m[0]&&"INPUT"===m[0].nodeName?m.val(i):m.text(i):e.obj(a).each((function(e,t){"INPUT"===t.nodeName?t.value=i:t.innerTEXT=i})),t&&t.call(n,i)}:t||b,N.call(this,"change",h),this},this.popup=function(n){if(n.popup&&!y){var i='<div id="'+p+'" class="bui-dialog" >';n.title&&(i+='<div class="bui-dialog-head">'+n.title+"</div>"),i+='<div class="bui-dialog-main"><div id="'+p+'-picker"></div></div>',n.buttons&&n.buttons.length&&(i+='<div class="bui-dialog-foot bui-box">',t.each(n.buttons,(function(e,t){var n="object"==typeof t&&"className"in t?" "+t.className:"",o="object"==typeof t&&"name"in t?t.name:t;i+='<div class="span1"><div class="bui-btn'+n+'">'+o+"</div></div>"})),i+="</div>"),i+="</div>";t(n.appendTo).append(i);c=e.obj(p+"-picker")}else c=e.obj(n.id);return this};var P=function(e,t,n){var i=C(e.cols),o=r["get"+t](),a=l["get"+t](),c=i.getTime(),s=r.getTime(),u=l.getTime();return c<s&&i["get"+t]()<o?("Month"==t&&(o+=1),void e.cols[x[t]].setValue(o)):c>u&&i["get"+t]()>a?("Month"==t&&(a+=1),void e.cols[x[t]].setValue(a)):void(n&&(c<s||c>u)&&e.cols[x[n]].onChange(e))},E={};function N(t){v.self=this==window||this==v?null:this,e.trigger.apply(v,arguments)}E.FullYear=function(e){return{values:(e=e||{values:function(){for(var e=[],t=r.getFullYear(),n=l.getFullYear(),i=t;i<=n;i++)e.push(i);return e}()}).values,displayValues:e.displayValues,onChange:function(e,t,n){P(e,"FullYear",x.Month?"Month":"")}}},E.Month=function(e){return{values:(e=e||{values:[1,2,3,4,5,6,7,8,9,10,11,12],displayValues:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}).values,displayValues:e.displayValues,textAlign:"right",onChange:function(e,t,n){for(var i=new Date,o=e.cols[x.FullYear]?e.cols[x.FullYear].value:i.getFullYear(),a=e.cols[x.Month]?e.cols[x.Month].value:i.getMonth()+1,r=new Date(o,parseInt(a),0).getDate(),l=[],c=1;c<=r;c++)l.push(c);var s=e.cols[x.Date];s&&s.replaceValues&&s.replaceValues(l,null,s.value<r?s.value:r),P(e,"Month",x.Date?"Date":"")}}},E.Date=function(e){return{values:(e=e||{values:function(){var e=31,t=[];do{t.unshift(e)}while(e--);return t}(),displayValues:function(){var e=31,t=[];do{t.unshift(e+"天")}while(e--);return t}()}).values,displayValues:e.displayValues,onChange:function(e,t,n){P(e,"Date")}}},E.Space=function(){return{divider:!0,content:"  "}},E.Hours=function(e){return{values:(e=e||function(){for(var e=[],t=[],n=0;n<24;n++)e.push(n),t.push(("0"+n).slice(-2));return{values:e,displayValues:t}}()).values,displayValues:e.displayValues,onChange:function(e,t,n){P(e,"Hours",x.Minutes?"Minutes":"")}}},E.Divider=function(){return{divider:!0,textAlign:"center",content:":"}},E.Minutes=function(e){return{values:(e=e||function(){for(var e=[],t=[],n=0;n<60;n++)e.push(n),t.push(("0"+n).slice(-2));return{values:e,displayValues:t}}()).values,displayValues:e.displayValues,onChange:function(e,t,n){P(e,"Minutes",x.Seconds?"Seconds":"")}}},E.Seconds=function(e){return{values:(e=e||function(){for(var e=[],t=[],n=0;n<60;n++)e.push(n),t.push(("0"+n).slice(-2));return{values:e,displayValues:t}}()).values,displayValues:e.displayValues,onChange:function(e,t,n){P(e,"Seconds")}}},v.init=function(i){var a,f,p,g=t.extend(!0,w,i);g.onBeforeInit&&g.onBeforeInit.call(v,g),v.config=g,v.min(g.min),v.max(g.max),v.cols(g.cols),v.id(g.id),v.$el=e.obj(g.handle)||null,v.el=v.$el?v.$el[0]:null,v.handler(g.handle),v.popup(g),v.onChange(g.onChange),v.formatValue(g.formatValue||"yyyy-MM-dd hh:mm:ss"),v.picker=e.picker({container:c,rotateEffect:g.rotateEffect,value:S(g.value?n(g.value):(a=r,f=l,p=new Date,p.getTime()<a.getTime()?a:p.getTime()>f.getTime()?f:p)),onChange:function(e,t,n){var i=u(e,t,n);h!=i&&(h=i,s&&s.call(v,i),N.call(this,"change",i))},cols:d}),g.popup&&!y&&((y=e.dialog.call(v,g))&&y.on("open",(function(){o=u(v.picker,v.value,v.displayValue),v.picker&&(v.picker.initialized=!1,v.picker.init()),N.call(v,"show")})),y&&y.on("close",(function(){N.call(v,"hide")}))),g.onInited&&g.onInited.call(v,g)},w.autoinit&&v.init(w),this.name="pickerdate",this.disabled=function(){var t=e.obj(a);return t&&t.addClass("disabled"),this},this.open=function(e){return y.open(e),this},this.isOpen=function(){return y.isOpen()},this.close=function(e){return y.close(e),this},this.modifyTitle=function(t){return e.obj(p).find(".bui-dialog-head").html(t),this},this.enabled=function(){var t=e.obj(a);return t&&t.removeClass("disabled"),this},this.destroy=function(e){e=1==e;this.off("show"),this.off("hide"),this.off("change"),y&&y.destroy(e),v=null},this.widget=function(t){var n={dialog:y||{}};return e.widget.call(n,t)},this.on=function(t,n){return e.on.apply(v,arguments),this},this.off=function(t,n){return e.off.apply(v,arguments),this}}return function(e){return new i(e)}}()}(window.bui||{},window.libs),function(e,t){e.levelselect=function(n){var i=t.extend(!0,{},{popup:!0,data:[],height:300,appendTo:"",title:"所在地区",trigger:null,placeholder:"请选择",level:3,visibleNum:2,scrollNum:1,log:!1,mask:!0,zIndex:121,autoClose:!0,fullscreen:!1,position:"bottom",effect:"fadeInUp",showValue:!0,onMask:null,value:[],autoinit:!0,onChange:null,onBeforeInit:null,template:null,onInited:null,toggle:!1,field:{name:"n",icon:"icon",image:"image",value:"",data:["c","a"]}},n),o=[],a=bui.guid(),r=a+"-slide",l=null,c=null,s=0,u=[],d=null,f=[],h=[],p=[],g=[],m=null,v={name:"levelselect",init:y,show:w,hide:function(e){S.call(this,"beforehide");var t={};"function"==typeof e?t.callback=function(){e&&e.call(v),S.call(v,"hide")}:"string"==typeof e?t.effect=e:"object"==typeof e&&(t=e);m&&m.close(t)},widget:function(t){var n={dialog:m,slide:d,select:f};return e.widget.call(n,t)},value:k,reset:function(){return f.forEach((function(e,t){e.value(""),0==t?(T(t,i.placeholder),e.text(i.placeholder),d&&d.to(t)):(T(t,""),e.text(""))})),this},setNav:T,destroy:function(e){for(let e=0;e<f.length;e++)f[e].destroy(),g[e].text(""),p[e].off("change"),h[e].off("click");m.destroy(),m=null,d.destroy(),d=null,o=[],l=null,c=null,s=0,u=[],f=[],h=[],p=[],g=[],C("change"),C("lastchange")},option:function(t,n){return e.option.call(v,t,n)},to:function(e,t){return d&&d.to(e,t),this},prev:function(){return d&&d.prev(),this},next:function(){return d&&d.next(),this},on:function(t,n){return e.on.apply(v,arguments),this},off:C,trigger:S};n.appendTo=n.appendTo||e.hasRouter&&router.currentPage()||"body";var b=n.id?t(n.id):t(n.appendTo);function y(n){var y=i=v.config=t.extend(!0,{},i,n);y.onBeforeInit&&y.onBeforeInit.call(v,y);var T="";y.popup?(m||(T=function(e){var t="";return t+='<div id="'+a+'" class="bui-dialog bui-levelselect" style="display:none;">',t+='    <div class="bui-dialog-head">'+e.title+"</div>",t+='    <div class="bui-dialog-main">',t+=O(e),t+="    </div>",t+='    <div class="bui-dialog-close"><i class="icon-close"></i></div>',t+="</div>"}(y),b.append(T),m=bui.dialog({id:a,height:y.height,mask:y.mask,scroll:!1,zIndex:y.zIndex,autoClose:y.autoClose,fullscreen:y.fullscreen,position:y.position,effect:y.effect,onMask:y.onMask})),l=e.obj(a)):(T=O(y),b.append(T),l=e.objId(a)),v.$el=l,c=e.objId(r);var C=0;for(C=0;C<y.level;C++)!function(n){p[n]=e.$(".select-level-val-"+n,l),h[n]=e.$(".select-level-"+n,c),y.trigger&&(g[n]=e.$(y.trigger).eq(n)),f[n]||(f[n]=bui.select({id:h[n],type:"select",direction:"right",field:{name:y.field.name,icon:y.field.icon,image:y.field.image,value:y.field.value||y.field.name},popup:!1,toggle:y.toggle,data:[],template:y.template}),f[n].on("change",(function(i){y.log&&console.log("change",n);var a=f[n].index()||0,r=f[n].value()||"",l=f[n].text()||f[n].value();u[n]={name:l,value:r,index:a};var c=[];"string"==typeof y.field.data?c=o[n][a][y.field.data]||o[n][a]:y.field.data&&"array"===e.typeof(y.field.data)&&y.field.data.forEach((function(e,t){o[n][a][y.field.data[t]]&&o[n][a][y.field.data[t]].length&&(c=o[n][a][y.field.data[t]])})),o[n+1]=c,f[n+1]&&f[n+1].option("data",c),f[n+2]&&f[n+2].option("data",[]),h[n]&&h[n].find(".bui-btn").removeClass("active"),t(i.target).parents(".bui-btn").addClass("active"),I(n),p[n]&&p[n].text(l),p[n+1]&&p[n+1].text(y.placeholder),p[n+2]&&p[n+2].text(""),g[n]&&g[n].text(l),g[n+1]&&g[n+1].text(y.placeholder),g[n+2]&&g[n+2].text(""),i.context={trigger:g[n],selector:p[n],index:n,select:f[n],data:o[n]};var s=o[n],b=o[n+1]||[];S.call(v,"change",i,s,b),y.onChange&&y.onChange.call(v,i,s,b),(n==y.level-1||b.length<1)&&S.call(v,"lastchange",i,s,b),1==y.visibleNum&&(y.log&&console.log("next"),d.next()),y.popup&&!m.isOpen()||(n==y.level-1?(y.log&&console.log("close"),y.autoClose&&m&&m.close()):0!=n&&(y.log&&console.log("next"),d.next()))})),p[n].on("click.bui",(function(){var e=t(this).index(),n=d.index();1==y.visibleNum?d.to(e):(e>n?d.next():d.prev(),t(this).addClass("active").siblings().removeClass("active"))})))}(C);!function(t){e.$(t.trigger).click((function(){w()}))}(y);var L=window&&window.viewport&&window.viewport.height()||t(window).height(),j=y.fullscreen?L:String(y.height).indexOf("%")>-1?L*parseFloat(y.height)/100:y.height;y.popup&&m?m.on("open",(function(e){s=j-l.find(".select-value").height()-l.children(".bui-dialog-head").height(),x(y)})):(s=j,x(y)),p[0]&&p[0].text(y.placeholder),g[0]&&g[0].text(y.placeholder),o[0]=y.data,f[0].option("data",o[0]),y.value&&k(y.value),y.onInited&&y.onInited.call(this,y)}function w(e){S.call(this,"beforeshow");var t={};"function"==typeof e?t.callback=function(){e&&e.call(v),S.call(v,"show")}:"string"==typeof e?t.effect=e:"object"==typeof e&&(t=e),m&&m.open(t)}function x(e){d||(d=bui.tab({id:r,height:s,scroll:!0,zoom:!1,visibleNum:e.visibleNum,scrollNum:e.scrollNum}).lock()).on("to",(function(e){I(e)}))}function k(t){if(void 0===t)return u;t&&"array"===e.typeof(t)?t.forEach((function(e,t){"string"==typeof e?f[t].value(e):"object"==typeof e&&(f[t].text(e.name||""),f[t].value(e.value||""))})):e.showLog("levelselect.value() 参数是一个数组类型")}function I(e){t(".select-value div",l).removeClass("active"),t(".select-value div",l).eq(e).addClass("active")}function T(e,n){return t(".select-value div",l).eq(e).html(n),g[e].html(n),this}function O(e){var t="",n=0;if(e.popup||(t+='<div id="'+a+'" class="bui-levelselect">'),e.showValue){for(t+='    <div class="bui-box select-value">',n=0;n<e.level;n++)t+='        <div class="select-level-val-'+n+'"></div>';t+="    </div>"}for(t+='<div id="'+r+'" class="bui-tab bui-levelselect-tab">',t+='    <div class="bui-tab-main">',t+="        <ul>",n=0;n<e.level;n++)t+="            <li>",t+='                <div class="select-level-'+n+'"></div>',t+="            </li>";return t+="        </ul>",t+="    </div>",t+="</div>",e.popup||(t+="</div>"),t}function C(t,n){return e.off.apply(v,arguments),this}function S(t){v.self=this==window||this==v?null:this,e.trigger.apply(v,arguments)}return i.onBeforeInit&&i.onBeforeInit.call(v,i),i.autoinit&&y(i),v}}(window.bui||{},window.libs);t((function(e){!function(t,n){t.tab=function(i){var o=e.config=n.extend(!0,{},{id:"",menu:".bui-tab-head > ul",children:".bui-tab-main > ul",header:"header",footer:"footer",main:".bui-tab-main",item:"li",prev:".bui-tab-prev",next:".bui-tab-next",data:null,navscroll:!1,loadall:!1,position:"top",BiconBadge:!0,iconPosition:"left",loaded:null,compiled:null,sideWidth:0,align:"center",alignClassName:"",stopHandle:"",width:0,height:0,relative:!1,zoom:!1,swipe:!0,animate:!0,bufferEffect:!1,visibleNum:1,scrollNum:1,distance:40,direction:"x",autoplay:!1,autoheight:!1,scroll:!0,index:0,fullscreen:!1,autopage:!1,autoload:!1,autoinit:!0,template:null,async:!0,callback:null,onBeforeInit:null,onInited:null,onStart:null,onMove:null,onEnd:null},t.config.slide,i),a=null,r=null,l=t.guid();function c(e,n){if(e&&!/[0-9]/.test(e))return this;var i=t.$(o.id).find(o.menu).children().eq(e),a=void 0!==n?n:"",r=i.find(".bui-badges"),l=i.find("i");return r.size()?r.text(n):l.size()&&o.iconBadge?l.append(`<span class="bui-badges">${a}</span>`):i.append(`<span class="bui-badges">${a}</span>`),this}function s(e){var n=t.$(o.id).find(o.menu).children();return void 0!==e?n.eq(e).find(".bui-badges").remove():n.find(".bui-badges").remove(),this}function u(e,n){var i=templatesNav(n||r);t.$(e).html(i)}function d(e){var t="left"==o.position||"right"==o.position?" bui-tab-sidenav":"",n=`${o.navscroll?'<div class="bui-navbar">':""}<ul class="bui-nav ${l}-menu ${t}">`;return e&&e.forEach((function(e,t){n+=function(e,t){var n="",i=function(e,t){return e.icon?e.icon.indexOf("&#")>-1?`<i class="icon">${e.icon}</i>`:`<i class="${e.icon}"></i>`:""}(e)||function(e,t){return e.image?`<i class="icon"><img src="${e.image}" /></i>`:""}(e),a=e.className?""+e.className:"";switch(o.iconPosition){case"left":n+=`<li class="bui-btn bui-align-${o.align} ${a}">${i}${e.title}</li>`;break;case"right":n+=`<li class="bui-btn bui-align-${o.align} bui-box ${a}"><div class="span1">${e.title}</div>${i}</li>`;break;case"bottom":n+=`<li class="bui-btn bui-align-${o.align} bui-box-vertical ${a}"><div class="span1">${e.title}</div>${i}</li>`;break;default:n+=`<li class="bui-btn bui-align-${o.align} bui-box-vertical ${a}">${i}<div class="span1">${e.title}</div></li>`}return n}(e)})),n+="</ul>\n                "+(o.navscroll?"</div>":"")}function f(e){var t="",n=o.menu.indexOf("#")>-1?"":function(e){var t=`<div class="bui-tab-head ${"bottom"==o.position?"bui-tab-foot":""}">`;return t+=d(e),t+"</div>"}(e),i=function(e){var t=`${"left"==o.position||"right"==o.position?'<div class="span1">':""}<div class="bui-tab-main"><ul class="${l}-main">`;return e&&e.forEach((function(e,n){t+=`<li class="bui-tab-main-item">\n                            <component id="${e.id}" class="delay-item" name="${e.name}" delay="true"></component>\n                        </li>`})),t+="</ul></div>",t+="left"==o.position||"right"==o.position?"</div>":""}(e);switch(o.position){case"top":t=n+i;break;case"bottom":t=i+n;break;default:t=n+i}return t}return function(e){var i,h;r=n.extend(!0,e.data),e.data&&(e.menu=`.${l}-menu`,e.children=`.${l}-main`,i=r,h=(o.template||f)(i),t.$(o.id).html(h),e.data=null);var p=t.$(".bui-tab-sidenav");if(r&&"left"==e.position){e.sideWidth&&p.width(e.sideWidth);var g=e.sideWidth||p.width();e.width=e.width||n(window).width()-g,t.$(e.id).addClass("bui-tab-left"),t.$(e.id).css({"margin-left":g}),p.css("left",-g)}else if(r&&"right"==e.position){e.sideWidth&&p.width(e.sideWidth);g=e.sideWidth||p.width();e.width=e.width||n(window).width()-g,t.$(e.id).addClass("bui-tab-right"),p.css({left:"100%"})}return a=t.slide(e),"left"!=e.position&&"right"!=e.position||t.$(e.id).css({overflow:"visible"}),r&&a.on("to",(function(){var e=this.index(),t=r&&r[e]||{},n=o.loadall?".delay-item":"#"+t.id;loader.delay({id:n,param:t.param,everytime:t.everytime,loaded:o.loaded,compiled:o.compiled})})).to(e.index),a.name="tab",a.templateNav=d,a.renderNav=u,a.addBadge=c,a.removeBadge=s,a}(o)}}(window.bui||{},window.libs)}));!function(e,t){e.input=function(n){var i,o,a,r,l,c={name:"input",handle:{},empty:function(){return o.val(""),o.next().css("display","none"),s.showLength&&r.text(0),this},value:function(e){if(void 0!==e)return o.val(e),l.trigger(s.event),this;return o.val()},reset:function(){return o.val(""),l.trigger(s.event),this},toggleType:function(){"text"==o.attr("type")?o.attr("type","password"):o.attr("type","text");return this},on:function(t,n){return e.on.apply(c,arguments),this},off:function(t,n){return e.off.apply(c,arguments),this},widget:function(t){return e.widget.call({},t)},option:function(t,n){return e.option.call(c,t,n)},config:s,init:d},s=c.config=t.extend(!0,{},{id:"",target:"input,textarea",event:"input",iconClass:".icon-remove",showIcon:!0,showLength:!1,maxLength:0,onInput:null,onBlur:null,onFocus:null,autoinit:!0,onBeforeInit:null,onChange:null,onInited:null,callback:null},e.config.searchbar,n),u=!1;function d(n){var d=t.extend(!0,s,n);if(d.onBeforeInit&&d.onBeforeInit.call(c,d),s=c.config=d,""!=d.id&&null!==d.id){if(i=e.obj(d.id),c.$el=i,l=i.find(d.target),o=l.eq(0),a=e.unit.startWithClass(d.iconClass)?d.iconClass:"."+d.iconClass,!u){if(function(e){var n=!1;l.on(e.event,(function(i){var o=this.value,s=t(this).parent(),u=s.find(a);o,o.length>0&&e.showIcon?u&&u.length?u.css("display","block"):(s.append('<i class="'+a.replace(/\./g," ").substr(1)+'"></i>'),u=l.find(a)):u&&u.css("display","none"),e.showLength&&(r=s.find("em")).text(o.length),n||(e.onInput&&e.onInput.call(c,i),f.call(c,"input",i))})).on("compositionstart",(function(){n=!0})).on("compositionend",(function(t){n=!1;var i=o.val();e.onInput&&e.onInput.call(c,t,i)})),e.onChange&&l.off("change").on("change",(function(t){e.onChange.call(c,t),f.call(c,"change",t)})),e.onFocus&&l.off("focus").on("focus",(function(n){var r=this.value;r,o=t(this),e.showIcon&&(i.find(a).css("display","none"),r&&t(this).next().css("display","block")),e.onFocus.call(c,n),f.call(c,"focus",n)})),e.onBlur&&l.off("blur").on("blur",(function(t){var n=e.onBlur&&e.onBlur.call(c,t);1==n||null===n?this.value:"",f.call(c,"blur",t)})),e.showIcon&&i.off("click.bui",a).on("click.bui",a,(function(t){e.callback&&e.callback.call(c,t),f.call(c,"click",t)})),u=!0}(d),d.showLength){var h=function(e){o.parent();return'<span class="bui-input-length"><em>0</em>/'+e.maxLength+"</span>"}(d);i.append(h)}d.maxLength>0&&l.attr("maxlength",d.maxLength)}return d.showLength&&l.trigger(d.event),d.onInited&&d.onInited.call(c,d),this}}function f(t){c.self=this==window||this==c?null:this,e.trigger.apply(c,arguments)}return s.autoinit&&d(s),c}}(bui||{},libs),function(e,t){e.timer=function(n){var i=t.extend({},{interval:1e3,target:null,reduce:!0,onEnd:null,onProcess:null,fixZero:!0,type:"number",time:10,times:0},n),o=i.reduce,a=i.target?e.obj(i.target):null,r=0,l=!1,c=i.times||i.time,s=!1,u=f(i),d=null;function f(t){var n=null;switch(t.type){case"minute":n=60*parseInt(c,10);break;case"hour":n=60*parseInt(c,10)*60;break;case"day":n=60*parseInt(c,10)*60*24;break;case"date":n=(e.date.convert(c).getTime()-(new Date).getTime())/1e3;break;case"second":default:n=parseInt(c,10)}return o||(c=n,n=0),n}function h(t){var n=new Date,o=e.date.format(n,"yyyy-MM-dd"),r=0,l=0,c=0,s="",u=parseInt(t%60,10);switch(i.type){case"minute":s=`${p(l=parseInt(t/60,10))}:${p(u)}`;break;case"hour":r=parseInt(t/60/60,10),l=parseInt(t/60%60,10),s=`${p(r)}:${p(l)}:${p(u)}`;break;case"date":o=e.date.format(i.times||i.time,"yyyy-MM-dd"),c=parseInt(t/60/60/24,10),r=parseInt(t/60/60%24,10),l=parseInt(t/60%60,10),s=`剩余${c}天 ${p(r)}:${p(l)}:${p(u)}`;break;case"day":o=e.date.format(n.getTime()+1e3*t,"yyyy-MM-dd"),c=parseInt(t/60/60/24,10),r=parseInt(t/60/60%24,10),l=parseInt(t/60%60,10),s=`剩余${c}天 ${p(r)}:${p(l)}:${p(u)}`;break;case"second":s=`${p(l=parseInt(t/60,10))}:${p(u)}`;break;case"number":l=parseInt(t/60,10),s=""+p(parseInt(t,10))}return{date:o,day:c,hour:r,minute:l,second:u,count:t,value:s,target:a&&a[0]}}function p(e){return e<10&&i.fixZero?"0"+e:e}var g=o?function e(){l&&(u=r,l=!1);var t=h(u);return u<=0?(u=0,a&&a.text(t.value),i.onEnd&&i.onEnd.call(this,t),clearTimeout(d),void(s=!1)):(a&&a.text(t.value),i.onProcess&&i.onProcess.call(this,t),u--,s=!0,d=setTimeout((function(){e()}),i.interval),this)}:function e(){l&&(u=r,l=!1);var t=h(u);return u>=c?(a&&a.text(t.value),u=c,i.onEnd&&i.onEnd.call(this,t),clearTimeout(d),void(s=!1)):(a&&a.text(t.value),i.onProcess&&i.onProcess.call(this,t),u++,s=!0,d=setTimeout((function(){e()}),i.interval),this)};return{name:"timer",stop:function(e){r=0,u=f(i),clearTimeout(d),d=null,e&&e.call(this)},start:g,restart:function(){return r=0,u=f(i),d=clearTimeout(d),g(),this},status:function(){return s},pause:function(){return r=u,l=!0,clearTimeout(d),this}}}}(window.bui||{},window.libs),function(e,t){e.extend({name:"floor",config:{id:"",menu:"",handle:".bui-btn",floorItem:".bui-floor-item",footer:".bui-floor-footer",area:.5,delay:200,height:"inherit",distance:1,onScroll:null,onScrollTop:null,onScrollBottom:null,onLoaded:null},callback:function(n){var i=this,o=null,a=null,r=null,l=null,c=!0,s=!1,u=!0,d=!0,f=null,h=0,p=[];function g(){p=[],l.each((function(e,t){var n={top:"none"===this.style.display?-1:this.offsetTop,display:this.style.display};p.push(n)}))}i.init=function(n){var f=t.extend(!0,i.config,n);if(i.config=f,f.id||e.showLog("id 不能为空"),o=e.$(f.id),a=e.$(f.menu),r=a&&a.find(f.handle),l=o.find(f.floorItem),o.find(f.footer),"string"==typeof f.height&&"inherit"!==f.height){var m=t(window).height()-e.$("header").height()-e.$("footer").height()-o[0].offsetTop;m=f.height.indexOf("%")>-1?t(window).height()*parseInt(f.height,10)/100:m,o.height(m).css("position","relative"),h=m}else"number"==typeof f.height&&f.height>0?(o.height(f.height).css("position","relative"),h=f.height):h=o.height();g(),s||function(e){var n=function(n){if(c){var o=t(this).scrollTop();0===o&&(n.index=0,i.trigger("scrolltop",n),e.onScrollTop&&e.onScrollTop.call(i,n)),o>5&&u&&(g(),u=!1);var a=h*parseFloat(e.area),l=0;for(l=0;l<p.length;l++){var s=p[l];if(s.top>-1){var d=s.top-o;if(s.top==o&&0==o)return r&&r.removeClass("active"),r&&r.eq(l).addClass("active"),n.index=l,void i.trigger("scrollto",n);d<a&&(r&&r.removeClass("active"),r&&r.eq(l).addClass("active"),n.index=l,i.trigger("scrollto",n))}}parseInt(o+this.offsetHeight,10)==parseInt(this.scrollHeight,10)&&(n.index=p.length-1,i.trigger("scrollbottom",n),e.onScrollBottom&&e.onScrollBottom.call(i,n))}i.trigger("scroll",n),e.onScroll&&e.onScroll.call(i,n)};o.scroll(n),a&&a.off("click.bui",e.handle).on("click.bui",e.handle,(function(e){c=!1,d&&(g(),d=!1);var n=t(this).index();i.to(n),i.trigger("click",e)})),o.parents("main").css("position","relative"),s=!0}(f),f.onLoaded&&f.onLoaded.call(i,f)},i.to=function(e,t){r=a&&a.find(i.config.handle);var n=p[e]&&p[e].top||0;o[0].scrollTop=n,r&&r.removeClass("active"),r&&r.eq(e).addClass("active"),f&&clearTimeout(f),f=setTimeout((function(){c=!0}),i.config.delay),t&&t.call(i,e),i.trigger("to",e);var l={target:o[0],index:e};i.trigger("scrollto",l)},i.destroy=function(e){e=1==e;o&&(o.off("click.bui"),o.off("scroll"),e&&o.remove(),o=null),a&&(a.off("click.bui"),a=null),i.off("click"),i.off("to"),i.off("scroll"),i.off("scrollto"),i.off("scrolltop"),i.off("scrollbottom"),s=!1},i.init(i.config)}})}(window.bui||{},window.libs),function(e,t){e.ajax=function(n){var i=t.Deferred(),o=null,a=t.extend(!0,{},{baseUrl:"",data:{},method:"GET",dataType:"json",timeout:6e4,headers:{},processData:!0,mimeType:"none",cache:!0,async:!0,needJsonString:!1,contentType:null,localData:null,transformRequest:null,transformResponse:null,native:!0,needNative:!1},e.config.ajax,n),r=a.success,l=a.fail||a.error;null===a.contentType&&"get"==a.method.toLocaleLowerCase()?a.contentType="text/html;charset=UTF-8":null===a.contentType&&"post"==a.method.toLocaleLowerCase()?a.contentType="application/x-www-form-urlencoded":a.contentType=a.contentType;"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;if(a.needJsonString)try{a.data="object"==typeof a.data?JSON.stringify(a.data):a.data}catch(e){a.data=a.data}if(a.data=a.transformRequest&&a.transformRequest.call(i,a.data)||a.data,!a.url)return e.showLog("url不能为空","bui.ajax"),i;if(a.url.indexOf("://")>-1?a.url=a.url:a.url.indexOf("./")>-1||a.url.indexOf("../")>-1?a.url=bui.unit.resolvePath(a.url):a.url=a.baseUrl+a.url,a.proxy){var c=a.url.indexOf(a.proxy),s=c>-1?c+1:-1;a.url=a.url.substr(s)}if(i.abort=function(){o&&o.abort()},a.localData)return a.localData=a.transformResponse&&a.transformResponse.call(i,a.localData)||a.localData,r&&r(a.localData,200),i.resolve(a.localData,200),i;if(a.needNative){if(void 0===e.native.ajax)return u(a),i;try{i=e.native.ajax&&e.native.ajax(a)||i}catch(e){}}else u(a);function u(e){e.success=function(t,n,o){var a=null;if("string"==typeof t&&"json"==e.dataType)try{a=JSON.parse(t)}catch(e){a=t}else a=t||{};a=e.transformResponse&&e.transformResponse.call(i,a)||a,r&&r(a,n,o),i.resolve(a,n,o)},e.error=function(t,n,o){var a;if("string"==typeof t&&"json"==e.dataType)try{a=JSON.parse(t)}catch(e){a=t}else a=t||{};l&&l(a,n,o),i.reject(a,n,o)};var n=e.type&&e.type.toUpperCase();e.type=n||e.method.toUpperCase(),o=t.ajax(e)}return i},e.get=function(n,i,o){var a={method:"GET"};a.url=n,a.data=i||{};var r=null,l=o&&o[0];return r=o&&"array"===e.typeof(o)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.get,a,l):a,bui.ajax(r)},e.post=function(n,i,o){var a={method:"POST",contentType:"application/x-www-form-urlencoded"};a.url=n,a.data=i||{};var r=null,l=o&&o[0];return(r=o&&"array"===e.typeof(o)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.post,a,l):a).contentType.indexOf("application/json")>-1&&(r.data="object"==typeof r.data?JSON.stringify(r.data):r.data),bui.ajax(r)},e.put=function(n,i,o){var a={method:"PUT",contentType:"application/json"};a.url=n,a.data=i||{};var r=null,l=o&&o[0];return(r=o&&"array"===e.typeof(o)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.put,a,l):a).contentType.indexOf("application/json")>-1&&(r.data="object"==typeof r.data?JSON.stringify(r.data):r.data),bui.ajax(r)},e.delete=function(n,i,o){var a={method:"DELETE",contentType:"application/json"};a.url=n,a.data=i||{};var r=null,l=o&&o[0];return(r=o&&"array"===e.typeof(o)&&"object"==e.typeof(l)?t.extend(!0,{},e.config.delete,a,l):a).contentType.indexOf("application/json")>-1&&(r.data="object"==typeof r.data?JSON.stringify(r.data):r.data),bui.ajax(r)},e.all=function(n){var i=null;return i=n&&"array"===e.typeof(n)?n:Array.prototype.slice.apply(arguments),t.when.apply(null,i)}}(window.bui||{},window.libs),function(e,t){e.load=function(n){var i,o={url:"",param:{},reload:!!e.hasRouter&&router.config.reload,replace:!1,native:!0,needNative:!1},a=t.extend(!0,{},o,e.config.load,n),r={},l=a.url;if(a.url)if(document.activeElement.blur(),l.indexOf("tel:")>=0||l.indexOf("mailto:")>=0||l.indexOf("sms:")>=0)e.unit.openExtral(l);else{if(l&&l.indexOf("?")>-1){var c=l.split("?");r=e.unit.keyStringToObject(c[1]),a.url=c[0]}try{var s="string"==typeof a.param&&JSON.parse(a.param)||a.param||{};a.param=t.extend(!0,{},r,s)}catch(t){return void e.showLog("param 参数值必须是一个{}对象","bui.load:web")}n&&n.needNative||e.nativeRouter?e.native.load&&e.native.load(a):(i=e.setUrlParams(a.url,a.param),a.reload?window.location.href=e.hasRouter?"index.html#"+i:i:!a.replace||e.hasRouter?e.hasRouter?window.router.load(a):window.location.href=i:window.location.replace(i))}else e.showLog("url 不能为空!","bui.load:web")}}(window.bui||{},window.libs),function(e,t){e.getPageParams=function(n){var i=t.Deferred(),o={callback:null,native:!0,needNative:!1};n=n||{};var a=t.extend(!0,{},o,e.config.getPageParams);"function"==typeof n?a.callback=n:n&&"object"===e.typeof(n)&&(a=t.extend(!0,{},o,e.config.getPageParams,n));"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;if(n&&n.needNative||e.nativeRouter)return i=e.native.getPageParams&&e.native.getPageParams(a)||i;if(e.hasRouter){var r=window.router.getPageParams&&window.router.getPageParams()||e.getUrlParams();a.callback&&a.callback(r),i.resolve(r)}else{var l=e.getUrlParams();a.callback&&a.callback(l),i.resolve(l)}return i}}(window.bui||{},window.libs),function(e,t){e.back=function(n){var i,o={index:-1,name:"",delay:!0,native:!0,beforeBack:!0,callback:null};"function"==typeof n?(o.callback=n,i=t.extend(!0,{},o,e.config.back)):i=n&&"object"===e.typeof(n)?t.extend(!0,{},o,e.config.back,n):t.extend(!0,{},o,e.config.back);"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;var a=e.hasRouter&&router.history&&router.history.getLast()||null;if(!1!==("function"==typeof i.beforeBack?i.beforeBack.call(this,{prevTarget:null,target:a}):i.beforeBack))if(n&&n.needNative||e.nativeRouter)e.native.back&&e.native.back(i);else{if(e.hasRouter)if(window.router.config.syncHistory){var r=e.history.get(),l=r.length-1;if(i.name){var c=e.array.indexs(r,i.name,"name"),s=c.length;i.index=s?-(r.length-c[s-1]-1):-1}if(Math.abs(i.index)>=r.length&&(i.index=-l),Math.abs(i.index)>=window.history.length&&window.router.config.hash&&(i.index=window.router.config.reloadCache?-l:-(window.history.length-1)),0==i.index&&(i.index=-1),window.router.config.hash&&!window.router.config.reloadCache)return void d();(r.length>1||window.history.length>1)&&d()}else window.router.back&&window.router.back(i);else d();var u=null}function d(){var t=(e.hasRouter&&e.history.getPrev()||{}).exports||{};window.history.go(i.index),u&&clearTimeout(u),i.delay&&i.callback?u=setTimeout((function(){e.hasRouter?i.callback.call(router,t):i.callback.call(e,{})}),500):i.callback&&i.callback()}}}(window.bui||{},window.libs),function(e,t){e.refresh=e.history.refresh}(window.bui||{}),function(e,t){e.run=function(n){var i={};"string"==typeof n?i.id=n:n&&"object"===e.typeof(n)&&(i=t.extend(!0,{},{id:"",name:"",data:null,onFail:null,native:!0,needNative:!0},e.config.run,n));var o=String(i.id);"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;if(n.needNative)e.native.run&&e.native.run(i);else if(o.indexOf("http://")>-1||o.indexOf("https://")>-1){var a=e.setUrlParams(i.id,i.data);if(e.platform.isIos())return void(window.location.href=a);(window.open("","_blank")||window.open("","_newtab")).location.href=a}}}(window.bui||{},window.libs),function(e,t){e.fileselect=function(n){var i,o,a,r=t.extend(!0,{},{native:!0,needNative:!1,needCompress:!1,appendTo:"",quality:.8,from:"camera",width:800,height:800,duration:10,onSuccess:null,onFail:null,mediaType:"picture"},e.config.fileselect,n),l=this,c={add:function(n){s=null;var i=t.extend(!0,{needChangeData:!0,needCompress:!1,name:"resize.jpg"},r,n);(u=i).mimeType=n.mimeType?n.mimeType:"",f?(n.from?"picture"===n.from||"photo"===n.from||"savephoto"===n.from?o.removeAttr("capture"):o.attr("capture",n.from):o.removeAttr("capture"),e.platform.isIos()&&"function"==typeof FastClick?o[0].dispatchEvent(new Event("click")):o.trigger("click")):a.add(i);return this},remove:function(t,n){n=n||"name";if(!f)return d=a.remove(t,n);if("string"==typeof t){d.length&&e.array.remove(d,t,n);var i=d.length?d[d.length-1].data:null;return s=i,o[0].value="",d}return this},clear:function(){d=[],s=null,f?o[0].value="":a.clear();return d},value:function(){s=f?s:a.value();return s},data:function(){d=f?d:a.data();return d},toFile:x,toBase64:function(n){var i=t.extend(!0,{needCompress:!1,destinationType:"data",mimeType:"",needChangeData:!1},n);if(i.data=i.data||s,i.mimeType=n.mimeType?n.mimeType:i.data&&i.data.type||"image/jpeg",f)try{w(i)}catch(t){e.showLog(t)}else a.toBase64(i);return this},resize:w,toBlob:k,currentIndex:function(){var e="";e=f?d.length-1:a.data().length-1;return e},currentName:function(){var e="";e=f?d[d.length-1].name:a.value().name;return e},init:y},s=null,u=null,d=[],f="object"==typeof n&&void 0!==n.needNative?!n.needNative:e.isWebapp,h="*",p=!1,g=null,m=null,v=null,b=null;function y(n){var y=t.extend(!0,r,n);switch(r.appendTo=y.appendTo||e.hasRouter&&router.currentPage()||"body",y.mediaType){case"allmedeia":h="*";break;case"picture":case"image":h="image/*";break;case"video":h="video/*";break;case"audio":h="audio/*";break;default:h=y.mediaType}return d=[],g=new Image,m=new FileReader,v=document.createElement("canvas"),b=v.getContext("2d"),f?(!function(){if(null==o){i=bui.guid();var e=r.from?'capture="'+r.from+'"':"",n='<input type="file" accept="'+h+'" name="uploadFiles" id="'+i+'" '+e+' style="display:none"/>';t(r.appendTo).append(n),o=t("#"+i)||t('input[name="uploadFiles"]')}}(),p||(o.on("change",(function(t){var n=this.files;if(!(n.length<1)){n.length>1&&e.showLog("一次只能选一张图片","bui.fileselect:web");var i=n[0];s=i;var o={name:i.name,data:i,type:i.type,size:i.size};d.push(o),u.needCompress?(u.data=i,u.mimeType=u.mimeType?u.mimeType:i.type,w(u)):u.onSuccess&&u.onSuccess.call(l,i,d),this.value=""}})),p=!0)):a=e.native.fileselect&&e.native.fileselect.call(this,n,{module:c})||{},this}function w(n){var i=t.extend(!0,{destinationType:"file",data:null,mimeType:"",quality:.8,width:800,height:800,needCompress:!0,needChangeData:!1,onSuccess:null,onFail:null},r,n);g.onload=function(){var t=this.width,n=this.height,o=null,a=i.width,r=i.height,c=t,u=n;i.needCompress&&(t>a||n>r)&&(t/n>a/r?(c=a,u=Math.round(a*(n/t))):(u=r,c=Math.round(r*(t/n)))),v.width=c,v.height=u,b.clearRect(0,0,c,u),b.drawImage(g,0,0,c,u);var f=v.toDataURL(i.mimeType||i.data&&i.data.type||"image/jpeg",i.quality),h=function(e){return e.indexOf(".png")>-1||e.indexOf(".jpg")>-1||e.indexOf(".gif")>-1||e.indexOf(".jpeg")>-1?e.substr(0,e.lastIndexOf(".")):e}(i.data.name)||"";switch(i.destinationType){case"file":o=x(f,h);break;case"blob":o=k(f);break;case"data":o=f}if(i.needChangeData){s=o;var p=e.array.index(d,i.data.name,"name");p>-1&&(d[p].data=o,o.size&&(d[p].size=o.size),o.type&&(d[p].type=o.type))}return i.onSuccess&&i.onSuccess.call(l,o,d),o},g.onerror=function(){i.onFail&&i.onFail.call(l,g.src)},m.onload=function(e){g.src=e.target.result};try{var o=i.data&&i.data.type||"";o="object"==typeof o?o.type||"":o||"",i.data&&0==o.indexOf("image")&&m.readAsDataURL(n.data)}catch(t){e.showLog(t)}}function x(t,n){try{n=n||"file";for(var i=t.split(","),o=(i[0].match(/:(.*?);/)||[])[1]||"image/jpeg",a=o.split("/")[1],r=atob(i[1]),l=r.length,c=new Uint8Array(l);l--;)c[l]=r.charCodeAt(l);return new File([c],n+"."+a,{type:o})}catch(t){e.showLog(t)}}function k(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),o=i.length,a=new Uint8Array(o);o--;)a[o]=i.charCodeAt(o);return new Blob([a],{type:n})}return y(r),c}}(bui||{},libs),function(e,t){e.file=function(n){var i,o,a,r,l,c={getFolder:d,removeFolder:function(e){var n=t.extend(!0,{},e);s.needNative?l.removeFolder(n):d({root:n.root,folderName:n.folderName,create:n.create,onSuccess:function(e,t){e.removeRecursively((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}});return this},getFile:p,getFileName:h,removeFile:function(e){var n=t.extend(!0,{},e);s.needNative?l.removeFile(n):p({root:n.root,create:n.create,folderName:n.folderName,fileName:n.fileName,onSuccess:function(e,t){e.remove((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}});return this},toBase64:function(e){return r.toBase64(e),this},open:function(t){var n=t||{};if(!n.url)return;s.needNative?l.open(n):e.showLog("web暂不支持open方法","bui.file.open:web");return this},init:u},s=c.config=t.extend(!0,{},{size:10,native:!0,needNative:!1},e.config.file,n);"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;function u(n){return r=e.fileselect(n),o=function(n){var o=t.Deferred();n.needNative?l=e.native.file&&e.native.file(n,{fileselect:r,module:c})||{}:(i="bui.app",a=1024*parseInt(s.size)*1024,window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,navigator.webkitPersistentStorage&&navigator.webkitPersistentStorage.requestQuota(a,(function(e){window.requestFileSystem(window.PERSISTENT,e,(function(e){o.resolve(e)}),u)})));function u(e){var t="";try{switch(e.code){case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}}catch(e){}var n={msg:t};o.reject(n)}return o}(n),!n.needNative&&d({root:!0,create:!0}),this}function d(e){var n={folderName:i,root:!1,create:!1,msg:"",param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},a=t.extend({},n,e),r="";if(a.create?(r="创建 ",a.param.create=!0):(r="获取 ",a.param.create=!1),s.needNative)l.getFolder(a);else{var u=f(a.folderName);u=a.root?u:i+"/"+u,o.done((function(e){e.root.getDirectory(u,a.param,(function(t){a.onSuccess&&a.onSuccess.call(c,t,e)}),(function(e){var t={msg:r+u+" 文件夹失败"};a.onFail&&a.onFail.call(c,t)}))})).fail((function(e){a.onFail&&a.onFail.call(c,{msg:"文件系统还没准备好."})}))}return this}function f(e){return"."==e[0]||"/"==e[0]||" "==e[0]?f(e.slice(1)):"."!=e[0]&&"/"!=e[0]&&" "!=e[0]?e:void 0}function h(e){return e&&e.indexOf("/")>-1?e.slice(e.lastIndexOf("/")+1,e.indexOf("?")>-1?e.indexOf("?"):void 0):e}function p(e){var n=t.extend({},{fileName:"",folderName:"",root:!1,create:!1,param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},e),o="";if(n.create?(o="创建 ",n.param.create=!0):(o="获取 ",n.param.create=!1),n.fileName&&!(n.fileName.indexOf(".")<0)){if(s.needNative)l.getFile(n);else{var a=h(n.fileName);d({root:n.root,folderName:n.folderName,create:!0,onSuccess:function(e,t){var r=e.name==i?e.name+"/"+a:i+"/"+e.name+"/"+a;t.root.getFile(r,n.param,(function(e){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(e){var t={msg:o+a+" 文件失败"};n.onFail&&n.onFail.call(c,t)}))},onFail:function(e){n.onFail&&n.onFail(e)}})}return this}n.onFail&&n.onFail()}return u(s),c}}(window.bui||{},window.libs),function(e,t){e.upload=function(n){var i,o,a,r,l,c,s,u={url:"",data:null,headers:{},showProgress:!0,timeout:6e4,contentType:!1,processData:!1,autoClose:!0,native:!0,needNative:!1,method:"POST",fileKey:"file",dataType:"json",mediaType:"picture",from:"picture",onProgress:null,onMask:function(){y()},onSuccess:null,onFail:null},d=t.extend(!0,{},u,e.config.upload,n),f=t.Deferred(),h={init:m,add:function(e){return e.onSuccess=e.onSuccess?e.onSuccess.bind(h):null,e.onFail=e.onFail?e.onFail.bind(h):null,o.add(e),this},remove:function(e,t){var n=v(),i=n.length;if(i<1)return this;/\d/.test(e)&&e.indexOf(".")<0?o.remove(n[e].name,t):"string"==typeof e?o.remove(e,t):o.remove(n[i-1].name,t);return this},resize:function(e){return o.resize(e),this},currentIndex:function(){return o.currentIndex()},currentName:function(){return o.currentName()},clear:function(){return o.clear(),this},data:v,start:b,startAll:function(e){var n=t.extend(!0,{needFileinfo:!1},d,e),i=n[n.fileKey]||o.data();n.data||(n.data={});let a=[];for(let e=0;e<i.length;e++){i[e];!function(e){if(!(e>i.length-1)){if(n.data[n.fileKey]=i[e]&&i[e].data,n.needFileinfo)for(var t in i[e])"data"!==t&&(n.data[t]=i[e]&&i[e][t]);var o=n.onSuccess,r=n.onFail;n.onSuccess=function(t){o&&o.call(h,t),a[e]=t,e==i.length-1&&n.onEnd&&n.onEnd.call(h,a)},n.onFail=function(t){r&&r.call(h,t),a[e]=t,e==i.length-1&&n.onEnd&&n.onEnd.call(h,a)},b(n)}}(e)}return f},stop:y,toBase64:function(e){return o.toBase64(e),this},widget:function(t){var n={loading:i,fileselect:o,ajax:a};return e.widget.call(n,t)}},p=d.showProgress,g=d.onProgress;"object"==typeof n&&void 0!==n.needNative?n.needNative:e.isWebapp;function m(t){return i=e.loading({display:"block",width:30,height:30,opacity:0,autoClose:t.autoClose,callback:t.onMask}),o=e.fileselect.call(h,{native:t.native,needNative:t.needNative,from:t.from,mediaType:t.mediaType}),t&&t.needNative&&(r=e.native.upload&&e.native.upload(t,{loading:i,fileselect:o,module:h})||{}),t.data?(b(t),this):this}function v(){return o.data()}function b(e){var n=t.extend(!0,{},d,e);if(c=n.url,l=o.value(),p=n.showProgress,l){if(p&&i.show(),n&&n.needNative)return r.start(n)||f;var s=n.data,u=Object.keys(s),g=new FormData,m=!1;return u.forEach((function(e,t){n.fileKey===e&&(m=!0),g.append(e,s[e])})),!m&&g.append(n.fileKey,l),n.data=g,function(e){var n=e.onSuccess,i=e.onFail;return a=t.ajax({url:c,type:e.method,data:e.data,cache:e.cache,headers:e.headers,dataType:e.dataType,contentType:e.contentType,processData:e.processData,timeout:e.timeout,xhr:function(){var e=t.ajaxSettings.xhr();if(w&&e.upload)return e.upload.addEventListener("progress",w,!1),e},success:function(e){x(),n&&n.call(h,e),f.resolve(e)},error:function(e,t,n){x(),i&&i.call(h,e,t),f.reject(e,t,n)}}),f}(n)}}function y(e){return d&&d.needNative?r.stop(e):(i&&i.stop(),a&&a.abort(),e&&e.call(h,i,a)),this}function w(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);s=t.toString()+"%",t<100?(n=s,p&&i&&i.show({text:n})):x(),g&&g.call(h,s)}var n}))}function x(){return i&&i.stop(),this}return m(d),h}}(window.bui||{},window.libs),function(e,t){e.download=function(n){var i,o,a,r,l,c,s={open:function(e){return o.open(e),this},getFile:function(e){var n=t.extend(!0,{autoDown:!0},u,e),i=e.fileName||o.getFileName(n.url);o.getFile({fileName:i,folderName:n.folderName,onSuccess:function(e,t){n.onSuccess&&n.onSuccess.call(s,e.fullPath||e,e,t)},onFail:function(e){n.autoDown=b(n)}})},removeFile:function(t){if(!t.fileName)return e.showLog("请告诉我们你要删除哪个文件, fileName "),this;return t.folderName=t.folderName||u.folderName,o.removeFile(t),this},removeFolder:function(e){return e.folderName=e.folderName||u.folderName,o.removeFolder(e),this},start:b,stop:y,toBase64:function(e){return o.toBase64(e),this},init:v,widget:function(t){var n={loading:g,file:o,ajax:i};return e.widget.call(n,t)}},u=s.config=t.extend(!0,{},{url:"",data:{},headers:{},method:"GET",showProgress:!0,timeout:6e4,fileName:"",folderName:"download",native:!0,needNative:!0,onProgress:null,onSuccess:null,onFail:null},e.config.download,n),d="object"==typeof n&&void 0!==n.needNative?!n.needNative:e.isWebapp,f=u.showProgress,h=u.onProgress,p=u.onFail,g=null,m=null;function v(t){return g=t.showProgress&&e.loading({display:"block",width:30,height:30,opacity:0,callback:function(){y()}}),o=e.file({native:t.native,needNative:t.needNative}),t.needNative?a=e.native.download&&e.native.download(t,{file:o,loading:g,module:s})||{}:function(e){if(o.getFolder({folderName:e.folderName,create:!1,onSuccess:function(e,t){l=e.fullPath},onFail:function(t){o.getFolder({folderName:e.folderName,create:!0,onSuccess:function(e,t){l=e.fullPath},onFail:function(e){p&&p.call(s,e)}})}}),!e.url)return;b(e)}(t),this}function b(e){var n=t.extend(!0,{},u,e);r=n.needEncode?encodeURI(n.url):n.url,h=n.onProgress,(f=n.showProgress)&&g&&g.show({text:"0%"}),l+"/"+(e.fileName||o.getFileName(n.url)),n.needNative?a.start(n):(n.cache=!1,n.contentType=!1,n.processData=!1,i=t.ajax({url:r,type:n.method,data:n.data,cache:n.cache,headers:n.headers,contentType:n.contentType,processData:n.processData,timeout:n.timeout,xhr:function(){var e=t.ajaxSettings.xhr();if(w&&e)return e.addEventListener("progress",w,!1),e},success:function(t){var i=e.fileName||o.getFileName(n.url);o.getFile({fileName:i,folderName:n.folderName,create:!0,onSuccess:function(e,t){n.onSuccess&&n.onSuccess.call(s,e.fullPath,t)}})},fail:function(e){x(),n.onFail&&n.onFail.call(s,e)}}))}function y(e){d?(x(),i&&i.abort(),m&&window.cancelAnimationFrame(m)):a.stop(),e&&e.call(s,g,i)}function w(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,m=window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);c=t.toString()+"%",t<100?(n=c,f&&g&&g.show({text:n})):x(),h&&h.call(s,c)}var n}))}function x(){f&&g&&g.stop()}return v(u),s}}(window.bui||{},window.libs),function(e,t){e.currentPlatform="webapp",e.on("pagereadybefore",(function(){e.platform.isWindow()||e.platform.isMac()?window.viewport=e.viewport(40):window.viewport=e.viewport(),e.config.init.auto&&e.init(),!e.hasRouter&&e.config.component.auto&&loader.components({id:"body"})})),e.webready=function(n){t(document).ready((function(){e.trigger.call(e,"pagereadybefore"),n&&n.call(e),e.trigger.call(e,"pageready")}))},e.ready=function(n){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp;var i=t.Deferred();if(e.isWebapp)t(document).ready((function(){e.trigger.call(e,"pagereadybefore"),n&&n.call(e),e.trigger.call(e,"pageready"),i.resolve()}));else{if(void 0===e.native.ready)return e.showLog("当前 bui.isWebapp = false; 但bui.js为webapp版本,不支持原生方法,请使用 buijs update -p xxx, 更换bui.js为对应xxx平台版本;"),e.webready(n),i;i=e.native.ready&&e.native.ready(n)||i}return i}}(window.bui||{},window.libs),function(e,t){e.checkVersion=function(n){n=n||{};var i,o,a,r,l,c=t.extend(!0,{id:"",target:"i",title:"版本更新",tips:{nowVersion:"",minVersion:"您的版本太低,需要卸载安装最新版才能正常使用!",fail:"网络超时,请检测网络再次尝试"},field:{data:""},currentVersion:"",currentVersionCode:"",width:580,height:500,mask:!0,needTips:!0,baseUrl:"",url:"",data:{},native:!0,needNativeRun:!0,needNative:!1,method:"GET",buttons:[{name:"取消",className:""},{name:"立即下载",className:"primary-reverse"}],timeout:2e4,callback:null,onSuccess:null,onFail:null},e.config.checkVersion,n),s=t("body"),u=t(c.id),d=!1,f=parseInt(c.currentVersionCode||e.config.versionCode),h=c.currentVersion||e.config.version,p=c.tips.minVersion,g=c.tips.nowVersion||"您目前的版本"+h+",已经是最新了 ^_^",m=c.target.indexOf("#")>-1?e.obj(c.target):u?u.find(c.target):null,v=e.confirm;function b(){e.platform.isIos()?e.run({id:l,native:c.native,needNative:c.needNativeRun}):e.run({id:r,native:c.native,needNative:c.needNativeRun})}!function(n){!function(n){e.ajax(n).done((function(h){var m=h&&"object"===e.typeof(h)?h:{},x=c.field.data?e.unit.getKeyValue(c.field.data,m):m,k=parseInt(x.minVersionCode);r=x.downloadUrl||"",l=x.iosDownloadUrl||"",o=x.remark||"检测到新版本"+a+",是否立即下载",i=parseInt(x.versionCode),a=x.versionName,x.forced="false"!=x.forced&&0!=x.forced,x.isForced||x.forced?(y(),f<k?v({title:n.title,content:p,width:n.width,height:n.height,mask:n.mask,autoClose:!1,buttons:[{name:"立即下载",className:"primary-reverse"}],callback:function(){try{b()}catch(t){e.showLog(t)}}}):f>k&&f<i?v({title:n.title,content:o,buttons:n.buttons,width:n.width,height:n.height,mask:n.mask,callback:function(){try{"立即下载"==t(event.target).text().trim()&&b()}catch(t){e.showLog(t)}}}):(w(),n.needTips&&e.hint(g))):f<i?y():w(),c.onSuccess&&c.onSuccess(x),!d&&c.id&&function(n){c.id&&u.length?u.off("click").on("click",r):s.off("click",c.id).on("click",c.id,r);function r(){f<i?(y(),v({title:"新版本"+a,content:o,buttons:n.buttons,width:n.width,height:n.height,mask:n.mask,callback:function(e){"立即下载"==t(e.target).text().trim()&&b()}})):(w(),e.hint(g)),n.callback&&n.callback.call(this)}d=!0}(n)})).fail((function(t){c.onFail&&c.onFail(),n.tips.fail&&e.hint(n.tips.fail)}))}(n)}(c);var y=function(){m&&m.find(".bui-badges").length||m&&m.append('<span class="bui-badges"></span>')},w=function(){m&&m.find(".bui-badges").remove()}}}(window.bui||{},window.libs),bui,libs,function(e,t){e.native.run=function(t){if(t.id){if(t.data&&t.data,t.id.indexOf("http")>-1)return e.native.openWeb({url:t.id}),this;if(t.id.indexOf(".")>-1)return e.native.openFile({url:t.id}),this}else e.showLog("id 不能为空","bui.run")},e.native.openWeb=function(e){("object"!=typeof e||e.url)&&cordova.exec((function(t){e.success&&e.success(t)}),(function(t){e.fail&&e.fail(result)}),"WorkPlus_WebView","openWebView",[{url:e.url,title:e.title||"",use_android_webview:!0,display_mode:!1===e.fullscreen?"":"FULL_SCREEN"}])},e.native.openFile=function(e,t,n,i){e=e||"",n=n||function(e){},i=i||function(e){app.hint("没有找到合适的程序打开该文件")},cordova.exec((function(e){n&&n(e)}),(function(e){i&&i(e)}),"WorkPlus_Files","readFile",[{path:e}])}}(bui||{},libs),function(e,t){e.native.fileselect=function(n,i){var o=n,a={add:function(n){r=null;var i=this,a=t.extend(!0,{width:800,height:800},o,n);function c(t){var n=t.imageURL||t.key;r=n;var o=n.lastIndexOf("?"),c=o<0?void 0:o,s=n.slice(n.lastIndexOf(".")+1,c),u=n.slice(n.lastIndexOf("/")+1,c),d="image/"+s;if(!e.array.compare(u,l,"name")){var f={name:u,data:n,type:d};l.push(f)}a.onSuccess&&a.onSuccess.call(i,n,l,t)}!function(e){switch(e.from){case"picture":case"photo":case"savephoto":s({success:function(e){c(e)},fail:function(t){e.fail&&e.fail(t)}});break;case"camera":!function(e){e=e||{},cordova.exec((function(t){e.success&&e.success(t)}),(function(t){e.fail&&e.fail(t)}),"WorkPlus_Image","takePhoto",[])}({success:function(e){c(e)},fail:function(t){e.fail&&e.fail(t)}});break;default:s({success:function(e){c(e)},fail:function(t){e.fail&&e.fail(t)}})}}(a)},remove:function(t,n){n=n||"name";if("string"==typeof t){var i=(l=e.array.remove(t,l,n)).length?l[l.length-1].data:null;return r=i,l}return this},clear:function(){return r=null,l=[]},value:function(){return r},data:function(){return l},toBase64:function(e){var t=(e=e||{}).data||r,n=e.onSuccess,i=e.onFail;try{!function(e,t,n){function i(e,t){"android"===cordova.platformId.toLowerCase()&&(e="file://"+e),window.resolveLocalFileSystemURL(e,(function(e){e.file((function(e){o(e,t)}),a)}),a)}function o(e,t){var n=new FileReader;n.onloadend=function(e){e.target._result&&(e.target._result=e.target._result.split(",")[1]),t(e.target._result,e)},n.readAsDataURL(e)}function a(e){n(e)}i(e,t)}(t,n,i)}catch(e){console.log(e)}return this},init:c},r=null,l=[];function c(){l=[]}function s(e){e=e||{},cordova.exec((function(t){e.success&&e.success(t)}),(function(t){e.fail&&e.fail(t)}),"WorkPlus_Image","selectImage",[])}return c(),a}}(bui||{},libs),function(e,t){e.native.file=function(n,i){var o,a,r,l,c={getFolder:d,removeFolder:function(e){var n=t.extend(!0,{},e);return d({root:n.root,folderName:n.folderName,create:n.create,onSuccess:function(e,t){e.removeRecursively((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.folderName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}}),this},getFile:h,getFileName:function(e){return e&&e.indexOf("/")>-1?e.slice(e.lastIndexOf("/")+1,e.indexOf("?")>-1?e.indexOf("?"):void 0):e},removeFile:function(e){var n=t.extend(!0,{},e);return h({root:n.root,create:n.create,folderName:n.folderName,fileName:n.fileName,onSuccess:function(e,t){e.remove((function(){n.onSuccess&&n.onSuccess.call(c,e,t)}),(function(t){var i={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,i,e)}))},onFail:function(e){var t={msg:"删除 "+n.fileName+" 文件失败"};n.onFail&&n.onFail.call(c,t)}}),this},open:function(e){var t=e||{};if(!t.url)return;var n=t.url||"";return cordova.exec((function(e){t.onSuccess&&t.onSuccess.call(c,entry)}),(function(e){t.onFail&&t.onFail.call(c,e)}),"WorkPlus_Files","readFile",[{path:n}]),this},init:u},s=n;(i=i||{}).fileselect,e.isWebapp||s.native;function u(e){return window.app&&app.getInfo((function(e){o=e.id||"bui.app",a=o})),l=function(){var e=t.Deferred();if(r=LocalFileSystem,0,window.requestFileSystem&&r)window.requestFileSystem(r&&r.PERSISTENT,0,(function(t){e.resolve(t)}),i);else{var n={msg:"不支持requestFileSystem"};e.reject(n)}function i(t){var n="";switch(t.code){case FileError.QUOTA_EXCEEDED_ERR:n="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:n="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:n="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:n="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:n="INVALID_STATE_ERR";break;default:n="Unknown Error"}var i={msg:n};e.reject(i)}return e}(),d({root:!0,create:!0}),this}function d(e){var n={folderName:a,root:!1,create:!1,msg:"",param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},i=t.extend({},n,e),o="";i.create?(o="创建 ",i.param.create=!0):(o="获取 ",i.param.create=!1);var r=f(i.folderName);return r=i.root?r:a+"/"+r,l.done((function(e){e.root.getDirectory(r,i.param,(function(t){i.onSuccess&&i.onSuccess.call(c,t,e)}),(function(e){var t={msg:o+r+" 文件夹失败"};i.onFail&&i.onFail.call(c,t)}))})).fail((function(e){i.onFail&&i.onFail.call(c,{msg:"文件系统还没准备好."})})),this}function f(e){return"."==(e=e||"")[0]||"/"==e[0]||" "==e[0]?f(e.slice(1)):"."!=e[0]&&"/"!=e[0]&&" "!=e[0]?e:void 0}function h(e){var n=t.extend({},{fileName:"",folderName:"",root:!1,create:!1,param:{create:!1,exclusive:!1},onSuccess:null,onFail:null},e),i={name:n.fileName,success:n.onSuccess,fail:n.onFail};try{!function(e){if("object"!=typeof e)return;var t=e.name,n=(e.mimeType||t.substr(t.lastIndexOf(".")+1),e.success||function(){}),i=e.fail||function(){};!function(e,t){cordova.exec((function(t){var n={};n.sdcard=t,n.documents=t,e&&e(n)}),(function(e){t&&t(e)}),"WorkPlus_Files","getUserFilePath",[{system:"file"}])}((function(e){var o=e.sdcard+t;!function(e,t,n){cordova.exec((function(e){t&&t(e)}),(function(e){n&&n(e)}),"WorkPlus_Files","isFileExist",[{path:e}])}(o,(function(e){var a={};e.exist?(a.isFile=!0,a.name=t,a.fullPath=o,n&&n.call(c,a.fullPath,a)):i&&i.call(c,a)}))}))}(i)}catch(e){console.log(e)}return this}return u(),c}}(bui||{},libs),function(e,t){e.native.upload=function(e,n){var i,o,a,r,l=e,c={init:h,start:p,stop:function(e){return s&&s.stop(),i&&i.abort(),e&&e.call(c,s,i),this}},s=(n=n||{}).loading||function(){},u=n.fileselect||function(){},d=l.showProgress,f=l.onProgress;function h(e){e.data&&p(e)}function p(e){var n=t.extend(!0,{},l,e);if(a=n.url,o=u.value(),d=n.showProgress,o)return d&&s.show(),function(e){var t=e.onSuccess,n=e.onFail;a=encodeURI(e.url);var r=new FileUploadOptions;r.fileKey=e.fileKey,r.mimeType=e.mimeType,r.fileName=o.substr(o.lastIndexOf("/")+1)||"image.jpg",r.params=e.data,(i=new FileTransfer).onprogress=g,i.upload(o,a,(function(e){m();var n=JSON.parse(e.response);t&&t.call(c,n)}),(function(e){m(),n&&n.call(c,e)}),r)}(n),this}function g(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);r=t.toString()+"%",t<100?(n=r,s&&s.show({text:n})):m(),f&&f.call(c,r)}var n}))}function m(){return s&&s.stop(),this}return h(l),c}}(bui||{},libs),function(e,t){e.native.download=function(n,i){var o,a={start:d,stop:function(){h()},toBase64:function(e){return l.toBase64(e),this},init:u},r=a.config=t.extend(!0,{},{url:"",data:{},headers:{},method:"GET",showProgress:!0,timeout:6e4,fileName:"",folderName:"download",native:!0,onProgress:null,onSuccess:null,onFail:null},e.config.download,n),l=(i=i||{}).file,c=i.loading,s=(e.isWebapp||r.native,r.showProgress,r.onProgress);r.onFail;function u(e){if(e.url)return d(e),this}function d(e){var t,n;e&&!e.url||(t=function(t){var n=e.data||{},i=new FileTransfer,o=encodeURI(e.url),r=e.fileName||e.url.substr(e.url.lastIndexOf("/")),l=t.sdcard+r;e.onProgress,e.showProgress&&c.show({text:"0%"}),i.onprogress=f,i.download(o,l,(function(t){try{h(),e.onSuccess&&e.onSuccess.call(a,t.fullPath,t,c)}catch(e){console.log(e)}}),(function(t){h(),e.onFail&&e.onFail.call(a,t,c)}),!1,n)},cordova.exec((function(e){var n={};n.sdcard=e,n.documents=e,t&&t(n)}),(function(e){n&&n(e)}),"WorkPlus_Files","getUserFilePath",[{system:"file"}]))}function f(e){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.requestAnimationFrame((function(){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);o=t.toString()+"%",t<100?(n=o,c&&c.show({text:n})):h(),s&&s.call(a,o)}var n}))}function h(){c&&c.stop()}return u(r),a}}(bui||{},libs),function(e,t){e.currentPlatform="workplus",e.native.ready=function(n){var i=t.Deferred();return"undefined"==typeof cordova?(e.showLog("请检查页面有没有引入 Cordova.js ","bui.native.ready:workplus"),e.webready(n),i.reject()):e.platform.isMac()||e.platform.isWindow()?(e.showLog("调用手机原生功能,需要在debugtool中打开","bui.native.ready:workplus"),e.webready(n),i.reject()):window.addEventListener("load",(function(t){document.addEventListener("deviceready",(function(){e.trigger.call(e,"pagereadybefore"),n&&n(),e.trigger.call(e,"pageready"),i.resolve()}),!1)}),!1),i}}(bui||{},libs),function(e,t){e.init=function(n){var i,o={id:".bui-page",height:0,header:"header",main:"main",footer:"footer",reduceRem:0};if("object"==e.typeof(n))i=t.extend({},o,e.config.init,n);else{var a={};a.height=n,i=t.extend({},o,a)}var r=i.height||document.documentElement.clientHeight||t("body").height()||t("#bui-router").height()||t(".bui-page").height();if(!(e.obj(i.main).length<1)){try{var l=e.obj(i.id),c=i.header.indexOf("#")>-1?e.obj(i.header)[0]:l.children(i.header)[0],s=i.footer.indexOf("#")>-1?e.obj(i.footer)[0]:l.children(i.footer)[0],u=i.main.indexOf("#")>-1?e.obj(i.main):l.children(i.main),d=c?c.offsetHeight:0,f=s?s.offsetHeight:0,h=i.reduceRem>0?e.unit.remToPx(i.reduceRem):0,p=r-d-f-h;if(parseInt(p)>0)u.height(p);else{var g=d+f+h+"px";e.unit.calcHeight(u,g)}}catch(t){e.showLog(t,"bui.init")}return p}},window.addEventListener?window.addEventListener("load",(function(t){e.trigger.call(e,"onload")}),!1):window.attachEvent("onload",(function(t){e.trigger.call(e,"onload")})),t(document).ready((function(){e.isWebapp=void 0===e.isWebapp?e.debug:e.isWebapp,e.trigger.call(e,"pagebefore"),"function"==typeof FastClick&&FastClick.attach(document.body),e.trigger.call(e,"pageinit")}));try{var n="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"",i=n.replace(/hidden/i,"visibilitychange");document.addEventListener(i,(function(t){document[n]?e.trigger.call(e,"pagehide",t):e.trigger.call(e,"pageshow",t)}))}catch(e){}try{navigator.control.gesture(!1),navigator.control.longpressMenu(!1)}catch(e){}}(window.bui||{},window.libs)}));
